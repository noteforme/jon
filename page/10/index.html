<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Jon&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  
  
    <link rel="alternate" href="/atom.xml" title="Jon's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="/localshare/css/share.css">

  
  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Jon&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Cease to struggle and you cease to live. - Thomas Carlyle</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/."><i class="fa fa-home"></i> Start</a>
        
          <a class="main-nav-link" href="/archives/"><i class="fa fa-archive"></i> Archiv</a>
        
          <a class="main-nav-link" href="/about/"><i class="fa fa-user"></i> Über</a>
        
          <a class="main-nav-link" href="/atom.xml"><i class="fa fa-rss"></i> RSS</a>
        
      </nav>
    </div>
    <div id="search-form">
      <div id="result-mask" class="hide"></div>
      <label><input id="search-key" type="text" autocomplete="off" placeholder="Suche"></label>
      <div id="result-wrap" class="hide">
        <div id="search-result"></div>
      </div>
      <div class="hide">
        <template id="search-tpl">
          <div class="item">
            <a href="/{path}" title="{title}">
              <div class="title">{title}</div>
              <div class="time">{date}</div>
              <div class="tags">{tags}</div>
            </a>
          </div>
        </template>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  <article id="post-AndroidSource" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/07/25/AndroidSource/">AndroidSource</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-07-25T01:57:29.000Z" itemprop="datePublished">2018年07月25日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/ANDROID/">ANDROID</a>
  </div>

      
      
<a href="/2018/07/25/AndroidSource/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Gästebuch
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV15W411L7Lc?p=9">https://www.bilibili.com/video/BV15W411L7Lc?p=9</a></p>
<h5 id="源码调试"><a href="#源码调试" class="headerlink" title="源码调试"></a>源码调试</h5><p>要学习Android源码需要编译一份，然后安装要求导入AndroidStudio,可以参考:<br><a target="_blank" rel="noopener" href="http://blog.csdn.net/huaiyiheyuan/article/details/52069122">http://blog.csdn.net/huaiyiheyuan/article/details/52069122</a></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Application</span> <span class="keyword">extends</span> <span class="title">ContextWrapper</span> <span class="title">implements</span> <span class="title">ComponentCallbacks2</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>当我点开父类ContextWrapper后，发现引用的是jar立面的class文件，既然有源码这肯定不是我所需要的，<br>可以这要操作:Project Structure-&gt;Dependencies(可以看到很多jar依赖删掉)-&gt;　＋JARS And Dierctories -&gt;添加源码要关联的frameworks 、packages…</p>
<ol>
<li>新建JDK1.8　选择openjdk8</li>
</ol>
<p>　<img src="/2018/07/25/AndroidSource/DeepinScrot_aosp1.png" alt="新建JDK"></p>
<ol start="2">
<li><p>删除依赖</p>
<p>　<img src="/2018/07/25/AndroidSource/DeepinScrot_aosp5.png" alt="删除依赖"></p>
</li>
</ol>
<p>3.　选择需要的包</p>
<p><img src="/2018/07/25/AndroidSource/DeepinScrot_aosp.png" alt="选择包"></p>
<p>4.　这一步要衡量一下，转为gradle项目后，project structure下面就没有moudles了<br> <img src="/2018/07/25/AndroidSource/DeepinScrot_aosp2.png" alt="添加包"><br>    这个设置后麻烦可以大了，后面不得不删除了android.ipr、android.iws、android.iml这三个文件重新生成</p>
<p>５.　跳转到源码<br>　　找到pacages-&gt; apps-&gt;Settings　<code>public class SettingsDrawerActivity extends Activity &#123;</code></p>
<p>  点开Activity发现还是跳转到jar的内容<br>  <img src="/2018/07/25/AndroidSource/DeepinScrot_aosp6.png" alt="跳转成功"> 点击Ok后再测试下</p>
<p>  <img src="/2018/07/25/AndroidSource/DeepinScrot_aosp7.png" alt="验证"><br>  终于成功了</p>
<p>** 哈哈　然后就可以愉快的调试源码了<br>**</p>
<p>/home/jon/noteforme.github.io/public/2017/08/10/DesignParrerns</p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/news/277549">https://cloud.tencent.com/developer/news/277549</a></p>
<ul>
<li>Activity启动过程</li>
</ul>
<p> 对应用程序Activity进行编译和打包</p>
<pre><code>  /home/jon/桌面/LaoLuo/chapter-7/src/packages/experimental/Activity
  make snod
  emulator
</code></pre>
<p>然后查看activity信息，在这里通过源码里面的 adb</p>
<pre><code>cd  /home/jon/AOSP/out/host/linux-x86/bin
adb shell dumpsys activity
</code></pre>
<blockquote>
</blockquote>
<img src="https://img-blog.csdn.net/20170123173332254?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaXRhY2hpODU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" style="zoom: 67%;">



<p>1.Android系统架构<br>Android系统架构分为五层，从上到下依次是应用层、应用框架层、系统运行库层、硬件抽象层和Linux内核层。</p>
<p>应用层<br>系统内置的应用程序以及非系统级的应用程序都是属于应用层。负责与用户进行直接交互，通常都是用Java进行开发的。</p>
<p>应用框架层（Java Framework)<br>应用框架层为开发人员提供了可以开发应用程序所需要的API，我们平常开发应用程序都是调用的这一层所提供的API，当然也包括系统的应用。这一层的是由Java代码编写的，可以称为Java Framework。下面来看这一层所提供的主要的组件。</p>
<p>名称    功能描述<br>Activity Manager(活动管理器)    管理各个应用程序生命周期以及通常的导航回退功能<br>Location Manager(位置管理器)    提供地理位置以及定位功能服务<br>Package Manager(包管理器)    管理所有安装在Android系统中的应用程序<br>Notification Manager(通知管理器)    使得应用程序可以在状态栏中显示自定义的提示信息<br>Resource Manager（资源管理器）    提供应用程序使用的各种非代码资源，如本地化字符串、图片、布局文件、颜色文件等<br>Telephony Manager(电话管理器)    管理所有的移动设备功能<br>Window Manager（窗口管理器）    管理所有开启的窗口程序<br>Content Providers（内容提供器）    使得不同应用程序之间可以共享数据<br>View System（视图系统）    构建应用程序的基本组件<br>表1<br>系统运行库层（Native)<br>系统运行库层分为两部分，分别是C/C++程序库和Android运行时库。下面分别来介绍它们。</p>
<p>1.C/C++程序库<br>C/C++程序库能被Android系统中的不同组件所使用，并通过应用程序框架为开发者提供服务，主要的C/C++程序库如下表2所示。</p>
<p>名称    功能描述<br>OpenGL ES    3D绘图函数库<br>Libc    从BSD继承来的标准C系统函数库，专门为基于嵌入式Linux的设备定制<br>Media Framework    多媒体库，支持多种常用的音频、视频格式录制和回放。<br>SQLite    轻型的关系型数据库引擎<br>SGL    底层的2D图形渲染引擎<br>SSL    安全套接层，是为网络通信提供安全及数据完整性的一种安全协议<br>FreeType    可移植的字体引擎，它提供统一的接口来访问多种字体格式文件<br>表2<br>2.Android运行时库<br>运行时库又分为核心库和ART(5.0系统之后，Dalvik虚拟机被ART取代)。核心库提供了Java语言核心库的大多数功能，这样开发者可以使用Java语言来编写Android应用。相较于JVM，Dalvik虚拟机是专门为移动设备定制的，允许在有限的内存中同时运行多个虚拟机的实例，并且每一个Dalvik 应用作为一个独立的Linux 进程执行。独立的进程可以防止在虚拟机崩溃的时候所有程序都被关闭。而替代Dalvik虚拟机的ART 的机制与Dalvik 不同。在Dalvik下，应用每次运行的时候，字节码都需要通过即时编译器转换为机器码，这会拖慢应用的运行效率，而在ART 环境中，应用在第一次安装的时候，字节码就会预先编译成机器码，使其成为真正的本地应用。</p>
<p>硬件抽象层（HAL)<br>硬件抽象层是位于操作系统内核与硬件电路之间的接口层，其目的在于将硬件抽象化，为了保护硬件厂商的知识产权，它隐藏了特定平台的硬件接口细节，为操作系统提供虚拟硬件平台，使其具有硬件无关性，可在多种平台上进行移植。 从软硬件测试的角度来看，软硬件的测试工作都可分别基于硬件抽象层来完成，使得软硬件测试工作的并行进行成为可能。通俗来讲，就是将控制硬件的动作放在硬件抽象层中。</p>
<p>Linux内核层<br>Android 的核心系统服务基于Linux 内核，在此基础上添加了部分Android专用的驱动。系统的安全性、内存管理、进程管理、网络协议栈和驱动模型等都依赖于该内核。<br>Android系统的五层架构就讲到这，了解以上的知识对以后分析系统源码有很大的帮助。</p>
<p>2.Android系统源码目录<br>我们要先了解Android系统源码目录，为后期源码学习打下基础。关于源码的阅读，你可以访问<a target="_blank" rel="noopener" href="http://androidxref.com/%E6%9D%A5%E9%98%85%E8%AF%BB%E7%B3%BB%E7%BB%9F%E6%BA%90%E7%A0%81%E3%80%82%E5%BD%93%E7%84%B6%EF%BC%8C%E6%9C%80%E5%A5%BD%E6%98%AF%E5%B0%86%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD%E4%B8%8B%E6%9D%A5%E3%80%82%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E6%B8%85%E5%8D%8E%E5%A4%A7%E5%AD%A6%E5%BC%80%E6%BA%90%E8%BD%AF%E4%BB%B6%E9%95%9C%E5%83%8F%E7%AB%99%E6%8F%90%E4%BE%9B%E7%9A%84Android">http://androidxref.com/来阅读系统源码。当然，最好是将源码下载下来。下载源码可以使用清华大学开源软件镜像站提供的Android</a> 镜像：<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/">https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/</a> 。如果觉得麻烦也可以查找国内的网盘进行下载，推荐使用该百度网盘地址下载：<a target="_blank" rel="noopener" href="http://pan.baidu.com/s/1ngsZs%EF%BC%8C%E5%AE%83%E6%8F%90%E4%BE%9B%E4%BA%86%E5%A4%9A%E4%B8%AAAndroid%E7%89%88%E6%9C%AC%E7%9A%84%E7%9A%84%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD%E3%80%82">http://pan.baidu.com/s/1ngsZs，它提供了多个Android版本的的源码下载。</a></p>
<p>整体结构<br>各个版本的源码目录基本是类似，如果是编译后的源码目录会多增加一个out文件夹，用来存储编译产生的文件。Android7.0的根目录结构说明如下表所示。</p>
<p>从表3可以看出，系统源码分类清晰，并且内容庞大且复杂。接下来分析packages中的内容，也就是应用层部分。<br>应用层部分<br>应用层位于整个Android系统的最上层，开发者开发的应用程序以及系统内置的应用程序都是在应用层。源码根目录中的packages目录对应着系统应用层。它的目录结构如表4所示。</p>
<h5 id="Android-open-source-project"><a href="#Android-open-source-project" class="headerlink" title="Android open source project"></a>Android open source project</h5><h5 id=""><a href="#" class="headerlink" title=""></a></h5><p>Android Architecture</p>
<p><img src="/2018/07/25/AndroidSource/android_stack_720.png" style="zoom:50%;">         <img src="/2018/07/25/AndroidSource/ape_fwk_all.png" style="zoom: 67%;"></p>
<p><a target="_blank" rel="noopener" href="https://source.android.com/">https://source.android.com/</a>                            </p>
<p> <a target="_blank" rel="noopener" href="https://source.android.com/devices/architecture">https://source.android.com/devices/architecture</a></p>
<blockquote>
<pre><code>    Android源码根目录    描述

abi    应用程序二进制接口
art    全新的ART运行环境
bionic    系统C库
bootable    启动引导相关代码
build    存放系统编译规则及generic等基础开发包配置
cts    Android兼容性测试套件标准
dalvik art    虚拟机
developers    开发者目录
development    应用程序开发相关
device    设备相关配置
docs    参考文档目录
external    开源模组相关文件
frameworks    应用程序框架，Android系统核心部分，由Java和C++编写
hardware    主要是硬件抽象层的代码
libcore    核心库相关文件
libnativehelper    动态库，实现JNI库的基础
ndk    NDK相关代码，帮助开发人员在应用程序中嵌入C/C++代码
out    编译完成后代码输出在此目录
packages    应用程序包
pdk    Plug Development Kit 的缩写，本地开发套件
platform_testing    平台测试
prebuilts    x86和arm架构下预编译的一些资源
sdk    sdk和模拟器
system    底层文件系统库、应用和组件
toolchain    工具链文件
tools    工具文件
Makefile    全局Makefile文件，用来定义编译规则
————————————————

https://blog.csdn.net/wenzhi20102321/article/details/80739649

https://blog.csdn.net/wen0006/article/details/5804639
</code></pre>
</blockquote>

        
        
          <blockquote id="copyright">
              <p>Ursprünglicher Link: <a href="http://noteforme.github.io.com/page/10/index.html">http://noteforme.github.io.com/page/10/index.html</a></p>
              <p>Copyright-Erklärung: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AOSP/" rel="tag">AOSP</a></li></ul>

          
    <div class="social-share">
      <span>Aktie:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-ViewDynamic" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/07/17/ViewDynamic/">ViewDynamic</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-07-17T12:25:26.000Z" itemprop="datePublished">2018年07月17日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/ANDROID/">ANDROID</a>
  </div>

      
      
<a href="/2018/07/17/ViewDynamic/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Gästebuch
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="动态添加布局"><a href="#动态添加布局" class="headerlink" title="动态添加布局"></a>动态添加布局</h4><h5 id="LinearLayout添加"><a href="#LinearLayout添加" class="headerlink" title="LinearLayout添加"></a>LinearLayout添加</h5><ul>
<li><p>父容器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout</span><br><span class="line">    android:id=&quot;@+id/ll_plan_one&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:orientation=&quot;vertical&quot;&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>子布局</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">View</span> view1 = inflate.inflate(R.layout.layout_animation, <span class="built_in">null</span>);</span><br><span class="line"><span class="built_in">View</span> view2 = inflate.inflate(R.layout.ic_hpan_suger_press_y, <span class="built_in">null</span>);</span><br><span class="line"><span class="built_in">View</span> view3 = inflate.inflate(R.layout.ic_hpan_suger_press_y, <span class="built_in">null</span>);</span><br></pre></td></tr></table></figure></li>
<li><p>添加进容器</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">llVertical.add<span class="constructor">View(<span class="params">view1</span>)</span>;</span><br><span class="line">llVertical.add<span class="constructor">View(<span class="params">view2</span>)</span>;</span><br><span class="line">llVertical.add<span class="constructor">View(<span class="params">view3</span>)</span>;</span><br></pre></td></tr></table></figure></li>
<li><p>添加同一个子布局会<strong>报错</strong></p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">llVertical.add<span class="constructor">View(<span class="params">view1</span>)</span>;</span><br><span class="line">llVertical.add<span class="constructor">View(<span class="params">view1</span>)</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>​    Caused by: java.lang.IllegalStateException: The specified child already has a parent. You must call removeView() on the child’s parent first.</p>
</blockquote>
</li>
</ul>

        
        
          <blockquote id="copyright">
              <p>Ursprünglicher Link: <a href="http://noteforme.github.io.com/page/10/index.html">http://noteforme.github.io.com/page/10/index.html</a></p>
              <p>Copyright-Erklärung: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Aktie:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Lambda" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/07/11/Lambda/">Lambda</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-07-11T06:23:20.000Z" itemprop="datePublished">2018年07月11日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/JAVA/">JAVA</a>
  </div>

      
      
<a href="/2018/07/11/Lambda/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Gästebuch
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://blog.oneapm.com/apm-tech/226.html">http://blog.oneapm.com/apm-tech/226.html</a></p>
<p>android </p>
<p><a target="_blank" rel="noopener" href="https://maxwell-nc.github.io/android/retrolambda.html">https://maxwell-nc.github.io/android/retrolambda.html</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1526621">https://cloud.tencent.com/developer/article/1526621</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/6844903668592934925">https://juejin.im/post/6844903668592934925</a></p>
<p>kotlin  lambda</p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/6844903604613021703">https://juejin.im/post/6844903604613021703</a></p>
<p>Video</p>
<h4 id="Java-lambda"><a href="#Java-lambda" class="headerlink" title="Java lambda"></a>Java lambda</h4><p>函数式编程</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/av54941486/">https://www.bilibili.com/video/av54941486/</a></p>
<p><a target="_blank" rel="noopener" href="http://www.chilangedu.com/sectionq/2132352424">http://www.chilangedu.com/sectionq/2132352424</a></p>
<h5 id="map"><a href="#map" class="headerlink" title="map"></a>map</h5><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;R&gt; Stream&lt;R&gt; <span class="keyword">map</span>(<span class="built_in">Function</span>&lt;? <span class="built_in">super</span> T, ? <span class="keyword">extends</span> R&gt; mapper);</span><br></pre></td></tr></table></figure>

<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="symbol">Function</span>&lt;<span class="symbol">T</span>, <span class="symbol">R</span>&gt; &#123;</span><br><span class="line">	    R apply(T t); <span class="comment">//将T类型转为R</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




        
        
          <blockquote id="copyright">
              <p>Ursprünglicher Link: <a href="http://noteforme.github.io.com/page/10/index.html">http://noteforme.github.io.com/page/10/index.html</a></p>
              <p>Copyright-Erklärung: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Aktie:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-EventBus" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/07/11/EventBus/">EventBus</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-07-11T06:12:08.000Z" itemprop="datePublished">2018年07月11日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/ANDROID/">ANDROID</a>
  </div>

      
      
<a href="/2018/07/11/EventBus/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Gästebuch
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ol>
<li><p>定义事件类</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessageEvent</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="built_in">String</span> message;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="title">MessageEvent</span>(<span class="params"><span class="built_in">String</span> message</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">String</span> <span class="function"><span class="title">getMessage</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p> EventBusActivity</p>
</li>
</ol>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Subscribe</span>(threadMode = ThreadMode.MAIN)</span><br><span class="line"><span class="keyword">public</span>  <span class="built_in">void</span>  <span class="function"><span class="title">onMessageEvent</span>(<span class="params">MessageEvent messageEvent</span>)</span>&#123;</span><br><span class="line">    btEventRecieve.setText(messageEvent.getMessage());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> <span class="built_in">void</span> <span class="function"><span class="title">onStart</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">     <span class="built_in">super</span>.onStart();</span><br><span class="line">     EventBus.getDefault().register(<span class="built_in">this</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> <span class="built_in">void</span> <span class="function"><span class="title">onStop</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">     <span class="built_in">super</span>.onStop();</span><br><span class="line">     EventBus.getDefault().unregister(<span class="built_in">this</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>GoalEventActivity </li>
</ol>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">findViewById(R.id.bt_message_send).setOnClickListener(v-&gt;&#123;</span><br><span class="line">    <span class="keyword">new</span> Thread<span class="function"><span class="params">(()-&gt;&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">        EventBus.getDefault().post(<span class="keyword">new</span> MessageEvent(<span class="string">&quot;我是 GoalEventActivity&quot;</span>));</span></span></span><br><span class="line"><span class="function"><span class="params">    &#125;)</span>.<span class="title">start</span><span class="params">()</span>;</span></span><br><span class="line"><span class="function">&#125;);</span></span><br></pre></td></tr></table></figure>





<h5 id="类别"><a href="#类别" class="headerlink" title="类别"></a>类别</h5><p>在上面的例子中，我们再注解<code>@Subscribe(threadMode = ThreadMode.MAIN)</code>中使用了ThreadMode.MAIN这个模式，表示该函数在主线程即UI线程中执行，实际上EventBus总共有四种线程模式，分别是： </p>
<ul>
<li>ThreadMode.MAIN：表示无论事件是在哪个线程发布出来的，该事件订阅方法onEvent都会在UI线程中执行，这个在Android中是非常有用的，因为在Android中只能在UI线程中更新UI，所有在此模式下的方法是不能执行耗时操作的。</li>
<li>ThreadMode.POSTING：表示事件在哪个线程中发布出来的，事件订阅函数onEvent就会在这个线程中运行，也就是说发布事件和接收事件在同一个线程。使用这个方法时，在onEvent方法中不能执行耗时操作，如果执行耗时操作容易导致事件分发延迟。</li>
<li>ThreadMode.BACKGROUND：表示如果事件在UI线程中发布出来的，那么订阅函数onEvent就会在子线程中运行，如果事件本来就是在子线程中发布出来的，那么订阅函数直接在该子线程中执行。</li>
<li>ThreadMode.AYSNC：使用这个模式的订阅函数，那么无论事件在哪个线程发布，都会创建新的子线程来执行订阅函数。</li>
</ul>
<p> <a target="_blank" rel="noopener" href="https://github.com/greenrobot/EventBus">https://github.com/greenrobot/EventBus</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/a040955194fc">https://www.jianshu.com/p/a040955194fc</a></p>
<p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000004279679">https://segmentfault.com/a/1190000004279679</a></p>

        
        
          <blockquote id="copyright">
              <p>Ursprünglicher Link: <a href="http://noteforme.github.io.com/page/10/index.html">http://noteforme.github.io.com/page/10/index.html</a></p>
              <p>Copyright-Erklärung: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Aktie:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Bluetooth02" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/07/05/Bluetooth02/">Bluetooth02</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-07-05T10:17:23.000Z" itemprop="datePublished">2018年07月05日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/BLE/">BLE</a>
  </div>

      
      
<a href="/2018/07/05/Bluetooth02/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Gästebuch
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="BLE-stack-蓝牙协议栈"><a href="#BLE-stack-蓝牙协议栈" class="headerlink" title="BLE stack(蓝牙协议栈)"></a>BLE stack(蓝牙协议栈)</h4><img src="/2018/07/05/Bluetooth02/bluetooth_20180706093223.png" alt="bluetooth_20180706093223" style="zoom: 80%;">



<p> 作为 Android 开发者，我们不必理解 BLE 的协议栈每个细节，这里大概介绍一下协议架构。 协议一般都是分层设计的。BLE 协议栈也不例外。我们来看一下这个图。整个协议栈大致分为三部分，从下到上分别为，控制器    （Controller）→主机（Host）→应用（Applications）。 </p>
<ul>
<li>Controller :  它是协议栈的底层的实现，直接与硬件相关，一般直接集成在 SoC 中，由芯片厂商实现，包括物理层和链路层。 </li>
<li>HOST : 这是协议栈的上层实现，是硬件的抽象，与具体的硬件和厂家无关 </li>
<li>应用层： 就是使用 Host 层提供的 API，开发的应用。 </li>
</ul>
<h4 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h4><ul>
<li><p>PhysicalLayer(物理层 ): 蓝牙是工作在 2.4GHz 附近，这是工业、科学、医疗 ISM 频段。可以看到它和 WiFi 工作在同一个频段。蓝牙把频段切分为 40 个通道，3 个广播通道，37 个数据通道，按照一定规律跳频通信（高斯频移键控 GFSK）。 </p>
</li>
<li><p>HCI   : 在 Host 层和 Controller 之间有一个接口层 :主机和控制器之间就是通过 HCI 命令和事件交互的。HCI 这一层是协议栈中是可选的，例如在一些简单小型的设备上可能就没有，但是所有的 Android 设备上肯定是有。这是蓝牙上层应用和芯片的交互的必经之路。后面我们会讲到，这一层的 log，能够很好的帮助我们分析和调试问题。 </p>
</li>
</ul>
<h4 id="Host"><a href="#Host" class="headerlink" title="Host"></a>Host</h4><h5 id="ATT-Attribute-Protocol"><a href="#ATT-Attribute-Protocol" class="headerlink" title="ATT (Attribute Protocol)"></a>ATT (Attribute Protocol)</h5><p>它是 BLE 通信的基础。ATT 把数据封装，向外暴露为“属性”，提供“属性”的为服务端，获取“属性”的为客户端。ATT 是专门为低功耗蓝牙设计的，结构非常简单，数据长度很短 .</p>
<h5 id="GATT-Generic-Attribute-Profile"><a href="#GATT-Generic-Attribute-Profile" class="headerlink" title="GATT(Generic Attribute Profile)"></a>GATT(Generic Attribute Profile)</h5><p> 全称叫做通用属性配置文件，它是建立在前面说的 ATT 的基础上，对 ATT 进行进一步的逻辑封装，定义数据的交互方式和含义。这是我们做 BLE 开发的时候直接接触的概念。 GATT 按照层级定义了三个概念：服务（Service）、特征（Characteristic）和描述（Descriptor）。 一个 Service 包含若干个 Characteristic，一个 Characteristic 可以包含若干 Descriptor。而 Characteristic 定义了数值和操作。Characteristic 的操作这几种权限：读、写、通知等权限。我们说的 BLE 通信，其实就是对 Characteristic 的读写或者订阅通知。还有最外面一层，Profile配置文件，把若干个相关的 Service 组合在一起，就成为了一个 Profile，Profile 就是定义了一个实际的应用场景。 </p>
<p><img src="/2018/07/05/Bluetooth02/Bluetooth02%5Cbluetooth_20180706102358.png" alt="Bluetooth02_20180706102358"></p>
<p>Service、Characteristic相当于标签（Service相当于他的类别，Characteristic相当于它的名字），而value才真正的包含数据，Descriptor是对这个value进行的说明和描述，当然我们可以从不同角度来描述和说明，因此可以有多个Descriptor. </p>
<ul>
<li>例如: </li>
</ul>
<p>常见的小米手环是一个BLE设备，（假设）它包含三个Service,分别是提供设备信息的Service、提供步数的Service、检测心率的Service; 而设备信息的service中包含的characteristic包括厂商信息、硬件信息、版本信息等；而心率Service则包括心率characteristic等，而心率characteristic中的value则真正的包含心率的数据，而descriptor则是对该value的描述说明，比如value的单位啊，描述啊，权限啊等。 </p>
<h5 id="GAP-Generic-Access-Profile"><a href="#GAP-Generic-Access-Profile" class="headerlink" title="GAP(Generic Access Profile)"></a>GAP(Generic Access Profile)</h5><p>它定义了 BLE 整个通信过程中的流程，例如广播、扫描、连接等流程。还定义了参与通信的设备角色，以及他们各自的职能，例如广播数据的 Broadcaster，接收广播的 Observer，还有被连接的“外设” Peripheral 和发起连接的“中心设备” Central。可以看到，参与交互的设备角色都不是对等 </p>
<h5 id="Applications"><a href="#Applications" class="headerlink" title="Applications"></a>Applications</h5><p>就是使用 Host 提供的 API 开发的低功耗蓝牙应用。 到这里，我们就把 BLE 的协议栈过了一下，为我们开发 BLE 有了一些理论基础。 </p>
<h4 id="BLE-on-Android"><a href="#BLE-on-Android" class="headerlink" title="BLE on Android"></a>BLE on Android</h4><ul>
<li><p>Central mode :  从Android 4.3 Jelly Bean，也就是 API 18 才开始支持低功耗蓝牙(蓝牙4.0)。这时支持 BLE 的 Central 模式，也就是我们在上面 GAP 中说的，Android 设备只能作为中心设备去连接其他设备。</p>
</li>
<li><p>Peripheral mode:从 Android 5.0 开始才支持外设模式(蓝牙4.1)。Android 设备现在可以发挥蓝牙 LE <em>外围设备</em>的作用。应用可以利用此功能让附近设备发现它。例如，您可以开发这样的应用：让设备发挥计步器或健康监测仪的作用，并与其他蓝牙 LE 设备进行数据通信。</p>
<p>新增的 <code>android.bluetooth.le</code> API 让您的应用可以发布广告、扫描响应以及与附近的蓝牙 LE 设备建立连接。要使用新增的广告和扫描功能，请在您的清单中添加 <code>BLUETOOTH_ADMIN</code> 权限。当用户更新您的应用或从 Play 商店下载您的应用时，会被要求向您的应用授予以下权限：“Bluetooth connection information:Allows the app to control Bluetooth, including broadcasting to or getting information about nearby Bluetooth devices.”</p>
<p>要启动蓝牙 LE 广播，以便其他设备能发现您的应用，请调用 <code>startAdvertising()</code>，并传入 <code>AdvertiseCallback</code> 类的实现。回调对象会收到广播操作成功或失败的报告。</p>
<p>Android 5.0 引入了 <code>ScanFilter</code> 类，让您的应用可以只扫描其感兴趣的特定类型设备。要开始扫描蓝牙 LE 设备，请调用 <code>startScan()</code>，并传入筛选器列表。在方法调用中，您还必须提供 <code>ScanCallback</code> 的实现，以便在发现蓝牙 LE 广播时进行报告。</p>
<p><a target="_blank" rel="noopener" href="https://developer.android.com/about/versions/android-5.0?hl=zh-cn#BluetoothBroadcasting">https://developer.android.com/about/versions/android-5.0?hl=zh-cn#BluetoothBroadcasting</a></p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Bluetooth#Communication_and_connection">https://en.wikipedia.org/wiki/Bluetooth#Communication_and_connection</a></p>
</li>
</ul>
<h5 id="Android-7-0-蓝牙架构"><a href="#Android-7-0-蓝牙架构" class="headerlink" title="Android 7.0 蓝牙架构"></a>Android 7.0 蓝牙架构</h5><p><img src="/2018/07/05/Bluetooth02/v2-8bf93957bb78f938894bec7749a0433b_hd.jpg" alt="v2-8bf93957bb78f938894bec7749a0433b_hd"></p>
<h5 id="Android-8-0-蓝牙架构"><a href="#Android-8-0-蓝牙架构" class="headerlink" title="Android 8.0 蓝牙架构"></a>Android 8.0 蓝牙架构</h5><p>Android 提供支持经典蓝牙和蓝牙低功耗的默认蓝牙堆栈。借助蓝牙，Android 设备可以创建个人区域网络，以便通过附近的蓝牙设备发送和接收数据。</p>
<p>在 Android 4.3 及更高版本中，Android 蓝牙堆栈可提供实现蓝牙低功耗 (BLE) 的功能。要充分利用 BLE API，请遵循 <a target="_blank" rel="noopener" href="https://source.android.com/devices/bluetooth/hci_requirements.html?hl=zh-cn">Android 蓝牙 HCI 要求</a>。具有合格芯片组的 Android 设备可以实现经典蓝牙或同时实现经典蓝牙和 BLE。BLE 不能向后兼容较旧版本的蓝牙芯片组。</p>
<p>在 Android 8.0 中，原生蓝牙堆栈完全符合蓝牙 5.0 的要求。要使用可用的蓝牙 5.0 功能，该设备需要具有符合蓝牙 5 要求的芯片组。</p>
<p><strong>注意</strong>：Android 8.0 及以前版本之间的原生蓝牙堆栈的最大变化是使用<a target="_blank" rel="noopener" href="https://source.android.com/devices/architecture/treble.html?hl=zh-cn">高音</a>。Android 8.0 中的供应商实现必须使用 HIDL 而不是 <code>libbt-vendor</code>。</p>
   <img src="/2018/07/05/Bluetooth02/bluetooth_fluoride_architecture.png" alt="fluoride_archite">

<ul>
<li><p>蓝牙系统服务</p>
<p>蓝牙系统服务（位于 <code>packages/apps/Bluetooth</code> 中）被打包为 Android 应用，并在 Android 框架层实现蓝牙服务和配置文件。此应用通过 JNI 调用原生蓝牙堆栈。</p>
</li>
<li><p>JNI</p>
<p>与 android.bluetooth 相关联的 JNI 代码位于 <code>packages/apps/Bluetooth/jni</code> 中。当发生特定蓝牙操作时（例如发现设备时），JNI 代码会调用蓝牙堆栈。</p>
</li>
<li><p>蓝牙堆栈</p>
<p>系统在 AOSP 中提供了默认蓝牙堆栈，它位于 <code>system/bt</code> 中。该堆栈会实现常规蓝牙 HAL，并通过扩展程序和更改配置对其进行自定义。</p>
</li>
<li><p>供应商实现</p>
<p>供应商设备使用硬件接口设计语言 (HIDL) 与蓝牙堆栈交互。</p>
</li>
</ul>
<img src="/2018/07/05/Bluetooth02/android-stack_2x.png" alt="android-stack_2x" style="zoom:67%;">

<h4 id="HIDL"><a href="#HIDL" class="headerlink" title="HIDL"></a>HIDL</h4><p><a target="_blank" rel="noopener" href="https://source.android.com/devices/architecture/hidl.html?hl=zh-cn">HIDL</a> 定义了蓝牙堆栈和供应商实现之间的接口。要生成蓝牙 HIDL 文件，请将蓝牙接口文件传递到 HIDL 生成工具中。接口文件位于 <code>hardware/interfaces/bluetooth</code> 下。</p>
<p><del>Android 7.x 及更早版本的蓝牙架构</del></p>
<p><a target="_blank" rel="noopener" href="https://developer.android.com/guide/platform/?hl=zh-cn">https://developer.android.com/guide/platform/?hl=zh-cn</a></p>
<p><a target="_blank" rel="noopener" href="https://source.android.com/setup/">https://source.android.com/setup/</a></p>
<p><a target="_blank" rel="noopener" href="https://source.android.com/devices/bluetooth/?hl=zh-cn">https://source.android.com/devices/bluetooth/?hl=zh-cn</a></p>
<h5 id="Android-中-BLE-操作的过程"><a href="#Android-中-BLE-操作的过程" class="headerlink" title="Android 中 BLE 操作的过程"></a>Android 中 BLE 操作的过程</h5><p><img src="/2018/07/05/Bluetooth02/Bluetooth02%5Cbluetooth_20180706120947.png" alt="bluetooth_20180706120947"></p>
<p>这里介绍一下 Android 中 BLE 操作的过程，APP 发起一个 BLE 操作，然后理解返回，操作结果通过回调上报。操作被封装为一个消息，然后放到协议栈的消息队列中，有一个独立的线程获取消息进行处理，类似于 Looper 和 Handler 机制。</p>
<p>因为是使用消息机制，回调的时候必须知道通知哪个客户端？客户端发起请求之前，首先要向协议栈注册客户端，注册成功以后，返回一个 clientIf，这是一个整型，是客户端在协议栈的一个句柄，客户端的后续操作，都只需要带上这个 clientIf 句柄即可。</p>
<p>在操作完成的时候，一般都有一个显式的停止操作，用来释放前面的申请的 clientIf 和资源。如果不能正确的释放，不仅会造成内存泄漏，而且可能会导致后续所有的 BLE 操作都是不能做了。因为这个 clientIf 是有限，在现在蓝牙协议栈中只有 32 个，而且是Android 上所有 APP 共用的。当这些资源用完以后，只有通过杀掉对应的 APP 或者重启蓝牙才能恢复。</p>
<h5 id="BLE-应用"><a href="#BLE-应用" class="headerlink" title="BLE 应用"></a>BLE 应用</h5><p>BLE 应用可以分为两大类：基于非连接的和连接的。</p>
<ul>
<li><p>Beacon 基于非连接的，这种应用就是依赖 BLE 的广播，也叫作 Beacon。这里有两个角色，发送广播的一方叫做 Broadcaster，监听广播的一方叫 Observer。</p>
</li>
<li><p>基于连接的，就是通过建立 GATT 连接，收发数据。这里也有两个角色，发起连接的一方，叫做中心设备—Central，被连接的设备，叫做外设—Peripheral。</p>
</li>
</ul>
<h6 id="非连接"><a href="#非连接" class="headerlink" title="非连接"></a>非连接</h6><p>它的网络拓扑结构如下。我们知道广播是单向的，Broadcaster 向外广播，监听者接收附近的广播，整体来说形成一个单向的星型。网络中可以有多个外设，也可以有多个监听者 </p>
<p>还有些设备，可以同时实现两个角色，既能发送广播，也可以接收广播。一个设备接收到广播，可以通过处理，然后再转发出去，这样就可以形成一个双向的网格，这就是蓝牙的 Mesh。这样的网络可以不受蓝牙传输距离限制了，只要在空间中布置足够密集的节点，就能把信息从网络一点，传递到任何一点。这个可以应用在物联网和智能家居系统中。 </p>
<p>前面在介绍协议栈物理层的时候，我们知道广播只在37、38、39这三个广播频道进行广播，监听者也在这三个频道进行监听。我们前面介绍了，蓝牙通信是跳频的，只有双方设备在某个时刻跳到同一个频到上，才能收到广播，这种传播数据效率比较低，数据量也有限，不适合大规模的数据传输。 </p>
<ul>
<li>广播包 </li>
</ul>
<p><img src="/2018/07/05/Bluetooth02/Bluetooth02%5CAndroid-BLE-in-Action.018.jpeg" alt="Android-BLE-in-Action.018"></p>
<p>​    广播数据其实包含两部分：Advertising Data（广播数据） 和 Scan Response Data（扫描响应数据）。通常    情况下，广播的一方，按照一定的间隔，往空中广播 Advertising Data，当某个监听设备监听到这个广播数据时    候，会通过发送 Scan Response Request，请求广播方发送扫描响应数据数据。这两部分数据的长度都是固定的 31 字节。在 Android 中，系统会把这两个数据拼接在一起，返回一个 62 字节的数组。</p>
<p>广播数据包的结构如这个图所示。广播包中是包含一个一个的小 AD structure，每个 AD structure 是一个完整的数据，它的结构是：第一个字节表示长度 n，后面紧接 n 个字节的数据。数据部分第一个字节表示数据类型，也就是后面的数据含义，后面 n - 1 个字节表示真实数据.</p>
<p><img src="/2018/07/05/Bluetooth02/Bluetooth02%5CAndroid-BLE-in-Action.019.jpeg" alt="Android-BLE-in-Action"></p>
<p>这些广播数据可以自己手动去解析，在 Android 5.0 也提供 ScanRecord 帮你解析，直接可以通过这个类获得有意义的数据。</p>
<ul>
<li><p>广播数据类型：设备连接属性，标识设备支持的 BLE 模式，这个是必须的。设备名字，设备包含的关键 GATT service，或者 Service data，厂商自定义数据等等。  </p>
</li>
<li><p>RSSI （信号强度 ）：RSSI 单位是 dB，通过 RSSI 能够大致推测出距离的远近。但是这个在 Android 设备上非常不靠谱，RSSI 的值波动很大，跟环境和手机的角度关系很大。 </p>
<p>​     Android 作为接收者怎么接收广播数据，扫描设备。代码其实很简单，首先创建一个 LeScanCallback，用来接收收到广播以后，回调上报数据。然后会用 BluetoothAdapter 的 startLeScan 来开始扫描，需要停止扫描的时候，使用 stopLeScan 来停止。 有 BluetoothDevice 这个参数，代表扫描到的设备，关键是设备的的 MAC 地址信息。然后就是 RSSI，表示扫描到的设备的信号强度，接下来 scanRecord 就是我们前面介绍的广播数据，这个数据的长度是62字节。值得提的一点是，BLE 所有回调函数都不是在主线程中的。</p>
<p>这里有几点需要注意，这里在不需要扫描以后，一定要 stopLeScan，而且 start 和 stop 中传入的 LeScanCallback 一定要是同一个，因为 LeScanCallback 就是我们客户端的标识。否者就会出现我们前面说的 clientIf 不释放的问题。在 Android 开发中，我们经常会使用匿名内部类来做参数，在这里就千万不要这么做。</p>
<p>在 Android 5.0 中，提供了全新的扫描 API — BluetoothLeScanner，它提供了对扫描更加精细的控制。</p>
<p>除了这种方法，还可以使用经典蓝牙扫描的方式，BluetoothAdapter 的 startDiscovery()，然后通过 BroadcastReceiver 来接收收到的广播。如果只是做 BLE 的开发，不建议使用这个方法，这是一个非常重的操作，灵活性非常差。</p>
</li>
<li><p>扫描的工作流程 </p>
<p><img src="/2018/07/05/Bluetooth02/E:/noteforme.github.io\source_posts\Bluetooth02\Android-BLE-in-Action.021.jpeg"></p>
<p>​    首先 APP 发起扫描请求，通过蓝牙的 Service 发送请求给蓝牙芯片。蓝牙芯片开始扫描，扫描到了设备，就通过回调上报。我们知道，扫描真正执行实在 BT 芯片中，只要 APP 发送了请求下去以后，Android 系统就可以休眠了，也就是我们常说的 AP （Application Processor），等扫描到了设备以后，底层 BP （Baseband Processor）就会唤醒上层 AP，执行回调通知到 APP，（动画）就像我们图中红色框标出的这样。这里有一个问题，随着我们周围的 BLE 设备逐渐增多，频繁扫描到设备，系统就会被频繁的唤醒，甚至睡眠不下去，从而导致耗电严重。</p>
<p>为了避免这种问题，耗电的问题。我们需要尽可能少的使用扫描。即使需要扫描，我们也希望尽可能少的上报扫描到的设备。这里就可以使用 Android 5.0 上提供的新接口，设置 ScanFilter，通过一定的规则过滤，只有扫描到了符合我们的规则的设备才上报，或者通过设置延迟上报，从而减少唤醒系统的次数。</p>
<p>这里总结一下扫描中一些建议。1、首先，尽可能使用新的 API，功能更强大；2、尽可能少地扫描，因为毕竟扫描是一个比较重的操作，耗电，也会减慢 BLE 连接速度；3、扫描的时候，尽量设置 ScanFilter，只扫描那些你感兴趣的设备，而不是全盘扫描；4、正确使用 API，特别是合理停止扫描，防止资源泄漏。</p>
</li>
<li><p>Android手机 作为 Broadcaster</p>
<p>从 Android 5.0 开始，Android 设备就可以像外设一样发送 BLE 广播了。这时 Android 设备之间就可以通过 BLE 来交互数据，或者发现对方设备了，例如类似 NFC 一样交换简单信息的应用，想象空间还是很大的。</p>
<p>Android 中实现的代码如下，通过前面的介绍，我们知道广播有两种包：Advertising Data 和 Scan Response Data，我们这里设置好这两种包，然后通过 BluetoothLeAdvertier 的 startAdvertising 就可以了。这里需要注意的点和前面一样，Start 了，需要注意 Stop。</p>
<p><img src="/2018/07/05/Bluetooth02/Bluetooth02%5CAndroid-BLE-in-Action.023.jpeg" alt="Android-BLE-in-Action"></p>
</li>
</ul>
<h5 id="基于连接"><a href="#基于连接" class="headerlink" title="基于连接"></a>基于连接</h5><p>BLE 连接的建立是通过 GAP 来协商和创建连接。Central 设备发起连接，外设接收连接请求，并协商连接参数。</p>
<p>前面我们介绍了 GATT，GATT 核心内容就是 Service、Characteristic 以及 Descriptor。每个 BLE 外设，根据自己的功能，向外暴露 Service 等。其实最重要的获取 Service 中的 Characteristic，Characteristic 可以被读、写、还有变化的时候有通知，这样就实现了双向的通信。</p>
<p> <img src="/2018/07/05/Bluetooth02/Bluetooth02%5Cbluetooth_2018-02-02.png" alt="bluetooth_2018-02-02.png"></p>
<p>​            连接到GATT服务器（发送数据的BLE设备）</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Roshen_android/article/details/76916111">https://blog.csdn.net/Roshen_android/article/details/76916111</a></p>
<p><a target="_blank" rel="noopener" href="https://www.race604.com/android-ble-in-action/">https://www.race604.com/android-ble-in-action/</a></p>
<p> <a target="_blank" rel="noopener" href="http://yannischeng.com/Android%20BLE%20%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/">http://yannischeng.com/Android%20BLE%20%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/</a></p>

        
        
          <blockquote id="copyright">
              <p>Ursprünglicher Link: <a href="http://noteforme.github.io.com/page/10/index.html">http://noteforme.github.io.com/page/10/index.html</a></p>
              <p>Copyright-Erklärung: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Aktie:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Bluetooth01" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/07/04/Bluetooth01/">Bluetooth01</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-07-04T10:37:45.000Z" itemprop="datePublished">2018年07月04日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/BLE/">BLE</a>
  </div>

      
      
<a href="/2018/07/04/Bluetooth01/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Gästebuch
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="蓝牙名称的由来"><a href="#蓝牙名称的由来" class="headerlink" title="蓝牙名称的由来"></a>蓝牙名称的由来</h4><ul>
<li> 蓝牙这个名称来自于第十世纪的一位丹麦国王Harald Blatand,Blatand在英文里的意思可以被解为蓝牙，</li>
</ul>
<p> 因为国王喜欢吃蓝梅，牙龈每天都是蓝色的所以叫牙.</p>
<ul>
<li>蓝牙这个标志的设计：它取自 Harald Bluetooth 名字中的「H」和「B」两个字母，用古北欧字母来表示，将这两者结合起来，就成为了蓝牙的 </li>
</ul>
<p><img src="/2018/07/04/Bluetooth01/Bluetooth01%5Cbluetooth_logo.jpg" alt="bluetooth_20180705150628"></p>
<h5 id="蓝牙技术联盟"><a href="#蓝牙技术联盟" class="headerlink" title="蓝牙技术联盟"></a>蓝牙技术联盟</h5><p><a target="_blank" rel="noopener" href="https://www.bluetooth.com/zh-cn">官网</a> </p>
<p>它负责蓝牙规范制定和推广的国际组织。做蓝牙相关产品的，少不了和它打交道。蓝牙技术联盟同时也拥有蓝牙商标，如果要使用，需要通过他们的授权。  Bluetooth SIG </p>
<h4 id="蓝牙个版本区别"><a href="#蓝牙个版本区别" class="headerlink" title="蓝牙个版本区别"></a>蓝牙个版本区别</h4><p><img src="/2018/07/04/Bluetooth01/Bluetooth01%5Cbluetooth_20180705150628.png" alt="bluetooth_20180705150628"></p>
<p>​                 <a target="_blank" rel="noopener" href="http://www.sohu.com/a/204758166_100040477">http://www.sohu.com/a/204758166_100040477</a> </p>
<h5 id="V1-0："><a href="#V1-0：" class="headerlink" title="V1.0："></a>V1.0：</h5><p>定义了蓝牙是一种低功耗的无线技术，传输率约在748~810kb/s，因是早期设计，容易受到同频率之产品所干扰下影响通讯质量。 </p>
<h5 id="V1-1"><a href="#V1-1" class="headerlink" title="V1.1"></a>V1.1</h5><p>所有设备都使用79个子频段在2.4GHz的频谱范围之内进行相互通信。此外，Bluetooth 1.1规范也修正了互不兼容的数据格式会引发Bluetooth 1.0设备之间的互操作性问题.</p>
<h5 id="V1-2"><a href="#V1-2" class="headerlink" title="V1.2"></a>V1.2</h5><p>增加了AFH可调式跳频技术这项技术，并主要针对现有蓝牙协议和802.11b/g之间的互相干扰问题进行了全面的改进，防止用户在同时使用支持蓝牙和无线局域网(WLAN)的两种装置的时候出现互相干扰的情况。</p>
<h5 id="V2-0"><a href="#V2-0" class="headerlink" title="V2.0"></a>V2.0</h5><ul>
<li>蓝牙2.0标准2.0 是 1.2 的改良提升版，传输率约在 1.8M/s~2.1M/s</li>
<li>开始支持双工模式——即一面作语音通讯，同时亦可以传输档案/高质素图片</li>
<li>2.0 版本当然也支持 Stereo 运作。</li>
</ul>
<h5 id="V2-1"><a href="#V2-1" class="headerlink" title="V2.1"></a>V2.1</h5><p>支持通过NFC（Near Field Communication，近距离通讯）进行配对，只需要将两个蓝牙设备靠近，按下一个键就可以配对了，配对密码将通过NFC进行传输，无需手动输入。</p>
<h5 id="V3-0"><a href="#V3-0" class="headerlink" title="V3.0"></a>V3.0</h5><p>核心是加入了“Generic Alternate MAC/PHY”（AMP），使蓝牙设备能最大限度的利用多种高速无线技术中更高的传输速率。这是一种全新的交替射频技术，允许蓝牙协议栈针对任一任务动态地选择正确的射频。</p>
<h5 id="4-0"><a href="#4-0" class="headerlink" title="4.0"></a>4.0</h5><p> 首先需要说明的是，发布于2010年的蓝牙4.0标准，本身就包含两个蓝牙标准——它包含传统蓝牙部分（也有称之为经典蓝牙Classic Bluetooth），也包含有低功耗蓝牙部分（Bluetooth Low Energy）。所以，毫无疑问的，低功耗蓝牙BLE属于蓝牙4.0！  </p>
<p> 蓝牙4.0的两个部分适用于不同的产品和应用场景，如传统蓝牙部分是在之前的1.0、2.0、3.0等基础上发展和完善起来的，主要用于和此前版本蓝牙1.0、2.0、3.0的兼容以及数据量比较大的传输，如语音，音乐，较高数据量传输等。 </p>
<p> 而低功耗蓝牙部分是在Nokia的Wibree标准上发展起来的。主要用于和蓝牙4.0以及更高标准版本的兼容 ，以及用于数据传输速率比较低的产品，如遥控类的，如鼠标，键盘，遥控鼠标(Air Mouse)，传感设备的数据发送，如心跳带，血压计，温度传感器等。  </p>
<p>由于蓝牙4.0集成了传统蓝牙和低功耗蓝牙两个标准，所以蓝牙4.0有双模和单模之分。双模即是传统蓝牙部分+低功耗蓝牙部分，单模即是单纯的低功耗蓝牙部分（BLE）。</p>
<p> 一台装配有蓝牙4.0双模模块的手机，当其配对连接的是蓝牙3.0设备时，其耗电量就会相对较高。若其配对的设备是智能手环等采用低功耗蓝牙模块的设备时，其功耗就非常低。针对一对一连接优化，并支持星形拓扑的一对多连接； <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c96e0006b34d">https://www.jianshu.com/p/c96e0006b34d</a></p>
<ul>
<li>​    单模蓝牙</li>
</ul>
<p><img src="/2018/07/04/Bluetooth01/Bluetooth01%5Cbluetooth_4ddf2.jpg" alt="bluetooth_4ddf2"></p>
<p>​                        </p>
<ul>
<li><pre><code> 双模蓝牙             
</code></pre>
</li>
</ul>
<p>  <img src="/2018/07/04/Bluetooth01/Bluetooth01%5Cblue_b4316d821.jpg" alt="blue_b4316d821"></p>
<h5 id="V-4-1"><a href="#V-4-1" class="headerlink" title="V 4.1"></a>V 4.1</h5><ul>
<li><p>提升数据传输率</p>
<p>相比蓝牙4.0，蓝牙4.1单包数据传输最大值从20字节上调到23字节，提升了15%的数据传输率。根据该规则，大家可以尝试修改单包数据payload的值，如果该芯片只支持BT4.0，那么修改传输23字节要么会编译报错，要么传输过程中会丢包。</p>
</li>
<li><p>主从共存 central peripheral</p>
<p>链路层Link layer拓扑结构做了更新，允许单设备主从同时共存（时间片轮转方式），以及一主对多从设备的连接拓扑,当BLE作Central的时候可以一对多，但是作Peripheral的时候只能一对一。  例如智能手表可以作为发射方向手机发射身体健康指数，同时作为接收方连接到蓝牙耳机/手环或其他设备上 </p>
</li>
<li><p>支持32-Bit UUID</p>
<p>32-Bit UUID指的是广播包携带的UUID，并不是指我们所说的针对属性列表的16 bit and 128 bit UUID。可以通过广播的32-Bit UUID映射得到完整的128 Bit UUID从而使得广播包内有效广播数据长度更多。</p>
<p>长期睡眠下的自动唤醒功能。例如在佩戴手环游泳1小时后，回到更衣室手环会自动和手机建立连接传输数据，不需要任何操作 </p>
</li>
<li><p>通过IPv6建立网络连接。蓝牙设备只需要通过蓝牙4.1连接到可以上网的设备（如手机），就可以通过IPv6与云端的数据进行同步。即实现“云同步”不再需要wifi连接（wifi模块的成本通常更高，也更费电）。通过IPv6建立网络连接。蓝牙设备只需要通过蓝牙4.1连接到可以上网的设备（如手机），就可以通过IPv6与云端的数据进行同步。即实现“云同步”不再需要wifi连接（wifi模块的成本通常更高，也更费电）</p>
</li>
</ul>
<h5 id="V-4-2"><a href="#V-4-2" class="headerlink" title="V 4.2"></a>V 4.2</h5><ul>
<li><p><strong>LE连接安全</strong> </p>
<p>从Spec定义上蓝牙4.0和4.1的配对加密环节都是基于AES-CCM加密，但是由于蓝牙4.1双方共享同一密钥，所以存在被破解风险和漏洞。蓝牙4.2的pairing环节，采用Diffie-HellmanKey Exchange密钥交换算法进行加密，每一个设备有一对密钥对，公钥和私钥，私钥自己保存，公钥公开给对方，数据交互时，一方通过自己的私钥和对方的公钥进行加密文件，接收方通过自己私钥和传输方的公钥进行解密，从而有效的防止中间人破解密钥的事件发生。 </p>
</li>
<li><p><strong>隐私保护</strong> </p>
<p>蓝牙在广播过程中会携带自己的BD address (bluetooth device address)即为蓝牙唯一的MAC地址，在某些应用，比如物流追踪应用当中是非常有帮助的，可以根据BD address固定物流设备。</p>
<p>但是在某些应用不希望自己的BD address暴露在主端设备的监控下，蓝牙4.2给出了灵活的选择，蓝牙4.2规定，从机设备可以选择在广播模式下发送随机BD address，这样主端设备除了接该到设备之后才能获取其真实BD address，除此该设备广播模式的BD address为随机序列。</p>
</li>
<li><p><strong>大数据传输</strong> </p>
<p>蓝牙4.1最大支持23字节单包数据传输，蓝牙4.2最大支持255字节单包数据传输，极大提升了数据传输率。详细可以参考我写的另外一篇文章《提升蓝牙4.2数据传输率的办法 - ATT_MTU》。 </p>
</li>
</ul>
<h5 id="5-0"><a href="#5-0" class="headerlink" title="5.0"></a>5.0</h5><ul>
<li><p><strong>传输距离更快、距离更远</strong> </p>
<p>蓝牙 5.0 和前一代蓝牙 4.2 相比，它的传输距离更远、速度更快。理论上的有效距离是 300 米，也就是整个家庭或整间办公室里的移动设备都可以稳定连结。而速度最快则是可以达到 2Mbps，让反应更快、性能更高的蓝牙设备更有可能被使用。除此之外，它还大幅增强了蓝牙广播的数据传输，能为商用蓝牙带来更好的前景，让使用蓝牙做为标准的物联网应用更加强大，可以向下相容旧版本产品 。</p>
</li>
<li><p><strong>蓝牙 Mesh 技术改变传输应用</strong> </p>
<p>蓝牙技术联盟（Bluetooth SIG）日前宣布推出蓝牙 Mesh 技术，这项技术将打破传统蓝牙设备间“一对一”的配对转变成“多对多”的讯号传输模式，除了应用在蓝牙 5.0，也会扩展到过往版本。蓝牙技术联盟表示，蓝牙 Mesh 技术是基于低功耗蓝牙技术推出的新网络技术，将为商用和工业用设备网络带来转变，也能让现有的物联网技术更加完整、稳定。 </p>
</li>
<li></li>
</ul>
<p><a target="_blank" rel="noopener" href="http://www.eet-china.com/news/article/201711190911">http://www.eet-china.com/news/article/201711190911</a></p>
<h5 id="蓝牙5-0和wifi的区别"><a href="#蓝牙5-0和wifi的区别" class="headerlink" title="蓝牙5.0和wifi的区别"></a>蓝牙5.0和wifi的区别</h5><ul>
<li><p>WIFI</p>
<p>Wi-Fi 的一大缺陷就是有距离限制，包括过去一对一蓝牙网络在内的传统无线网络，都会受两台设备距离的限制。以 Wi-Fi 来说，有效的传输距离为 50 平方米以内，除非你装中继设备，一旦离开这个区域，你的手机就失去用武之地。</p>
<p>除此之外，Wi-Fi 还有耗电问题，你的手机就算是把屏幕关闭，还是得一天充一次电，Wi-Fi 是一个很重要的因素。</p>
</li>
<li><p>蓝牙 Mesh </p>
<p>“蓝牙 Mesh”找到一个聪明的解决办法。这些设备彼此间连接，并将信号传递给附近另一个设备，形成中继资料传输的互连设备网络或网格。这意味着讯息从一个设备传递到另一个设备，再到下一个设备，接力传输。 </p>
</li>
</ul>
<p><img src="/2018/07/04/Bluetooth01/Bluetooth01%5Cbluetooth_20180705175518.png" alt="bluetooth_20180705150628"></p>
<p><strong>▲ 左图为传统 Wi-Fi 的连接方式，必须要有一个 Hub 连系其他设备，因此有距离限制。右图则是蓝牙 Mesh 的方式，越多设备连到这个网络上，范围就会越广。</strong> </p>
<p>与传统的交换式网络相比，无线Mesh网络去掉了节点之间的布线需求，但仍具有分布式网络所提供的冗余机制和重新路由功能。在无线Mesh网络里，如果要添加新的设备，只需要简单地接上电源就可以了，它可以自动进行自我配置，并确定最佳的多跳传输路径。添加或移动设备时，网络能够自动发现拓扑变化，并自动调整通信路由，以获取最有效的传输路径。  </p>
<p>透过这种接力传输，形成一个无需大量电力消耗或天线广布的可靠网络。蓝牙设备之间可不透过 Wi-Fi 网络就能实现设备与设备的“对话”。换句话说，智能设备采用这种技术，在有限范围内就能完成设备间的沟通，并利用手机等设备来控制。</p>
<p>过去因为家中需要有一个 Hub 连接其他设备，因此有 Google、Apple、Amazon 等这些“语音助手”出现，用这些当成控制中枢。但蓝牙 Mesh 架构下，你不需要另外一个“中枢”，用智能手机就可以掌握一切。家中的蓝牙设备建构自己的网络，手机只要与其中一个蓝牙设备取得联系，就可以控制全家（整个建筑物）设备，监控这些设备的状态。</p>
<p>由于 Mesh 网络不需复杂设定、配对或使用路由器等存取设备，因此并不会造成安装负担，反观采用其他智慧家庭联网技术如 ZigBee、Z-wave 或其他厂商间自有的通讯技术，多需加装闸道器（Gateway）才能确保各种设备沟通无虞。</p>
<ul>
<li><p>蓝牙 Mesh 工作原理：为什么还是无法取代 Wi-Fi？</p>
<p>蓝牙 BLE 通讯协议中，GAP 层（Generic Access Profile）用来控制决定蓝牙设备的扫描、广播和连接等关系，也就是说，GAP 决定蓝牙设备怎样与其他设备连接、被其他设备看到等流程。 在蓝牙 mesh 出现之前，GAP 有一个典型的父子网络关系，其中“父”端决定所有路由，“子”端执行分配的任务。 例如，当你将蓝牙键盘连接到平板电脑，平板为父端、键盘为子端。</p>
<p>GAP 使你的设备被其他设备看见，并决定你的设备是否可以或怎样与其他设备互动。例如常用在室内定位的 Beacon 设备就只是向外广播，不支持连接。智能手环等设备，就可以与你的手机设备连接。</p>
<p>从蓝牙 4.1 开始，GAP 扩大了蓝牙设备的网络能力。蓝牙设备可兼具“父”和“子”的功能，使所有设备能直接连接和广播到任何其他设备。蓝牙也因此适用传输范围内和传输范围外的所有设备。</p>
<p>正是上述这种能直接或间接连接任何数量有 Mesh 功能的设备，因此理论上建构一个长达几公里范围的 Mesh 网络也不是不可能。 如果网络中每个设备都在其他至少一个设备的广播范围内，Mesh 网络理论上可覆盖无限距离。</p>
<p>在这情况下，灯泡就可能成为一个家庭主要 Mesh 网络设备之一，因为一个家庭或是建筑，几乎每个角落都有光线覆盖的需要，因此灯泡就会以保持一定距离的方式连续安装。如果每个灯泡都是蓝牙 Mesh 设备，那么这个网络就得以全面覆盖建筑物。</p>
<p>蓝牙 Mesh 网络不仅有低功耗，还有低频宽的特色。这听起来好像是个缺点？其实不然。 由于蓝牙 Mesh 网络不是用来让你发送影音资料，主要是用来传递维护连接或发送命令，发送一个“关闭”或“打开”的指定，用不到多少频宽。这就是为什么蓝牙 Mesh 网络虽然范围无远弗届，但无法完全取代 Wi-Fi。 乍看很像，但仔细了解后，你会发现它们适合不同的利基市场。</p>
<p><a target="_blank" rel="noopener" href="http://www.icsmart.cn/13985/">http://www.icsmart.cn/13985/</a></p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Bluetooth#Communication_and_connection">https://en.wikipedia.org/wiki/Bluetooth#Communication_and_connection</a></p>
</li>
</ul>

        
        
          <blockquote id="copyright">
              <p>Ursprünglicher Link: <a href="http://noteforme.github.io.com/page/10/index.html">http://noteforme.github.io.com/page/10/index.html</a></p>
              <p>Copyright-Erklärung: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Aktie:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-INTERVIEW-CONCURRENCY" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/07/02/INTERVIEW-CONCURRENCY/">INTERVIEW_CONCURRENCY</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-07-02T08:15:24.000Z" itemprop="datePublished">2018年07月02日</time>
</span>
      
      
      
<a href="/2018/07/02/INTERVIEW-CONCURRENCY/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Gästebuch
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://noteforme.github.io/tags/concurrency/">https://noteforme.github.io/tags/concurrency/</a></p>
<h3 id="线程基础"><a href="#线程基础" class="headerlink" title="线程基础"></a>线程基础</h3><h5 id="Java线程模型"><a href="#Java线程模型" class="headerlink" title="Java线程模型"></a>Java线程模型</h5><ol>
<li>用户线程与内核级线程</li>
<li>并发与并行</li>
<li>多线程模型</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://crazyfzw.github.io/2018/06/19/thred-model/">https://crazyfzw.github.io/2018/06/19/thred-model/</a></p>
<p>谈谈对多线程的理解</p>
<ol>
<li>在Android中一个应用程序就是一个单独的进程，一般来说，当我们运行一个应用，系统就会自动创建一个进程，并且为这个进程创建一个主线程–UI线程，这样就可以运行MainActivity。</li>
<li>线程是操作系统能够进行运算调度的最小单位，线程是进程的子集，线程可以并行的执行不同任务，所有的线程共享同一片内存空间，这就为线程间通信提供了基础，线程有五种状态：创建，就绪，运行，阻塞，死亡。</li>
</ol>
<h5 id="多线程有什么要注意的问题？"><a href="#多线程有什么要注意的问题？" class="headerlink" title="多线程有什么要注意的问题？"></a>多线程有什么要注意的问题？</h5><p>并发问题，安全问题，效率问题。</p>
<p>谈谈你对并发编程的理解并举例说明</p>
<p>谈谈你对多线程同步机制的理解？</p>
<h5 id="进程和线程的区别-协程呢"><a href="#进程和线程的区别-协程呢" class="headerlink" title="? 进程和线程的区别 协程呢"></a>? 进程和线程的区别 协程呢</h5><ul>
<li>进程  </li>
</ul>
<p>​    是系统给程序分配资源的基本单位，每个进程都有唯一的地址空间，一个程序至少有一个进程，一个进程至少有一个线程.</p>
<ul>
<li><p>线程</p>
<p>线程是执行操作的基本单位，JVM结构中共享 Method Area ,Heap Area</p>
</li>
</ul>
<p>​    <a target="_blank" rel="noopener" href="https://blog.csdn.net/mxsgoden/article/details/8821936">https://blog.csdn.net/mxsgoden/article/details/8821936</a></p>
<p>​    <a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2013/04/processes_and_threads.html">https://www.ruanyifeng.com/blog/2013/04/processes_and_threads.html</a></p>
<p>进程 : 有很大的独立性</p>
<p>线程 :  所有线程都有完全一样的地址空间,意味着它们也共享同样的全局变量。由于线程可以访问进程地址空间的每一个内存地址，所以一个线程可以读、写甚至清除另一个线程的堆栈。</p>
<p>每个进程中的内容 : 地址空间  全局变量 打开文件 子进程    即将发生的定时器    信号与信号处理程序</p>
<p>每个线程中的内容：程序计数器、寄存器、堆栈、状态.</p>
<p>协程?</p>
<p>​        协程拥有自己的寄存器上下文和栈，协程调度切换时，将寄存器上下文和栈保存到其他地方，在切回来的    时候，恢复先前保存的寄存器上下文和栈，即所有局部状态的一个特定组合），每次过程重入时，就相当于进入上一次调用的状态，换种说法：进入上一次离开时所处逻辑流的位置。</p>
<p>协程的好处:</p>
<ol>
<li>无需线程上下文切换的开销 </li>
<li>无需原子操作锁定及同步的开销</li>
<li>方便切换控制流，简化编程模型</li>
</ol>
<p>​    为什么要有线程，而不是仅仅用进程？</p>
<h5 id="怎么创建一个线程"><a href="#怎么创建一个线程" class="headerlink" title="怎么创建一个线程"></a>怎么创建一个线程</h5><ol>
<li><p>继承Thread类创建线程类.</p>
</li>
<li><p>通过Runnable接口创建线程类</p>
</li>
<li><p>通过Callable和FutureTask创建线程</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CallableThreadTest</span> <span class="keyword">implements</span> <span class="title">Callable</span>&lt;<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        CallableThreadTest ctt = <span class="keyword">new</span> CallableThreadTest();</span><br><span class="line">        FutureTask&lt;Integer&gt; ft = <span class="keyword">new</span> FutureTask&lt;&gt;(ctt);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot; 的循环变量i的值&quot;</span> + i);</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">20</span>) &#123;</span><br><span class="line">                <span class="keyword">new</span> Thread(ft, <span class="string">&quot;有返回值的线程&quot;</span>).start();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;子线程的返回值：&quot;</span> + ft.get());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ExecutionException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot; &quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="线程如何关闭？"><a href="#线程如何关闭？" class="headerlink" title="线程如何关闭？"></a>线程如何关闭？</h5><p>​    最正确的停止线程的方式是使用 interrupt,和条件满足.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (!Thread.currentThread().isInterrupted() &amp;&amp; cout&lt;<span class="number">1000</span>) &#123;</span><br><span class="line">    <span class="keyword">do</span> more work</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="在Java中wait和sleep方法的不同"><a href="#在Java中wait和sleep方法的不同" class="headerlink" title="在Java中wait和sleep方法的不同"></a>在Java中wait和sleep方法的不同</h5><pre><code>1. sleep作用Thread上，wait作用object上
2. sleep不会释放锁
3. sleep可以在任何代码块。wait必须在同步方法，持有锁中运行。
</code></pre>
<p>​    </p>
<p>谈谈wait/notify关键字的理解</p>
<ol>
<li>调用之前持有对象锁</li>
<li>wait ,线程进入 waiting状态，释放对象锁</li>
<li>notify,唤醒处于waiting状态的线程。</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://howtodoinjava.com/java/multi-threading/wait-notify-and-notifyall-methods/">https://howtodoinjava.com/java/multi-threading/wait-notify-and-notifyall-methods/</a></p>
<h5 id="如何控制某个方法允许并发访问线程的个数？"><a href="#如何控制某个方法允许并发访问线程的个数？" class="headerlink" title="如何控制某个方法允许并发访问线程的个数？"></a>如何控制某个方法允许并发访问线程的个数？</h5><p>​    信号量</p>
<h5 id="什么导致线程阻塞？"><a href="#什么导致线程阻塞？" class="headerlink" title="什么导致线程阻塞？"></a>什么导致线程阻塞？</h5><ol>
<li> 阻塞指的是暂停一个线程的执行以等待某个条件发生。 Thread.sleep t.join 等待输入</li>
<li>线程执行了一个对象的<code>wait()</code>方法，直接进入阻塞状态，等待其他线程执行<code>notify()</code>或者<code>notifyAll()</code>方法。</li>
</ol>
<h5 id="如何保证线程安全？"><a href="#如何保证线程安全？" class="headerlink" title="如何保证线程安全？"></a>如何保证线程安全？</h5><pre><code>1. 使用线程安全的类。
2. 使用synchronized同步代码块，或者用Lock锁。
</code></pre>
<h5 id="如何实现线程同步？"><a href="#如何实现线程同步？" class="headerlink" title="如何实现线程同步？"></a>如何实现线程同步？</h5><pre><code> 1. Synchronized修饰整个方法或代码块。
 2. Lock
</code></pre>
<h5 id="两个进程同时要求写或者读，能不能实现？如何防止进程的同步？"><a href="#两个进程同时要求写或者读，能不能实现？如何防止进程的同步？" class="headerlink" title="两个进程同时要求写或者读，能不能实现？如何防止进程的同步？"></a>两个进程同时要求写或者读，能不能实现？如何防止进程的同步？</h5><p>​    可以进行同时读写，但为了保证数据的正确，必须要针对进程访问的共享临界区进行处理；两个进程不能同时进入临界区，否则会导致数据错乱。常见的处理方式有：<strong>信号量、管程、会合、分布式系统</strong></p>
<ul>
<li><p><strong>信号量</strong><br> 信号量是一个计数器，它只支持2种操作：P操作（进入临界区）和V操作（退出临界区）。假设有信号量SV，则对它的P、V操作含义如下：<br>   P(SV)，如果SV的值大于0，意味着可以进入临界区，就将它减1；如果SV的值为0，意味着别的进程正在访问临界区，则挂起当前进程的执行；<br>   V(SV)，当前进程退出临界区时，如果有其他进程因为等待SV而挂起，则唤醒之；如果没有，则将SV加1，之后再退出临界区。</p>
</li>
<li><p><strong>管程</strong><br>   提出原因：信号量机制不足，程序编写困难、易出错</p>
<pre><code>   方案：在程序设计语言中引入一种高级维护机制
   定义：是一个特殊的模块；有一个名字；由关于共享资源的数据结构及在其上操作上的一组过程组成。进程只能通过调用管程中的过程间接访问管程中的数据结构
</code></pre>
<p>  1）互斥：管程是互斥进入的 为了保证数据结构的数据完整性<br> 管程的互斥由编译器负责保证的，是一种语言机制<br>  2）同步：设置条件变量及等待唤醒操作以解决同步问题<br> 可以让一个进程或者线程在条件变量上等待（先释放管程的管理权），也可以通过发送信号将等待在条件变量上的进程线程唤醒</p>
</li>
</ul>
<p>  链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/72f5017c6649">https://www.jianshu.com/p/72f5017c6649</a></p>
<h5 id="线程间操作List"><a href="#线程间操作List" class="headerlink" title="线程间操作List"></a>线程间操作List</h5><p>​    </p>
<h5 id="怎么中止一个线程，Thread-Interupt一定有效吗？"><a href="#怎么中止一个线程，Thread-Interupt一定有效吗？" class="headerlink" title="怎么中止一个线程，Thread.Interupt一定有效吗？"></a>怎么中止一个线程，Thread.Interupt一定有效吗？</h5><p>不一定 </p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903896339447815#heading-6">https://juejin.cn/post/6844903896339447815#heading-6</a></p>
<h3 id="线程安全-锁"><a href="#线程安全-锁" class="headerlink" title="线程安全 锁"></a>线程安全 锁</h3><h5 id="讲一下java中的同步的方法-结果锁一起"><a href="#讲一下java中的同步的方法-结果锁一起" class="headerlink" title="讲一下java中的同步的方法 结果锁一起"></a>讲一下java中的同步的方法 结果锁一起</h5><ol>
<li><p>synchronized  </p>
</li>
<li><p>wait和notify</p>
</li>
<li><p>volatile</p>
<p>  a. volatile关键字为域变量的访问提供了一种免锁机制<br>  b.使用volatile修饰域相当于告诉虚拟机该域可能会被其他线程更新<br>  c.因此每次使用该域就要重新计算，而不是使用寄存器中的值<br>  d.volatile不会提供任何原子操作，它也不能用来修饰final类型的变量 </p>
</li>
</ol>
<h5 id="synchronize的原理"><a href="#synchronize的原理" class="headerlink" title="synchronize的原理"></a>synchronize的原理</h5><blockquote>
<ol>
<li>原子性：确保线程互斥的访问同步代码；</li>
<li>可见性：保证共享变量的修改能够及时可见，其实是通过Java内存模型中的 “<strong>对一个变量unlock操作之前，必须要同步到主内存中；如果对一个变量进行lock操作，则将会清空工作内存中此变量的值，在执行引擎使用此变量前，需要重新从主内存中load操作或assign操作初始化变量值</strong>” 来保证的；</li>
<li>有序性：有效解决重排序问题，即 “一个unlock操作先行发生(happen-before)于后面对同一个锁的lock操作”；</li>
</ol>
</blockquote>
<h5 id="谈谈对Synchronized关键字，类锁，方法锁，重入锁的理解"><a href="#谈谈对Synchronized关键字，类锁，方法锁，重入锁的理解" class="headerlink" title="谈谈对Synchronized关键字，类锁，方法锁，重入锁的理解"></a>谈谈对Synchronized关键字，类锁，方法锁，重入锁的理解</h5><ol>
<li>当synchronized作用于普通方法是，锁对象是this；</li>
<li>当synchronized作用于静态方法是，锁对象是当前类的Class对象；</li>
<li>当synchronized作用于代码块时，锁对象是synchronized(obj)中的这个obj。</li>
</ol>
<h5 id="static-synchronized-方法的多线程访问和作用"><a href="#static-synchronized-方法的多线程访问和作用" class="headerlink" title="static synchronized 方法的多线程访问和作用"></a>static synchronized 方法的多线程访问和作用</h5><p>也就是两个的区别了,也就是synchronized相当于this.synchronized，而static synchronized相当于Something.synchronized，它可以对类的所有对象实例起作用</p>
<h5 id="synchronized与Lock的区别"><a href="#synchronized与Lock的区别" class="headerlink" title="synchronized与Lock的区别"></a>synchronized与Lock的区别</h5><p>Lock支持的功能:</p>
<p>公平锁：Synchronized是非公平锁，ReentrantLock支持公平锁，默认非公平锁</p>
<p>可中断锁：ReentrantLock提供了lockInterruptibly（）的功能，可以中断争夺锁的操作，抢锁的时候会check是否被中断，中断直接抛出异常，退出抢锁。而Synchronized只有抢锁的过程，不可干预，直到抢到锁以后，才可以编码控制锁的释放。</p>
<p>快速反馈锁：ReentrantLock提供了trylock（）  和 trylock（tryTimes）的功能，不等待或者限定时间等待获取锁，更灵活。可以避免死锁的发生。</p>
<p>读写锁：ReentrantReadWriteLock类实现了读写锁的功能，类似于Mysql，锁自身维护一个计数器，读锁可以并发的获取，写锁只能独占。而synchronized全是独占锁</p>
<p>Condition：ReentrantLock提供了比Sync更精准的线程调度工具，Condition，一个lock可以有多个Condition，比如在生产消费的业务下，一个锁通过控制生产Condition和消费Condition精准控制。</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/09d5ba4bfb7a">https://www.jianshu.com/p/09d5ba4bfb7a</a></p>
<h5 id="ReentrantLock的内部实现"><a href="#ReentrantLock的内部实现" class="headerlink" title="ReentrantLock的内部实现"></a>ReentrantLock的内部实现</h5><p>显式锁ReentrantLock和同步工具类的实现基础都是AQS (AbstractQueuedSynchronizer).AQS内部有一条双向的队列存放等待线程，节点是Node对象。每个Node维护了线程、前后Node的指针和等待状态等参数。</p>
<p>ReentrantLock是可重入锁，也就是同一个线程可以多次获取锁，每获取一次就会进行一次计数，解锁的时候就会递减这个计数，直到计数变为0。</p>
<p>它有两种实现，一种是公平锁，一种是非公平锁，</p>
<h5 id="lock原理"><a href="#lock原理" class="headerlink" title="lock原理"></a>lock原理</h5><p>整体来看Lock主要是通过两个东西来实现的分别是<strong>CAS和AQS(AbstractQueuedSynchronizer)。</strong>通过加锁和解锁的过程来分析锁的实现。</p>
<p>一、整体概述流程</p>
<ol>
<li><p>读取表示锁状态的变量</p>
</li>
<li><p>如果表示状态的变量的值为0，那么当前线程尝试将变量值设置为1（通过CAS操作完成），当多个线程同时将表示状态的变量值由0设置成1时，仅一个线程能成功，其它线程都会失败。失败后进入队列自旋转并阻塞当前线程。</p>
<p>  2.1 若成功，表示获取了锁，</p>
<blockquote>
<p>2.1.1 如果该线程（或者说节点）已位于在队列中，则将其出列（并将下一个节点则变成了队列的头节点）</p>
</blockquote>
<blockquote>
<p>2.1.2 如果该线程未入列，则不用对队列进行维护</p>
</blockquote>
<blockquote>
<p>2.1.3 然后当前线程从lock方法中返回，对共享资源进行访问。           </p>
</blockquote>
<p>   2.2 若失败，则当前线程将自身放入等待（锁的）队列中并阻塞自身，此时线程一直被阻塞在lock方法中，没有从该方法中返回（被唤醒后仍然在lock方法中，并从下一条语句继续执行，这里又会回到第1步重新开始）。</p>
</li>
<li><p>如果表示状态的变量的值为1，那么将当前线程放入等待队列中，然后将自身阻塞<br> <a target="_blank" rel="noopener" href="https://blog.csdn.net/liyantianmin/article/details/54673109">https://blog.csdn.net/liyantianmin/article/details/54673109</a></p>
</li>
</ol>
<h5 id="死锁的四个必要条件？"><a href="#死锁的四个必要条件？" class="headerlink" title="死锁的四个必要条件？"></a>死锁的四个必要条件？</h5><ol>
<li>互斥条件: 指线程对己经获取到的资源进行排它性使用 ，即该资源同时只由 一个线<br>程占用。如果 此时 还有其 他 线程请求获取该资源 ，则 请求者只能等待，直至占有资<br>源 的 线程释放该资源。</li>
<li>请求并持有条件 : 指一个线程己经持有了至少一个资源，但又提出了新的资源请求，<br>而新资源己被其 他 线程占有，所 以 当前线程会被阻塞 ，但 阻塞 的同时 并不释放自 己<br>己经获取的资源。</li>
<li>不可剥夺条件 : 指线程获取到的资源在自己使用完之前不能被其他线程抢占 ， 只有在自己使用完 毕后才 由 自 己释放该资源。</li>
<li>环路等待条件 : 指在发生死锁时 ，必然存在一个线程→资源的环形链 ，即线程集合</li>
</ol>
<h5 id="怎么避免死锁？"><a href="#怎么避免死锁？" class="headerlink" title="怎么避免死锁？"></a>怎么避免死锁？</h5><p>请求并持有和环路等待条件是可 以被破坏.</p>
<h5 id="synchronized是公平锁还是非公平锁-ReteranLock是公平锁吗？是怎么实现的"><a href="#synchronized是公平锁还是非公平锁-ReteranLock是公平锁吗？是怎么实现的" class="headerlink" title="synchronized是公平锁还是非公平锁,ReteranLock是公平锁吗？是怎么实现的"></a>synchronized是公平锁还是非公平锁,ReteranLock是公平锁吗？是怎么实现的</h5><ol>
<li>synchronized只能是非公平锁。</li>
<li>而ReentrantLock可以实现公平锁和非公平锁两种。</li>
<li>公平锁的公平的含义在于如果线程现在拿不到这把锁，那么线程就都会进入等待，开始排队，在等待队列里等待时间长的线程会优先拿到这把锁，有先来先得的意思。而非公平锁就不那么“完美”了，它会在一定情况下，忽略掉已经在排队的线程，发生插队现象</li>
</ol>
<h5 id="synchronized跟ReentranLock有什么区别？"><a href="#synchronized跟ReentranLock有什么区别？" class="headerlink" title="synchronized跟ReentranLock有什么区别？"></a>synchronized跟ReentranLock有什么区别？</h5><p>都是加锁方式同步，而且都是阻塞式的同步，也就是说当如果一个线程获得了对象锁，进入了同步块，其他访问该同步块的线程都必须阻塞在同步块外面等待</p>
<ul>
<li><p>synchronized</p>
<p><strong>自动释放锁</strong>,只有非公平锁。都是可重入的</p>
</li>
<li><p>ReentrantLock</p>
<p> <strong>手动释放锁</strong></p>
</li>
</ul>
<h5 id="对象锁和类锁是否会互相影响？"><a href="#对象锁和类锁是否会互相影响？" class="headerlink" title="对象锁和类锁是否会互相影响？"></a>对象锁和类锁是否会互相影响？</h5><p>不会相互影响</p>
<ul>
<li><p>类锁</p>
<p>在代码中的方法上加了static和synchronized的锁，或者synchronized(xxx.class）的代码段</p>
</li>
<li><p>对象锁</p>
<p>在代码中的方法上加了synchronized的锁，或者synchronized(this）的代码段</p>
</li>
<li><p>私有锁</p>
<p>在类内部声明一个私有属性如private Object lock，在需要加锁的代码段synchronized(lock）</p>
</li>
</ul>
<h5 id="管理线程-提高效率"><a href="#管理线程-提高效率" class="headerlink" title="管理线程 提高效率"></a>管理线程 提高效率</h5><h5 id="volatile的原理"><a href="#volatile的原理" class="headerlink" title="volatile的原理"></a>volatile的原理</h5><p> 有序性.</p>
<p> 可见性 :</p>
<p>　    （1）修改volatile变量时会强制将修改后的值刷新的主内存中。</p>
<p>　　（2）修改volatile变量后会导致其他线程工作内存中对应的变量值失效。因此，再读取该变量值的时候就需要重新从读取主内存中的值。</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/paddix/p/5428507.html">https://www.cnblogs.com/paddix/p/5428507.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1NT4y1G7WE?p=8">https://www.bilibili.com/video/BV1NT4y1G7WE?p=8</a></p>
<h5 id="synchronized-和volatile-关键字的区别"><a href="#synchronized-和volatile-关键字的区别" class="headerlink" title="synchronized 和volatile 关键字的区别"></a>synchronized 和volatile 关键字的区别</h5><ol>
<li>volatile仅能实现变量的修改可见性，不能保证原子性；而synchronized则可以保证变量的修改可见性和原子性</li>
<li>volatile标记的变量不会被编译器优化；synchronized标记的变量可以被编译器优化.</li>
</ol>
<p>多线程断点续传原理</p>
<p>其实原理很简单，只需要保证每个子任务的下载进度能够被即时地记录即可。这样继续下载时只需要读取这些下载记录，从上次下载结束的位置开始下载即可。</p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844904013440221198">https://juejin.cn/post/6844904013440221198</a></p>
<h3 id="线程池"><a href="#线程池" class="headerlink" title="线程池"></a>线程池</h3><h5 id="JavaAPI线程池有哪些参数"><a href="#JavaAPI线程池有哪些参数" class="headerlink" title="JavaAPI线程池有哪些参数"></a>JavaAPI线程池有哪些参数</h5><p><img src="https://s0.lgstatic.com/i/image2/M01/AD/A3/CgoB5l3eH8mAAoJCAACEOKMHtpw036.png"></p>
<p><img src="https://s0.lgstatic.com/i/image2/M01/AD/A3/CgoB5l3eH-KAAHpkAAC4vEMOXQ4797.png"></p>
<h5 id="为什么要用线程池"><a href="#为什么要用线程池" class="headerlink" title="为什么要用线程池"></a>为什么要用线程池</h5><ol>
<li>降低资源消耗2. 提高响应速度3. 提高线程的可管理性</li>
</ol>
<h5 id="什么是线程池，如何使用"><a href="#什么是线程池，如何使用" class="headerlink" title="什么是线程池，如何使用?"></a>什么是线程池，如何使用?</h5><p>很多小任务让一组线程来执行，而不是一个任务对应一个新线程。这种能接收大量小任务并进行分发处理的就是线程池</p>
<h5 id="什么是核心线程"><a href="#什么是核心线程" class="headerlink" title="什么是核心线程"></a>什么是核心线程</h5><p>​    常驻线程池的线程数量</p>
<h5 id="怎么销毁核心线程"><a href="#怎么销毁核心线程" class="headerlink" title="怎么销毁核心线程"></a>怎么销毁核心线程</h5><p>​    allowCoreThreadTimeOut</p>
<p>​    <a target="_blank" rel="noopener" href="https://objcoding.com/2019/04/14/threadpool-some-settings/">https://objcoding.com/2019/04/14/threadpool-some-settings/</a></p>
<h5 id="为什么DCL-DOUBLE-CHECK-LOCK要那么写，直接在方法前加synchronized不行吗"><a href="#为什么DCL-DOUBLE-CHECK-LOCK要那么写，直接在方法前加synchronized不行吗" class="headerlink" title="为什么DCL DOUBLE CHECK LOCK要那么写，直接在方法前加synchronized不行吗"></a>为什么DCL DOUBLE CHECK LOCK要那么写，直接在方法前加synchronized不行吗</h5><p>​    不DCL 这样写，就会创建多个实例</p>
<p>​    synchronized可以，这样粒度太大了.</p>
<p>​    <a target="_blank" rel="noopener" href="https://blog.csdn.net/zhaoyajie1011/article/details/106812327">https://blog.csdn.net/zhaoyajie1011/article/details/106812327</a></p>
<h5 id="如何让两个线程循环交替打印"><a href="#如何让两个线程循环交替打印" class="headerlink" title="如何让两个线程循环交替打印"></a>如何让两个线程循环交替打印</h5><p>LockSupport_1A2B.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">char</span>[] aI = <span class="string">&quot;1234567&quot;</span>.toCharArray();</span><br><span class="line">        <span class="keyword">char</span>[] aC = <span class="string">&quot;ABCDEFG&quot;</span>.toCharArray();</span><br><span class="line"></span><br><span class="line">        t1 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">char</span> c : aI) &#123;</span><br><span class="line">                System.out.print(c);</span><br><span class="line">                LockSupport.unpark(t2);</span><br><span class="line">                LockSupport.park();</span><br><span class="line">            &#125;</span><br><span class="line">            LockSupport.unpark(t2);</span><br><span class="line">        &#125;);</span><br><span class="line">        t2 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">char</span> c : aC) &#123;</span><br><span class="line">                System.out.print(c);</span><br><span class="line">                LockSupport.unpark(t1);</span><br><span class="line">                LockSupport.park();</span><br><span class="line">            &#125;</span><br><span class="line">            LockSupport.unpark(t1);</span><br><span class="line">        &#125;);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line"><span class="comment">//        System.out.println(&quot;t1  &quot; + t1.getState());</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;t2  &quot; + t2.getState());</span></span><br><span class="line">        t1.join();</span><br><span class="line">        t2.join();</span><br></pre></td></tr></table></figure>



<p>Notify_1A2B.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">Notify_1A2B o = <span class="keyword">new</span> Notify_1A2B();</span><br><span class="line"><span class="keyword">char</span>[] aI = <span class="string">&quot;1234567&quot;</span>.toCharArray();</span><br><span class="line"><span class="keyword">char</span>[] aC = <span class="string">&quot;ABCDEFG&quot;</span>.toCharArray();</span><br><span class="line">t1 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (o) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c : aI) &#123;</span><br><span class="line">            System.out.print(c);</span><br><span class="line">            o.notify();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                o.wait();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line">t2 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (o) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">char</span> c : aC) &#123;</span><br><span class="line">                System.out.print(c);</span><br><span class="line">                o.notify();</span><br><span class="line">                o.wait();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">t1.start();</span><br><span class="line">t2.start();</span><br><span class="line">t1.join();</span><br><span class="line">t2.join();</span><br></pre></td></tr></table></figure>



<p>协程可以在Java项目中使用吗？</p>
<p>线程池了解多少？拒绝策略有几种,为什么有newSingleThread</p>
<h5 id="跨进程通信了解多少？管道了解吗？"><a href="#跨进程通信了解多少？管道了解吗？" class="headerlink" title="跨进程通信了解多少？管道了解吗？"></a>跨进程通信了解多少？管道了解吗？</h5><pre><code>文件
AIDL （基于 Binder）
    Android 进阶：进程通信之 AIDL 的使用
    Android 进阶：进程通信之 AIDL 解析
Binder
    Android 进阶：进程通信之 Binder 机制浅析
Messenger （基于 Binder）
    Android 进阶：进程通信之 Messenger 使用与解析 
ContentProvider （基于 Binder）
    Android 进阶：进程通信之 ContentProvider 内容提供者 
Socket
    Android 进阶：进程通信之 Socket （顺便回顾 TCP UDP）
</code></pre>
<p><img src="https://img-blog.csdn.net/20170605011532312?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMTI0MDg3Nw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"><br>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/u011240877/article/details/72863432">https://blog.csdn.net/u011240877/article/details/72863432</a></p>
<h5 id="底层原理"><a href="#底层原理" class="headerlink" title="底层原理"></a>底层原理</h5><ul>
<li>RXJava怎么切换线程</li>
<li>binder进程间通信可以调用原进程方法吗？</li>
<li>SharedPreference原理？读取xml是在哪个线程?</li>
<li>AQS了解吗？</li>
<li>ConcurrentHashMap，线程安全，为何安全。底层实现是怎么样的。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/63859501">https://www.zhihu.com/question/63859501</a></p>
<h5 id="AQS"><a href="#AQS" class="headerlink" title="AQS"></a>AQS</h5><p><a target="_blank" rel="noopener" href="http://gee.cs.oswego.edu/dl/papers/aqs.pdf">http://gee.cs.oswego.edu/dl/papers/aqs.pdf</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV11Q4y1M7K2?from=search&amp;seid=12598203519866117819">https://www.bilibili.com/video/BV11Q4y1M7K2?from=search&amp;seid=12598203519866117819</a></p>
<p><a target="_blank" rel="noopener" href="https://javadoop.com/post/AbstractQueuedSynchronizer">https://javadoop.com/post/AbstractQueuedSynchronizer</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1yJ411v7er?from=search&amp;seid=12598203519866117819">https://www.bilibili.com/video/BV1yJ411v7er?from=search&amp;seid=12598203519866117819</a></p>
<h5 id="阻塞队列原理"><a href="#阻塞队列原理" class="headerlink" title="阻塞队列原理"></a>阻塞队列原理</h5><p><img src="https://s0.lgstatic.com/i/image3/M01/62/7D/Cgq2xl4le9SAL6enAAGpXZi8Wcg079.jpg"></p>
<p>阻塞功能:阻塞功能使得生产者和消费者两端的能力得以平衡，当有任何一端速度过快时，阻塞队列便会把过快的速度给降下来</p>
<p>是否有界</p>
<ul>
<li> LinkedBlockingQueue 的上限是 Integer.MAX_VALUE，约为 2 的 31 次方,</li>
<li>ArrayBlockingQueue 如果容量满了，也不会扩容，所以一旦满了就无法再往里放数据了。</li>
</ul>

        
        
          <blockquote id="copyright">
              <p>Ursprünglicher Link: <a href="http://noteforme.github.io.com/page/10/index.html">http://noteforme.github.io.com/page/10/index.html</a></p>
              <p>Copyright-Erklärung: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/inter/" rel="tag">inter</a></li></ul>

          
    <div class="social-share">
      <span>Aktie:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-INTERVIEW-SENIOR" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/22/INTERVIEW-SENIOR/">INTERVIEW_SENIOR</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-06-22T10:56:44.000Z" itemprop="datePublished">2018年06月22日</time>
</span>
      
      
      
<a href="/2018/06/22/INTERVIEW-SENIOR/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Gästebuch
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<h3 id="高端技术面试题"><a href="#高端技术面试题" class="headerlink" title="高端技术面试题"></a>高端技术面试题</h3><p><strong>这里讲的是大公司需要用到的一些高端Android技术，这里专门整理了一个文档，希望大家都可以看看。这些题目有点技术含量，需要好点时间去研究一下的。</strong></p>
<h5 id="（一）图片"><a href="#（一）图片" class="headerlink" title="（一）图片"></a>（一）图片</h5><ul>
<li><p>图片库对比</p>
</li>
<li><p>图片库的源码分析</p>
</li>
<li><p>图片框架缓存实现</p>
</li>
<li><p>LRUCache原理</p>
</li>
<li><p>图片加载原理</p>
</li>
<li><p>自己去实现图片库，怎么做？</p>
</li>
<li><p>Glide源码解析</p>
</li>
<li><p>Glide使用什么缓存？</p>
</li>
<li><p>Glide内存缓存如何控制大小？</p>
</li>
</ul>
<h3 id="框架学习"><a href="#框架学习" class="headerlink" title="框架学习"></a>框架学习</h3><p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=pUV3qZh481k">https://www.youtube.com/watch?v=pUV3qZh481k</a></p>
<h4 id="okhttp"><a href="#okhttp" class="headerlink" title="okhttp"></a>okhttp</h4><p>​    <a target="_blank" rel="noopener" href="https://noteforme.github.io/2017/08/07/OKHTTP/">https://noteforme.github.io/2017/08/07/OKHTTP/</a></p>
<h6 id="okhttp怎么支持http2-0"><a href="#okhttp怎么支持http2-0" class="headerlink" title="okhttp怎么支持http2.0"></a>okhttp怎么支持http2.0</h6><p>​    Handshake则会把服务端支持的Tls版本，加密方式等都带回来，然后会把这个没有验证过的HandShake用X509Certificate去验证证书的有效性。然后会通过Platform去从SSLSocket去获取ALPN的协议支持信息，当后端支持的协议内包含Http2.0时，则就会把请求升级到Http2.0阶段。</p>
<p>​    配置合适的适配器，解析json数据。</p>
<p>​    Android 如何编写基于编译时注解的项目</p>
<p>​    编译时注解与运行时注解，为什么retrofit要使用运行时注解？什么时候用运行时注解？</p>
<p>​    在项目中有直接使用tcp,socket来发送消息吗</p>
<p>​    <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1ib4y1f7S1">https://www.bilibili.com/video/BV1ib4y1f7S1</a></p>
<p>Okhttp缓存机制</p>
<h6 id="网络请求缓存处理，okhttp如何处理网络缓存的"><a href="#网络请求缓存处理，okhttp如何处理网络缓存的" class="headerlink" title="网络请求缓存处理，okhttp如何处理网络缓存的"></a>网络请求缓存处理，okhttp如何处理网络缓存的</h6><p>自己去设计网络请求框架，怎么做？</p>
<ul>
<li>从网络加载一个10M的图片，说下注意事项</li>
<li>TCP的3次握手和四次挥手</li>
<li>TCP与UDP的区别</li>
<li>TCP与UDP的应用</li>
<li>HTTP协议</li>
<li>HTTP1.0与2.0的区别</li>
<li>HTTP报文结构</li>
<li>HTTP与HTTPS的区别以及如何实现安全性</li>
<li>如何验证证书的合法性?</li>
<li>https中哪里用了对称加密，哪里用了非对称加密，对加密算法（如RSA）等是否有了解?</li>
<li>client如何确定自己发送的消息被server收到?</li>
<li>谈谈你对安卓签名的理解。</li>
<li>请解释安卓为啥要加签名机制?</li>
<li>视频加密传输</li>
<li>App 是如何沙箱化，为什么要这么做？</li>
<li>权限管理系统（底层的权限是如何进行 grant 的）？</li>
</ul>
<h4 id="Retrofit"><a href="#Retrofit" class="headerlink" title="Retrofit"></a>Retrofit</h4><p>在retrofit中的泛型是怎么解析的</p>
<p><a target="_blank" rel="noopener" href="https://noteforme.github.io/2017/09/23/Retrofit/">https://noteforme.github.io/2017/09/23/Retrofit/</a></p>
<h4 id="RxJava"><a href="#RxJava" class="headerlink" title="RxJava"></a>RxJava</h4><p><a target="_blank" rel="noopener" href="https://noteforme.github.io/2020/08/04/RxJava/">https://noteforme.github.io/2020/08/04/RxJava/</a></p>
<p>在 RxJava 中， 会遇到被观察者发送消息太快以至于它的操作符或者订阅者不能及时处理相关的消息，这就是典型的背压（ Back Pressure ）场景。</p>
<p>RxJava 是基于 Push 模型 。对于 Pull 模型而言，当消费者请求数据的时候，如果生产者比较慢  ，则消费者会阻塞等待。如果生产者比较快，生产者会等待消费者处理完后再生产新的数据，所以不会出现背压的情况。然而在 RxJava  中，只要生产者数据准备好了就会发射出去。如果生产者比较慢，则消费者会等待新的数据到来。如果生产者比较快，则会有很多数据发射给消费者，而不管消费者当前有没有能力处理数据，这样就会导致背压。</p>
<p>在 RxJava 2.x 中， Observable 不再支持背压，而是改用 Flowable 来专门支持背压。默认队列大小为 128 ，并且要求所有的操作符强制支持背压。</p>
<h5 id="RxJava原理及如何封装使用"><a href="#RxJava原理及如何封装使用" class="headerlink" title="RxJava原理及如何封装使用"></a>RxJava原理及如何封装使用</h5><p>​            使用观察者模式，和装饰器模式。</p>
<p>​            先用Observablex向右构建流，然后向左创建订阅流，最后时间通过观察者回调流发送。</p>
<p>​    </p>
<p>​    你了解协程吗？协程有什么作用？可以完全取代rxjava吗？</p>
<h5 id="rxjava里面用了大量的-lt-super-T-gt-这些，是什么意思。"><a href="#rxjava里面用了大量的-lt-super-T-gt-这些，是什么意思。" class="headerlink" title="rxjava里面用了大量的&lt;? super T&gt;这些，是什么意思。"></a>rxjava里面用了大量的<code>&lt;? super T&gt;</code>这些，是什么意思。</h5><ul>
<li><p>如果要从集合中读取类型T的数据，并且不能写入，可以使用 ? extends 通配符；(Producer Extends)</p>
</li>
<li><p>如果要从集合中写入类型T的数据，并且不需要读取，可以使用 ? super 通配符；(Consumer Super),只能用Object接收。</p>
</li>
<li><p>如果既要存又要取，那么就不要使用任何通配符。</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/86cf908afcb6">https://www.jianshu.com/p/86cf908afcb6</a></p>
</li>
</ul>
<h5 id="RxJava怎么通过被订阅者传给订阅者的过程是什么样的"><a href="#RxJava怎么通过被订阅者传给订阅者的过程是什么样的" class="headerlink" title="RxJava怎么通过被订阅者传给订阅者的过程是什么样的?"></a>RxJava怎么通过被订阅者传给订阅者的过程是什么样的?</h5><h5 id="Observer处理完onComplete后会还能onNext吗"><a href="#Observer处理完onComplete后会还能onNext吗" class="headerlink" title="Observer处理完onComplete后会还能onNext吗?"></a>Observer处理完onComplete后会还能onNext吗?</h5><p>​    onComplete是用来控制不能发送数据的，也就是不能onNext了，包括onError也是不能再发送onNext数据了，该方法中也是调用了     dispose方法。    </p>
<h5 id="RxJava中map、flatMap的区别，你还用过其他哪些操作符"><a href="#RxJava中map、flatMap的区别，你还用过其他哪些操作符" class="headerlink" title="RxJava中map、flatMap的区别，你还用过其他哪些操作符?"></a>RxJava中map、flatMap的区别，你还用过其他哪些操作符?</h5><p>​    map是通过原始数据类型返回另外一种数据类型，而flatMap是通过原始数据类型返回另外一种被观察者。</p>
<h5 id="Maybe、Single、Flowable、Completable几种观察者的区别，以及他们在什么场景用？"><a href="#Maybe、Single、Flowable、Completable几种观察者的区别，以及他们在什么场景用？" class="headerlink" title="Maybe、Single、Flowable、Completable几种观察者的区别，以及他们在什么场景用？"></a>Maybe、Single、Flowable、Completable几种观察者的区别，以及他们在什么场景用？</h5><p>​    如果只想发一条数据，或者不发数据就用Maybe，如果想发多条数据或者不发数据就用Observable，如果只发一条数据或者失败就用Single，如果想用背压策略使用Flowable，如果不发数据就用Completable</p>
<p>也就是说Maybe可能不发送数据，如果发送数据只会发送单条数据。</p>
<p>single也是发送单条数据，但是它要么成功要么失败。</p>
<h5 id="RxJava切换线程是怎么回事"><a href="#RxJava切换线程是怎么回事" class="headerlink" title="RxJava切换线程是怎么回事?"></a>RxJava切换线程是怎么回事?</h5><p>subscribeOn实际是创建了ObservableSubscribeOn的Observable，它的订阅方法里面创建了<code>SubscribeOnObserver</code>，通过线程池执行Runnable，使上游Observable的订阅在子线程中执行，这就是为什么subscribeOn能控制observable在哪个线程中执行的原因 </p>
<h5 id="RxJava的subscribeOn只有第一次生效"><a href="#RxJava的subscribeOn只有第一次生效" class="headerlink" title="RxJava的subscribeOn只有第一次生效?"></a>RxJava的subscribeOn只有第一次生效?</h5><p>subscribeOn对subscribe订阅进行处理，针对是订阅流，从后向前流动，所以最前面的一次生效。</p>
<p>subscribeOn是规定上游的observable在哪个线程中执行，如果我们执行多次的subscribeOn的话，从下游的observer到上游的observable的订阅过程，<strong>最开始调用的subscribeOn返回的observable会把后面执行的subscribeOn返回的observable给覆盖了，因此我们感官的是只有第一次的subscribeOn能生效。</strong></p>
<h5 id="RxJava的observeOn多次调用哪个有效"><a href="#RxJava的observeOn多次调用哪个有效" class="headerlink" title="RxJava的observeOn多次调用哪个有效?"></a>RxJava的observeOn多次调用哪个有效?</h5><p>observeOn在事件发送的 onNext(T t)进行处理，针对的是观察者流，从前向后流动，所以最后一次生效。</p>
<p>observeOn是指定下游的observer在哪个线程中执行，所以这个更好理解，看observeOn下一个observer是哪一个，<strong>所以多次调用observeOn肯定是最后一个observeOn控制有效。</strong></p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6900870262062120967">https://juejin.cn/post/6900870262062120967</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/339620311">https://zhuanlan.zhihu.com/p/339620311</a></p>
<p>RxJava中背压是怎么回事？</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c3965e82b164">https://www.jianshu.com/p/c3965e82b164</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/322405376">https://zhuanlan.zhihu.com/p/322405376</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Af4y187b8">https://www.bilibili.com/video/BV1Af4y187b8</a></p>
<h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><ul>
<li>sqlite升级，增加字段的语句</li>
<li>数据库框架对比和源码分析</li>
<li>数据库的优化</li>
<li>数据库数据迁移问题</li>
</ul>
<h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3><h6 id="排序算法有哪些？"><a href="#排序算法有哪些？" class="headerlink" title="排序算法有哪些？"></a>排序算法有哪些？</h6><p>冒泡排序、选择排序、插入排序、归并排序、快速排序、希尔排序、堆排序、计数排序、桶排序、基数排序</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/42586566">https://zhuanlan.zhihu.com/p/42586566</a></p>
<p><img src="https://img-blog.csdn.net/20180912224019565?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2NzcwNjQx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p>
<h6 id="最快的排序算法是哪个？"><a href="#最快的排序算法是哪个？" class="headerlink" title="最快的排序算法是哪个？"></a>最快的排序算法是哪个？</h6><p>快速排序  最好情况O(nlogn)  最坏情况 O(n^2)</p>
<p>为什么不是堆排序  ?</p>
<p> 在堆排序（小根堆）的时候，每次总是将最小的元素移除，然后将最后的元素放到堆顶，再让其自我调整。这样一来，有很多比较将是被浪费的，因为被拿到堆顶的那个元素几乎肯定是很大的，而靠近堆顶的元素又几乎肯定是很小的，最后一个元素能留在堆顶的可能性微乎其微，最后一个元素很有可能最终再被移动到底部。在堆排序里面有大量这种近乎无效的比较。随着数据规模的增长，比较的开销最差情况应该在（线性*对数）级别，如果数据量是原来的10倍，那么用于比较的时间开销可能是原来的10log10倍<br>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36770641/article/details/82669788">https://blog.csdn.net/qq_36770641/article/details/82669788</a></p>
<ul>
<li>手写一个冒泡排序</li>
</ul>
<ul>
<li>手写快速排序代码</li>
<li>快速排序的过程、时间复杂度、空间复杂度</li>
<li>手写堆排序</li>
<li>堆排序过程、时间复杂度及空间复杂度</li>
<li>写出你所知道的排序算法及时空复杂度，稳定性</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://noteforme.github.io/2021/03/21/Data-Sort/">https://noteforme.github.io/2021/03/21/Data-Sort/</a></p>
<ul>
<li>二叉树给出根节点和目标节点，找出从根节点到目标节点的路径</li>
<li>给阿里2万多名员工按年龄排序应该选择哪个算法？</li>
<li>GC算法(各种算法的优缺点以及应用场景)</li>
<li>蚁群算法与蒙特卡洛算法</li>
<li>子串包含问题(KMP 算法)写代码实现</li>
<li>一个无序，不重复数组，输出N个元素，使得N个元素的和相加为M，给出时间复杂度、空间复杂度。手写算法</li>
<li>万亿级别的两个URL文件A和B，如何求出A和B的差集C(提示：Bit映射-&gt;hash分组-&gt;多文件读写效率-&gt;磁盘寻址以及应用层面对寻址的优化)</li>
<li>百度POI中如何试下查找最近的商家功能(提示：坐标镜像+R树)。</li>
<li>两个不重复的数组集合中，求共同的元素。</li>
<li>两个不重复的数组集合中，这两个集合都是海量数据，内存中放不下，怎么求共同的元素？</li>
<li>一个文件中有100万个整数，由空格分开，在程序中判断用户输入的整数是否在此文件中。说出最优的方法</li>
<li>一张Bitmap所占内存以及内存占用的计算</li>
<li>2000万个整数，找出第五十大的数字？</li>
<li>烧一根不均匀的绳，从头烧到尾总共需要1个小时。现在有若干条材质相同的绳子，问如何用烧绳的方法来计时一个小时十五分钟呢？</li>
<li>求1000以内的水仙花数以及40亿以内的水仙花数</li>
<li>5枚硬币，2正3反如何划分为两堆然后通过翻转让两堆中正面向上的硬8币和反面向上的硬币个数相同</li>
<li>时针走一圈，时针分针重合几次</li>
<li>N*N的方格纸,里面有多少个正方形</li>
<li>x个苹果，一天只能吃一个、两个、或者三个，问多少天可以吃完？</li>
</ul>
<h5 id="插件化、模块化、组件化、热修复、增量更新、Gradle"><a href="#插件化、模块化、组件化、热修复、增量更新、Gradle" class="headerlink" title="插件化、模块化、组件化、热修复、增量更新、Gradle"></a>插件化、模块化、组件化、热修复、增量更新、Gradle</h5><ul>
<li>对热修复和插件化的理解</li>
<li>插件化原理分析</li>
<li>模块化实现（好处，原因）</li>
<li>热修复,插件化</li>
<li>项目组件化的理解</li>
<li>描述清点击 Android Studio 的 build 按钮后发生了什么</li>
</ul>
<h3 id="架构设计和设计模式"><a href="#架构设计和设计模式" class="headerlink" title="架构设计和设计模式"></a>架构设计和设计模式</h3><p>​    <a target="_blank" rel="noopener" href="https://noteforme.github.io/categories/DesignPatterns/">https://noteforme.github.io/categories/DesignPatterns/</a></p>
<h4 id="设计原则"><a href="#设计原则" class="headerlink" title="设计原则"></a>设计原则</h4><p>​    单一职责</p>
<p>​    一个类应该只负责一项职责。</p>
<p>接口隔离</p>
<p>​    客户端不应该依赖它不需要的接口，即一个类对另一个类的依赖应该建立在最小的接口上。</p>
<p>依赖倒置</p>
<ul>
<li>高层模块不应该依赖低层模块，二者都应该依赖其抽象。</li>
<li>抽象不应该依赖细节，细节应该依赖抽象。</li>
<li>依赖倒置的中心思想是<strong>面向接口编程</strong>。</li>
</ul>
<p>里氏替换</p>
<ul>
<li>所有使用基类的地方必须能透明的使用其子类。</li>
<li>使用继承时，遵循里氏替换原则，<strong>子类尽量不要重写父类的方法</strong>。继承实际上让两个类耦合性增强了，适当情况下可以通过 聚合 组合 依赖来解决问题。</li>
</ul>
<p>​    通用做法是： 原来的父类和子类都继承一个更通俗的基类，原有的继承关系去掉，采用依赖，聚合，组合等关系代替。</p>
<p>开闭原则 ocp</p>
<p>迪米特法则</p>
<p>​    一个对象应该对其他对象保持最少的了解</p>
<h4 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h4><ul>
<li>谈谈你对Android设计模式的理解</li>
<li>MVC MVP MVVM原理和区别</li>
<li>你所知道的设计模式有哪些？</li>
<li>项目中常用的设计模式</li>
<li>手写生产者/消费者模式</li>
<li>写出观察者模式的代码</li>
<li>适配器模式，装饰者模式，外观模式的异同？</li>
<li>用到的一些开源框架，介绍一个看过源码的，内部实现过程。</li>
<li>谈谈对RxJava的理解</li>
<li>RxJava的功能与原理实现</li>
<li>RxJava的作用，与平时使用的异步操作来比的优缺点</li>
<li>说说EventBus作用，实现方式，代替EventBus的方式</li>
<li>从0设计一款App整体架构，如何去做？</li>
<li>说一款你认为当前比较火的应用并设计(比如：直播APP，P2P金融，小视频等)</li>
<li>谈谈对java状态机理解</li>
<li>Fragment如果在Adapter中使用应该如何解耦？</li>
<li>Binder机制及底层实现</li>
<li>对于应用更新这块是如何做的？(解答：灰度，强制更新，分区域更新)？</li>
<li>实现一个Json解析器(可以通过正则提高速度)</li>
<li>统计启动时长,标准</li>
</ul>
<h3 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h3><ul>
<li>如何对Android 应用进行性能分析以及优化?</li>
<li>ddms 和 traceView</li>
<li>性能优化如何分析systrace？</li>
<li>用IDE如何分析内存泄漏？</li>
<li>Java多线程引发的性能问题，怎么解决？</li>
<li>启动页白屏及黑屏解决？</li>
<li>启动太慢怎么解决？</li>
<li>怎么保证应用启动不卡顿？</li>
<li>App启动崩溃异常捕捉</li>
<li>自定义View注意事项</li>
<li>现在下载速度很慢,试从网络协议的角度分析原因,并优化(提示：网络的5层都可以涉及)。</li>
<li>Https请求慢的解决办法（提示：DNS，携带数据，直接访问IP）</li>
<li>如何保持应用的稳定性</li>
<li>RecyclerView和ListView的性能对比</li>
<li>ListView的优化</li>
<li>RecycleView优化</li>
<li>View渲染</li>
<li>Bitmap如何处理大图，如一张30M的大图，如何预防OOM</li>
<li>java中的四种引用的区别以及使用场景</li>
<li>强引用置为null，会不会被回收？</li>
</ul>
<h4 id="NDK、jni、Binder、AIDL、进程通信有关"><a href="#NDK、jni、Binder、AIDL、进程通信有关" class="headerlink" title="NDK、jni、Binder、AIDL、进程通信有关"></a>NDK、jni、Binder、AIDL、进程通信有关</h4><ul>
<li>请介绍一下NDK</li>
<li>什么是NDK库?</li>
<li>jni用过吗？</li>
<li>如何在jni中注册native函数，有几种注册方式?</li>
<li>Java如何调用c、c++语言？</li>
<li>jni如何调用java层代码？</li>
<li>进程间通信的方式？</li>
<li>Binder机制</li>
<li>简述IPC？</li>
<li>什么是AIDL？</li>
<li>AIDL解决了什么问题？</li>
<li>AIDL如何使用？</li>
<li>Android 上的 Inter-Process-Communication 跨进程通信时如何工作的？</li>
<li>多进程场景遇见过么？</li>
<li>Android进程分类？</li>
<li>进程和 Application 的生命周期？</li>
<li>进程调度</li>
<li>谈谈对进程共享和线程安全的认识</li>
<li>谈谈对多进程开发的理解以及多进程应用场景</li>
<li>什么是协程？</li>
</ul>
<h4 id="framework层、ROM定制、Ubuntu、Linux之类的问题"><a href="#framework层、ROM定制、Ubuntu、Linux之类的问题" class="headerlink" title="framework层、ROM定制、Ubuntu、Linux之类的问题"></a>framework层、ROM定制、Ubuntu、Linux之类的问题</h4><ul>
<li>java虚拟机的特性</li>
<li>谈谈对jvm的理解</li>
<li>JVM内存区域，开线程影响哪块内存</li>
<li>对Dalvik、ART虚拟机有什么了解？</li>
<li>Art和Dalvik对比</li>
<li>虚拟机原理，如何自己设计一个虚拟机(内存管理，类加载，双亲委派)</li>
<li>谈谈你对双亲委派模型理解</li>
<li>JVM内存模型，内存区域</li>
<li>类加载机制</li>
<li>谈谈对ClassLoader(类加载器)的理解</li>
<li>谈谈对动态加载（OSGI）的理解</li>
<li>内存对象的循环引用及避免</li>
<li>内存回收机制、GC回收策略、GC原理时机以及GC对象</li>
<li>垃圾回收机制与调用System.gc()区别</li>
<li>系统启动流程是什么？（提示：Zygote进程 –&gt; SystemServer进程 –&gt; 各种系统服务 –&gt; 应用进程）</li>
<li>大体说清一个应用程序安装到手机上时发生了什么</li>
<li>简述Activity启动全部过程</li>
<li>App启动流程，从点击桌面开始</li>
<li>Android中进程内存的分配，能不能自己分配定额内存？</li>
<li>如何保证一个后台服务不被杀死？（相同问题：如何保证service在后台不被kill？）比较省电的方式是什么？</li>
<li>App中唤醒其他进程的实现方式</li>
</ul>
<p>​    <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c3965e82b164">https://www.jianshu.com/p/c3965e82b164</a></p>
<p>​    <a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label29">https://www.cnblogs.com/deman/p/5860976.html#_label29</a></p>
<ul>
<li><strong>AMS是如何启动的？</strong></li>
<li><strong>AMS在Android起到什么作用？</strong></li>
<li><strong>AMS有哪些应用场景？我们是如何应用AMS核心原理的？</strong></li>
<li><strong>WMS的工作原理说说？</strong></li>
<li><strong>JVM的核心原理你懂多少？</strong></li>
<li><strong>我们的代码是如何在栈区中运行的？</strong></li>
<li><strong>如何使用字节码研究系统级原理？</strong></li>
</ul>

        
        
          <blockquote id="copyright">
              <p>Ursprünglicher Link: <a href="http://noteforme.github.io.com/page/10/index.html">http://noteforme.github.io.com/page/10/index.html</a></p>
              <p>Copyright-Erklärung: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/inter/" rel="tag">inter</a></li></ul>

          
    <div class="social-share">
      <span>Aktie:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Zigbee" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/20/Zigbee/">Zigbee</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-06-20T08:51:26.000Z" itemprop="datePublished">2018年06月20日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/ANDROID/">ANDROID</a>
  </div>

      
      
<a href="/2018/06/20/Zigbee/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Gästebuch
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_34581118/article/details/78452316">https://blog.csdn.net/qq_34581118/article/details/78452316</a></p>
<p>0000 0101<br>0001 0000</p>
<p>0001 0101   = 1 * 2^4+ 1*2^2 + 1 = 21  =  0X15<img src="/2018/06/20/Zigbee/Zigbee%5CZigbee_20180620172017.png" alt="Zigbee_20180620172017"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">01</span> <span class="number">02</span> <span class="number">10</span> <span class="number">11</span> <span class="number">02</span> <span class="number">10</span> <span class="number">02</span> <span class="number">10</span> <span class="number">11</span> <span class="number">03</span></span><br><span class="line">	  <span class="attribute">10</span>       <span class="number">10</span>    <span class="number">10</span> <span class="number">10</span> </span><br><span class="line"><span class="attribute">01</span>    <span class="number">00</span>  <span class="number">11</span>    <span class="number">00</span>   <span class="number">00</span>  <span class="number">11</span> <span class="number">03</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/feiyangxiaomi/article/details/9257375">https://blog.csdn.net/feiyangxiaomi/article/details/9257375</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5b124346e51d450684732790">https://juejin.im/post/5b124346e51d450684732790</a></p>

        
        
          <blockquote id="copyright">
              <p>Ursprünglicher Link: <a href="http://noteforme.github.io.com/page/10/index.html">http://noteforme.github.io.com/page/10/index.html</a></p>
              <p>Copyright-Erklärung: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Aktie:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Architecture" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/14/Architecture/">Architecture</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-06-14T01:31:59.000Z" itemprop="datePublished">2018年06月14日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/Jetpack/">Jetpack</a>
  </div>

      
      
<a href="/2018/06/14/Architecture/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Gästebuch
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h5 id="Jetpack"><a href="#Jetpack" class="headerlink" title="Jetpack"></a>Jetpack</h5><p><img src="/2018/06/14/Architecture/2021-08-02_8.15_jetpack.png"></p>
<p>It helps to be familiar with software architectural patterns that separate data from the user interface, such as MVP or MVC</p>
<p><a target="_blank" rel="noopener" href="https://developer.android.com/jetpack/docs/getting-started">https://developer.android.com/jetpack/docs/getting-started</a></p>
<ul>
<li>modules should interact</li>
</ul>
<p><img src="/2018/06/14/Architecture/final-architecture.png" alt="final-architecture"></p>
<ul>
<li>NetworkBoundResource</li>
</ul>
<p>It starts by observing the database for the resource. When the entry is loaded from the database for the first time, <code>NetworkBoundResource</code> checks whether the result is good enough to be dispatched or that it  should be re-fetched from the network. Note that both of these  situations can happen at the same time, given that you probably want to  show cached data while updating it from the network.</p>
<p><img src="/2018/06/14/Architecture/network-bound-resource.png" alt="final-architecture"></p>
<p><a target="_blank" rel="noopener" href="https://developer.android.com/topic/libraries/architecture">https://developer.android.com/topic/libraries/architecture</a></p>
<p>架构学习从codelab开始吧!</p>
<p> <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/19f97654c451">https://www.jianshu.com/p/19f97654c451</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/qingmei2/MVVM-Architecture">https://github.com/qingmei2/MVVM-Architecture</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5dafc49b6fb9a04e17209922">https://juejin.im/post/5dafc49b6fb9a04e17209922</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5d2be05ff265da1bd605d49a">https://juejin.im/post/5d2be05ff265da1bd605d49a</a></p>
<h6 id="LifecycleOwner"><a href="#LifecycleOwner" class="headerlink" title="LifecycleOwner"></a><strong>LifecycleOwner</strong></h6><p><a target="_blank" rel="noopener" href="https://developer.android.com/reference/androidx/lifecycle/LifecycleOwner.html"><code>LifecycleOwner</code> is an interface </a>implemented by the <a target="_blank" rel="noopener" href="https://developer.android.com/reference/androidx/appcompat/app/AppCompatActivity"><code>AppCompatActivity</code></a> and <a target="_blank" rel="noopener" href="https://developer.android.com/reference/androidx/fragment/app/Fragment"><code>Fragment</code></a> classes. You can subscribe other components to owner objects which implement this interface, to observe changes to the lifecycle of the owner.</p>
<p>To read an introductory guide to this topic, see <a target="_blank" rel="noopener" href="https://developer.android.com/topic/libraries/architecture/lifecycle.html">Handling Lifecycles</a>.</p>
<p><a target="_blank" rel="noopener" href="https://codelabs.developers.google.com/codelabs/android-lifecycles/#1">https://codelabs.developers.google.com/codelabs/android-lifecycles/#1</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/gQhBeKA2vGAkh3Tbqn0tEA">https://mp.weixin.qq.com/s/gQhBeKA2vGAkh3Tbqn0tEA</a></p>
<h6 id="ViewModel"><a href="#ViewModel" class="headerlink" title="ViewModel"></a>ViewModel</h6><p><a target="_blank" rel="noopener" href="https://noteforme.github.io/2020/04/06/viewmodel/">https://noteforme.github.io/2020/04/06/viewmodel/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/731ca42823ee">https://www.jianshu.com/p/731ca42823ee</a></p>
<p>viewmodelstoreowner</p>
<h6 id="navigation"><a href="#navigation" class="headerlink" title="navigation"></a>navigation</h6><p><a target="_blank" rel="noopener" href="https://developer.android.com/guide/navigation/">https://developer.android.com/guide/navigation/</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.android.com/guide/navigation/navigation-getting-started">https://developer.android.com/guide/navigation/navigation-getting-started</a></p>
<p><a target="_blank" rel="noopener" href="https://codelabs.developers.google.com/codelabs/android-navigation/index.html?index=../../index#0">https://codelabs.developers.google.com/codelabs/android-navigation/index.html?index=..%2F..%2Findex#0</a></p>
<p>Codelab 抽屉图标不显示</p>
<ul>
<li><p>BottomNavigationView 导航栏优化  recarete fragment</p>
<p><a target="_blank" rel="noopener" href="https://medium.com/@freedom.chuks7/how-to-use-jet-pack-components-bottomnavigationview-with-navigation-ui-19fb120e3fb9">https://medium.com/@freedom.chuks7/how-to-use-jet-pack-components-bottomnavigationview-with-navigation-ui-19fb120e3fb9</a></p>
</li>
</ul>
<p><strong>NOTICE</strong> :  NavigationView each item ID is matching with fragment ID in navigation</p>
<p> <a target="_blank" rel="noopener" href="https://jiangjiwei.site/post/navigation-zhi-fragment-qie-huan/">https://jiangjiwei.site/post/navigation-zhi-fragment-qie-huan/</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/lwj1994/navigation-keep-state-fragment">https://github.com/lwj1994/navigation-keep-state-fragment</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/STAR-ZERO/navigation-keep-fragment-sample">https://github.com/STAR-ZERO/navigation-keep-fragment-sample</a></p>
<p>Bottom tab定位</p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/50577356/android-jetpack-navigation-bottomnavigationview-with-youtube-or-instagram-like">https://stackoverflow.com/questions/50577356/android-jetpack-navigation-bottomnavigationview-with-youtube-or-instagram-like</a></p>
<p>全局共享</p>
<p><a target="_blank" rel="noopener" href="https://github.com/googlesamples/android-architecture-components">googlesamples</a></p>
<h5 id="previously-architecture"><a href="#previously-architecture" class="headerlink" title="previously architecture"></a>previously architecture</h5><p>MVC MVP. MVVM三种架构介绍</p>
<p><a target="_blank" rel="noopener" href="http://www.jcodecraeer.com/a/anzhuokaifa/2017/1024/8636.html">http://www.jcodecraeer.com/a/anzhuokaifa/2017/1024/8636.html</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/Kc1826MQ3ReMkoIWlsQGVw">https://mp.weixin.qq.com/s/Kc1826MQ3ReMkoIWlsQGVw</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5dafc49b6fb9a04e17209922">https://juejin.im/post/5dafc49b6fb9a04e17209922</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5dafc49b6fb9a04e17209922#heading-13">https://juejin.im/post/5dafc49b6fb9a04e17209922#heading-13</a></p>
<ul>
<li>MVP</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://juejin.im/entry/5955e7166fb9a06bc23a8598">https://juejin.im/entry/5955e7166fb9a06bc23a8598</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/yaozs/YzsBaseActivity">https://github.com/yaozs/YzsBaseActivity</a></p>
<p>多个activity对p的复用</p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/599ce8016fb9a0247e4255f4">https://juejin.im/post/599ce8016fb9a0247e4255f4</a></p>
<ul>
<li>Component</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/8_8gGpkpO2QFNkWgSRBwIg">https://mp.weixin.qq.com/s/8_8gGpkpO2QFNkWgSRBwIg</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/6a50ef1ef45c">https://www.jianshu.com/p/6a50ef1ef45c</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.android.com/studio/build/dependencies#duplicate_classes">https://developer.android.com/studio/build/dependencies#duplicate_classes</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.android.com/studio/build/manifest-merge?hl=zh-cn">https://developer.android.com/studio/build/manifest-merge?hl=zh-cn</a></p>
<p>merge androidmanifest 合并</p>
<p>&lt;<a target="_blank" rel="noopener" href="https://developer.android.com/studio/build/manifest-merge">https://developer.android.com/studio/build/manifest-merge</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/14a822e42151">https://www.jianshu.com/p/14a822e42151</a></p>
<p>compose</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/0mAbKEuBH5HHYa23EcWalg">https://mp.weixin.qq.com/s/0mAbKEuBH5HHYa23EcWalg</a></p>
<p>lifecycle</p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/6847902220755992589">https://juejin.im/post/6847902220755992589</a></p>
<p>组件化 服务</p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/6884492604370026503">https://juejin.im/post/6884492604370026503</a></p>

        
        
          <blockquote id="copyright">
              <p>Ursprünglicher Link: <a href="http://noteforme.github.io.com/page/10/index.html">http://noteforme.github.io.com/page/10/index.html</a></p>
              <p>Copyright-Erklärung: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Aktie:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>



    <nav id="page-nav">

<a class="extend prev" rel="prev" href="/page/9/">Vorheriger</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/11/">Nächster</a>
</nav>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-posts"></i> Letzte</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/11/23/Font/">Font</a>
          </li>
        
          <li>
            <a href="/2021/11/08/coroutine-begin/">coroutine_begin</a>
          </li>
        
          <li>
            <a href="/2021/11/06/Language/">Language</a>
          </li>
        
          <li>
            <a href="/2021/10/31/BinarySearch/">BinarySearch</a>
          </li>
        
          <li>
            <a href="/2021/09/11/kotlin-senior2/">kotlin-senior2</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-tag"></i> Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AOSP/" style="font-size: 20px;">AOSP</a> <a href="/tags/Activity/" style="font-size: 10px;">Activity</a> <a href="/tags/AndroidNewFeatures/" style="font-size: 10px;">AndroidNewFeatures</a> <a href="/tags/Assembly/" style="font-size: 10px;">Assembly</a> <a href="/tags/BLOG/" style="font-size: 10px;">BLOG</a> <a href="/tags/ConstraintLayout/" style="font-size: 10px;">ConstraintLayout</a> <a href="/tags/DB/" style="font-size: 11.43px;">DB</a> <a href="/tags/DataStructure/" style="font-size: 10px;">DataStructure</a> <a href="/tags/Drawer/" style="font-size: 10px;">Drawer</a> <a href="/tags/Git/" style="font-size: 11.43px;">Git</a> <a href="/tags/JVM/" style="font-size: 18.57px;">JVM</a> <a href="/tags/Kotlin/" style="font-size: 15.71px;">Kotlin</a> <a href="/tags/Operators/" style="font-size: 10px;">Operators</a> <a href="/tags/RxJava/" style="font-size: 14.29px;">RxJava</a> <a href="/tags/THINK/" style="font-size: 10px;">THINK</a> <a href="/tags/TabLayout/" style="font-size: 10px;">TabLayout</a> <a href="/tags/Test/" style="font-size: 14.29px;">Test</a> <a href="/tags/TouchEvent/" style="font-size: 12.86px;">TouchEvent</a> <a href="/tags/VIEW/" style="font-size: 12.86px;">VIEW</a> <a href="/tags/concurrency/" style="font-size: 14.29px;">concurrency</a> <a href="/tags/inter/" style="font-size: 17.14px;">inter</a> <a href="/tags/keyboard/" style="font-size: 10px;">keyboard</a> <a href="/tags/proguard/" style="font-size: 10px;">proguard</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-classify"></i> Kategorien</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ANDROID/">ANDROID</a><span class="category-list-count">56</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/BLE/">BLE</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DataStructure/">DataStructure</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DesignPatterns/">DesignPatterns</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ENGLISH/">ENGLISH</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a><span class="category-list-count">25</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Jetpack/">Jetpack</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kotlin/">Kotlin</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/LINUX/">LINUX</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mathematics/">Mathematics</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS/">OS</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Organization/">Organization</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TEST/">TEST</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TOOL/">TOOL</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/VIEW/">VIEW</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/anim/">anim</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/coroutine/">coroutine</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/flutter/">flutter</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-archive"></i> Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021年11月</a><span class="archive-list-count">22</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020年12月</a><span class="archive-list-count">45</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019年12月</a><span class="archive-list-count">20</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018年11月</a><span class="archive-list-count">32</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017年12月</a><span class="archive-list-count">57</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-tag"></i> Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AOSP/" rel="tag">AOSP</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Activity/" rel="tag">Activity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AndroidNewFeatures/" rel="tag">AndroidNewFeatures</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Assembly/" rel="tag">Assembly</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BLOG/" rel="tag">BLOG</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ConstraintLayout/" rel="tag">ConstraintLayout</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DB/" rel="tag">DB</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DataStructure/" rel="tag">DataStructure</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Drawer/" rel="tag">Drawer</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/" rel="tag">JVM</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kotlin/" rel="tag">Kotlin</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Operators/" rel="tag">Operators</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RxJava/" rel="tag">RxJava</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/THINK/" rel="tag">THINK</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TabLayout/" rel="tag">TabLayout</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Test/" rel="tag">Test</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TouchEvent/" rel="tag">TouchEvent</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VIEW/" rel="tag">VIEW</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/concurrency/" rel="tag">concurrency</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/inter/" rel="tag">inter</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/keyboard/" rel="tag">keyboard</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/proguard/" rel="tag">proguard</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-link"></i> Blogroll</h3>
    <div class="widget">
      <ul>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example1.com/">site-name1</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example2.com/">site-name2</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example3.com/">site-name3</a>
        </li>
      
      </ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <a id="totop" href="#top"></a>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      <p>
        <a href="/sitemap.xml">Sitemap</a>
        <span> | </span><a href="/atom.xml">Abonnieren Sie diese Site</a>
        <span> | </span><a href="/about/">Kontaktieren Sie den Blogger</a>
      </p>
      
        <p>
          <i class="fa fa-visitors"></i>
          <i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>
          ，
          <i class="fa fa-views"></i>
          <i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>
        </p>
      
      <p>
        <span>Copyright &copy; 2021 Jon.</span>
        <span>Theme by <a href="https://github.com/chaooo/hexo-theme-BlueLake/" target="_blank">BlueLake.</a></span>
        
            <span>Count by <a href="http://busuanzi.ibruce.info/" target="_blank">busuanzi.</a></span>
        
        <span>Powered by <a href="https://hexo.io/" target="_blank">Hexo.</a></span>
      </p>
    </div>
  </div>
</footer>

    </div>
    
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/search.json.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>






  
<script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



  
<script src="/localshare/js/social-share.js"></script>

  
<script src="/localshare/js/qrcode.js"></script>




















  </div>
</body>
</html>