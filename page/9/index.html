<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Jon&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  
  
    <link rel="alternate" href="/atom.xml" title="Jon's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="/localshare/css/share.css">

  
  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Jon&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Cease to struggle and you cease to live. - Thomas Carlyle</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/."><i class="fa fa-home"></i> Home</a>
        
          <a class="main-nav-link" href="/archives/"><i class="fa fa-archive"></i> Archive</a>
        
          <a class="main-nav-link" href="/about/"><i class="fa fa-user"></i> About</a>
        
          <a class="main-nav-link" href="/atom.xml"><i class="fa fa-rss"></i> RSS</a>
        
      </nav>
    </div>
    <div id="search-form">
      <div id="result-mask" class="hide"></div>
      <label><input id="search-key" type="text" autocomplete="off" placeholder="search"></label>
      <div id="result-wrap" class="hide">
        <div id="search-result"></div>
      </div>
      <div class="hide">
        <template id="search-tpl">
          <div class="item">
            <a href="/{path}" title="{title}">
              <div class="title">{title}</div>
              <div class="time">{date}</div>
              <div class="tags">{tags}</div>
            </a>
          </div>
        </template>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  <article id="post-LiveData" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/06/15/LiveData/">LiveData</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2020-06-15T03:20:42.000Z" itemprop="datePublished">2020年06月15日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/Jetpack/">Jetpack</a>
  </div>

      
      
<a href="/2020/06/15/LiveData/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV19B4y1N7iV">https://www.bilibili.com/video/BV19B4y1N7iV</a></p>
<h3 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h3><ol>
<li>确保界面符合数据状态</li>
<li>不会发生内存泄漏</li>
<li>不会因Activity停止而导致崩溃</li>
<li>不再需要手动处理生命周期</li>
<li>数据始终保持最新状态</li>
<li>适当的配置更改</li>
<li>共享资源</li>
</ol>
<h5 id="stiky-event"><a href="#stiky-event" class="headerlink" title="stiky event"></a>stiky event</h5><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7019734258793054238">https://juejin.cn/post/7019734258793054238</a></p>
<h4 id="savedStateHandle-使用"><a href="#savedStateHandle-使用" class="headerlink" title="savedStateHandle 使用"></a>savedStateHandle 使用</h4><p> 模拟app killed</p>
<p><a target="_blank" rel="noopener" href="https://developer.android.com/codelabs/android-lifecycles#6">https://developer.android.com/codelabs/android-lifecycles#6</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adb shell ps -A |grep lifecycle</span><br><span class="line">adb shell am kill </span><br></pre></td></tr></table></figure>



<h5 id="1-为什么有粘性事件"><a href="#1-为什么有粘性事件" class="headerlink" title="1. 为什么有粘性事件"></a>1. 为什么有粘性事件</h5><p>Google官方文档中描述，设备横竖屏切换的时候，界面销毁重建，但是Activity生命周期并未结束，旋转后新建的空页面上数据需要重新填充，曾经的后台Activity返回到前台后立即接受最新的数据，所以LiveData在被再次观察时会立即推送数据更新。</p>
<h5 id="粘性实例"><a href="#粘性实例" class="headerlink" title="粘性实例"></a>粘性实例</h5><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6856688280231444487">https://juejin.cn/post/6856688280231444487</a></p>
<ol start="2">
<li><p>旋转屏幕，为什么能保持数据</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">static <span class="class"><span class="keyword">class</span> <span class="title">ObserverWithState</span> </span>&#123;</span><br><span class="line">    State mState;</span><br><span class="line">    LifecycleEventObserver mLifecycleObserver;</span><br><span class="line"></span><br><span class="line">    ObserverWithState(LifecycleObserver observer, State initialState) &#123;</span><br><span class="line">        mLifecycleObserver = Lifecycling.lifecycleEventObserver(observer);</span><br><span class="line">        mState = initialState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void dispatchEvent(LifecycleOwner owner, Event event) &#123;</span><br><span class="line">        State newState = event.getTargetState();</span><br><span class="line">        mState = min(mState, newState);</span><br><span class="line">        mLifecycleObserver.onStateChanged(owner, event); <span class="comment">// onstart状态 能继续发送，不知道什么方法触发的。</span></span><br><span class="line">        mState = newState;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="livedata和viewmodel关系"><a href="#livedata和viewmodel关系" class="headerlink" title="livedata和viewmodel关系"></a>livedata和viewmodel关系</h4><p>viewmodel中的数据发生变化时通知页面</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/98a44ef9f3304b6b847d9e02fd0327b8~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="image.png"></p>
<h5 id="livedata-active状态e"><a href="#livedata-active状态e" class="headerlink" title="livedata active状态e"></a>livedata active状态e</h5><p><img src="/2020/06/15/LiveData/lifecycle_state.jpg" alt="lifecycle_state"></p>
<p><code>LiveData</code> objects only consider subscriptions as active when their respective lifecycle owner is either <a target="_blank" rel="noopener" href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.State.html#started">STARTED</a> or <a target="_blank" rel="noopener" href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.State.html#resumed">RESUMED</a>.</p>
<p>STARTED ， </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">shouldBeActive</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> mOwner.getLifecycle().getCurrentState().isAtLeast(STARTED);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EnumTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">compareTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">        println(<span class="string">&quot;DESTROYED &quot;</span>+  State.DESTROYED.isAtLeast(State.STARTED))</span><br><span class="line">        println(<span class="string">&quot;INITIALIZED &quot;</span>+  State.INITIALIZED.isAtLeast(State.STARTED))</span><br><span class="line">        println(<span class="string">&quot;CREATED &quot;</span>+  State.CREATED.isAtLeast(State.STARTED))</span><br><span class="line">        println(<span class="string">&quot;STARTED &quot;</span>+  State.STARTED.isAtLeast(State.STARTED))</span><br><span class="line">        println(<span class="string">&quot;RESUMED &quot;</span>+  State.RESUMED.isAtLeast(State.STARTED))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>DESTROYED false<br>INITIALIZED false<br>CREATED false<br>STARTED true<br>RESUMED true</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44076155/article/details/121471697">https://blog.csdn.net/qq_44076155/article/details/121471697</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6955309901363036191">https://juejin.cn/post/6955309901363036191</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7148049769057746952">https://juejin.cn/post/7148049769057746952</a></p>
<p>从上面例子可以知道LiveData的核心主要在于这两步，liveData.observe()以及liveData.postValue()，一个是注册观察者，一个是发送通知。那么下面的解析就将这两个函数作为切入点。</p>
<p>mLastVersion : 观察者</p>
<p>mVersion :      被观察者</p>
<h5 id="1-LiveData-observe"><a href="#1-LiveData-observe" class="headerlink" title="1.LiveData.observe()"></a>1.LiveData.observe()</h5><p>从liveData.observe()跟踪进去:</p>
<p>LiveData.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">private</span> SafeIterableMap&lt;Observer&lt;? <span class="keyword">super</span> T&gt;, ObserverWrapper&gt; mObservers =</span><br><span class="line">            <span class="keyword">new</span> SafeIterableMap&lt;&gt;();</span><br><span class="line">            </span><br><span class="line">            ......</span><br><span class="line">            </span><br><span class="line"> <span class="meta">@MainThread</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">observe</span><span class="params">(<span class="meta">@NonNull</span> LifecycleOwner owner, <span class="meta">@NonNull</span> Observer&lt;? <span class="keyword">super</span> T&gt; observer)</span> </span>&#123;</span><br><span class="line">        assertMainThread(<span class="string">&quot;observe&quot;</span>);</span><br><span class="line">        <span class="comment">//✅ 第一部分</span></span><br><span class="line">        <span class="keyword">if</span> (owner.getLifecycle().getCurrentState() == DESTROYED) &#123;</span><br><span class="line">            <span class="comment">// ignore</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//✅ 第二部分</span></span><br><span class="line">        LifecycleBoundObserver wrapper = <span class="keyword">new</span> LifecycleBoundObserver(owner, observer);</span><br><span class="line">        ObserverWrapper existing = mObservers.putIfAbsent(observer, wrapper);</span><br><span class="line">        <span class="keyword">if</span> (existing != <span class="keyword">null</span> &amp;&amp; !existing.isAttachedTo(owner)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Cannot add the same observer&quot;</span></span><br><span class="line">                    + <span class="string">&quot; with different lifecycles&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (existing != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//✅ 第三部分</span></span><br><span class="line">        owner.getLifecycle().addObserver(wrapper);</span><br><span class="line">    &#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>observe方法传有两个参数LifecycleOwner和Observer，LifecycleOwner是一个具有Android生命周期的类，一般传入的是Activity和Fragment，Observer是一个接口，内部存在void onChanged(T t)方法。</p>
<p><strong>✅ 第一部分：</strong> observe内部一开始就存在一个生命周期的判断，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (owner.getLifecycle().getCurrentState() &#x3D;&#x3D; DESTROYED) &#123;return;&#125;</span><br></pre></td></tr></table></figure>

<p>当组件生命周期已经Destroy了，也就没有必要再继续走下去，则直接return。在这里，LiveData对生命周期的感知也就慢慢显现出来了。</p>
<p><strong>✅ 第二部分：</strong> 首先以LifecycleOwner和Observer作为参数创建了一个LifecycleBoundObserver对象，接着以Observer为key，新创建的LifecycleBoundObserver为value，存储到mObservers这个map中。在后面LiveData postValue中会遍历出该map的value值ObserverWrapper，获取组件生命周期的状态，已此状态来决定分不分发通知（这部分详情见“第二小节postValue()”）</p>
<p>那LifecycleBoundObserver是什么？</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LifecycleBoundObserver</span> <span class="keyword">extends</span> <span class="title">ObserverWrapper</span> <span class="title">implements</span> <span class="title">LifecycleEventObserver</span> </span>&#123;</span><br><span class="line">        @NonNull</span><br><span class="line">        final LifecycleOwner mOwner;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="title">LifecycleBoundObserver</span>(<span class="params">@NonNull LifecycleOwner owner, Observer&lt;? <span class="built_in">super</span> T&gt; observer</span>)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(observer);</span><br><span class="line">            mOwner = owner;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .......</span><br><span class="line">    &#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>从源码可以看到，LifecycleBoundObserver继承ObserverWrapper并且实现了LifecycleEventObserver的接口，LifecycleEventObserver是监听组件生命周期更改并将其分派给接收方的一个接口，而在LifecycleBoundObserver的构造函数中将observer传给了父类ObserverWrapper。LifecycleBoundObserver其实只是包裹着LifecycleOwner和Observer得一个类，其中的实现有点代理模式的味道。</p>
<p><strong>✅ 第三部分：</strong> <code>owner.getLifecycle().addObserver(wrapper)</code>将新创建的LifecycleBoundObserver添加到Lifecycle中，也就是说这个时候观察者注册成功，当LifecycleOwner也就是组件的状态发生改变时，也会通知到所匹配的observer。</p>
<p>到这里，UI层<code>viewModel.liveData.observe(this, object:Observer&lt;String&gt; &#123;             override fun onChanged(value: String) &#123;&#125; &#125;)</code>注册观察者的内部解析也就大致清楚了。</p>
<h5 id="2-postValue"><a href="#2-postValue" class="headerlink" title="2.postValue()"></a>2.postValue()</h5><p>liveData.postValue()是作为一个发射方来通知数据改变，其内部又做了哪些工作？接下来就一探究竟。直接从postValue中最核心的部分在于将参数value赋值给了一个全局变量源码开始：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> protected <span class="keyword">void</span> <span class="function"><span class="title">postValue</span>(<span class="params">T value</span>)</span> &#123;</span><br><span class="line">        boolean postTask;</span><br><span class="line">        synchronized (mDataLock) &#123;</span><br><span class="line">            postTask = mPendingData == NOT_SET;</span><br><span class="line">            mPendingData = value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!postTask) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ArchTaskExecutor.getInstance().postToMainThread(mPostValueRunnable);</span><br><span class="line">    &#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>postValue中首先将参数value赋值给了一个全局变量mPendingData，它的初始值为一个空对象，而mPendingData只是作为一个中间媒介来存储value的值，在后续的操作中会用到，我们就暂时先记住它。</p>
<p>在最后就是一个将线程切换到主线程的操作，主要看mPostValueRunnable的实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> Runnable mPostValueRunnable = <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            Object newValue;</span><br><span class="line">            <span class="keyword">synchronized</span> (mDataLock) &#123;</span><br><span class="line">                newValue = mPendingData;</span><br><span class="line">                mPendingData = NOT_SET;</span><br><span class="line">            &#125;</span><br><span class="line">            setValue((T) newValue);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>在Runnable中,mPendingData赋值给了临时变量newValue，最后调用了setValue（）方法。我们都知道LiveData发送通知可以使用PostValue或者SetValue，而他两的区别就在于，PostValue可以在任意线程中调用，而SetValue只能在主线程中，因为PostValue多了一步上面切换主线程的操作。</p>
<p>OK，接下来就是PostValue/SetValue最核心的部分。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">    @MainThread</span><br><span class="line">    protected <span class="keyword">void</span> <span class="function"><span class="title">setValue</span>(<span class="params">T value</span>)</span> &#123;</span><br><span class="line">        assertMainThread(<span class="string">&quot;setValue&quot;</span>);</span><br><span class="line">        mVersion++;</span><br><span class="line">        mData = value;</span><br><span class="line">        dispatchingValue(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    .......</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">void</span> <span class="function"><span class="title">dispatchingValue</span>(<span class="params">@Nullable ObserverWrapper initiator</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (mDispatchingValue) &#123;</span><br><span class="line">            mDispatchInvalidated = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        mDispatchingValue = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            mDispatchInvalidated = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (initiator != <span class="literal">null</span>) &#123;</span><br><span class="line">                considerNotify(initiator);</span><br><span class="line">                initiator = <span class="literal">null</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//✅ 第二部分</span></span><br><span class="line">                <span class="keyword">for</span> (Iterator&lt;<span class="built_in">Map</span>.Entry&lt;Observer&lt;? <span class="built_in">super</span> T&gt;, ObserverWrapper&gt;&gt; iterator =</span><br><span class="line">                        mObservers.iteratorWithAdditions(); iterator.hasNext(); ) &#123;</span><br><span class="line">                    considerNotify(iterator.next().getValue());</span><br><span class="line">                    <span class="keyword">if</span> (mDispatchInvalidated) &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">while</span> (mDispatchInvalidated);</span><br><span class="line">        mDispatchingValue = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>在setValue中，参数value将值赋给了一个全局变量mData，而这个mData最后将通过mObserver.onChanged((T) mData);将需要修改的value值分发给了UI。最后调用传入一个null调用dispatchingValue方法。</p>
<p>由于dispatchingValue里的参数为null，也就顺理成章的走到了<strong>✅ 第二部分</strong>。else一进入就是迭代器在遍历mObservers，而mObservers在第一小节“1.LiveData.observe()”中说得很清楚，它作为一个map，存储了Observer和ObserverWrapper。通过遍历，将每个观察者所匹配的ObserverWrapper作为参数传给了considerNotify（）方法。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">private <span class="keyword">void</span> <span class="function"><span class="title">considerNotify</span>(<span class="params">ObserverWrapper observer</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!observer.mActive) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Check latest state b4 dispatch. Maybe it changed state but we didn&#x27;t get the event yet.</span></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// we still first check observer.active to keep it as the entrance for events. So even if</span></span><br><span class="line">        <span class="comment">// the observer moved to an active state, if we&#x27;ve not received that event, we better not</span></span><br><span class="line">        <span class="comment">// notify for a more predictable notification order.</span></span><br><span class="line">        <span class="keyword">if</span> (!observer.shouldBeActive()) &#123;</span><br><span class="line">            observer.activeStateChanged(<span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (observer.mLastVersion &gt;= mVersion) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        observer.mLastVersion = mVersion;</span><br><span class="line">        observer.mObserver.onChanged((T) mData);</span><br><span class="line">    &#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>而在considerNotify()中，先通过observer来获取组件生命周期的状态，如果处于非活动状态，则拒绝发起通知。在该方法的最后， <code>observer.mObserver.onChanged((T) mData)</code>，是不是很熟悉，这就是UI层一开始就实现的接口，而就在这找到了最后的发送方。</p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6955309901363036191">https://juejin.cn/post/6955309901363036191</a></p>
<h5 id="粘性事件原理"><a href="#粘性事件原理" class="headerlink" title="粘性事件原理"></a>粘性事件原理</h5><h3 id="数据粘性"><a href="#数据粘性" class="headerlink" title="数据粘性"></a>数据粘性</h3><p>实例</p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7148049769057746952">https://juejin.cn/post/7148049769057746952</a></p>
<p>或者切换屏幕 turn the android phone on the horizontal</p>
<p>经过了解和使用 view model,databiding后，我觉得这个不是官方留的坑，在特定的场景可能还需要这样做，我获取手环睡眠数据此时有其他fragment还没创建，我就需要创建后才就监听到数据。</p>
<h5 id="方法1"><a href="#方法1" class="headerlink" title="方法1"></a>方法1</h5><p>我们能不能再创建新的ObserverWrapper的时候，直接把mVersion的值赋给mLastVersion，这样就符合(observer.mLastVersion &gt;= mVersion)这一条件了，就不会再继续执行onChanged方法了</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/geyuecang/article/details/89028283">https://blog.csdn.net/geyuecang/article/details/89028283</a></p>
<h5 id="singleLiveEvent"><a href="#singleLiveEvent" class="headerlink" title="singleLiveEvent"></a>singleLiveEvent</h5><p>多个观察者，这个就不好用了。</p>
<p>其实这个方法解决的并不是粘性事件的问题，而是“数据倒灌”的问题。“数据倒灌”一词出自<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://xiaozhuanlan.com/u/kunminx">KunMinX</a>的Blog<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://xiaozhuanlan.com/topic/6719328450"><strong>重学安卓：LiveData 数据倒灌 背景缘由全貌 独家解析</strong></a>,即在setValue后,observe对此次set的value值会进行多次消费。比如进行第二次observe的时候获取到的数据是第一次的旧数据。这样会带来不可预期的后果。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/android/architecture-samples/blob/dev-todo-mvvm-live/todoapp/app/src/main/java/com/example/android/architecture/blueprints/todoapp/SingleLiveEvent.java">https://github.com/android/architecture-samples/blob/dev-todo-mvvm-live/todoapp/app/src/main/java/com/example/android/architecture/blueprints/todoapp/SingleLiveEvent.java</a></p>
<blockquote>
<p><code>m.compareAndSet(a,b)</code>,如果m==a ,返回true，同时将m置为b； 如果m==b，返回false。</p>
</blockquote>
<h5 id="方法3"><a href="#方法3" class="headerlink" title="方法3"></a>方法3</h5><p>UnPeekLiveData</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProtectedUnPeekLiveData</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">LiveData</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">boolean</span> isAllowNullValue;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> HashMap&lt;Integer, Boolean&gt; observers = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">observeInActivity</span><span class="params">(<span class="meta">@NonNull</span> AppCompatActivity activity, <span class="meta">@NonNull</span> Observer&lt;? <span class="keyword">super</span> T&gt; observer)</span> </span>&#123;</span><br><span class="line">        LifecycleOwner owner = activity;</span><br><span class="line">        Integer storeId = System.identityHashCode(observer);<span class="comment">//源码这里是activity.getViewModelStore()，是为了保证同一个ViewModel环境下&quot;唯一可信源&quot;</span></span><br><span class="line">        observe(storeId, owner, observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">observe</span><span class="params">(<span class="meta">@NonNull</span> Integer storeId,</span></span></span><br><span class="line"><span class="function"><span class="params">                         <span class="meta">@NonNull</span> LifecycleOwner owner,</span></span></span><br><span class="line"><span class="function"><span class="params">                         <span class="meta">@NonNull</span> Observer&lt;? <span class="keyword">super</span> T&gt; observer)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (observers.get(storeId) == <span class="keyword">null</span>) &#123;</span><br><span class="line">            observers.put(storeId, <span class="keyword">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">super</span>.observe(owner, t -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (!observers.get(storeId)) &#123;</span><br><span class="line">                observers.put(storeId, <span class="keyword">true</span>);</span><br><span class="line">                <span class="keyword">if</span> (t != <span class="keyword">null</span> || isAllowNullValue) &#123;</span><br><span class="line">                    observer.onChanged(t);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setValue</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (value != <span class="keyword">null</span> || isAllowNullValue) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;Integer, Boolean&gt; entry : observers.entrySet()) &#123;</span><br><span class="line">                entry.setValue(<span class="keyword">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">super</span>.setValue(value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.setValue(<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>，为每个传入的observer对象携带一个布尔类型的值，作为其是否能进入observe方法的开关。每当有一个新的observer存进来的时候，开关默认关闭。</p>
<p>每次setValue后，打开所有Observer的开关，允许所有observe执行。</p>
<p>这个确实清晰，简单</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/d0244c4c7cc9">https://www.jianshu.com/p/d0244c4c7cc9</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903623252508685">https://juejin.cn/post/6844903623252508685</a></p>
<h5 id="方法4"><a href="#方法4" class="headerlink" title="方法4"></a>方法4</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Used as a wrapper for data that is exposed via a LiveData that represents an event.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Event</span>&lt;<span class="type">out T</span>&gt;</span>(<span class="keyword">private</span> <span class="keyword">val</span> content: T) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> hasBeenHandled = <span class="literal">false</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">set</span> <span class="comment">// Allow external read but not write</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the content and prevents its use again.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getContentIfNotHandled</span><span class="params">()</span></span>: T? &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">if</span> (hasBeenHandled) &#123;</span><br><span class="line">            <span class="literal">null</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            hasBeenHandled = <span class="literal">true</span></span><br><span class="line">            content</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the content, even if it&#x27;s already been handled.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">peekContent</span><span class="params">()</span></span>: T = content</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>UnPeekLiveData 或者 ELiveData </p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5b2b1b2cf265da5952314b63">https://juejin.im/post/5b2b1b2cf265da5952314b63</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/79d909b6f8bd">https://www.jianshu.com/p/79d909b6f8bd</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/6892704779781275662">https://juejin.im/post/6892704779781275662</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/d0244c4c7cc9">https://www.jianshu.com/p/d0244c4c7cc9</a></p>
<h4 id="LifeCycle"><a href="#LifeCycle" class="headerlink" title="LifeCycle"></a>LifeCycle</h4><p>通过lifecycle旋转屏幕后，重新发送事件来分析，粘性事件。<br><a target="_blank" rel="noopener" href="https://developer.android.com/codelabs/android-lifecycles#2">https://developer.android.com/codelabs/android-lifecycles#2</a></p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="https://noteforme.github.io/page/9/index.html">https://noteforme.github.io/page/9/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-THINKING" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/05/19/THINKING/">THINKING</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2020-05-19T01:55:11.000Z" itemprop="datePublished">2020年05月19日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/TOOL/">TOOL</a>
  </div>

      
      
<a href="/2020/05/19/THINKING/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>the way learning </p>
<p>一年后用不到，就不用学。</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1bY4y1Y7WR/?spm_id_from=333.788">https://www.bilibili.com/video/BV1bY4y1Y7WR/?spm_id_from=333.788</a></p>
<ol>
<li>how to use(video blog)</li>
<li></li>
</ol>
<p>学习产生价值，带着目标学习.</p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5eb168e9f265da7bb65fb27a">https://juejin.im/post/5eb168e9f265da7bb65fb27a</a></p>
<p><a target="_blank" rel="noopener" href="https://www.mifengtd.cn/articles/runningcheese-gtd-system.html">https://www.mifengtd.cn/articles/runningcheese-gtd-system.html</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/JsonChao/Awesome-Android-Notebook">https://github.com/JsonChao/Awesome-Android-Notebook</a></p>
<p>I don’t know what to do  if I prevent me  think code or tech in my life.   I think i   love tech ,but it could’t support my career now.I l’m  look forword is that what I can do .</p>
<p>CodeReview</p>
<img src="/2020/05/19/THINKING/codereview3.png" alt="codereview3" style="zoom:50%;">



<p><img src="/2020/05/19/THINKING/codereview4.jpg"></p>
<img src="/2020/05/19/THINKING/codereview1.jpg" alt="CodeReview1" style="zoom: 50%;">

<img src="/2020/05/19/THINKING/codereview2.jpg" alt="CodeReview1" style="zoom:50%;">


        
        
          <blockquote id="copyright">
              <p>Original link: <a href="https://noteforme.github.io/page/9/index.html">https://noteforme.github.io/page/9/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/THINK/" rel="tag">THINK</a></li></ul>

          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-ActivityLayout" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/05/08/ActivityLayout/">ActivityLayout</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2020-05-08T01:54:32.000Z" itemprop="datePublished">2020年05月08日</time>
</span>
      
      
      
<a href="/2020/05/08/ActivityLayout/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Activity绘制流程</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yanbober/article/details/45970721?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160657696619724827674302%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=160657696619724827674302&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v28-10-45970721.pc_first_rank_v2_rank_v28&amp;utm_term=setContentView&amp;spm=1018.2118.3001.4449">https://blog.csdn.net/yanbober/article/details/45970721?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160657696619724827674302%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=160657696619724827674302&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v28-10-45970721.pc_first_rank_v2_rank_v28&amp;utm_term=setContentView&amp;spm=1018.2118.3001.4449</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/ii07I8Cy80MqjsqKkns_WQ">https://mp.weixin.qq.com/s/ii07I8Cy80MqjsqKkns_WQ</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/b5b1b8e1747f">https://www.jianshu.com/p/b5b1b8e1747f</a></p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="https://noteforme.github.io/page/9/index.html">https://noteforme.github.io/page/9/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AOSP/" rel="tag">AOSP</a></li></ul>

          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-DataStructure" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/05/06/DataStructure/">DataStructure</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2020-05-06T01:46:22.000Z" itemprop="datePublished">2020年05月06日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/DataStructure/">DataStructure</a>
  </div>

      
      
<a href="/2020/05/06/DataStructure/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>无论什么难题，降低复杂度的方法就是这三个步骤。只要你能深入理解这里的核心思想，就能把问题迎刃而解。</p>
<p>第一步，暴力解法。在没有任何时间、空间约束下，完成代码任务的开发。</p>
<p>第二步，无效操作处理。将代码中的无效计算、无效存储剔除，降低时间或空间复杂度。</p>
<p>第三步，时空转换。设计合理数据结构，完成时间复杂度向空间复杂度的转移。</p>
<p>既然说这是这门专栏的总纲，那么很显然后续的学习都是在这个总纲体系的框架中。第一步的暴力解法没有太多的套路，只要围绕你面临的问题出发，大胆发挥想象去尝试解决即可。第二步的无效操作处理中，你需要学会并掌握递归、二分法、排序算法、动态规划等常用的算法思维。第三步的时空转换，你需要对数据的操作进行细分，全面掌握常见数据结构的基础知识。再围绕问题，有针对性的设计数据结构、采用合理的算法思维，去不断完成时空转移，降低时间复杂度。</p>
<img src="/2020/05/06/DataStructure/datastructure_overview.jpg" alt="datastructure_overview" style="zoom:67%;">

<p><em><a target="_blank" rel="noopener" href="https://github.com/labuladong/fucking-algorithm">https://github.com/labuladong/fucking-algorithm</a></em></p>
<h4 id="复杂度"><a href="#复杂度" class="headerlink" title="复杂度"></a>复杂度</h4><p><img src="/2020/05/06/DataStructure/%E6%89%A7%E8%A1%8C%E6%AD%A5%E9%AA%A4.png"></p>
<p>消耗计算时间和计算空间</p>
<h5 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h5><ul>
<li><p>对数阶</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> count =<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(count &lt; n)&#123;</span><br><span class="line">  count = count * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>代码看到 2 * 2 * 2 … 最终离n很近，最终退出循环，2^x =n ,得到 x = log2^n,所以这个循环时间复杂度为O(logn)</p>
</blockquote>
</li>
</ul>
<h5 id="空间复杂度"><a href="#空间复杂度" class="headerlink" title="空间复杂度"></a>空间复杂度</h5><p>空间方面主要体现在计算过程中,对于存储资源的消耗情况</p>
<p><img src="/2020/05/06/DataStructure/312PM.png" alt="312PM"></p>
<p><img src="/2020/05/06/DataStructure/518dddPM.png" alt="518dddPM"></p>
<h4 id="链表"><a href="#链表" class="headerlink" title="链表"></a>链表</h4><p>​    </p>
<p><img src="/2020/05/06/DataStructure/2021-04-20_15-49-24LinkedLIst.png"></p>
<p>p,q指向的都是整体</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> data; <span class="comment">// 存储数据本身</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">pNext</span>;</span> <span class="comment">//pNext存储  它指向的下一个节点的指针</span></span><br><span class="line">&#125; NODE, *PNODE;</span><br><span class="line"><span class="comment">// NODE等价于struct node</span></span><br><span class="line"><span class="comment">//PNODE等价于struct node*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//将动态分配的新节点的地址赋给p</span></span><br><span class="line">PNODE p = (PNODE)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(NODE));</span><br><span class="line"></span><br><span class="line"><span class="built_in">free</span>(p) <span class="comment">//删除p指向节点所占的内存，不是删除p本身所占的内存</span></span><br><span class="line"></span><br><span class="line">p-&gt;pNext; <span class="comment">//p所指向结构体变量中pNext成员本身</span></span><br></pre></td></tr></table></figure>

<ol>
<li><p>插入q节点</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">方法<span class="number">1</span>:</span><br><span class="line">r = p-&gt; pNext ; p-&gt;pNext =q ; q-&gt;pNext = r;</span><br><span class="line">方法<span class="number">2</span>:</span><br><span class="line">q-&gt;pNext = p-&gt;pNext;</span><br><span class="line">p-&gt;pNext = q;</span><br></pre></td></tr></table></figure></li>
<li><p>删除p后面的节点</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r = p-&gt;pNext;</span><br><span class="line">p-&gt;pNext= r-&gt;pNext;</span><br><span class="line"><span class="built_in">free</span>(r);</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="双向链表"><a href="#双向链表" class="headerlink" title="双向链表"></a>双向链表</h4><h5 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h5><p><img src="/2020/05/06/DataStructure/Data-LinkedList/DoubleLInkedList_insert_middle.png"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ListNodePosi &lt;T&gt; <span class="built_in">insertAsPred</span>(T <span class="keyword">const</span>&amp;e)&#123;<span class="comment">//紧靠当前节点之前插入新节点</span></span><br><span class="line">    ListNodePosi&lt;T&gt; x = <span class="keyword">new</span> <span class="built_in">ListNode</span>(e,pred,<span class="keyword">this</span>); <span class="comment">//创建新节点</span></span><br><span class="line">    pred-&gt;succ = x;</span><br><span class="line">    <span class="keyword">this</span>-&gt;pred= x;<span class="comment">//设置正向链接,这里是当前节点的前置节点的意思，容易和节点pred混淆</span></span><br><span class="line">    <span class="keyword">return</span> x; <span class="comment">//返回新节点的位置</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h4><ol>
<li>递归必须得有一个明确的中止条件。</li>
<li>该函数所处理的数据规模必须在递减。</li>
</ol>
<h5 id="递归复杂度"><a href="#递归复杂度" class="headerlink" title="递归复杂度"></a>递归复杂度</h5><h6 id="递归跟踪-recursion-trace-分析"><a href="#递归跟踪-recursion-trace-分析" class="headerlink" title="递归跟踪(recursion trace)分析"></a>递归跟踪(recursion trace)分析</h6><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sum</span>(<span class="keyword">int</span> A[],<span class="keyword">int</span> n)&#123;</span><br><span class="line">	<span class="keyword">return</span> (n&lt;<span class="number">1</span>)?</span><br><span class="line">        <span class="number">0</span>:<span class="built_in">sum</span>(A,n<span class="number">-1</span>)+A[n<span class="number">-1</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<img src="/2020/05/06/DataStructure/2021-04-25_17-54-13.png" style="zoom:50%;">

<p>检查每个<strong>递归实例</strong>，累计所需的时间(调用语句本身，计入对应的子实例)</p>
<p>其总和即算法执行时间</p>
<p>本例中，单个递归实例自身只需o(1)时间</p>
<p>T(n) = o(1)  * (n+1) = o(n)</p>
<h6 id="递归方程"><a href="#递归方程" class="headerlink" title="递归方程"></a>递归方程</h6><p>求解sum(A,n) : 递归求解规模为n-1的问题sum(A,n-1) 加上 A[n-1]  。</p>
<p>​    T(n) = T(n-1) + o(1)  // 为了求解T(n)所需要的时间,花了T(n-1)的时间求解n-1的问题,然后再花了o(1)的时间 </p>
<p>​     T(0) = o(1)</p>
<blockquote>
<p>T(n) = T(n-1) + o(1) //两边同时 -n</p>
<p>T(n) -n = T(n-1) -(n-1) </p>
<p>​             = …</p>
<p>​             =T(2) - 2</p>
<p>​            = T(1) -1 </p>
<p>​            =T(0)</p>
<p>T(n) = o(1) +n  = o(n)</p>
</blockquote>
<h5 id="递归实例"><a href="#递归实例" class="headerlink" title="递归实例"></a>递归实例</h5><h6 id="阶乘-、求和"><a href="#阶乘-、求和" class="headerlink" title="阶乘 、求和"></a>阶乘 、求和</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;n=1 输出 %ld \n &quot;</span>, f(<span class="number">1</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;n=2 输出 %ld \n &quot;</span>, f(<span class="number">2</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;n=3 输出 %ld \n &quot;</span>, f(<span class="number">3</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;n=4 输出 %ld \n &quot;</span>, f(<span class="number">4</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;n=5 输出 %ld \n &quot;</span>, f(<span class="number">5</span>));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;n=100 相加 %ld \n &quot;</span>, sum(<span class="number">100</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> val,mult = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入一个数: val=&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;val);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= val; ++i) &#123;</span><br><span class="line">        mult = mult * i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d的阶乘是: %d\n&quot;</span>,val,mult);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//假定n的值是1或大于1的值</span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> n * f(n - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1+2+...+100</span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (n + sum(n<span class="number">-1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h6 id="汉诺塔"><a href="#汉诺塔" class="headerlink" title="汉诺塔"></a>汉诺塔</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">hannuota</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">char</span> a, <span class="keyword">char</span> b, <span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *      一个盘子 :</span></span><br><span class="line"><span class="comment">     *              直接将a柱子上的盘子从a移动到b</span></span><br><span class="line"><span class="comment">     *      否则 :</span></span><br><span class="line"><span class="comment">     *              先将a柱子上的n-1个盘子借助c移到b</span></span><br><span class="line"><span class="comment">     *              直接将a柱子上的盘中从a移到c</span></span><br><span class="line"><span class="comment">     *              最后将b柱子上的n-1个盘子借助a移到c</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="number">1</span> == n) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;将编号为%d的盘子直接从%c柱子移到%c柱子\n&quot;</span>, n, a, c);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        hannuota(n - <span class="number">1</span>, a, c, b);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;将编号为%d的盘子直接从%c柱子移到%c柱子\n&quot;</span>, n, a, c);</span><br><span class="line">        hannuota(n - <span class="number">1</span>, b, a, c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch1 = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">    <span class="keyword">char</span> ch2 = <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">    <span class="keyword">char</span> ch3 = <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入要移动盘子的个数:&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">    hannuota(n,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h6 id="Fibonacci-c"><a href="#Fibonacci-c" class="headerlink" title="Fibonacci.c"></a>Fibonacci.c</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>  <span class="title">f</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(n==<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>  <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> f(n<span class="number">-1</span>)+f(n<span class="number">-2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;输入n的值为 &quot;</span>);</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;f(n) %d \n&quot;</span>,f(n));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>上面这种求和方式，随着n增加，时间复杂度会指数型增加，到了40已经算不动了，里面会有大量重复的计算</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> f = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> g = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (n--)&#123;</span><br><span class="line">        g = g+f;</span><br><span class="line">        f = g-f;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> g;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种时间复杂度O(n),不要太快,交替滚动向前推进。</p>
<h4 id="Hash-散列"><a href="#Hash-散列" class="headerlink" title="Hash(散列)"></a>Hash(散列)</h4><p>[Hash(key) + 1^2] % M          以平方数为距离，确定下一试探桶单元</p>
<p> M为三列表的容量</p>
<p><img src="/2020/05/06/DataStructure/2021-06-15_09-13-49_diction.png"></p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="https://noteforme.github.io/page/9/index.html">https://noteforme.github.io/page/9/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-DeliverValue" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/04/28/DeliverValue/">DeliverValue</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2020-04-28T02:20:55.000Z" itemprop="datePublished">2020年04月28日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/JAVA/">JAVA</a>
  </div>

      
      
<a href="/2020/04/28/DeliverValue/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h5 id="Value-Copy"><a href="#Value-Copy" class="headerlink" title="Value Copy"></a>Value Copy</h5><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/huaiyiheyuan/article/details/55102057">https://blog.csdn.net/huaiyiheyuan/article/details/55102057</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/lP-xB5yzpvqVEiA439euVQ">https://mp.weixin.qq.com/s/lP-xB5yzpvqVEiA439euVQ</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5e91cc6c51882573a343db03">https://juejin.im/post/5e91cc6c51882573a343db03</a></p>
<p>基本数据类型  declare in stack</p>
<p>Object  declare in Heap</p>
<p>Java value deliver  </p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5af3a44bf265da0b74522bf3">https://juejin.im/post/5af3a44bf265da0b74522bf3</a></p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">String</span> name = <span class="string">&quot;hollischuang&quot;</span>;</span><br><span class="line"><span class="keyword">String</span> name = <span class="keyword">new</span> <span class="built_in"><span class="keyword">String</span></span>(<span class="string">&quot;hollischuang&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


        
        
          <blockquote id="copyright">
              <p>Original link: <a href="https://noteforme.github.io/page/9/index.html">https://noteforme.github.io/page/9/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Bluetooth04" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/04/26/Bluetooth04/">Bluetooth04</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2020-04-26T02:46:23.000Z" itemprop="datePublished">2020年04月26日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/BLE/">BLE</a>
  </div>

      
      
<a href="/2020/04/26/Bluetooth04/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h5 id="蓝牙问题汇总"><a href="#蓝牙问题汇总" class="headerlink" title="蓝牙问题汇总"></a>蓝牙问题汇总</h5><p><a target="_blank" rel="noopener" href="https://race604.com/android-ble-in-action/">https://race604.com/android-ble-in-action/</a></p>
<ol>
<li>连接断开之后可以根据实际情况进行重连，但如果是连接失败的情况，建议不要立即重连，而是调用<code>void closeBluetoothGatt()</code>清空一下状态，并延迟一段时间等待复位，否则会把gatt阻塞，导致手机不重启蓝牙就再也无法连接任何设备的严重情况。</li>
</ol>
<p>  <a target="_blank" rel="noopener" href="https://github.com/Jasonchenlijian/FastBle/blob/master/README_1.2.x.md">https://github.com/Jasonchenlijian/FastBle/blob/master/README_1.2.x.md</a></p>
<ol start="2">
<li><p>每当设备断开连接时，请确保在BluetoothGatt对象上调用close()并将其设置为null,</p>
<p>解决方法:始终在断开连接时关闭gatt实例，并在每次连接时创建一个新的gatt实例。</p>
<p>在<code>onLeScan(..)</code>中启动一个新线程，然后进行连接</p>
<p><a target="_blank" rel="noopener" href="https://stackoom.com/question/1Cyqr/Android-%E8%93%9D%E7%89%99%E4%BD%8E%E5%8A%9F%E8%80%97%E4%B8%8D%E7%A8%B3%E5%AE%9A">https://stackoom.com/question/1Cyqr/Android-%E8%93%9D%E7%89%99%E4%BD%8E%E5%8A%9F%E8%80%97%E4%B8%8D%E7%A8%B3%E5%AE%9A</a></p>
</li>
</ol>
<p>BluetoothLeScanner: could not find callback wrapper</p>
<ol start="3">
<li><p>连接失败处理</p>
<p>分两个平台来说，iOS端也有连接失败的委托，但是好像几乎不会发生这种情况，至少我从来没遇见过，而对于同款设备，android常常会出现连接失败的情况，<code>status != BluetoothGatt.GATT_SUCCESS</code>  ，android端开发请不要把连接失败和断开连接放在一块处理，因为断开连接可以直接尝试重新连接，而连接失败后尝试重新连接，需要加一些延时，并且需要gatt.close，清空一下状态，否则会把gatt阻塞导致手机不重启蓝牙就再也无法连接任何设备的情况。</p>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="http://liuyanwei.jumppo.com/2017/01/23/zhihu-live-a-hour-for-bluetooth-0.html">http://liuyanwei.jumppo.com/2017/01/23/zhihu-live-a-hour-for-bluetooth-0.html</a></p>
<ol start="4">
<li>扫描广播包</li>
</ol>
<p>所有外设，只有在发出广播包的情况下，才能被central发现，绝大多数情况下，外设被连接后就不会发出广播（也有例外），很多人遇到无法找到设备的问题，大多属于这种情况。 重复扫描问题——————</p>
<p><a target="_blank" rel="noopener" href="http://liuyanwei.jumppo.com/2017/01/23/zhihu-live-a-hour-for-bluetooth-0.html">http://liuyanwei.jumppo.com/2017/01/23/zhihu-live-a-hour-for-bluetooth-0.html</a></p>
<ol start="5">
<li><p>Android 7+ will stop scanning if it continues without stopping at all  for 30 minutes or more. This was added as a feature to prevent battery  drain in case developers had inadvertently or abusively left scanning on forever.</p>
<p><a target="_blank" rel="noopener" href="https://github.com/AltBeacon/android-beacon-library/issues/528">https://github.com/AltBeacon/android-beacon-library/issues/528</a></p>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_37796683/article/details/83657204">https://blog.csdn.net/m0_37796683/article/details/83657204</a></p>
<ol start="6">
<li><p>status 133</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/baidu_26352053/article/details/54571688">https://blog.csdn.net/baidu_26352053/article/details/54571688</a></p>
</li>
<li><p>unregisterApp() - mClientIf=5</p>
</li>
<li><p> filter</p>
</li>
</ol>
<p>   <a target="_blank" rel="noopener" href="https://juejin.im/post/5d37d4d6f265da1bc414958a">https://juejin.im/post/5d37d4d6f265da1bc414958a</a></p>
<ol start="9">
<li><p>防止Android7中的BLE扫描滥用，从而做了一些限制，即不要在30s内对蓝牙扫描<br>重复开启-关闭超过5次。</p>
<p><a target="_blank" rel="noopener" href="https://blog.classycode.com/undocumented-android-7-ble-behavior-changes-d1a9bd87d983">https://blog.classycode.com/undocumented-android-7-ble-behavior-changes-d1a9bd87d983</a></p>
</li>
</ol>
<ul>
<li>蓝牙添加扫描间隔</li>
</ul>
<p>​    <a target="_blank" rel="noopener" href="https://github.com/haodynasty/AndroidBleManager">https://github.com/haodynasty/AndroidBleManager</a></p>
<p>​    <a target="_blank" rel="noopener" href="https://github.com/AltBeacon/android-beacon-library">https://github.com/AltBeacon/android-beacon-library</a></p>
<h3 id="应用如何做自动重连"><a href="#应用如何做自动重连" class="headerlink" title="应用如何做自动重连"></a>应用如何做自动重连</h3><p>其实自动重连比想象的要简单许多，无论是android还是ios端，只需要在设备断开连接的委托方法中，重新调用gatt.connet或者是centralManager.connet方法就可以了，无论当时设备是否有点，是否在周围，当设备再次开会或者连接到可连接范围内，都会自动被连上，就是这么简单。</p>
<p><a target="_blank" rel="noopener" href="http://liuyanwei.jumppo.com/2017/01/23/zhihu-live-a-hour-for-bluetooth-0.html">http://liuyanwei.jumppo.com/2017/01/23/zhihu-live-a-hour-for-bluetooth-0.html</a></p>
<p>Intent mIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);<br>startActivityForResult(mIntent, 1);</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mBluetoothAdapter.<span class="builtin-name">enable</span>();</span><br><span class="line">mBluetoothAdapter.<span class="builtin-name">disable</span>();</span><br></pre></td></tr></table></figure>

<p> <a target="_blank" rel="noopener" href="https://blog.csdn.net/u014418171/article/details/81219297">https://blog.csdn.net/u014418171/article/details/81219297</a></p>
<p>扫描</p>
<p>过滤</p>
<p><strong>Scanning by device name</strong></p>
<p>Looking for a device by it’s name has 2 main use cases: to look for 1 specific device or to look for 1 specific device model. For example, my Polar H7 chest strap advertises itself as “Polar H7 391BB014”. The latter part (‘391BB014’) is a unique number (or serial number) and the first part is generic for all Polar H7 devices. This is very common practice. Unfortunately the device name scan filter can only be used to find specific devices as it does full string matching. If you want to find all Polar H7 devices you will need to do a ‘substring’ compare on ‘Polar H7’, but you can’t do that with a filter. You just need to pass <code>null</code> as the filter and do the substring comparison yourself in <code>onScanResult</code>.</p>
<p>So here is an example of how to scan for devices by <strong>exact</strong> name</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">String</span>[] names = <span class="keyword">new</span> <span class="keyword">String</span>[]&#123;<span class="string">&quot;Polar H7 391BB014&quot;</span>&#125;;</span><br><span class="line">List&lt;ScanFilter&gt; filters = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(names != <span class="keyword">null</span>) &#123;</span><br><span class="line">    filters = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">String</span> name : names) &#123;</span><br><span class="line">        ScanFilter <span class="built_in">filter</span> = <span class="keyword">new</span> ScanFilter.Builder()</span><br><span class="line">                .setDeviceName(name)</span><br><span class="line">                .build();</span><br><span class="line">        filters.<span class="built_in">add</span>(<span class="built_in">filter</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">scanner.startScan(filters, scanSettings, scanCallback);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://medium.com/@martijn.van.welie/making-android-ble-work-part-1-a736dcd53b02">https://medium.com/@martijn.van.welie/making-android-ble-work-part-1-a736dcd53b02</a></p>
<p>android蓝牙自动连接</p>
<p><a target="_blank" rel="noopener" href="http://www.cocoachina.com/articles/83844">http://www.cocoachina.com/articles/83844</a></p>
<h5 id="Ble-library"><a href="#Ble-library" class="headerlink" title="Ble library"></a>Ble library</h5><p><a target="_blank" rel="noopener" href="https://github.com/NordicSemiconductor/Android-BLE-Library">Android-BLE-Library</a></p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">LoggableBleManager</span> <span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">log</span>(final int priority, <span class="variable">@NonNull</span> final String message)</span><br><span class="line">是日志打印出口</span><br><span class="line">是 <span class="selector-tag">BleManager</span> <span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">log</span>(final int priority, <span class="variable">@NonNull</span> final String message)的实现</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/NordicSemiconductor/nRF-Logger-API">nRF-Logger-API</a>是手机日志查看工具</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">LoggableBleManager&lt;T</span> <span class="keyword">extends</span> <span class="title">BleManagerCallbacks&gt;</span> <span class="keyword">extends</span> <span class="title">BleManager&lt;T&gt;</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="type">ILogSession</span> logSession;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * The manager constructor.</span></span><br><span class="line"><span class="comment">    * &lt;p&gt;</span></span><br><span class="line"><span class="comment">    * After constructing the manager, the callbacks object must be set with</span></span><br><span class="line"><span class="comment">    * &#123;@link #setManagerCallbacks(BleManagerCallbacks)&#125;.</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * @param context the context.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   public <span class="type">LoggableBleManager</span>(<span class="meta">@NonNull</span> <span class="keyword">final</span> <span class="type">Context</span> context) &#123;</span><br><span class="line">      <span class="keyword">super</span>(context);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Sets the log session to log into.</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * @param session nRF Logger log session to log inti, or null, if nRF Logger is not installed.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   public void setLogger(<span class="meta">@Nullable</span> <span class="keyword">final</span> <span class="type">ILogSession</span> session) &#123;</span><br><span class="line">      logSession = session;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   public void log(<span class="keyword">final</span> int priority, <span class="meta">@NonNull</span> <span class="keyword">final</span> <span class="type">String</span> message) &#123;</span><br><span class="line">      <span class="type">Logger</span>.log(logSession, <span class="type">LogContract</span>.<span class="type">Log</span>.<span class="type">Level</span>.fromPriority(priority), message);</span><br><span class="line">      <span class="type">Log</span>.println(priority, <span class="string">&quot;BleManager&quot;</span>, message);</span><br><span class="line"><span class="comment">//    Timber.i(&quot;BleManager   &quot;+ message);</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


        
        
          <blockquote id="copyright">
              <p>Original link: <a href="https://noteforme.github.io/page/9/index.html">https://noteforme.github.io/page/9/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-annotation" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/04/25/annotation/">annotation</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2020-04-25T14:38:39.000Z" itemprop="datePublished">2020年04月25日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/JAVA/">JAVA</a>
  </div>

      
      
<a href="/2020/04/25/annotation/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h3><h4 id="注解的作用"><a href="#注解的作用" class="headerlink" title="注解的作用"></a>注解的作用</h4><img src="/2020/04/25/annotation/2021-07-29_9.08.16_function.png" alt="ff">

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/briblue/article/details/73824058">https://blog.csdn.net/briblue/article/details/73824058</a></p>
<ul>
<li>提供信息给编译器： 编译器可以利用注解来探测错误和警告信息</li>
<li>编译阶段时的处理：  软件工具可以用来利用注解信息来生成代码、Html文档或者做其它相应处理。</li>
<li>运行时的处理：  某些注解可以在程序运行的时候接受代码的提取</li>
</ul>
<p>元注解 ： 不可以再分的注解， 负责注解其他注解。java定义了4个标准的meta-annotation类型,它们被用来提供对其它annotation类型作说明。Target Retention Documented Inherited</p>
<p>​                如上图的 Overide被@Target和@Retention修饰，他们用来说明解释其他注解，位于 java.lang.annotation下</p>
<h4 id="元注解类型"><a href="#元注解类型" class="headerlink" title="元注解类型"></a>元注解类型</h4><h5 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h5><p>用于描述注解的使用范围(注解可以用在什么地方)</p>
<p>如 类 属性 方法等</p>
<p><img src="/2020/04/25/annotation/2021-06-28_21-32-34_target.png"></p>
<h5 id="Retention"><a href="#Retention" class="headerlink" title="Retention"></a>Retention</h5><p>需要什么级别保存该注释信息，用于保留注解的生命周期</p>
<p><img src="/2020/04/25/annotation/2021-06-28_21-36-57_retention.png"></p>
<h5 id="Inherited"><a href="#Inherited" class="headerlink" title="@Inherited"></a>@Inherited</h5><p>标明所修饰的注解，在所作用的类上，是否可以被继承。</p>
<h5 id="Documented"><a href="#Documented" class="headerlink" title="@Documented"></a>@Documented</h5><p>javadoc的工具文档化</p>
<h4 id="注解使用"><a href="#注解使用" class="headerlink" title="注解使用"></a>注解使用</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Sxt&#123;</span><br><span class="line"> 	<span class="function">String <span class="title">studentName</span><span class="params">()</span></span>;  <span class="comment">// studentName 参数名， String参数类型</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>注解元素必须要有值，我们定义注解元素时，经常使用空字符串，0作为默认值。</p>
<p>也经常使用负数(比如:-1)表示不存在的含义</p>
<p>annotation01</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(value = &#123;ElementType.METHOD,ElementType.TYPE&#125;)</span> <span class="comment">//针对方法 和类有效</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span>	<span class="comment">// 针对运行时有效</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Annotation01 &#123;</span><br><span class="line">    <span class="function">String <span class="title">studentName</span><span class="params">()</span> <span class="keyword">default</span> &quot;&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">age</span><span class="params">()</span> <span class="keyword">default</span> 0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">id</span><span class="params">()</span> <span class="keyword">default</span> -1</span>; <span class="comment">// String indexOf(&quot;abc&quot;) -1</span></span><br><span class="line"></span><br><span class="line">    String[] schools() <span class="keyword">default</span> &#123;<span class="string">&quot;清华大学&quot;</span>,<span class="string">&quot;哈工大&quot;</span>&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Annotation02</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(value = &#123;ElementType.METHOD,ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Annotation02 &#123;</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果只有一个参数，一般写成value</p>
<p>Demo01</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Annotation01</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo02</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Annotation01(age = 19, studentName = &quot;老高&quot;,</span></span><br><span class="line"><span class="meta">            id = 1001, schools = &#123;&quot;哈工大&quot;, &quot;清华大学&quot;&#125;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Annotation02(value = &quot;aaaa&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Annotation02(&quot;aaaa&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test02</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用注解,参照 test01(),也可以省略”value=” 参见test02()</p>
<h5 id="注解实例"><a href="#注解实例" class="headerlink" title="注解实例"></a>注解实例</h5><p>注解设置 SxtStudent信息，映射数据库</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(value = &#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SxtTable &#123;</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(value = &#123;ElementType.FIELD&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SxtField &#123;</span><br><span class="line">    <span class="function">String <span class="title">columnName</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">String <span class="title">type</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">length</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SxtTable(&quot;tb_student&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SxtStudent</span> </span>&#123;</span><br><span class="line">    <span class="meta">@SxtField(columnName = &quot;id&quot;,type = &quot;int&quot;,length = 10)</span></span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SxtField(columnName = &quot;sname&quot;,type = &quot;varchar&quot;,length = 10)</span></span><br><span class="line">    <span class="keyword">private</span> String studentName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SxtField(columnName = &quot;age&quot;,type = &quot;int&quot;,length = 3)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过第三方工具获取注解信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    Class clazz = Class.forName(<span class="string">&quot;annotation.SxtStudent&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获得类的所有有效注解</span></span><br><span class="line">    Annotation[] annotations = clazz.getAnnotations();</span><br><span class="line">    <span class="keyword">for</span> (Annotation a:annotations)&#123;</span><br><span class="line">        System.out.println(a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获得类的指定注解</span></span><br><span class="line">    SxtTable st = (SxtTable)clazz.getAnnotation(SxtTable.class);</span><br><span class="line">    System.out.println(st.value());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获得类的属性的注解</span></span><br><span class="line">    Field f = clazz.getDeclaredField(<span class="string">&quot;studentName&quot;</span>);</span><br><span class="line">    SxtField sxtField = f.getAnnotation(SxtField.class);</span><br><span class="line">    System.out.println(sxtField.columnName()+<span class="string">&quot;--&quot;</span> + sxtField.type()+<span class="string">&quot;---&quot;</span> + sxtField.length());</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>运行结果</p>
<blockquote>
<p>@annotation.SxtTable(value=tb_student)<br>tb_student<br>sname–varchar—10</p>
</blockquote>
<h5 id="反射实例"><a href="#反射实例" class="headerlink" title="反射实例"></a>反射实例</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">String path = <span class="string">&quot;reflection.User&quot;</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    Class&lt;?&gt; clazz = Class.forName(path);</span><br><span class="line">    <span class="comment">//对象是表示或封装一些数据。一个类被加载后，JVM会创建一个对应该类的Class对象，类的整个结构信息会放到对应的CLass对象中。</span></span><br><span class="line">    <span class="comment">//这个Class对象就像一面镜子一样，通过这面镜子我可已看到对应类的全部信息。</span></span><br><span class="line">    System.out.println(clazz.hashCode());</span><br><span class="line"></span><br><span class="line">    Class clazz2 = Class.forName(path); <span class="comment">// 一个类对应的一个class对象</span></span><br><span class="line">    System.out.println(clazz2.hashCode());</span><br><span class="line"></span><br><span class="line">    Class intCLazz = <span class="keyword">int</span>.class;</span><br><span class="line">    <span class="keyword">int</span>[] arr01 = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">int</span>[][] arr02 = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">30</span>][<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">int</span>[]arr03 = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">30</span>];</span><br><span class="line">    <span class="keyword">double</span>[] arr04 = <span class="keyword">new</span> <span class="keyword">double</span>[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line">    System.out.println(arr01.getClass().hashCode());</span><br><span class="line">    System.out.println(arr02.getClass().hashCode());</span><br><span class="line">    System.out.println(arr03.getClass().hashCode());</span><br><span class="line">    System.out.println(arr04.getClass().hashCode());</span><br></pre></td></tr></table></figure>





<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=vZe5zG0vh3U&amp;list=PLC664nq_h8b9Jzh-qYJ_AeOpmSoBLC_tg&amp;index=1">https://www.youtube.com/watch?v=vZe5zG0vh3U&amp;list=PLC664nq_h8b9Jzh-qYJ_AeOpmSoBLC_tg&amp;index=1</a></p>
<h3 id="注解处理器"><a href="#注解处理器" class="headerlink" title="注解处理器"></a>注解处理器</h3><p>是javac处理注解的一种工具，它用来在编译时扫描和处理注解。简单来说就是在编译器，通过注解采集信息，生成.java文件。减少重复代码的编写。</p>
<h5 id="APT原理"><a href="#APT原理" class="headerlink" title="APT原理"></a>APT原理</h5><p><img src="/2020/04/25/annotation/2021-07-29_2.39.54_apt.png"></p>
<p><img src="/2020/04/25/annotation/2021-07-29_2.10_process.png"></p>
<h5 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h5><p><img src="/2020/04/25/annotation/2021-07-29_2.10.48_step.png"></p>
<h5 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h5><p>APT就这固定的几步，网上demo可以生成，我的就是没法生成，原来是因为,@DIActivity类的头部没有设置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DIActivity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>项目 MRouter</p>
<h4 id="Arouter"><a href="#Arouter" class="headerlink" title="Arouter"></a>Arouter</h4><h5 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h5><p>获得当前程序在手机中对应的apk文件,使用classsloader:dexfile(PMS)，反射获取apk所有的类，筛选出注册activity的类。初始化</p>
<h5 id="核心实现"><a href="#核心实现" class="headerlink" title="核心实现"></a>核心实现</h5><p><img src="/2020/04/25/annotation/2021-08-12_1.18_arouter.png"></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Ly4y1W7f5?p=6&amp;spm_id_from=pageDriver">https://www.bilibili.com/video/BV1Ly4y1W7f5?p=6&amp;spm_id_from=pageDriver</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1nU4y1a79o?from=search&amp;seid=3188418579827888379">https://www.bilibili.com/video/BV1nU4y1a79o?from=search&amp;seid=3188418579827888379</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6925283352698159117#heading-14">https://juejin.cn/post/6925283352698159117#heading-14</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6947992544252788767">https://juejin.cn/post/6947992544252788767</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/xx326664162/article/details/68490059">https://blog.csdn.net/xx326664162/article/details/68490059</a></p>
<p><a target="_blank" rel="noopener" href="https://hanshuliang.blog.csdn.net/article/details/117072224">https://hanshuliang.blog.csdn.net/article/details/117072224</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/han1202012/APT">https://github.com/han1202012/APT</a></p>
<h4 id="反射机制"><a href="#反射机制" class="headerlink" title="反射机制"></a>反射机制</h4><p>Java反射机制是在运行状态中，对于任意一个类，都能够知道这个类的所有属性和方法；对于任意一个对象都能够调用它的任意一个方法；这种动态获取的信息以及动态调用对象的方法的功能称为java的反射机制。</p>
<h5 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> reflection;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MethodReflect</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addResult</span><span class="params">(<span class="keyword">int</span> addNum)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> addNum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用反射第一步:获取操作类MethodDemoFieldDemo所对应的Class对象</span></span><br><span class="line">Class &lt; ?&gt;cls = Class.forName(<span class="string">&quot;reflection.MethodReflect&quot;</span>);</span><br><span class="line"><span class="comment">//使用MethodDemo类的class对象生成 实例</span></span><br><span class="line">Object obj = cls.newInstance();</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取public int addResult(int addNum)方法</span></span><br><span class="line">Method addMethod = cls.getMethod(<span class="string">&quot;addResult&quot;</span>, <span class="keyword">new</span> Class[] &#123;</span><br><span class="line">        <span class="keyword">int</span>.class</span><br><span class="line">&#125;);</span><br><span class="line">System.out.println(<span class="string">&quot;修饰符: &quot;</span> + Modifier.toString(addMethod.getModifiers()));</span><br><span class="line">System.out.println(<span class="string">&quot;返回值: &quot;</span> + addMethod.getReturnType());</span><br><span class="line">System.out.println(<span class="string">&quot;方法名称: &quot;</span> + addMethod.getName());</span><br><span class="line">System.out.println(<span class="string">&quot;参数列表: &quot;</span> + addMethod.getParameterTypes());</span><br><span class="line"><span class="keyword">int</span> result = (<span class="keyword">int</span>) addMethod.invoke(obj, <span class="number">2</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;调用addResult后的运行结果:&quot;</span> + result);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;--------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取public String toString() 方法</span></span><br><span class="line">Method toStringMethod = cls.getMethod(<span class="string">&quot;toString&quot;</span>, <span class="keyword">new</span> Class[] &#123;&#125;);</span><br><span class="line">System.out.println(<span class="string">&quot;修饰符: &quot;</span> + Modifier.toString(toStringMethod.getModifiers()));</span><br><span class="line">System.out.println(<span class="string">&quot;返回值: &quot;</span> + toStringMethod.getReturnType());</span><br><span class="line">System.out.println(<span class="string">&quot;方法名称: &quot;</span> + toStringMethod.getName());</span><br><span class="line">System.out.println(<span class="string">&quot;参数列表: &quot;</span> + toStringMethod.getParameterTypes());</span><br><span class="line">String msg = (String) toStringMethod.invoke(obj);</span><br><span class="line">System.out.println(<span class="string">&quot;调用toString后的运行结果:&quot;</span> + msg);</span><br></pre></td></tr></table></figure>



<p>Method类的invoke(Object obj,Object  args[])方法接收的参数必须为对象,如果参数为基本类型数据,必须转换为相应的包装类型的对象。invoke()方法的返回值总是对象,如果实际被调用的方法的返回类型是基本类型数据,那么invoke()方法会把它转换为相应的包装类型的对象,再将其返回.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InvokeTester</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">InvokeTester</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> param1, <span class="keyword">int</span> param2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> param1 + param2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">echo</span><span class="params">(String mesg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;echo&quot;</span> + mesg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Class classType = InvokeTester.class;</span><br><span class="line">        Object invokertester = classType.newInstance(); <span class="comment">//1</span></span><br><span class="line">        Method addMethod = classType.getMethod(<span class="string">&quot;add&quot;</span>, <span class="keyword">new</span> Class[]&#123; <span class="comment">//2</span></span><br><span class="line">                <span class="keyword">int</span>.class,</span><br><span class="line">                <span class="keyword">int</span>.class</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        Object result = addMethod.invoke(invokertester, <span class="keyword">new</span> Object[]&#123; <span class="comment">//3</span></span><br><span class="line">                <span class="keyword">new</span> Integer(<span class="number">100</span>),</span><br><span class="line">                <span class="keyword">new</span> Integer(<span class="number">200</span>)</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        System.out.println(result);</span><br><span class="line">        Method echo = classType.getMethod(<span class="string">&quot;echo&quot;</span>, <span class="keyword">new</span> Class[]&#123;</span><br><span class="line">                String.class</span><br><span class="line">        &#125;);</span><br><span class="line">        Object obj = echo.invoke(invokertester, <span class="keyword">new</span> Object[]&#123;</span><br><span class="line">                <span class="keyword">new</span> String(<span class="string">&quot;Jon is very good!!!&quot;</span>)</span><br><span class="line">        &#125;);</span><br><span class="line">        System.out.println(obj.toString());</span><br><span class="line"></span><br><span class="line">        InvokeTester test = <span class="keyword">new</span> InvokeTester(); <span class="comment">//1</span></span><br><span class="line">        test.setName(<span class="string">&quot;黄翊&quot;</span>); <span class="comment">//2</span></span><br><span class="line">        <span class="comment">//Method[] methods;</span></span><br><span class="line">        Method[] methods = test.getClass().getDeclaredMethods(); <span class="comment">//3</span></span><br><span class="line">        <span class="comment">//循环查找获取id方法，并执行查看是否有返回值</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; methods.length; i++) &#123;</span><br><span class="line">            <span class="comment">//如果此方法有get和Id关键字则执行</span></span><br><span class="line">            <span class="keyword">if</span> (methods[i].getName().indexOf(<span class="string">&quot;get&quot;</span>) != -<span class="number">1</span> &amp;&amp; methods[i].getName().indexOf(<span class="string">&quot;Name&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// 获取此get方法返回值,判断是否有值,如果没有值说明即将执行的操作新增</span></span><br><span class="line">                <span class="keyword">if</span> (methods[i].invoke(test, <span class="keyword">null</span>) == <span class="keyword">null</span>) &#123; <span class="comment">//4</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;此对象没有值！！！&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Object strName = methods[i].invoke(test, <span class="keyword">null</span>);</span><br><span class="line">                    System.out.println(strName);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h5 id="invoke方法的使用"><a href="#invoke方法的使用" class="headerlink" title="invoke方法的使用"></a>invoke方法的使用</h5><p>实际上invoke方法的使用，和我们常见的有所区别。</p>
<p>我们经常创建一个对象A，A对象里面的方法getA()方法，然后A.getA()</p>
<p>我们采用新的方式调用<br>（1）弄一个方法的“替身”（其实就是构建一个Method对象，让这个Method对象来代替你现在要用的方法）<br>（2）然后给替身需要的对象和参数，让替身去替你调用（像替身替你去战斗）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> reflection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InvokeTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">(String[] arg)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (String string : arg) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;zp is &quot;</span> + string);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invokeDemo</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//获取字节码对象,这里要填好你对应对象的包的路径</span></span><br><span class="line">        Class&lt;InvokeTest&gt; clazz = (Class&lt;InvokeTest&gt;) Class.forName(<span class="string">&quot;reflection.InvokeTest&quot;</span>);</span><br><span class="line">        <span class="comment">//形式一：获取一个对象</span></span><br><span class="line"><span class="comment">//        Constructor con =  clazz.getConstructor();</span></span><br><span class="line"><span class="comment">//        InvokeTest m = (InvokeTest) con.newInstance();</span></span><br><span class="line">        <span class="comment">//形式二：直接new对象，实际上不是框架的话，自己写代码直接指定某个对象创建并调用也可以</span></span><br><span class="line">        InvokeTest m = <span class="keyword">new</span> InvokeTest();</span><br><span class="line">        String[] s = <span class="keyword">new</span> String[]&#123;<span class="string">&quot;handsome&quot;</span>,<span class="string">&quot;smart&quot;</span>&#125;;</span><br><span class="line">        <span class="comment">//获取Method对象</span></span><br><span class="line">        Method method = clazz.getMethod(<span class="string">&quot;test&quot;</span>, String[].class); <span class="comment">//invoke方法要比别的方法多做一步</span></span><br><span class="line">        <span class="comment">//调用invoke方法来调用</span></span><br><span class="line">        method.invoke(m, (Object) s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<blockquote>
<p>zp is handsome<br>zp is smart</p>
</blockquote>
<p>所以使用invoke方法要比别的方法多做一步，就是构建一个Method对象，这个对象替代的是现在程序要调用方法的替代品。</p>
<p>而且除了参数以外，invoke还会多要一个对象，因为方法调用需要对象，所以invoke要想调用的目标方法，就需要目标方法的需要的对象。</p>
<p>看起来invoke方法不仅比平常方法直接调用要麻烦很多，但是你有想过吗，我只需要输入参数，我可以调用替代各种方法，在未知的情况下，根据条件决定去调用什么对象，什么方法，一下子就让代码变得灵活，这不仅是invoke的妙处，也是整个反射的妙处，在程序运行时根据条件灵活使用。</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/350058223">https://zhuanlan.zhihu.com/p/350058223</a></p>
<h5 id="Method信息"><a href="#Method信息" class="headerlink" title="Method信息"></a>Method信息</h5><p>我们已经能通过<code>Class</code>实例获取所有<code>Field</code>对象，同样的，可以通过<code>Class</code>实例获取所有<code>Method</code>信息。<code>Class</code>类提供了以下几个方法来获取<code>Method</code>：</p>
<ul>
<li><code>Method getMethod(name, Class...)</code>：获取某个<code>public</code>的<code>Method</code>（包括父类）</li>
<li><code>Method getDeclaredMethod(name, Class...)</code>：获取当前类的某个<code>Method</code>（不包括父类）</li>
<li><code>Method[] getMethods()</code>：获取所有<code>public</code>的<code>Method</code>（包括父类）</li>
<li><code>Method[] getDeclaredMethods()</code>：获取当前类的所有<code>Method</code>（不包括父类）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getScore</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">99</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getGrade</span><span class="params">(<span class="keyword">int</span> year)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @Override</span></span><br><span class="line"><span class="comment">//    public void hello() &#123;</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;Student:hello&quot;);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Person:hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;Student&gt; methodClass = Student.class;</span><br><span class="line">Arrays.stream(methodClass.getMethods()).forEach(method -&gt; System.out.println(<span class="string">&quot;method方法:    &quot;</span> + method));</span><br></pre></td></tr></table></figure>

<p>打印出</p>
<blockquote>
<p>method方法:    public int reflection.liao.Student.getScore(java.lang.String)<br>method方法:    public void reflection.liao.Person.hello()<br>method方法:    public java.lang.String reflection.liao.Person.getName()</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;Person&gt; methodClass = Person.class;</span><br><span class="line">Arrays.stream(methodClass.getMethods()).forEach(method -&gt; System.out.println(<span class="string">&quot;method方法:    &quot;</span> + method));</span><br></pre></td></tr></table></figure>

<p>打印出</p>
<blockquote>
<p>method方法:    public void reflection.liao.Person.hello()<br>method方法:    public java.lang.String reflection.liao.Person.getName()</p>
<p>…object方法</p>
</blockquote>
<ol>
<li><p>getMethods()可以 获取所有<code>public</code>的<code>Method</code>（包括父类），</p>
</li>
<li><p>不能获取到子类的方法,除非是是多肽实现</p>
</li>
</ol>
<h5 id="getDeclaredMethod获取的Method能否调用子类"><a href="#getDeclaredMethod获取的Method能否调用子类" class="headerlink" title="getDeclaredMethod获取的Method能否调用子类?"></a>getDeclaredMethod获取的Method能否调用子类?</h5><p>父类class通过getDeclaredMethod获取的Method能否调用子类的对象</p>
<p>验证是不可以</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; clz = Class.forName(<span class="string">&quot;reflection.liao.Person&quot;</span>);</span><br><span class="line">Object o = clz.newInstance();</span><br><span class="line">Method methodGetName = clz.getMethod(<span class="string">&quot;getName&quot;</span>);</span><br><span class="line">Object noParams = methodGetName.invoke(o);</span><br><span class="line">System.out.println(noParams);</span><br><span class="line"></span><br><span class="line">Method methodHello  = clz.getMethod(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">System.out.println(methodHello.invoke(o));</span><br><span class="line"></span><br><span class="line">Method methodGetGrade = clz.getMethod(<span class="string">&quot;getGrade&quot;</span>);</span><br><span class="line">System.out.println(methodGetGrade.invoke(o));</span><br></pre></td></tr></table></figure>

<blockquote>
<p>A Person<br>Person:hello<br>null        // 这个null是哪里来的</p>
</blockquote>
<p>提示</p>
<p>java.lang.NoSuchMethodException: reflection.liao.Person.getGrade()</p>
<p>所以是调用不了的。</p>
<p><a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/1252599548343744/1264803678201760">https://www.liaoxuefeng.com/wiki/1252599548343744/1264803678201760</a></p>
<p><a target="_blank" rel="noopener" href="http://www.51gjie.com/java/796.html">http://www.51gjie.com/java/796.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/onlywujun/p/3519037.html">https://www.cnblogs.com/onlywujun/p/3519037.html</a></p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="https://noteforme.github.io/page/9/index.html">https://noteforme.github.io/page/9/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-JVM" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/04/18/JVM/">JVM</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2020-04-18T14:19:42.000Z" itemprop="datePublished">2020年04月18日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/JAVA/">JAVA</a>
  </div>

      
      
<a href="/2020/04/18/JVM/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a href="https://noteforme.github.io/2020/01/04/JVM-METHOD/">JVM方法区-第六章</a></p>
<img src="/2020/04/18/JVM/2020-04-16_8.22.33.png" alt="2020-04-16_8.22.33" style="zoom:50%;">



<p><img src="/2020/04/18/JVM/2020-04-16_8.29.39.png" alt="2020-04-16_8.29.39"></p>
<p><img src="/2020/04/18/JVM/2020-04-16_8.41.39.png" alt="2020-04-16_8.41.39"></p>
<p><img src="/2020/04/18/JVM/2020-04-16_8.43.41.png" alt="2020-04-16_8.43.41"></p>
<p><a target="_blank" rel="noopener" href="https://www.iteye.com/blog/rednaxelafx-656951">https://www.iteye.com/blog/rednaxelafx-656951</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/av75247289?p=2">https://www.bilibili.com/video/av75247289?p=2</a></p>
<p>这种情况全局变量 b: B是否会造成内存泄漏</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">val</span> b = B.getInstance()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span> &#123;</span><br><span class="line">        <span class="keyword">val</span> b = B()</span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">getInstance</span><span class="params">()</span></span>: B &#123;</span><br><span class="line">            <span class="keyword">return</span> b</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我觉得不会,B 并不指向A</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1GA4y197VR?spm_id_from=333.337.search-card.all.click&amp;vd_source=d4c5260002405798a57476b318eccac9">https://www.bilibili.com/video/BV1GA4y197VR?spm_id_from=333.337.search-card.all.click&amp;vd_source=d4c5260002405798a57476b318eccac9</a></p>
<p>mOpenEnv  加</p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="https://noteforme.github.io/page/9/index.html">https://noteforme.github.io/page/9/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JVM/" rel="tag">JVM</a></li></ul>

          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-tool-mac" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/04/11/tool-mac/">tool_mac</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2020-04-11T08:35:50.000Z" itemprop="datePublished">2020年04月11日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/TOOL/">TOOL</a>
  </div>

      
      
<a href="/2020/04/11/tool-mac/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h5 id="IntelliJ-idea-clion"><a href="#IntelliJ-idea-clion" class="headerlink" title="IntelliJ idea clion"></a>IntelliJ idea clion</h5><p>clion激活: CLion-2019.2.5.dmg 下载完成后,先使用再打开,jetbrains-agent-20200227.zip直接拖入就好了。</p>
<p>some tool for mac</p>
<p>查看当前环境变量 : env</p>
<h5 id="Packet-Sender"><a href="#Packet-Sender" class="headerlink" title="Packet Sender"></a>Packet Sender</h5><p>tcp ip tool</p>
<img src="/2020/04/11/tool-mac/Screen Shot 2020-04-11 at 4.40.59 PM.png" alt="Screen Shot 2020-04-11 at 4.40.59 PM" style="zoom:67%;">







<h5 id="HomeBrew安装"><a href="#HomeBrew安装" class="headerlink" title="HomeBrew安装"></a>HomeBrew安装</h5><ol>
<li>下载</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/Homebrew/install/master/install.sh">https://raw.githubusercontent.com/Homebrew/install/master/install.sh</a></p>
<ol start="2">
<li><p>更换源</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BREW_REPO=<span class="string">&quot;https://github.com/Homebrew/brew&quot;</span></span><br><span class="line">   换成  </span><br><span class="line">BREW_REPO=<span class="string">&quot;git://mirrors.ustc.edu.cn/brew.git&quot;</span> </span><br></pre></td></tr></table></figure></li>
<li><p>权限</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod <span class="number">755</span> <span class="keyword">install</span>.sh </span><br><span class="line">./<span class="keyword">install</span>.sh </span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43635647/article/details/104249968">https://blog.csdn.net/weixin_43635647/article/details/104249968</a></p>
<h5 id="set-environment-variable-mac"><a href="#set-environment-variable-mac" class="headerlink" title="set environment variable mac"></a>set environment variable mac</h5><ol>
<li>Flutter</li>
</ol>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi ~/.bash_profile</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="string">&quot;<span class="variable">$PATH</span>:/Users/john/development/flutter/bin&quot;</span></span><br><span class="line"></span><br><span class="line">which flutter</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>jdk </p>
<p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/10/install/installation-jdk-and-jre-macos.htm#JSJIG-GUID-F575EB4A-70D3-4AB4-A20E-DBE95171AB5F">https://docs.oracle.com/javase/10/install/installation-jdk-and-jre-macos.htm#JSJIG-GUID-F575EB4A-70D3-4AB4-A20E-DBE95171AB5F</a></p>
</li>
</ol>
<h5 id="mac-terminal"><a href="#mac-terminal" class="headerlink" title="mac terminal"></a>mac terminal</h5><ol>
<li>download and install iterm2</li>
<li>Download iterm2-finder-tools-1.0.0  open Open iTerm.workflow install</li>
<li>file top 右键 customize toolbar then move opem iTerm into toolbar</li>
</ol>
</li>
<li><p>Ignore</p>
<p><code>Command + Shift + .</code></p>
</li>
<li><p>Environment set</p>
<p>AppledeMacBook-Pro:~ apple$ cat ~/.bash_profile</p>
<p>export PATH=”$PATH:/Users/john/development/flutter/bin”</p>
<p>export PUB_HOSTED_URL=<a target="_blank" rel="noopener" href="https://pub.flutter-io.cn/">https://pub.flutter-io.cn</a></p>
<p>export FLUTTER_STORAGE_BASE_URL=<a target="_blank" rel="noopener" href="https://storage.flutter-io.cn/">https://storage.flutter-io.cn</a> </p>
</li>
</ol>
<h5 id="gradle-阿里云镜像"><a href="#gradle-阿里云镜像" class="headerlink" title="gradle 阿里云镜像"></a>gradle 阿里云镜像</h5><p>/Users/john/.gradle 目录添加 init.gradle</p>
<h5 id="鼠须管默认简繁体"><a href="#鼠须管默认简繁体" class="headerlink" title="鼠须管默认简繁体"></a>鼠须管默认简繁体</h5><p>control 加上 ~ 快捷键</p>
<h5 id="屏幕录制"><a href="#屏幕录制" class="headerlink" title="屏幕录制"></a>屏幕录制</h5><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43428139/article/details/109038098">https://blog.csdn.net/qq_43428139/article/details/109038098</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/hi3254014978/p/15084851.html#:~:text=%E8%A7%A3%E5%86%B3Mac%E7%AC%94%E8%AE%B0%E6%9C%AC%E7%94%B5%E8%84%91%E8%87%AA%E5%B8%A6%E5%BD%95%E5%B1%8F%E8%BD%AF%E4%B">https://www.cnblogs.com/hi3254014978/p/15084851.html#:~:text=%E8%A7%A3%E5%86%B3Mac%E7%AC%94%E8%AE%B0%E6%9C%AC%E7%94%B5%E8%84%91%E8%87%AA%E5%B8%A6%E5%BD%95%E5%B1%8F%E8%BD%AF%E4%B</a></p>
<h5 id="adb-环境变量"><a href="#adb-环境变量" class="headerlink" title="adb 环境变量"></a>adb 环境变量</h5><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sudo touch ~/.zshrc</span><br><span class="line">sudo vi ~/.zshrc</span><br><span class="line"></span><br><span class="line">复制</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">ANDROID_HOME</span>=/Users/m/Library/Android/sdk</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$ANDROID_HOME</span>/platform-tools:$PATH</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$ANDROID_HOME</span>/tools:$PATH</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$ANDROID_HOME</span>/tools/bin:$PATH</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://dev.to/ravics09/solution-of-command-not-found-adb-error-29e7">https://dev.to/ravics09/solution-of-command-not-found-adb-error-29e7</a></p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="https://noteforme.github.io/page/9/index.html">https://noteforme.github.io/page/9/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-viewmodel" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/04/06/viewmodel/">viewmodel</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2020-04-06T07:51:24.000Z" itemprop="datePublished">2020年04月06日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/Jetpack/">Jetpack</a>
  </div>

      
      
<a href="/2020/04/06/viewmodel/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://developer.android.com/topic/libraries/architecture/viewmodel">https://developer.android.com/topic/libraries/architecture/viewmodel</a></p>
<p>Share data between fragments</p>
<h4 id="livedata和viewmodel关系"><a href="#livedata和viewmodel关系" class="headerlink" title="livedata和viewmodel关系"></a>livedata和viewmodel关系</h4><p>viewmodel中的数据发生变化时通知页面</p>
<h4 id="ViewModel出现前"><a href="#ViewModel出现前" class="headerlink" title="ViewModel出现前"></a>ViewModel出现前</h4><ol>
<li>瞬间数据丢失</li>
<li>异步调用的内存泄漏</li>
<li>类膨胀提高维护难度和测试难度</li>
</ol>
<p><img src="/2020/04/06/viewmodel/2021-08-02_8.18_viewmodel.png"></p>
<p>Share data between fragments</p>
<p>It’s very common that two or more fragments in an activity need to communicate with each other</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">class SharedViewModel : ViewModel() &#123;</span><br><span class="line">    val selected &#x3D; MutableLiveData&lt;Item&gt;()</span><br><span class="line"></span><br><span class="line">    fun select(item: Item) &#123;</span><br><span class="line">        selected.value &#x3D; item</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class MasterFragment : Fragment() &#123;</span><br><span class="line"></span><br><span class="line">    private lateinit var itemSelector: Selector</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Use the &#39;by activityViewModels()&#39; Kotlin property delegate</span><br><span class="line">    &#x2F;&#x2F; from the fragment-ktx artifact</span><br><span class="line">    private val model: SharedViewModel by activityViewModels()</span><br><span class="line"></span><br><span class="line">    override fun onViewCreated(view: View, savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onViewCreated(view, savedInstanceState)</span><br><span class="line">        itemSelector.setOnClickListener &#123; item -&gt;</span><br><span class="line">            &#x2F;&#x2F; Update the UI</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class DetailFragment : Fragment() &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Use the &#39;by activityViewModels()&#39; Kotlin property delegate</span><br><span class="line">    &#x2F;&#x2F; from the fragment-ktx artifact</span><br><span class="line">    private val model: SharedViewModel by activityViewModels()</span><br><span class="line"></span><br><span class="line">    override fun onViewCreated(view: View, savedInstanceState: Bundle?) &#123;</span><br><span class="line">        super.onViewCreated(view, savedInstanceState)</span><br><span class="line">        model.selected.observe(viewLifecycleOwner, Observer&lt;Item&gt; &#123; item -&gt;</span><br><span class="line">            &#x2F;&#x2F; Update the UI</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://codelabs.developers.google.com/codelabs/android-lifecycles/#0">https://codelabs.developers.google.com/codelabs/android-lifecycles/#0</a></p>
<h5 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyViewModel</span>  <span class="keyword">extends</span> <span class="title">ViewModel</span> </span>&#123; </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyViewModel</span><span class="params">(Application application)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> number;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyViewModel</span> <span class="keyword">extends</span> <span class="title">AndroidViewModel</span> </span>&#123; <span class="comment">//需要用到application就用AndroidViewModel</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyViewModel</span><span class="params">(Application application)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(application);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> number;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="ViewModel保持数据原理"><a href="#ViewModel保持数据原理" class="headerlink" title="ViewModel保持数据原理"></a>ViewModel保持数据原理</h4><ol>
<li>使用</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">viewModel = <span class="keyword">new</span> ViewModelProvider(<span class="keyword">this</span>, <span class="keyword">new</span> ViewModelProvider.AndroidViewModelFactory(getApplication())).get(MyViewModel.class);</span><br></pre></td></tr></table></figure>



<ol start="2">
<li><p>owner.getViewModelStore()</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ViewModelProvider</span><span class="params">(<span class="meta">@NonNull</span> ViewModelStoreOwner owner, <span class="meta">@NonNull</span> Factory factory)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>(owner.getViewModelStore(), factory);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>ComponentActivity</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ViewModelStore <span class="title">getViewModelStore</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (getApplication() == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">&quot;Your activity is not yet attached to the &quot;</span></span><br><span class="line">                + <span class="string">&quot;Application instance. You can&#x27;t request ViewModel before onCreate call.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (mViewModelStore == <span class="keyword">null</span>) &#123;</span><br><span class="line">        NonConfigurationInstances nc =</span><br><span class="line">                (NonConfigurationInstances) getLastNonConfigurationInstance(); <span class="comment">//拿到上次屏幕的状态</span></span><br><span class="line">        <span class="keyword">if</span> (nc != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// Restore the ViewModelStore from NonConfigurationInstances</span></span><br><span class="line">            mViewModelStore = nc.viewModelStore; <span class="comment">// 获取上次的mViewModelStore，里面保存有HashMap&lt;String, ViewModel&gt; mMap</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (mViewModelStore == <span class="keyword">null</span>) &#123;</span><br><span class="line">            mViewModelStore = <span class="keyword">new</span> ViewModelStore();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mViewModelStore;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>所以ViewModel横竖屏切换保存数据的秘诀就是</p>
<p>//拿到上次屏幕的状态,获取上次的mViewModelStore，里面保存有HashMap&lt;String, ViewModel&gt; mMap,接着通过.get(MyViewModel.class);获取ViewModel,如果获取不到就反射newInstance()一个。</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Hh411a7LX?p=6&amp;spm_id_from=pageDriver">https://www.bilibili.com/video/BV1Hh411a7LX?p=6&amp;spm_id_from=pageDriver</a></p>
<h4 id="Unit-test"><a href="#Unit-test" class="headerlink" title="Unit test"></a>Unit test</h4><p><a target="_blank" rel="noopener" href="https://simplifiedcoding.in/all-courses">https://simplifiedcoding.in/all-courses</a></p>
<p><a target="_blank" rel="noopener" href="https://simplifiedcoding.in/course/android-testing-tutorial-from-junit-to-espresso/start/1">https://simplifiedcoding.in/course/android-testing-tutorial-from-junit-to-espresso/start/1</a></p>
<p>点 DOWNLOAD CODE OF SPENDS TRACKER 跳转后就有下载地址</p>
<p> spend-tracker</p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=B-dJTFeOAqw">https://www.youtube.com/watch?v=B-dJTFeOAqw</a></p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=uH6-HNxK32E">https://www.youtube.com/watch?v=uH6-HNxK32E</a></p>
<h5 id="SavedStateHandle"><a href="#SavedStateHandle" class="headerlink" title="SavedStateHandle"></a>SavedStateHandle</h5><p><a target="_blank" rel="noopener" href="https://www.kodeco.com/5212210-jetpack-saved-state-for-viewmodel-getting-started">https://www.kodeco.com/5212210-jetpack-saved-state-for-viewmodel-getting-started</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6907121847024746503">https://juejin.cn/post/6907121847024746503</a></p>
<h5 id="VisibleForTesting"><a href="#VisibleForTesting" class="headerlink" title="VisibleForTesting"></a>VisibleForTesting</h5><p>通过上面的代码看出， 被测试的testPrivate方法的可见性还是被改成Protected。也就是,VisibleForTesting只是一个注释，一个元数据metadata，它并没有进入程序逻辑，也没有被转化成字节码byte code 从而被JVM执行。</p>
<p>笔者猜测可能是Guava 的 程序员犯懒了, 即不愿意在unit test里直接利用Reflection来测试私有方法。也没有把私有方法写入另一个类中。所以设计了VisibleForTesting的注解来提醒其他程序员: 这里为了测试私有方法把私有方法改成了Protected(受保护的)并放宽了访问限制。</p>
<p>可是就JAVA本身而言，只有通过Reflection才能真正测试私有方法。</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yanlongpankow/p/6240563.html">https://www.cnblogs.com/yanlongpankow/p/6240563.html</a></p>
<p><a target="_blank" rel="noopener" href="https://jefflin1982.medium.com/android-visiblefortesting%E7%9A%84%E7%94%A8%E9%80%94-5a666a17ba95">https://jefflin1982.medium.com/android-visiblefortesting%E7%9A%84%E7%94%A8%E9%80%94-5a666a17ba95</a></p>
<h5 id="viewmodel-share"><a href="#viewmodel-share" class="headerlink" title="viewmodel share"></a>viewmodel share</h5><p><a target="_blank" rel="noopener" href="https://github.com/google-developer-training/android-basics-kotlin-cupcake-app/tree/starter">https://github.com/google-developer-training/android-basics-kotlin-cupcake-app/tree/starter</a></p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="https://noteforme.github.io/page/9/index.html">https://noteforme.github.io/page/9/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>



    <nav id="page-nav">

<a class="extend prev" rel="prev" href="/page/8/">Previous</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><a class="extend next" rel="next" href="/page/10/">Next</a>
</nav>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-posts"></i> Recent</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/08/09/LC-DP-BAG/">LC_DP_BAG</a>
          </li>
        
          <li>
            <a href="/2023/04/02/LC-DP/">LC-DP</a>
          </li>
        
          <li>
            <a href="/2023/01/10/RecyclerView-padding/">RecyclerView-padding</a>
          </li>
        
          <li>
            <a href="/2023/01/02/LC-GREEDY/">LC-GREEDY</a>
          </li>
        
          <li>
            <a href="/2022/12/27/viewBinding/">viewBinding</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-tag"></i> Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ANDROID/" style="font-size: 12.86px;">ANDROID</a> <a href="/tags/AOSP/" style="font-size: 18.57px;">AOSP</a> <a href="/tags/Activity/" style="font-size: 10px;">Activity</a> <a href="/tags/AndroidNewFeatures/" style="font-size: 10px;">AndroidNewFeatures</a> <a href="/tags/Assembly/" style="font-size: 10px;">Assembly</a> <a href="/tags/BLOG/" style="font-size: 10px;">BLOG</a> <a href="/tags/ConstraintLayout/" style="font-size: 10px;">ConstraintLayout</a> <a href="/tags/DB/" style="font-size: 11.43px;">DB</a> <a href="/tags/Drawer/" style="font-size: 10px;">Drawer</a> <a href="/tags/Fragment/" style="font-size: 11.43px;">Fragment</a> <a href="/tags/Git/" style="font-size: 11.43px;">Git</a> <a href="/tags/JVM/" style="font-size: 18.57px;">JVM</a> <a href="/tags/LEETCODE/" style="font-size: 20px;">LEETCODE</a> <a href="/tags/Operators/" style="font-size: 10px;">Operators</a> <a href="/tags/Performance/" style="font-size: 14.29px;">Performance</a> <a href="/tags/RecyclerView/" style="font-size: 11.43px;">RecyclerView</a> <a href="/tags/RxJava/" style="font-size: 14.29px;">RxJava</a> <a href="/tags/THINK/" style="font-size: 10px;">THINK</a> <a href="/tags/TOOL/" style="font-size: 11.43px;">TOOL</a> <a href="/tags/TabLayout/" style="font-size: 10px;">TabLayout</a> <a href="/tags/Test/" style="font-size: 14.29px;">Test</a> <a href="/tags/TouchEvent/" style="font-size: 12.86px;">TouchEvent</a> <a href="/tags/VIEW/" style="font-size: 11.43px;">VIEW</a> <a href="/tags/anim/" style="font-size: 10px;">anim</a> <a href="/tags/concurrency/" style="font-size: 14.29px;">concurrency</a> <a href="/tags/coroutie/" style="font-size: 17.14px;">coroutie</a> <a href="/tags/inter/" style="font-size: 15.71px;">inter</a> <a href="/tags/keyboard/" style="font-size: 10px;">keyboard</a> <a href="/tags/proguard/" style="font-size: 10px;">proguard</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-classify"></i> Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ANDROID/">ANDROID</a><span class="category-list-count">59</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/BLE/">BLE</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DataStructure/">DataStructure</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DesignPatterns/">DesignPatterns</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ENGLISH/">ENGLISH</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Jetpack/">Jetpack</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kotlin/">Kotlin</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/LINUX/">LINUX</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mathematics/">Mathematics</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS/">OS</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Organization/">Organization</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SOURCE/">SOURCE</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TEST/">TEST</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TOOL/">TOOL</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/VIEW/">VIEW</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/anim/">anim</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/flutter/">flutter</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-archive"></i> Archive</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/">2023年08月</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022年12月</a><span class="archive-list-count">33</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021年12月</a><span class="archive-list-count">23</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020年12月</a><span class="archive-list-count">45</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019年12月</a><span class="archive-list-count">20</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018年11月</a><span class="archive-list-count">32</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017年12月</a><span class="archive-list-count">57</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-tag"></i> Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ANDROID/" rel="tag">ANDROID</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AOSP/" rel="tag">AOSP</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Activity/" rel="tag">Activity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AndroidNewFeatures/" rel="tag">AndroidNewFeatures</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Assembly/" rel="tag">Assembly</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BLOG/" rel="tag">BLOG</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ConstraintLayout/" rel="tag">ConstraintLayout</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DB/" rel="tag">DB</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Drawer/" rel="tag">Drawer</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fragment/" rel="tag">Fragment</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/" rel="tag">JVM</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LEETCODE/" rel="tag">LEETCODE</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Operators/" rel="tag">Operators</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Performance/" rel="tag">Performance</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RecyclerView/" rel="tag">RecyclerView</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RxJava/" rel="tag">RxJava</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/THINK/" rel="tag">THINK</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TOOL/" rel="tag">TOOL</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TabLayout/" rel="tag">TabLayout</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Test/" rel="tag">Test</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TouchEvent/" rel="tag">TouchEvent</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VIEW/" rel="tag">VIEW</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/anim/" rel="tag">anim</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/concurrency/" rel="tag">concurrency</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/coroutie/" rel="tag">coroutie</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/inter/" rel="tag">inter</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/keyboard/" rel="tag">keyboard</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/proguard/" rel="tag">proguard</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-link"></i> Blogroll</h3>
    <div class="widget">
      <ul>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example1.com/">site-name1</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example2.com/">site-name2</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example3.com/">site-name3</a>
        </li>
      
      </ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <a id="totop" href="#top"></a>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      <p>
        <a href="/sitemap.xml">Site Map</a>
        <span> | </span><a href="/atom.xml">Subscribe to this site</a>
        <span> | </span><a href="/about/">Contact the blogger</a>
      </p>
      
        <p>
          <i class="fa fa-visitors"></i>
          <i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>
          ，
          <i class="fa fa-views"></i>
          <i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>
        </p>
      
      <p>
        <span>Copyright &copy; 2023 Jon.</span>
        <span>Theme by <a href="https://github.com/chaooo/hexo-theme-BlueLake/" target="_blank">BlueLake.</a></span>
        
            <span>Count by <a href="http://busuanzi.ibruce.info/" target="_blank">busuanzi.</a></span>
        
        <span>Powered by <a href="https://hexo.io/" target="_blank">Hexo.</a></span>
      </p>
    </div>
  </div>
</footer>

    </div>
    
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/search.json.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>






  
<script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



  
<script src="/localshare/js/social-share.js"></script>

  
<script src="/localshare/js/qrcode.js"></script>




















  </div>
</body>
</html>