<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Jon&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  
  
    <link rel="alternate" href="/atom.xml" title="Jon's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="/localshare/css/share.css">

  
  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Jon&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Cease to struggle and you cease to live. - Thomas Carlyle</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/."><i class="fa fa-home"></i> Home</a>
        
          <a class="main-nav-link" href="/archives/"><i class="fa fa-archive"></i> Archive</a>
        
          <a class="main-nav-link" href="/about/"><i class="fa fa-user"></i> About</a>
        
          <a class="main-nav-link" href="/atom.xml"><i class="fa fa-rss"></i> RSS</a>
        
      </nav>
    </div>
    <div id="search-form">
      <div id="result-mask" class="hide"></div>
      <label><input id="search-key" type="text" autocomplete="off" placeholder="search"></label>
      <div id="result-wrap" class="hide">
        <div id="search-result"></div>
      </div>
      <div class="hide">
        <template id="search-tpl">
          <div class="item">
            <a href="/{path}" title="{title}">
              <div class="title">{title}</div>
              <div class="time">{date}</div>
              <div class="tags">{tags}</div>
            </a>
          </div>
        </template>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  <article id="post-INTERVIEW-JAVA" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/05/24/INTERVIEW-JAVA/">INTERVIEW-JAVA</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-05-24T14:31:57.000Z" itemprop="datePublished">2018年05月24日</time>
</span>
      
      
      
<a href="/2018/05/24/INTERVIEW-JAVA/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://interview-q-a-1gdnkgkla15afdbe-1258598664.tcloudbaseapp.com/Java/HashMap%E5%8E%9F%E7%90%86-%E7%BE%8E%E5%9B%A2.html">https://interview-q-a-1gdnkgkla15afdbe-1258598664.tcloudbaseapp.com/Java/HashMap%E5%8E%9F%E7%90%86-%E7%BE%8E%E5%9B%A2.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/huangjialin/p/12411842.html">面试题含答案</a></p>
<h3 id="java基础面试知识点"><a href="#java基础面试知识点" class="headerlink" title="java基础面试知识点"></a>java基础面试知识点</h3><h5 id="java中-和equals和hashCode的区别"><a href="#java中-和equals和hashCode的区别" class="headerlink" title="java中==和equals和hashCode的区别"></a>java中==和equals和hashCode的区别</h5><p>类型</p>
<ul>
<li>基本类型：比较的是值是否相同；</li>
<li>引用类型：如果是 类、接口、数组的话,当他们用双等号（==）进行比较的时候，比较的是他们的引用，如果要比较堆中对象是否相同，那么就要重写equals方法了；</li>
<li>默认情况下（没有覆写equals方法）的equals方法都是调用Object类的equals方法，而Object的equals方法主要是用于判断<strong>对象的内存地址引用是不是同一个地址</strong>（是不是同一个对象）。</li>
</ul>
<h5 id="int、char、long各占多少字节数"><a href="#int、char、long各占多少字节数" class="headerlink" title="int、char、long各占多少字节数"></a>int、char、long各占多少字节数</h5><p>   byte   1字节       short   2字节         int    4字节           long   8字节          </p>
<p>   char   2字节       float   4字节         double  8字节      boolean  false/true(理论上占用1bit,1/8字节，实际处理按1byte处理) </p>
<h5 id="int与integer的区别"><a href="#int与integer的区别" class="headerlink" title="int与integer的区别"></a>int与integer的区别</h5><p>​    Integer 是int的包装类；int是基本数据类型;</p>
<p>​    Integer实际是对象的引用，int是直接存储数据值</p>
<h5 id="谈谈对java多态-polymorphism-的理解-Java中实现多态的机制是什么"><a href="#谈谈对java多态-polymorphism-的理解-Java中实现多态的机制是什么" class="headerlink" title="谈谈对java多态(polymorphism)的理解,Java中实现多态的机制是什么"></a>谈谈对java多态(polymorphism)的理解,Java中实现多态的机制是什么</h5><p> 实现的机制是，父类或者接口定义的引用变量指向子类或者子类的实现， 执行期间判断所引用对象的实际类型，根据其实际的类型调用相应的方法。</p>
<ol>
<li><p>编译时多态(静态多态)==重载</p>
</li>
<li><p>运行时多态（动态多态）</p>
<p>无论哪种方法，核心之处在对父类方法的改写或对接口方法的实现，以取得运行时不同的执行效果.</p>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/tutorial/java/IandI/polymorphism.html">https://docs.oracle.com/javase/tutorial/java/IandI/polymorphism.html</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1447574">https://cloud.tencent.com/developer/article/1447574</a></p>
<h5 id="String、StringBuffer、StringBuilder区别"><a href="#String、StringBuffer、StringBuilder区别" class="headerlink" title="String、StringBuffer、StringBuilder区别"></a>String、StringBuffer、StringBuilder区别</h5><ul>
<li>都是fianl类，不能被继承,底层都是 char[] value实现</li>
<li>String类长度是不可变的，substring()、  concat(),最终实现都是通过  new String(buf, true)实现的,StringBuffer,StringBuilder是通过操作本类的value实现的</li>
<li>StringBuffer类是线程安全的，StringBuilder不是线程安全的</li>
<li>String：字符串常量。</li>
</ul>
<p>​    </p>
<h5 id="什么是内部类？内部类的作用"><a href="#什么是内部类？内部类的作用" class="headerlink" title="什么是内部类？内部类的作用"></a>什么是内部类？内部类的作用</h5><p>​    内部类:    一个类定义在另一个类的内部，就叫内部类</p>
<p>​    作用: </p>
<ul>
<li><p>内部类  拥有外部类的所有访问权限，包括被private修饰的私有数据</p>
</li>
<li><p>内部类可以很好的隐藏实现</p>
</li>
<li><p>内部类可以实现多重继承</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类一</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassA</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">name</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;liutao&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">doSomeThing</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// doSomeThing</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//类二</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassB</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">age</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">25</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//类三</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainExample</span></span>&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Test1</span> <span class="keyword">extends</span> <span class="title">ClassA</span></span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">name</span><span class="params">()</span></span>&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">super</span>.name();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Test2</span> <span class="keyword">extends</span> <span class="title">ClassB</span></span>&#123;</span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">age</span><span class="params">()</span></span>&#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">super</span>.age();</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">name</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Test1().name();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">age</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> Test2().age();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">       MainExample mi=<span class="keyword">new</span> MainExample();</span><br><span class="line">       System.out.println(<span class="string">&quot;姓名:&quot;</span>+mi.name());</span><br><span class="line">       System.out.println(<span class="string">&quot;年龄:&quot;</span>+mi.age());</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> MainExample 类通过内部类拥有了 ClassA 和 ClassB 的两个类的继承关系。 而无需关注 ClassA 中的 doSomeThing 方法的实现。这就是比接口实现更有戏的地方</p>
<p> <a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903566293860366">https://juejin.cn/post/6844903566293860366</a></p>
</li>
</ul>
<h5 id="抽象类和接口区别"><a href="#抽象类和接口区别" class="headerlink" title="抽象类和接口区别"></a>抽象类和接口区别</h5><table>
<thead>
<tr>
<th>Abstract class</th>
<th>Interface</th>
</tr>
</thead>
<tbody><tr>
<td>1) Abstract class can <strong>have abstract and non-abstract</strong> methods.</td>
<td>Interface can have <strong>only abstract</strong> methods. Since Java 8, it can have <strong>default and static methods</strong> also.</td>
</tr>
<tr>
<td>2) Abstract class <strong>doesn’t support multiple inheritance</strong>.</td>
<td>Interface <strong>supports multiple inheritance</strong>.</td>
</tr>
<tr>
<td>3) Abstract class <strong>can have final, non-final, static and non-static variables</strong>.</td>
<td>Interface has <strong>only static and final variables</strong>.</td>
</tr>
<tr>
<td>4) Abstract class <strong>can provide the implementation of interface</strong>.</td>
<td>Interface <strong>can’t provide the implementation of abstract class</strong>.</td>
</tr>
<tr>
<td>5) The <strong>abstract keyword</strong> is used to declare abstract class.</td>
<td>The <strong>interface keyword</strong> is used to declare interface.</td>
</tr>
<tr>
<td>6) An <strong>abstract class</strong> can extend another Java class and implement multiple Java interfaces.</td>
<td>An <strong>interface</strong> can extend another Java interface only.</td>
</tr>
<tr>
<td>7) An <strong>abstract class</strong> can be extended using keyword “extends”.</td>
<td>An <strong>interface</strong> can be implemented using keyword “implements”.</td>
</tr>
<tr>
<td>8) A Java <strong>abstract class</strong> can have class members like private, protected, etc.</td>
<td>Members of a Java interface are public by default.</td>
</tr>
<tr>
<td>9)<strong>Example:</strong>  public abstract class Shape{ public abstract void draw(); }</td>
<td><strong>Example:</strong>  public interface Drawable{ void draw(); }</td>
</tr>
</tbody></table>
<p><a target="_blank" rel="noopener" href="https://www.javatpoint.com/difference-between-abstract-class-and-interface">https://www.javatpoint.com/difference-between-abstract-class-and-interface</a></p>
<h5 id="泛型中extends和super的区别"><a href="#泛型中extends和super的区别" class="headerlink" title="? 泛型中extends和super的区别"></a>? 泛型中extends和super的区别</h5><ul>
<li><p>上界&lt;? extends T&gt;不能往里存，只能往外取，适合频繁往外面读取内容的场景。</p>
</li>
<li><p>下界&lt;? super T&gt;不影响往里存，但往外取只能放在Object对象里，适合经常往里面插入数据的场景</p>
<p><a target="_blank" rel="noopener" href="https://noteforme.github.io/2018/04/16/Generics/">https://noteforme.github.io/2018/04/16/Generics/</a></p>
</li>
</ul>
<h5 id="string-转换成-integer的方式及原理"><a href="#string-转换成-integer的方式及原理" class="headerlink" title="string 转换成 integer的方式及原理"></a>string 转换成 integer的方式及原理</h5><ol>
<li>判断是否null或””</li>
<li>判断第一位正负数，逐位获取值 ?</li>
</ol>
<p>  <a target="_blank" rel="noopener" href="https://blog.csdn.net/nobody_1/article/details/91488686">https://blog.csdn.net/nobody_1/article/details/91488686</a></p>
<h5 id="静态内部类的设计意图"><a href="#静态内部类的设计意图" class="headerlink" title="静态内部类的设计意图"></a>静态内部类的设计意图</h5><p>​    非静态内部类编译后会隐含的保存着一个引用，改引用指向创建它的外围类，静态内部类没有，</p>
<p>​    它不能使用任何外围类的非static成员变量和方法.</p>
<h5 id="final，finally，finalize的区别"><a href="#final，finally，finalize的区别" class="headerlink" title="final，finally，finalize的区别"></a>final，finally，finalize的区别</h5><p>  Final : 用于申明属性，方法，类，表示属性不可变，方法不可以覆盖，类不能继承</p>
<ol>
<li><p>final数组</p>
<p><strong>Java 中数组也是对象</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> arr[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;  <span class="comment">//  注意，数组 arr 是 final 的</span></span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">         arr[i] = arr[i]*<span class="number">10</span>;</span><br><span class="line">         System.out.println(arr[i]);</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>

<p>数组是对象的一种，现在数组是被 final 修饰的，所以它的意思是一旦被赋值之后，变量的引用不能修改。但是我们现在想证明的是，数组对象里面的内容可以修改</p>
</li>
<li><p>非数组对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123; </span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">20</span>; </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123; </span><br><span class="line">       <span class="keyword">final</span> Test t = <span class="keyword">new</span> Test();</span><br><span class="line">       t.p = <span class="number">30</span>; </span><br><span class="line">       System.out.println(t.p);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>把它用 final 修饰，然后去尝试改它里面成员变量 p 的值，并打印出结果，程序会打印出“30”。一开始 p 的值是 20，但是最后修改完毕变成了 30，说明这次修改是成功的。</p>
<p>以上我们就得出了一个结论，<strong>final 修饰一个指向对象的变量的时候，对象本身的内容依然是可以变化的</strong>。</p>
<p><a target="_blank" rel="noopener" href="https://kaiwu.lagou.com/course/courseInfo.htm?courseId=16#/detail/pc?id=311">https://kaiwu.lagou.com/course/courseInfo.htm?courseId=16#/detail/pc?id=311</a></p>
</li>
</ol>
<ul>
<li><p>Finally: 异常语句处理机构中，与try{}进行配合使用，不论try中的代码是否执行完，表示总是执行的部分</p>
</li>
<li><p>Finalize: Object类的一个方法，用于对象”消失”时，由JVM进行调用用于对对象进行垃圾回收，释放对象占用的资源.</p>
</li>
</ul>
<h5 id="Serializable-和Parcelable-的区别，如何将一个Java对象序列化到文件里？"><a href="#Serializable-和Parcelable-的区别，如何将一个Java对象序列化到文件里？" class="headerlink" title="Serializable 和Parcelable 的区别，如何将一个Java对象序列化到文件里？"></a>Serializable 和Parcelable 的区别，如何将一个Java对象序列化到文件里？</h5><ol>
<li><p>两者最大的区别在于 <strong>存储媒介的不同</strong>，<code>Serializable</code> 使用 <strong>I/O 读写存储在硬盘上</strong>，而 <code>Parcelable</code> 是直接 <strong>在内存中读写</strong>。很明显，内存的读写速度通常大于 IO 读写，所以在 Android 中传递数据优先选择 <code>Parcelable</code>。</p>
</li>
<li><p><code>Serializable</code> 会使用反射，序列化和反序列化过程需要大量 I/O 操作，也会创建很多临时对象， <code>Parcelable</code> 自已实现封送和解封（marshalled &amp;unmarshalled）操作不需要用反射，数据也存放在 Native 内存中，效率要快很多。</p>
<p> <a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903518826921991">https://juejin.cn/post/6844903518826921991</a></p>
</li>
</ol>
<p>父类的静态方法能否被子类重写</p>
<p> 不能，静态方法只和类有关,JVM加载后先初始化static相关属性方法,重写依赖于类的实例.</p>
<h5 id="成员内部类、局部内部类以及项目中的应用"><a href="#成员内部类、局部内部类以及项目中的应用" class="headerlink" title="成员内部类、局部内部类以及项目中的应用"></a>成员内部类、局部内部类以及项目中的应用</h5><p>成员内部类 : 普通的内部类，不存在任何static的变量和方法；</p>
<p>局部内部类： 嵌套于方法和作用域内</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Parcel5</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Destionation <span class="title">destionation</span><span class="params">(String str)</span></span>&#123;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">PDestionation</span> <span class="keyword">implements</span> <span class="title">Destionation</span></span>&#123;</span><br><span class="line">            <span class="keyword">private</span> String label;</span><br><span class="line">            <span class="function"><span class="keyword">private</span> <span class="title">PDestionation</span><span class="params">(String whereTo)</span></span>&#123;</span><br><span class="line">                label = whereTo;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">readLabel</span><span class="params">()</span></span>&#123;</span><br><span class="line">                <span class="keyword">return</span> label;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> PDestionation(str);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">      Parcel5 parcel5 = <span class="keyword">new</span> Parcel5();</span><br><span class="line">      Destionation d = parcel5.destionation(<span class="string">&quot;chenssy&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>闭包和局部内部类的区别</p>
<h5 id="Java中对象的生命周期"><a href="#Java中对象的生命周期" class="headerlink" title="Java中对象的生命周期"></a>Java中对象的生命周期</h5><p>​    <strong>1、创建阶段(Created)</strong><br>  <code>检测类是否被加载没有加载的先加载</code>→<code>为新生对象分配内存</code>→<code>将分配到的内存空间都初始化为零值</code>→<code>对对象进行必要的设置</code>→<code>执行&lt;init&gt;方法把对象进行初始化</code><br> 对象的加载大小是类加载中就已经确定好了的，类加载过程就相当复杂了，如下图：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/4345692-846543b5bed56265.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/452" alt="img"></p>
<p>类加载过程.png</p>
<p><strong>2、应用阶段(In Use)</strong><br>  至少有一个强引用使用着</p>
<p><strong>3、不可见阶段(Invisible)</strong><br>  程序的执行已经超出了该对象的作用域了</p>
<p><strong>4、不可达阶段(Unreachable)</strong><br>  程序不再持有该对象的任何强引用，这种情况下，该对象仍可能被JVM等系统下的某些已装载的静态变量或线程或JNI等强引用持有着，这些特殊的强引用被称为”GC root”</p>
<p><strong>5、收集阶段(Collected)</strong><br>  垃圾回收器发现该对象已经处于“不可达阶段”并且垃圾回收器已经对该对象的内存空间重新分配做好准备时，则对象进入了“收集阶段”。如果该对象已经重写了finalize()方法，则会去执行该方法的终端操作。</p>
<p><strong>6、终结阶段(Finalized)</strong><br>  当对象执行完finalize()方法后仍然处于不可达状态时，则该对象进入终结阶段。在该阶段是等待垃圾回收器对该对象空间进行回收。</p>
<p><strong>7、对象空间重分配阶段(De-allocated)</strong><br>  垃圾回收器对该对象的所占用的内存空间进行回收或者再分配了，则该对象彻底消失了，称之为“对象空间重新分配阶段”。</p>
<p>链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/72f5017c6649">https://www.jianshu.com/p/72f5017c6649</a></p>
<h3 id="JVM"><a href="#JVM" class="headerlink" title="JVM"></a>JVM</h3><h5 id="String特性"><a href="#String特性" class="headerlink" title="String特性"></a>String特性</h5><p>Java虚拟机在内存中开辟出一块单独的区域</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/60643031">https://zhuanlan.zhihu.com/p/60643031</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1PJ411n7xZ?p=118">https://www.bilibili.com/video/BV1PJ411n7xZ?p=118</a>   几个视频讲到用法，最好能用图画出来</p>
<p><a target="_blank" rel="noopener" href="https://www.iteye.com/blog/rednaxelafx-774673">https://www.iteye.com/blog/rednaxelafx-774673</a></p>
<h5 id="哪些情况下的对象会被垃圾回收机制处理掉？"><a href="#哪些情况下的对象会被垃圾回收机制处理掉？" class="headerlink" title="哪些情况下的对象会被垃圾回收机制处理掉？"></a>哪些情况下的对象会被垃圾回收机制处理掉？</h5><ol>
<li>可达性分析,GC Root向下搜索，产生一个reference chain 。当一个对象不能和任何GC Root产生关系时就被回收.</li>
<li><ul>
<li>强引用 ：那<strong>垃圾回收器</strong>绝不会回收</li>
<li>软引用: 内存溢出时候对象回收</li>
<li>弱引用:下一次GC时候对象回收</li>
<li>虚引用：随时可能被回收</li>
</ul>
</li>
<li>当前商业虚拟机的垃圾回收都采用分代收集算法，这种算法并没有什么新的思想，只是根据对象的存活周期将内存划分为几块。一般是把Java堆分为新生代和老年代，这样就可以根据各个年代的特点采用最适当的收集算法。在新生代中，每次垃圾回收都有大批对象死去，只有少量存活，那就选用复制算法，只要付出少量存活对象的复制成本就可以完成收集。而老年代中因为对象存活率高，没有额外的空间对它进行分配担保，那就使用标记清理或者标记整理算法来进行回收。</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://noteforme.github.io/2021/01/05/JVM-GC/">https://noteforme.github.io/2021/01/05/JVM-GC/</a></p>
<p><a target="_blank" rel="noopener" href="https://noteforme.github.io/2020/04/18/JVM/">https://noteforme.github.io/2020/04/18/JVM/</a></p>
<h5 id="String为什么要设计成不可变的？"><a href="#String为什么要设计成不可变的？" class="headerlink" title="String为什么要设计成不可变的？"></a>String为什么要设计成不可变的？</h5><ol>
<li><p>便于实现字符串池</p>
<p>由于会大量的使用String常量，如果每一次声明一个String都创建一个String对象，那将会造成极大的空间资源的浪费。Java提出了String pool的概念，在堆中开辟一块存储空间String  pool，当初始化一个String变量时，如果该字符串已经存在了，就不会去创建一个新的字符串变量，而是会返回已经存在了的字符串的引用。</p>
<p>如果字符串是可变的，某一个字符串变量改变了其值，那么其指向的变量的值也会改变，String pool将不能够实现！</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wkfvawl/p/11693260.html">https://www.cnblogs.com/wkfvawl/p/11693260.html</a></p>
</li>
</ol>
<h3 id="java深入源码级的面试题"><a href="#java深入源码级的面试题" class="headerlink" title="java深入源码级的面试题"></a>java深入源码级的面试题</h3><h5 id="讲一下常见编码方式？"><a href="#讲一下常见编码方式？" class="headerlink" title="讲一下常见编码方式？"></a>讲一下常见编码方式？</h5><ol>
<li><p>ASCII码:  用一个字节的低7位表示，总共128个,0<del>31 是控制字符如换行回车删除等；32</del>126 是打印字符，可以通过键盘输入并且能够显示出来</p>
</li>
<li><p>UTF-16:  固定两个字节表示一个字符：说到 UTF 必须要提到 Unicode（Universal Code 统一码），ISO  试图想创建一个全新的超语言字典，世界上所有的语言都可以通过这本字典来相互翻译。可想而知这个字典是多么的复杂，关于 Unicode  的详细规范可以参考相应文档。Unicode 是 Java 和 XML 的基础，下面详细介绍 Unicode 在计算机中的存储形式。<br>UTF-16 具体定义了 Unicode 字符在计算机中存取方法。UTF-16 用两个字节来表示 Unicode  转化格式，这个是定长的表示方法，不论什么字符都可以用两个字节表示，两个字节是 16 个 bit，所以叫 UTF-16。UTF-16  表示字符非常方便，每两个字节表示一个字符，这个在字符串操作时就大大简化了操作，这也是 Java 以 UTF-16  作为内存的字符存储格式的一个很重要的原因。</p>
</li>
<li><p>UTF-8:  优化UTF-16,UTF-16  统一采用两个字节表示一个字符，虽然在表示上非常简单方便，但是也有其缺点，有很大一部分字符用一个字节就可以表示的现在要两个字节表示，存储空间放大了一倍，在现在的网络带宽还非常有限的今天，这样会增大网络传输的流量，而且也没必要。而 UTF-8 采用了一种变长技术，每个编码区域有不同的字码长度。不同类型的字符可以是由 1~6 个字节组成。<br>UTF-8 有以下编码规则：<br>如果一个字节，最高位（第 8 位）为 0，表示这是一个 ASCII 字符（00 - 7F）。可见，所有 ASCII 编码已经是 UTF-8 了。<br>如果一个字节，以 11 开头，连续的 1 的个数暗示这个字符的字节数，例如：110xxxxx 代表它是双字节 UTF-8 字符的首字节。<br>如果一个字节，以 10 开始，表示它不是首字节，需要向前查找才能得到当前字符的首字节 </p>
</li>
<li><p>GBK 、ISO-8859-1、GB2312</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/mlan/p/7823375.html">https://www.cnblogs.com/mlan/p/7823375.html</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/mlan/p/7823375.html">https://www.cnblogs.com/mlan/p/7823375.html</a></p>
</li>
</ol>
<h5 id="utf-8编码中的中文占几个字节；int型几个字节？"><a href="#utf-8编码中的中文占几个字节；int型几个字节？" class="headerlink" title="utf-8编码中的中文占几个字节；int型几个字节？"></a>utf-8编码中的中文占几个字节；int型几个字节？</h5><p>​    少数是汉字每个占用3个字节，多数占用4个字节。</p>
<p>​    <a target="_blank" rel="noopener" href="https://blog.csdn.net/hellokatewj/article/details/24325653">https://blog.csdn.net/hellokatewj/article/details/24325653</a></p>
<p>​    int类型 4个字节</p>
<h5 id="静态代理和动态代理的区别，什么场景使用？"><a href="#静态代理和动态代理的区别，什么场景使用？" class="headerlink" title="静态代理和动态代理的区别，什么场景使用？"></a>静态代理和动态代理的区别，什么场景使用？</h5><p>​    静态代理 :  编译的时候就已经存在，</p>
<p>​    动态代理 ： 通过反射机制生成的代理对象</p>
<p>​    <a target="_blank" rel="noopener" href="https://noteforme.github.io/2021/01/14/DesignPattern-Proxy/">https://noteforme.github.io/2021/01/14/DesignPattern-Proxy/</a></p>
<p>​    <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/2f518a4a4c2b">https://www.jianshu.com/p/2f518a4a4c2b</a></p>
<h5 id="Java的异常体系"><a href="#Java的异常体系" class="headerlink" title="Java的异常体系"></a>Java的异常体系</h5><p>非运行时异常 :编译期间可以检查到的异常, 像IoException,DataFormatException,CertificateException</p>
<p>运行时异常 : NullPointerException, ClassCastException,IndexOutOfBoundsException</p>
<h5 id="谈谈你对解析与分派的认识。"><a href="#谈谈你对解析与分派的认识。" class="headerlink" title="? 谈谈你对解析与分派的认识。"></a>? 谈谈你对解析与分派的认识。</h5><h5 id="说说你对Java反射的理解"><a href="#说说你对Java反射的理解" class="headerlink" title="说说你对Java反射的理解"></a>说说你对Java反射的理解</h5><p>​    对于任何一个类都可以通过反射知道的它的属性和方法。</p>
<h5 id="说说你对Java注解的理解"><a href="#说说你对Java注解的理解" class="headerlink" title="说说你对Java注解的理解"></a>说说你对Java注解的理解</h5><p>​    注解，对代码进行注明。使得程序在编译或者运行时，读取到注解并加以处理，以间接的改变程序的运行。</p>
<h5 id="为什么Java里的匿名内部类只能访问final修饰的外部变量？"><a href="#为什么Java里的匿名内部类只能访问final修饰的外部变量？" class="headerlink" title="为什么Java里的匿名内部类只能访问final修饰的外部变量？"></a>为什么Java里的匿名内部类只能访问final修饰的外部变量？</h5><p>​    因为匿名内部类最终会被编译成一个单独的类，而被该类使用的变量会以构造函数参数的形式传递给该类。如果变量不定义为final的，参数在匿名内部类中可以被修改，进而造成和外部的变量不一致的问题，为了避免这种不一致的情况，规定匿名内部类只能访问final修饰的外部变量。</p>
<h5 id="说说你对依赖注入的理解"><a href="#说说你对依赖注入的理解" class="headerlink" title="说说你对依赖注入的理解?"></a>说说你对依赖注入的理解?</h5><p>​    给予调用方它所需要的对象</p>
<h4 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h4><h5 id="说一下泛型原理，并举例说明"><a href="#说一下泛型原理，并举例说明" class="headerlink" title="说一下泛型原理，并举例说明"></a>说一下泛型原理，并举例说明</h5><p>​    泛型实现了参数化类型的概念，使代码可以应用于多种类型。</p>
<p>​    在泛型代码内部，无法获得任何有关泛型参数类型的信息。    </p>
<h3 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h3><h5 id="常用数据结构简介"><a href="#常用数据结构简介" class="headerlink" title="常用数据结构简介"></a>常用数据结构简介</h5><p>数组 栈 队列  链表 图 树 哈希表</p>
<h5 id="并发集合了解哪些？"><a href="#并发集合了解哪些？" class="headerlink" title="并发集合了解哪些？"></a>并发集合了解哪些？</h5><p>ConcurrentHashMap  CopyOnWriteArrayList  CopyOnWriteArraySet  ArrayBlockingQueue  LinkedBlockingQueue</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u010942020/article/details/73610121">https://blog.csdn.net/u010942020/article/details/73610121</a></p>
<h5 id="列举java的集合以及集合之间的继承关系"><a href="#列举java的集合以及集合之间的继承关系" class="headerlink" title="列举java的集合以及集合之间的继承关系"></a>列举java的集合以及集合之间的继承关系</h5><img src="/2018/05/24/INTERVIEW-JAVA/colltetcion_map.png">



<p><img src="https://images4.pianshen.com/887/c1/c1abbb330519fa244799ae0923a2f3cf.png"></p>
<h5 id="List-Set-Map的区别"><a href="#List-Set-Map的区别" class="headerlink" title="List,Set,Map的区别"></a>List,Set,Map的区别</h5><p>容器类介绍以及之间的区别（容器类估计很多人没听这个词，Java容器主要可以划分为4个部分：List列表、Set集合、Map映射、工具类（Iterator迭代器、Enumeration枚举类、Arrays和Collections），具体的可以看看这篇博文 <a target="_blank" rel="noopener" href="http://alexyyek.github.io/2015/04/06/Collection/">Java容器类</a>）</p>
<ol>
<li>List是一个有序的队列，每一个元素都有它的索引。Set是一个不允许有重复元素的集合。</li>
<li>Map是一个映射接口，即key-value键值对。</li>
</ol>
<h5 id="List和Map的实现方式以及存储方式"><a href="#List和Map的实现方式以及存储方式" class="headerlink" title="List和Map的实现方式以及存储方式"></a>List和Map的实现方式以及存储方式</h5><ol>
<li><p>list</p>
<p>ArrayList    查询快 .  LinkedList  插入删除快</p>
</li>
</ol>
<p>修改对象A的equals方法的签名，那么使用HashMap存放这个对象实例的时候，会调用哪个equals方法？</p>
<h5 id="集合Set实现Hash怎么防止碰撞"><a href="#集合Set实现Hash怎么防止碰撞" class="headerlink" title="集合Set实现Hash怎么防止碰撞"></a>集合Set实现Hash怎么防止碰撞</h5><p>1，如果hash码值不相同，说明是一个新元素，存储；</p>
<p>如果没有元素和传入对象（也就是add的元素）的hash值相等，那么就认为这个元素在table中不存在，将其添加进table；</p>
<p>2.1，如果hash码值相同，且equles判断相等，说明元素已经存在，不存；</p>
<p>2.2，如果hash码值相同，且equles判断不相等，说明元素不存在，存；</p>
<p>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/github_37130188/article/details/96508272">https://blog.csdn.net/github_37130188/article/details/96508272</a></p>
<p>​                    <a target="_blank" rel="noopener" href="https://noteforme.github.io/2018/05/31/HashMap/">https://noteforme.github.io/2018/05/31/HashMap/</a></p>
<h5 id="HashMap"><a href="#HashMap" class="headerlink" title="HashMap"></a>HashMap</h5><ol>
<li>对key的Dashcode()做hash运算，计算index.</li>
<li>如果没碰撞直接放到bucket⾥</li>
<li>如果碰撞了，以链表的形式存在buckets后</li>
<li>如果节点已经存在就替换old value(保证key的唯⼀性)</li>
<li>如果bucket满了(超过load factor*current capacity)，就要resize</li>
</ol>
<p>get数据</p>
<ol>
<li><p>对key的hashCode()做hash运算，计算index;</p>
</li>
<li><p>如果在bucket⾥的第⼀个节点⾥直接命中，则直接返回；</p>
</li>
<li><p>如果有冲突，则通过key.equals(k)去查找对应的Entry;分为下面两种方式.</p>
</li>
<li><p>若为树，则在树中通过key.equals(k)查找，O(logn)；</p>
</li>
<li><p>若为链表，则在链表中通过key.equals(k)查找，O(n)。</p>
</li>
</ol>
<h5 id="ArrayMap"><a href="#ArrayMap" class="headerlink" title="ArrayMap"></a>ArrayMap</h5><p>​    因为其会对key从小到大排序，使用<strong>二分法</strong>查询key对应在数组中的下标。<br> 在添加、删除、查找数据的时候都是<strong>先使用二分查找法得到相应的index</strong>，然后通过index来进行添加、查找、删除等操作。</p>
<ul>
<li><strong>数据量不大</strong></li>
<li><strong>空间</strong>比时间<strong>重要</strong></li>
<li>需要使用<code>Map</code></li>
<li>在Android平台，相对来说，内存容量更宝贵。而且数据量不大。所以当需要使用<code>key</code>是<code>Object</code>类型的<code>Map</code>时，可以考虑使用<code>ArrayMap</code>来替换<code>HashMap</code></li>
</ul>
<h5 id="hashmap-hashtable区别"><a href="#hashmap-hashtable区别" class="headerlink" title="hashmap hashtable区别"></a>hashmap hashtable区别</h5><p>堆的结构</p>
<p>​    堆分为两种：<em>最大堆</em>和<em>最小堆</em>，两者的差别在于节点的排序方式。</p>
<p>在最大堆中，父节点的值比每一个子节点的值都要大。在最小堆中，父节点的值比每一个子节点的值都要小。这就是所谓的“堆属性”，并且这个属性对堆中的每一个节点都成立。<br><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/6b526aa481b1">https://www.jianshu.com/p/6b526aa481b1</a></p>
<h5 id="堆和树的区别"><a href="#堆和树的区别" class="headerlink" title="堆和树的区别"></a>堆和树的区别</h5><p>​    左子节点必须比父节点小，右子节点必须必比父节点大。但是在堆中并非如此。在最大堆中两个子节点都必须比父节点小，而在最小堆中，它们都必须比父节点大。</p>
<p>堆和栈在内存中的区别是什么(解答提示：可以从数据结构方面以及实际实现方面两个方面去回答)？</p>
<h5 id="什么是深拷贝和浅拷贝"><a href="#什么是深拷贝和浅拷贝" class="headerlink" title="什么是深拷贝和浅拷贝"></a>什么是深拷贝和浅拷贝</h5><ul>
<li><p>浅拷贝</p>
<p>是一个传址,也就是把a的值赋给b的时候同时也把a的地址赋给了b，当b（a）的值改变的时候，a（b）的值同时也会改变</p>
</li>
<li><p>深拷贝</p>
<p>​    深拷贝是指，拷贝对象的具体内容，二内存地址是自主分配的，拷贝结束之后俩个对象虽然存的值是一样的，但是内存地址不一样，俩个对象页互相不影响，互不干涉</p>
</li>
</ul>
<p>手写链表逆序代码</p>
<p>讲一下对树，B+树的理解</p>
<p>讲一下对图的理解</p>
<p>判断单链表成环与否？</p>
<p>链表翻转（即：翻转一个单项链表）</p>
<p>合并多个单有序链表（假设都是递增的）</p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/page/11/index.html">http://noteforme.github.io.com/page/11/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/inter/" rel="tag">inter</a></li></ul>

          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Concurrency_Locking" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/05/24/Concurrency_Locking/">Concurrency_Locking</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-05-24T14:31:57.000Z" itemprop="datePublished">2018年05月24日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/JAVA/">JAVA</a>
  </div>

      
      
<a href="/2018/05/24/Concurrency_Locking/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="锁的7大类"><a href="#锁的7大类" class="headerlink" title="锁的7大类"></a>锁的7大类</h4><h5 id="偏向锁-轻量级锁-重量级锁；"><a href="#偏向锁-轻量级锁-重量级锁；" class="headerlink" title="偏向锁/轻量级锁/重量级锁；"></a>偏向锁/轻量级锁/重量级锁；</h5><p><img src="/2018/05/24/Concurrency_Locking/2021-07-06_12-19-34.png"></p>
<ul>
<li><p>偏向锁</p>
<p>​    如果自始至终，对于这把锁都不存在竞争，那么其实就没必要上锁，只需要打个标记就行了，这就是偏向锁的思想。</p>
</li>
<li><p>轻量级锁</p>
<p>​    JVM 开发者发现在很多情况下，synchronized 中的代码是被多个线程交替执行的，而不是同时执行的，也就是说并不存在实际的    竞争，或者是只有短时间的锁竞争，用 CAS 就可以解决，这种情况下，用完全互斥的重量级锁是没必要的。</p>
</li>
<li><p>重量级锁</p>
<p>​    重量级锁是互斥锁，它是利用操作系统的同步机制实现的，所以开销相对比较大。当多个线程直接有实际竞争，且锁竞争时间长的时候，轻量级锁不能满足需求，锁就会膨胀为重量级锁。重量级锁会让其他申请却拿不到锁的线程进入阻塞状态。</p>
<h5 id="锁升级"><a href="#锁升级" class="headerlink" title="锁升级"></a>锁升级</h5><p><img src="https://s0.lgstatic.com/i/image3/M01/58/E4/CgpOIF35yCGAGFBbAAAO9n9VgTQ034.png"></p>
<ul>
<li><p>synchronized锁升级</p>
<p>偏向锁： markword记录这个线程ID -》如果线程争用升级为自旋锁 -》10次以后升级为重量级锁</p>
</li>
</ul>
<h4 id="synchronized的monitor-锁"><a href="#synchronized的monitor-锁" class="headerlink" title="synchronized的monitor 锁"></a>synchronized的monitor 锁</h4><h5 id="同步代码块"><a href="#同步代码块" class="headerlink" title="同步代码块"></a>同步代码块</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SynTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">synBlock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;lagou&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反编译后的字节码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">synBlock</span><span class="params">()</span></span>;</span><br><span class="line">   descriptor: ()V</span><br><span class="line">   flags: ACC_PUBLIC</span><br><span class="line">   Code:</span><br><span class="line">     stack=<span class="number">2</span>, locals=<span class="number">3</span>, args_size=<span class="number">1</span></span><br><span class="line">        <span class="number">0</span>: aload_0</span><br><span class="line">        <span class="number">1</span>: dup</span><br><span class="line">        <span class="number">2</span>: astore_1</span><br><span class="line">        <span class="number">3</span>: monitorenter</span><br><span class="line">        4: getstatic     #2                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">        7: ldc           #3                      // String lagou</span><br><span class="line">        9: invokevirtual #4               // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">       <span class="number">12</span>: aload_1</span><br><span class="line">       <span class="number">13</span>: monitorexit</span><br><span class="line">       <span class="number">14</span>: goto          <span class="number">22</span></span><br><span class="line">       <span class="number">17</span>: astore_2</span><br><span class="line">       <span class="number">18</span>: aload_1</span><br><span class="line">       <span class="number">19</span>: monitorexit</span><br><span class="line">       <span class="number">20</span>: aload_2</span><br><span class="line">       <span class="number">21</span>: athrow</span><br><span class="line">       <span class="number">22</span>: <span class="keyword">return</span></span><br></pre></td></tr></table></figure>

<p>synchronized 代码块实际上多了 monitorenter 和 monitorexit 指令，标红的第3、13、19行指令分别对应的是 monitorenter 和 monitorexit.可以把执行 monitorenter 理解为加锁，执行 monitorexit 理解为释放锁，每个对象维护着一个记录着被锁次数的计数器。未被锁定的对象的该计数器为 0。</p>
<ol>
<li>monitorenter</li>
</ol>
<p>执行 monitorenter 的线程尝试获得 monitor 的所有权，会发生以下这三种情况之一：</p>
<p>a. 如果该 monitor 的计数为 0，则线程获得该 monitor 并将其计数设置为 1。然后，该线程就是这个 monitor 的所有者。</p>
<p>b. 如果线程已经拥有了这个 monitor ，则它将重新进入，并且累加计数。</p>
<p>c. 如果其他线程已经拥有了这个 monitor，那个这个线程就会被阻塞，直到这个 monitor 的计数变成为 0，代表这个 monitor 已经被释放了，于是当前这个线程就会再次尝试获取这个 monitor。</p>
<ol start="2">
<li>monitorexit<br>monitorexit 的作用是将 monitor 的计数器减 1，直到减为 0 为止。代表这个 monitor 已经被释放了，已经没有任何线程拥有它了，也就代表着解锁，所以，其他正在等待这个 monitor 的线程，此时便可以再次尝试获取这个 monitor 的所有权。</li>
</ol>
<p>从上面也可看到  <strong>synchronized是可重入锁</strong></p>
<h6 id="synchronized-方法"><a href="#synchronized-方法" class="headerlink" title="synchronized 方法"></a>synchronized 方法</h6><p>​        同步代码块是使用 monitorenter 和 monitorexit 指令实现的。而对于 synchronized 方法，并不是依靠 monitorenter 和 monitorexit 指令实现的，被 javap 反汇编后可以看到，synchronized 方法和普通方法大部分是一样的，不同在于，这个方法会有一个叫作 ACC_SYNCHRONIZED 的 flag 修饰符，来表明它是同步方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    method body</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反编译后的指令</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">synMethod</span><span class="params">()</span></span>;</span><br><span class="line">   </span><br><span class="line">       descriptor: ()V</span><br><span class="line">   </span><br><span class="line">       flags: ACC_PUBLIC, ACC_SYNCHRONIZED</span><br><span class="line">   </span><br><span class="line">       Code:</span><br><span class="line">   </span><br><span class="line">         stack=<span class="number">0</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">   </span><br><span class="line">            <span class="number">0</span>: <span class="keyword">return</span></span><br><span class="line">   </span><br><span class="line">         LineNumberTable:</span><br><span class="line">   </span><br><span class="line">           line <span class="number">16</span>: <span class="number">0</span></span><br><span class="line">   </span><br></pre></td></tr></table></figure>



<p>被 synchronized 修饰的方法会有一个 ACC_SYNCHRONIZED 标志。当某个线程要访问某个方法的时候，会首先检查方法是否有 ACC_SYNCHRONIZED 标志，如果有则需要先获得 monitor 锁，然后才能开始执行方法，方法执行之后再释放 monitor 锁。其他方面， synchronized 方法和刚才的 synchronized 代码块是很类似的，例如这时如果其他线程来请求执行方法，也会因为无法获得 monitor 锁而被阻塞。</p>
<h6 id="synchronized-和-Lock选择"><a href="#synchronized-和-Lock选择" class="headerlink" title="synchronized 和 Lock选择"></a>synchronized 和 Lock选择</h6><ol>
<li><p>如果能不用最好既不使用 Lock 也不使用 synchronized。因为在许多情况下你可以使用 java.util.concurrent 包中的机制，它会为你处理所有的加锁和解锁操作，也就是推荐优先使用工具类来加解锁。</p>
</li>
<li><p>如果 synchronized 关键字适合你的程序， 那么请尽量使用它，这样可以减少编写代码的数量，减少出错的概率。因为一旦忘记在 finally 里 unlock，代码可能会出很大的问题，而使用 synchronized 更安全。</p>
</li>
<li><p>如果特别需要 Lock 的特殊功能，比如尝试获取锁、可中断、超时功能等，才使用 Lock。</p>
</li>
</ol>
<h6 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Lock</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">lock</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">lockInterruptibly</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException</span>;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">tryLock</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">tryLock</span><span class="params">(<span class="keyword">long</span> time, TimeUnit unit)</span> <span class="keyword">throws</span> InterruptedException</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">unlock</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">Condition <span class="title">newCondition</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>lock() </p>
<p>lock() 是最基础的获取锁的方法,获取锁和释放锁都是显式的，不像 synchronized 那样是隐式的，所以 Lock 不会像 synchronized 一样在异常时自动释放锁（synchronized 即使不写对应的代码也可以释放）,使用 lock() 时必须由我们自己主动去释放锁，因此最佳实践是执行 lock() 后，首先在 try{} 中操作同步资源，如果有必要就用 catch{} 块捕获异常，然后在 finally{} 中释放锁，以保证发生异常时锁一定被释放.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Lock lock = ...;</span><br><span class="line">lock.lock();</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="comment">//获取到了被本锁保护的资源，处理任务</span></span><br><span class="line">    <span class="comment">//捕获异常</span></span><br><span class="line">&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">    lock.unlock();   <span class="comment">//释放锁</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>tryLock()</p>
<p>​    尝试获取锁，如果当前锁没有被其他线程占用，则获取成功，返回 true，否则返回 false，代表获取锁失败。该方法会立即返回，即便在拿不到锁时也不会一直等待，所以通常情况下，我们用 if 语句判断 tryLock() 的返回结果.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Lock lock = ...;</span><br><span class="line"><span class="keyword">if</span>(lock.tryLock()) &#123;</span><br><span class="line">     <span class="keyword">try</span>&#123;</span><br><span class="line">         <span class="comment">//处理任务</span></span><br><span class="line">     &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">         lock.unlock();   <span class="comment">//释放锁</span></span><br><span class="line">     &#125; </span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//如果不能获取锁，则做其他事情</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个方法可以方便的解决死锁问题</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tryLock</span><span class="params">(Lock lock1, Lock lock2)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">       <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">           <span class="keyword">if</span> (lock1.tryLock()) &#123;</span><br><span class="line">               <span class="keyword">try</span> &#123;</span><br><span class="line">                   <span class="keyword">if</span> (lock2.tryLock()) &#123;</span><br><span class="line">                       <span class="keyword">try</span> &#123;</span><br><span class="line">                           System.out.println(<span class="string">&quot;获取到了两把锁，完成业务逻辑&quot;</span>);</span><br><span class="line">                           <span class="keyword">return</span>;</span><br><span class="line">                       &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                           lock2.unlock();</span><br><span class="line">                       &#125;</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                   lock1.unlock();</span><br><span class="line">               &#125;</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               Thread.sleep(<span class="keyword">new</span> Random().nextInt(<span class="number">1000</span>));</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>如果代码中我们不用 tryLock() 方法,比如有两个线程同时调用这个方法，传入的 lock1 和 lock2 恰好是相反的，那么如果第一个线程获取了 lock1 的同时，第二个线程获取了 lock2，它们接下来便会尝试获取对方持有的那把锁，但是又获取不到，于是便会陷入死锁，使用tryLock()后，如果获取到了 lock1 但没有获取到 lock2，那么也会释放掉 lock1</p>
</li>
<li><p>tryLock(long time, TimeUnit unit)</p>
<p>使用 tryLock(long time, TimeUnit unit) 时，在等待了一段指定的超时时间后，线程会主动放弃这把锁的获取，避免永久等待；在等待的期间，也可以随时中断线程，这就避免了死锁的发生。</p>
</li>
<li><p>lockInterruptibly()</p>
<p>如果这个锁当前是可以获得的，那么这个方法会立刻返回,，但是如果这个锁当前是不能获得的（被其他线程持有），那么当前线程便会开始等待，除非它等到了这把锁或者是在等待的过程中被Thread的interrupt()方法中断了，否则这个线程便会一直在这里执行这行代码。一直尝试获取直到获取到为止。</p>
<p>相比于不能响应中断的 synchronized 锁，lockInterruptibly() 可以让程序更灵活，可以在获取锁的同时，保持对中断的响应。我们可以把这个方法理解为超时时间是无穷长的 tryLock(long time, TimeUnit unit)，因为 tryLock(long time, TimeUnit unit) 和 lockInterruptibly() 都能响应中断，只不过 lockInterruptibly() 永远不会超时。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lockInterruptibly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           lock.lockInterruptibly();</span><br><span class="line">           <span class="keyword">try</span> &#123;</span><br><span class="line">               System.out.println(<span class="string">&quot;操作资源&quot;</span>);</span><br><span class="line">           &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">               lock.unlock();</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>unlock()</p>
<p>最后要介绍的方法是 unlock() 方法，是用于解锁的，u方法比较简单，对于 ReentrantLock 而言，执行 unlock() 的时候，内部会把锁的“被持有计数器”减 1，直到减到 0 就代表当前这把锁已经完全释放了，如果减 1 后计数器不为 0，说明这把锁之前被“重入”了，那么锁并没有真正释放，仅仅是减少了持有的次数。</p>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://www.yinxiang.com/everhub/note/c27d346d-ed4d-4e7b-aef9-0b501a44deb7">https://www.yinxiang.com/everhub/note/c27d346d-ed4d-4e7b-aef9-0b501a44deb7</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1NT4y1G7WE?p=5">https://www.bilibili.com/video/BV1NT4y1G7WE?p=5</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1qE411q7fk?p=10">https://www.bilibili.com/video/BV1qE411q7fk?p=10</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/aspirant/p/11470858.html">https://www.cnblogs.com/aspirant/p/11470858.html</a></p>
</li>
</ul>
<h5 id="可重入锁-非可重入锁；"><a href="#可重入锁-非可重入锁；" class="headerlink" title="可重入锁/非可重入锁；"></a>可重入锁/非可重入锁；</h5><p>​    可重入锁 ： 可重入锁指的是线程当前已经持有这把锁了，能在不释放这把锁的情况下，再次获取这把锁。    </p>
<p>​    synchronized是可冲入锁</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">T</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">synchronized</span> <span class="keyword">void</span>  <span class="title">m1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;m1 start&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        m2();</span><br><span class="line">        System.out.println(<span class="string">&quot;m1 end&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">m2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            TimeUnit.SECONDS.sleep(<span class="number">2</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;m2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> T().m1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="name">m1</span> start</span><br><span class="line"><span class="name">m2</span></span><br><span class="line"><span class="name">m1</span> e<span class="symbol">nd</span></span><br></pre></td></tr></table></figure>

<p>如果synchronized不是可重入锁，执行m1()执行m2()会发生死锁,</p>
<p>为什么synchronized必须是可重入锁呢?</p>
<p>如果父类m2()是synchronized方法,子类重写m2()方法，调用子类m2(),接着调用super.m2()就会发生死锁</p>
<h5 id="共享锁-独占锁"><a href="#共享锁-独占锁" class="headerlink" title="共享锁/独占锁"></a>共享锁/独占锁</h5><ul>
<li><p>共享锁</p>
<p>共享锁指的是我们同一把锁可以被多个线程同时获得</p>
</li>
<li><p>独占锁 </p>
<p>这把锁只能同时被一个线程获得</p>
<p>读写锁就最好地诠释了共享锁和独占锁的理念。读写锁中的读锁，是共享锁，而写锁是独占锁。读锁可以被同时读，可以同时被多个线程持有，而写锁最多只能同时被一个线程持有。</p>
</li>
</ul>
<p>整体思路是它有两把锁，第 1 把锁是写锁，获得写锁之后，既可以读数据又可以修改数据，而第 2 把锁是读锁，获得读锁之后，只能查看数据，不能修改数据。读锁可以被多个线程同时持有，所以多个线程可以同时查看数据。</p>
<p>我们在使用读写锁时遵守下面的获取规则：</p>
<ol>
<li>如果有一个线程已经占用了读锁，则此时其他线程如果要申请读锁，可以申请成功。</li>
<li>如果有一个线程已经占用了读锁，则此时其他线程如果要申请写锁，则申请写锁的线程会一直等待释放读锁，因为读写不能同时操作。</li>
<li>如果有一个线程已经占用了写锁，则此时其他线程如果申请写锁或者读锁，都必须等待之前的线程释放写锁，同样也因为读写不能同时，并且两个线程不应该同时写。</li>
</ol>
<p>所以我们用一句话总结：要么是一个或多个线程同时有读锁，要么是一个线程有写锁，但是两者不会同时出现。也可以总结为：读读共享、其他都互斥（写写互斥、读写互斥、写读互斥）。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 描述：     演示读写锁用法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReadWriteLockDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ReentrantReadWriteLock reentrantReadWriteLock = <span class="keyword">new</span> ReentrantReadWriteLock(</span><br><span class="line">            <span class="keyword">false</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ReentrantReadWriteLock.ReadLock readLock = reentrantReadWriteLock</span><br><span class="line">            .readLock();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ReentrantReadWriteLock.WriteLock writeLock = reentrantReadWriteLock</span><br><span class="line">            .writeLock();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        readLock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;得到读锁，正在读取&quot;</span>);</span><br><span class="line">            Thread.sleep(<span class="number">500</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;释放读锁&quot;</span>);</span><br><span class="line">            readLock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        writeLock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;得到写锁，正在写入&quot;</span>);</span><br><span class="line">            Thread.sleep(<span class="number">500</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;释放写锁&quot;</span>);</span><br><span class="line">            writeLock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Thread(() -&gt; read()).start();</span><br><span class="line">        <span class="keyword">new</span> Thread(() -&gt; read()).start();</span><br><span class="line">        <span class="keyword">new</span> Thread(() -&gt; write()).start();</span><br><span class="line">        <span class="keyword">new</span> Thread(() -&gt; write()).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Thread</span>-<span class="number">0</span>得到读锁，正在读取</span><br><span class="line"><span class="attribute">Thread</span>-<span class="number">1</span>得到读锁，正在读取</span><br><span class="line"><span class="attribute">Thread</span>-<span class="number">0</span>释放读锁</span><br><span class="line"><span class="attribute">Thread</span>-<span class="number">1</span>释放读锁</span><br><span class="line"><span class="attribute">Thread</span>-<span class="number">2</span>得到写锁，正在写入</span><br><span class="line"><span class="attribute">Thread</span>-<span class="number">2</span>释放写锁</span><br><span class="line"><span class="attribute">Thread</span>-<span class="number">3</span>得到写锁，正在写入</span><br><span class="line"><span class="attribute">Thread</span>-<span class="number">3</span>释放写锁</span><br></pre></td></tr></table></figure>

<p>读锁可以同时被多个线程获得，而写锁不能。</p>
<p>为什么要对读加锁 :  读本身是线程安全的，加读锁，主要是为了让写锁感知到，在有人读取的时候，不要同时写入。</p>
<p>ReentrantReadWriteLockTest.java</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> static ReentrantReadWriteLock reentrantLock = <span class="keyword">new</span> <span class="constructor">ReentrantReadWriteLock()</span>;</span><br><span class="line"><span class="keyword">private</span> static ReentrantReadWriteLock.ReadLock readLock = reentrantLock.read<span class="constructor">Lock()</span>;</span><br><span class="line"><span class="keyword">private</span> static ReentrantReadWriteLock.WriteLock writeLock = reentrantLock.write<span class="constructor">Lock()</span>;</span><br><span class="line"></span><br><span class="line">public static void read<span class="literal">()</span> &#123;</span><br><span class="line">    readLock.lock<span class="literal">()</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span>.get<span class="constructor">Name()</span> + <span class="string">&quot;获取读锁，开始执行&quot;</span>);</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>sleep(<span class="number">2000</span>);</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">        e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">        readLock.unlock<span class="literal">()</span>;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span>.get<span class="constructor">Name()</span> + <span class="string">&quot;释放读锁&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">public static void write<span class="literal">()</span> &#123;</span><br><span class="line">    writeLock.lock<span class="literal">()</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span>.get<span class="constructor">Name()</span> + <span class="string">&quot;获取写锁，开始执行&quot;</span>);</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>sleep(<span class="number">2000</span>);</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">        e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">        writeLock.unlock<span class="literal">()</span>;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span>.get<span class="constructor">Name()</span> + <span class="string">&quot;释放写锁&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static void main(String<span class="literal">[]</span> args) &#123;</span><br><span class="line">    <span class="keyword">new</span> <span class="constructor">Thread(()</span> -&gt; read<span class="literal">()</span>, <span class="string">&quot;Thread1&quot;</span>).start<span class="literal">()</span>;</span><br><span class="line">    <span class="keyword">new</span> <span class="constructor">Thread(()</span> -&gt; read<span class="literal">()</span>, <span class="string">&quot;Thread2&quot;</span>).start<span class="literal">()</span>;</span><br><span class="line">    <span class="keyword">new</span> <span class="constructor">Thread(()</span> -&gt; write<span class="literal">()</span>, <span class="string">&quot;Thread3&quot;</span>).start<span class="literal">()</span>;</span><br><span class="line">    <span class="keyword">new</span> <span class="constructor">Thread(()</span> -&gt; write<span class="literal">()</span>, <span class="string">&quot;Thread4&quot;</span>).start<span class="literal">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果:</p>
<p><u>Thread1获取读锁，开始执行<br>Thread2获取读锁，开始执行<br>Thread1释放读锁<br>Thread2释放读锁<br>Thread3获取写锁，开始执行<br>Thread3释放写锁<br>Thread4获取写锁，开始执行<br>Thread4释放写锁</u></p>
<p>线程1和线程2可以同时获取读锁，而线程3和线程4只能依次获取写锁，因为线程4必须等待线程3释放写锁后才能获取到锁</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/fanrenxiang/article/details/104312606">https://blog.csdn.net/fanrenxiang/article/details/104312606</a></p>
<h5 id="公平锁-非公平锁；"><a href="#公平锁-非公平锁；" class="headerlink" title="公平锁/非公平锁；"></a>公平锁/非公平锁；</h5><ul>
<li><p>公平锁 </p>
<p>线程就都会进入等待，开始排队，在等待队列里等待时间长的线程会优先拿到这把锁，有先来先得的意思，公平锁指的是按照线程请求的顺序，来分配锁</p>
</li>
<li><p>非公平锁</p>
<p>它会在一定情况下，忽略掉已经在排队的线程，发生插队现象，而非公平锁指的是不完全按照请求的顺序，在一定情况下，可以允许插队</p>
<p>公平锁 <code>new ReentrantLock(false);</code></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FairAndUnfair</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;</span><br><span class="line">        PrintQueue printQueue = <span class="keyword">new</span> PrintQueue();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Thread thread[] = <span class="keyword">new</span> Thread[<span class="number">10</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            thread[i] = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Job(printQueue), <span class="string">&quot;Thread &quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            thread[i].start();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">100</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Job</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> PrintQueue printQueue;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Job</span><span class="params">(PrintQueue printQueue)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.printQueue = printQueue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.printf(<span class="string">&quot;%s: Going to print a job\n&quot;</span>, Thread.currentThread().getName());</span><br><span class="line">        printQueue.printJob(<span class="keyword">new</span> Object());</span><br><span class="line">        System.out.printf(<span class="string">&quot;%s: The document has been printed\n&quot;</span>, Thread.currentThread().getName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PrintQueue</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Lock queueLock = <span class="keyword">new</span> ReentrantLock(<span class="keyword">false</span>); <span class="comment">//非公平锁</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printJob</span><span class="params">(Object document)</span> </span>&#123;</span><br><span class="line">        queueLock.lock();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Long duration = (<span class="keyword">long</span>) (Math.random() * <span class="number">10000</span>);</span><br><span class="line">            System.out.printf(<span class="string">&quot;%s: PrintQueue: Printing a Job during %d seconds\n&quot;</span>,</span><br><span class="line">                    Thread.currentThread().getName(), (duration / <span class="number">1000</span>));</span><br><span class="line">            Thread.sleep(duration);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            queueLock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        queueLock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Long duration = (<span class="keyword">long</span>) (Math.random() * <span class="number">10000</span>);</span><br><span class="line">            System.out.printf(<span class="string">&quot;%s: PrintQueue: Printing a Job during %d seconds\n&quot;</span>,</span><br><span class="line">                    Thread.currentThread().getName(), (duration / <span class="number">1000</span>));</span><br><span class="line">            Thread.sleep(duration);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            queueLock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>​        运行结果</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Thread</span> <span class="number">0</span>: Going to print a job</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">0</span>: PrintQueue: Printing a Job during <span class="number">8</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">1</span>: Going to print a job</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">2</span>: Going to print a job</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">3</span>: Going to print a job</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">4</span>: Going to print a job</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">5</span>: Going to print a job</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">6</span>: Going to print a job</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">7</span>: Going to print a job</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">8</span>: Going to print a job</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">9</span>: Going to print a job</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">0</span>: PrintQueue: Printing a Job during <span class="number">2</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">0</span>: The document has been printed</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">1</span>: PrintQueue: Printing a Job during <span class="number">8</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">1</span>: PrintQueue: Printing a Job during <span class="number">8</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">1</span>: The document has been printed</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">2</span>: PrintQueue: Printing a Job during <span class="number">7</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">2</span>: PrintQueue: Printing a Job during <span class="number">5</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">2</span>: The document has been printed</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">3</span>: PrintQueue: Printing a Job during <span class="number">5</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">3</span>: PrintQueue: Printing a Job during <span class="number">0</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">3</span>: The document has been printed</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">4</span>: PrintQueue: Printing a Job during <span class="number">5</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">4</span>: PrintQueue: Printing a Job during <span class="number">9</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">4</span>: The document has been printed</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">5</span>: PrintQueue: Printing a Job during <span class="number">6</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">5</span>: PrintQueue: Printing a Job during <span class="number">6</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">5</span>: The document has been printed</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">6</span>: PrintQueue: Printing a Job during <span class="number">1</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">6</span>: PrintQueue: Printing a Job during <span class="number">5</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">6</span>: The document has been printed</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">7</span>: PrintQueue: Printing a Job during <span class="number">1</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">7</span>: PrintQueue: Printing a Job during <span class="number">1</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">7</span>: The document has been printed</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">8</span>: PrintQueue: Printing a Job during <span class="number">6</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">8</span>: PrintQueue: Printing a Job during <span class="number">1</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">8</span>: The document has been printed</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">9</span>: PrintQueue: Printing a Job during <span class="number">1</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">9</span>: PrintQueue: Printing a Job during <span class="number">0</span> seconds</span><br><span class="line"><span class="attribute">Thread</span> <span class="number">9</span>: The document has been printed</span><br></pre></td></tr></table></figure>

<p>可以看到thread1释放锁后又重新获取到锁</p>
<p>​    ReentrantLockTest.java</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="keyword">COUNT</span> = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> start = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">static</span> ReentrantLock lock = <span class="keyword">new</span> ReentrantLock(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) &#123;</span><br><span class="line">    Runnable <span class="keyword">task</span> = () -&gt; &#123;</span><br><span class="line">        <span class="keyword">for</span> (; ; ) &#123;</span><br><span class="line">            lock.lock();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (start &lt;= <span class="keyword">COUNT</span>) &#123;</span><br><span class="line">                    System.out.<span class="keyword">println</span>(Thread.currentThread().getName() + <span class="string">&quot;=&gt; &quot;</span> + start++);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    System.exit(<span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                lock.unlock();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">new</span> Thread(<span class="keyword">task</span>).start();</span><br><span class="line">    <span class="keyword">new</span> Thread(<span class="keyword">task</span>).start();</span><br></pre></td></tr></table></figure>

<p>运行结果:</p>
<br>

<p>Thread-0=&gt; 1<br>Thread-1=&gt; 2<br>Thread-0=&gt; 3<br>Thread-1=&gt; 4<br>…<br>Thread-1=&gt; 36<br>Thread-1=&gt; 37<br>Thread-1=&gt; 38<br>Thread-1=&gt; 39</p>
<p>Thread-1=&gt; 40<br>Thread-1=&gt; 41<br>Thread-1=&gt; 42<br>Thread-1=&gt; 43<br>Thread-1=&gt; 44<br>Thread-1=&gt; 45<br>Thread-1=&gt; 46<br>Thread-1=&gt; 47<br>Thread-1=&gt; 48</p>
<br>

<p>Otherwise this lock does not guarantee any particular access order.可见公平锁不保证有序。</p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903983308341261">https://juejin.cn/post/6844903983308341261</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/ReentrantLock.html">https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/ReentrantLock.html</a></p>
<h5 id="悲观锁-乐观锁；"><a href="#悲观锁-乐观锁；" class="headerlink" title="悲观锁/乐观锁；"></a>悲观锁/乐观锁；</h5><ol>
<li><p>悲观锁</p>
<blockquote>
<p>必须先拿到锁，以便达到“独占”的状态，当前线程在操作资源的时候，其他线程由于不能拿到锁.</p>
<p>它认为如果不锁住这个资源，别的线程就会来争抢，就会造成数据结果错误，所以悲观锁为了确保结果的正确性，会在每次获取并修改数据时，都把数据锁住，让其他线程无法访问该数据，这样就可以确保数据内容万无一失。</p>
<p>Java 中悲观锁的实现包括 synchronized 关键字和 Lock 相关类等，我们以 Lock 接口为例，例如 Lock 的实现类 ReentrantLock，类中的 lock() 等方法就是执行加锁，而 unlock() 方法是执行解锁。处理资源之前必须要先加锁并拿到锁，等到处理完了之后再解开锁，这就是非常典型的悲观锁思想。</p>
</blockquote>
<p>synchronized 关键字和 Lock 接口</p>
<p>大喜大悲：数据库</p>
<blockquote>
<p>数据库中同时拥有悲观锁和乐观锁的思想。例如，我们如果在 MySQL 选择 select for update 语句，那就是悲观锁，在提交之前不允许第三方来修改该数据，这当然会造成一定的性能损耗，在高并发的情况下是不可取的</p>
<p>相反，我们可以利用一个版本 version 字段在数据库中实现乐观锁。在获取及修改数据时都不需要加锁，但是我们在获取完数据并计算完毕，准备更新数据时，会检查版本号和获取数据时的版本号是否一致，如果一致就直接更新，如果不一致，说明计算期间已经有其他线程修改过这个数据了，那我就可以选择重新获取数据，重新计算，然后再次尝试更新数据。</p>
</blockquote>
</li>
</ol>
<ol start="2">
<li>乐观锁</li>
</ol>
<p>利用 CAS 理念，在不独占资源的情况下，完成了对资源的修改。</p>
<p>为了确保数据正确性，在更新之前，会去对比在我修改数据期间，数据有没有被其他线程修改过：如果没被修改过，就说明真的只有我自己在操作，那我就可以正常的修改数据；如果发现数据和我一开始拿到的不一样了，说明其他线程在这段时间内修改过数据，那说明我迟了一步，所以我会放弃这次修改，并选择报错、重试等策略。</p>
<p>​    </p>
<h5 id="自旋锁-非自旋锁；"><a href="#自旋锁-非自旋锁；" class="headerlink" title="自旋锁/非自旋锁；"></a>自旋锁/非自旋锁；</h5><ul>
<li><p>自旋锁</p>
<p>自旋锁的理念是如果线程现在拿不到锁，并不直接陷入阻塞或者释放 CPU 资源，而是开始利用循环，不停地尝试获取锁，这个循环过程被形象地比喻为“自旋”</p>
<p>阻塞和唤醒线程都是需要高昂的开销的，如果同步代码块中的内容不复杂，那么可能转换线程带来的开销比实际业务代码执行的开销还要大。</p>
</li>
<li><p>非自旋锁</p>
<p>如果它发现此时获取不到锁，它就把自己的线程切换状态，让线程休眠，然后 CPU 就可以在这段时间去做很多其他的事情，直到之前持有这把锁的线程释放了锁，于是 CPU 再把之前的线程恢复回来，让这个线程再去尝试获取这把锁。</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 持有锁的线程，null表示锁未被线程持有</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> AtomicReference&lt;Thread&gt; ref = <span class="keyword">new</span> AtomicReference&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lock</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Thread currentThread = Thread.currentThread();</span><br><span class="line">    <span class="keyword">while</span>(!ref.compareAndSet(<span class="keyword">null</span>, currentThread))&#123;</span><br><span class="line">        <span class="comment">//当ref为null的时候compareAndSet返回true，反之为false</span></span><br><span class="line">        <span class="comment">//通过循环不断的自旋判断锁是否被其他线程持有</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unLock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Thread cur = Thread.currentThread();</span><br><span class="line">    <span class="keyword">if</span>(ref.get() != cur)&#123;</span><br><span class="line">        <span class="comment">//exception ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    ref.set(<span class="keyword">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> count  = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">    ExecutorService executorService = Executors.newFixedThreadPool(<span class="number">100</span>);</span><br><span class="line">    CountDownLatch countDownLatch = <span class="keyword">new</span> CountDownLatch(<span class="number">100</span>);</span><br><span class="line">    SimpleSpinningLock simpleSpinningLock = <span class="keyword">new</span> SimpleSpinningLock();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">100</span> ; i++)&#123;</span><br><span class="line">        executorService.execute(() -&gt; &#123;</span><br><span class="line">            simpleSpinningLock.lock();</span><br><span class="line">            ++count;</span><br><span class="line">            simpleSpinningLock.unLock();</span><br><span class="line">            countDownLatch.countDown();</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    countDownLatch.await();</span><br><span class="line">    System.out.println(count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="可中断锁-不可中断锁。"><a href="#可中断锁-不可中断锁。" class="headerlink" title="可中断锁/不可中断锁。"></a>可中断锁/不可中断锁。</h5><p>第 7 种分类是可中断锁和不可中断锁。在 Java 中，synchronized 关键字修饰的锁代表的是不可中断锁，一旦线程申请了锁，就没有回头路了，只能等到拿到锁以后才能进行其他的逻辑处理。而我们的 ReentrantLock 是一种典型的可中断锁，例如使用 lockInterruptibly 方法在获取锁的过程中，突然不想获取了，那么也可以在中断之后去做其他的事情，不需要一直傻等到获取到锁才离开。</p>
<h4 id="死锁"><a href="#死锁" class="headerlink" title="死锁"></a>死锁</h4><ul>
<li>条件</li>
</ul>
<ol>
<li>互斥条件 :   任务使用的资源至少有一个是不能共享的；chopstick一次只能被一个Philosopher使用</li>
<li>请求保持条件:   至少有一个任务必须持有跟一个资源且正在等待获取一个当前被别的任务持有的资源</li>
<li>不可剥夺条件:  资源不能被任务抢占</li>
<li>环路等待条件:  必须有循环等待。一个任务等待其他任务所持有的资源，后者又等待另一个任务所持有的资源,使得大家都被锁住.</li>
</ol>
<p><strong>当两个（或多个）线程（或进程）相互持有对方所需要的资源，却又都不主动释放自己手中所持有的资源，导致大家都获取不到自己想要的资源</strong></p>
<p>那么为什么会产生死锁呢? 学过操作系统的朋友应该都知道，死锁的产生必须具备以<br>下四个条件 。</p>
<ol>
<li>互斥条件: 指线程对己经获取到的资源进行排它性使用 ，即该资源同时只由 一个线<br>程占用。如果 此时 还有其 他 线程请求获取该资源 ，则 请求者只能等待，直至占有资<br>源 的 线程释放该资源。</li>
<li>.请求并持有条件 : 指一个线程己经持有了至少一个资源，但又提出了新的资源请求，<br>而新资源己被其 他 线程占有，所 以 当前线程会被阻塞 ，但 阻塞 的同时 并不释放自 己<br>己经获取的资源。</li>
<li>不可剥夺条件 : 指线程获取到的资源在自己使用完之前不能被其他线程抢占 ， 只有在自己使用完 毕后才 由 自 己释放该资源。</li>
<li>环路等待条件 : 指在发生死锁时 ，必然存在一个线程→资源的环形链 ，即线程集合<br>{TO,TLT2，…，Tn}中的TO正在等待一个Tl占用的资源， Tl正在等待T2占 用的资源，……Tn正在等待己被 TO 占用的资源。</li>
</ol>
<h5 id="避免死锁"><a href="#避免死锁" class="headerlink" title="避免死锁"></a>避免死锁</h5><p>要想避免死锁，只需要破坏掉至少一个构造死锁的必要条件即可， 但是学过操作系统</p>
<p>的读者应该都知道，目前只有请求并持有和环路等待条件是可 以被破坏 的。<br>造成死锁的原因其实和申请资源的顺序有很大关系 ，</p>
<h4 id="经典的哲学家吃饭问题"><a href="#经典的哲学家吃饭问题" class="headerlink" title="经典的哲学家吃饭问题"></a>经典的哲学家吃饭问题</h4><p> 5位哲学家 ，5只筷子在他们之间.    </p>
<ul>
<li><p>筷子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Chopstick</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> taken = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> number;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNumber</span><span class="params">(<span class="keyword">int</span> number)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.number = number;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> number;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">take</span><span class="params">(<span class="keyword">int</span> numChop)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (taken) &#123;</span><br><span class="line">            Print.print(numChop+<span class="string">&quot;   wait&quot;</span>);</span><br><span class="line">            wait();</span><br><span class="line">        &#125;</span><br><span class="line">        taken = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">drop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        taken = <span class="keyword">false</span>;</span><br><span class="line">        notifyAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>哲学家 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Philosopher</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Chopstick left;</span><br><span class="line">    <span class="keyword">private</span> Chopstick right;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> ponderFactor;</span><br><span class="line">    <span class="keyword">private</span> Random rand = <span class="keyword">new</span> Random(<span class="number">47</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pause</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ponderFactor == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">        TimeUnit.MILLISECONDS.sleep(rand.nextInt(ponderFactor * <span class="number">250</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Philosopher</span><span class="params">(Chopstick left, Chopstick right, <span class="keyword">int</span> id, <span class="keyword">int</span> ponderFactor)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.ponderFactor = ponderFactor;</span><br><span class="line">        <span class="keyword">this</span>.left = left;</span><br><span class="line">        <span class="keyword">this</span>.right = right;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (!Thread.interrupted()) &#123;</span><br><span class="line">                Print.print(<span class="keyword">this</span> + <span class="string">&quot; &quot;</span> + <span class="string">&quot;need thinking &quot;</span> + ponderFactor + <span class="string">&quot;    毫秒&quot;</span>);</span><br><span class="line">                pause();</span><br><span class="line">                <span class="comment">//Philosopher becomes hungry</span></span><br><span class="line">                Print.print(<span class="keyword">this</span> + <span class="string">&quot;  &quot;</span> + <span class="string">&quot;grabbing right  第&quot;</span> + (id + <span class="number">1</span>) + <span class="string">&quot;  号筷子&quot;</span>);</span><br><span class="line">                right.take(id + <span class="number">1</span>);</span><br><span class="line"><span class="comment">//                if (id == 2) &#123;</span></span><br><span class="line"><span class="comment">//                    System.out.println(right.taken);</span></span><br><span class="line"><span class="comment">//                &#125;</span></span><br><span class="line">                pause();            <span class="comment">//拿起右边的筷子进入等待状态</span></span><br><span class="line">                Print.print(<span class="keyword">this</span> + <span class="string">&quot; .&quot;</span> + <span class="string">&quot;try grabbing left   第  &quot;</span> + (id) + <span class="string">&quot;  号筷子&quot;</span>);  <span class="comment">//尝试拿起左边的筷子</span></span><br><span class="line">                left.take(id);</span><br><span class="line">                Print.print(<span class="keyword">this</span> + <span class="string">&quot; &quot;</span> + <span class="string">&quot;eating&quot;</span>);</span><br><span class="line">                pause();</span><br><span class="line">                right.drop();</span><br><span class="line">                left.drop();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            Print.print(<span class="keyword">this</span> + <span class="string">&quot; &quot;</span> + <span class="string">&quot;exiting via interrupt&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Philosopher&quot;</span> + id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>运行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeadlockingDiningPhilosophers</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ponder = <span class="number">5</span>; <span class="comment">//默认 Philosopher思考的时间</span></span><br><span class="line">        <span class="keyword">if</span> (args.length &gt; <span class="number">0</span>)</span><br><span class="line">            ponder = Integer.parseInt(args[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">int</span> size = <span class="number">5</span>;  <span class="comment">//默认筷子的个数</span></span><br><span class="line">        <span class="keyword">if</span> (args.length &gt; <span class="number">1</span>)</span><br><span class="line">            size = Integer.parseInt(args[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">        ExecutorService exec = Executors.newCachedThreadPool();</span><br><span class="line">        Chopstick[] sticks = <span class="keyword">new</span> Chopstick[size];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">            sticks[i] = <span class="keyword">new</span> Chopstick();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">            exec.execute(<span class="keyword">new</span> Philosopher(sticks[i], sticks[(i + <span class="number">1</span>) % size], i, ponder));</span><br><span class="line"></span><br><span class="line"><span class="comment">//        if (args.length == 3 &amp;&amp; args[2].equals(&quot;timeout&quot;))</span></span><br><span class="line">        TimeUnit.SECONDS.sleep(<span class="number">5</span>);</span><br><span class="line"><span class="comment">//        else &#123;</span></span><br><span class="line"><span class="comment">//            System.out.println(&quot;Press &#x27;&#x27;Enter to quit&quot;);</span></span><br><span class="line"><span class="comment">//            System.in.read();</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"></span><br><span class="line">        exec.shutdownNow();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>结果</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Philosopher0</span> need thinking <span class="number">5</span>    毫秒</span><br><span class="line"><span class="attribute">Philosopher3</span> need thinking <span class="number">5</span>    毫秒</span><br><span class="line"><span class="attribute">Philosopher2</span> need thinking <span class="number">5</span>    毫秒</span><br><span class="line"><span class="attribute">Philosopher1</span> need thinking <span class="number">5</span>    毫秒</span><br><span class="line"><span class="attribute">Philosopher4</span> need thinking <span class="number">5</span>    毫秒</span><br><span class="line"><span class="attribute">Philosopher0</span>  grabbing right  第<span class="number">1</span>  号筷子</span><br><span class="line"><span class="attribute">Philosopher3</span>  grabbing right  第<span class="number">4</span>  号筷子</span><br><span class="line"><span class="attribute">Philosopher2</span>  grabbing right  第<span class="number">3</span>  号筷子</span><br><span class="line"><span class="attribute">Philosopher1</span>  grabbing right  第<span class="number">2</span>  号筷子</span><br><span class="line"><span class="attribute">Philosopher4</span>  grabbing right  第<span class="number">5</span>  号筷子</span><br><span class="line"><span class="attribute">Philosopher0</span> .try grabbing left   第  <span class="number">0</span>  号筷子</span><br><span class="line"><span class="attribute">Philosopher3</span> .try grabbing left   第  <span class="number">3</span>  号筷子</span><br><span class="line"><span class="attribute">Philosopher2</span> .try grabbing left   第  <span class="number">2</span>  号筷子</span><br><span class="line"><span class="attribute">Philosopher1</span> .try grabbing left   第  <span class="number">1</span>  号筷子</span><br><span class="line"><span class="attribute">Philosopher4</span> .try grabbing left   第  <span class="number">4</span>  号筷子</span><br><span class="line"><span class="attribute">2</span>   wait</span><br><span class="line"><span class="attribute">3</span>   wait</span><br><span class="line"><span class="attribute">4</span>   wait</span><br><span class="line"><span class="attribute">0</span>   wait</span><br><span class="line"><span class="attribute">1</span>   wait</span><br><span class="line"><span class="attribute">Philosopher1</span> exiting via interrupt</span><br><span class="line"><span class="attribute">Philosopher4</span> exiting via interrupt</span><br><span class="line"><span class="attribute">Philosopher0</span> exiting via interrupt</span><br><span class="line"><span class="attribute">Philosopher3</span> exiting via interrupt</span><br><span class="line"><span class="attribute">Philosopher2</span> exiting via interrupt</span><br></pre></td></tr></table></figure>



<h4 id="银行转账问题"><a href="#银行转账问题" class="headerlink" title="银行转账问题"></a>银行转账问题</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TransferMoney</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flag;</span><br><span class="line">    <span class="keyword">static</span> Account a = <span class="keyword">new</span> Account(<span class="number">800</span>);</span><br><span class="line">    <span class="keyword">static</span> Account b = <span class="keyword">new</span> Account(<span class="number">600</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Account</span><span class="params">(<span class="keyword">int</span> balance)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.balance = balance;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> balance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (flag == <span class="number">1</span>) &#123;</span><br><span class="line">            transferMoney(a, b, <span class="number">200</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (flag == <span class="number">0</span>) &#123;</span><br><span class="line">            transferMoney(b, a, <span class="number">200</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">transferMoney</span><span class="params">(Account from, Account to, <span class="keyword">int</span> amount)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//先获取两把锁，然后开始转账</span></span><br><span class="line">        <span class="keyword">int</span> fromHash = System.identityHashCode(from);</span><br><span class="line">        <span class="keyword">int</span> toHash = System.identityHashCode(to);</span><br><span class="line">        System.out.println(Thread.currentThread().getName() +  <span class="string">&quot;  fromHash &lt; toHash &quot;</span>+(fromHash &lt; toHash));</span><br><span class="line">        <span class="keyword">if</span> (fromHash &lt; toHash) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (from) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot; 获得锁A    &quot;</span> + from.balance);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">synchronized</span> (to) &#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">&quot; 获得锁B    &quot;</span> + to.balance);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (from.balance - amount &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                        System.out.println(Thread.currentThread().getName() + <span class="string">&quot; 余额不足，转账失败。&quot;</span>);</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"><span class="comment">//                    from.balance -= amount;</span></span><br><span class="line"><span class="comment">//                    to.balance += amount;</span></span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">&quot; 成功转账&quot;</span> + amount + <span class="string">&quot;元&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (fromHash &gt; toHash) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (to) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot; 获得锁A    &quot;</span> + to.balance);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">synchronized</span> (from) &#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">&quot; 获得锁B    &quot;</span> + from.balance);</span><br><span class="line">                    <span class="keyword">if</span> (from.balance - amount &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;  余额不足，转账失败。&quot;</span>);</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"><span class="comment">//                    from.balance -= amount;</span></span><br><span class="line"><span class="comment">//                    to.balance += amount;</span></span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">&quot;   成功转账&quot;</span> + amount + <span class="string">&quot;元&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        TransferMoney r1 = <span class="keyword">new</span> TransferMoney();</span><br><span class="line">        TransferMoney r2 = <span class="keyword">new</span> TransferMoney();</span><br><span class="line">        r1.flag = <span class="number">1</span>;</span><br><span class="line">        r2.flag = <span class="number">0</span>;</span><br><span class="line">        Thread t1 = <span class="keyword">new</span> Thread(r1, <span class="string">&quot;t1&quot;</span>);</span><br><span class="line">        Thread t2 = <span class="keyword">new</span> Thread(r2, <span class="string">&quot;t2&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t1.join();</span><br><span class="line">        t2.join();</span><br><span class="line"><span class="comment">//        System.out.println(&quot;a的余额&quot; + a.balance);</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;b的余额&quot; + b.balance);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>打印结构</p>
<blockquote>
<p>t1 fromHash 1967932108 toHash 2072748565  fromHash &lt; toHash true<br>t2 fromHash 2072748565 toHash 1967932108  fromHash &lt; toHash false<br>t1 获得锁A<br>t1 获得锁B<br>t1 成功转账200元<br>t2 获得锁B<br>t2 获得锁A<br>t2   成功转账200元<br>a的余额500</p>
<h4 id="b的余额500"><a href="#b的余额500" class="headerlink" title="b的余额500"></a>b的余额500</h4></blockquote>
<ol>
<li><p><strong>使用 HashCode 的值来决定顺序</strong></p>
<p>主要思想是，两个线程都先获取 锁A,再获取锁B,这样就不会有死锁了</p>
</li>
<li><p><strong>主键 ID 具有唯一、不重复的特点</strong></p>
<p>由主键 ID 大小来决定获取锁的顺序，就可以确保避免死锁。</p>
</li>
</ol>
</li>
</ul>
<h5 id="CAS"><a href="#CAS" class="headerlink" title="CAS"></a>CAS</h5><p>AtomicStampedReference 在变量前面添加版本号，每次变量更新的时候都把版本号加1</p>
<h5 id="AQS"><a href="#AQS" class="headerlink" title="AQS"></a>AQS</h5><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/dennyzhangdd/p/7218510.html">https://www.cnblogs.com/dennyzhangdd/p/7218510.html</a></p>
<h5 id="信号量"><a href="#信号量" class="headerlink" title="信号量"></a>信号量</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SemaphoreTestMain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Semaphore sSemaphore = <span class="keyword">new</span> Semaphore(<span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span>  </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">final</span> SemaphoreTestMain semaphoreTestMain = <span class="keyword">new</span> SemaphoreTestMain();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">1000</span>;i++)</span><br><span class="line">            &#123;</span><br><span class="line">               Thread myThread = <span class="keyword">new</span> Thread()</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">super</span>.run();</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            semaphoreTestMain.test();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;;</span><br><span class="line">               myThread.setName(<span class="string">&quot;threat index:&quot;</span> + i);</span><br><span class="line">                myThread.start();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        sSemaphore.acquire();</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;--in&quot;</span>);</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;--out&quot;</span> );</span><br><span class="line">        sSemaphore.release();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1B7411L7tE">https://www.bilibili.com/video/BV1B7411L7tE</a></p>
<p><a target="_blank" rel="noopener" href="https://tech.meituan.com/2018/11/15/java-lock.html">https://tech.meituan.com/2018/11/15/java-lock.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/javazejian/article/details/72828483#t2">https://blog.csdn.net/javazejian/article/details/72828483#t2</a></p>
<p><a target="_blank" rel="noopener" href="https://tech.meituan.com/2018/11/15/java-lock.html">https://tech.meituan.com/2018/11/15/java-lock.html</a></p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/page/11/index.html">http://noteforme.github.io.com/page/11/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/concurrency/" rel="tag">concurrency</a></li></ul>

          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-CaptureApp" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/04/21/CaptureApp/">CaptureApp</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-04-21T05:24:41.000Z" itemprop="datePublished">2018年04月21日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/TOOL/">TOOL</a>
  </div>

      
      
<a href="/2018/04/21/CaptureApp/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Fiddler"><a href="#Fiddler" class="headerlink" title="Fiddler"></a>Fiddler</h2><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/4a8dae519efe">https://www.jianshu.com/p/4a8dae519efe</a><br><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/99b6b4cd273c">https://www.jianshu.com/p/99b6b4cd273c</a></p>
<h2 id="WireShark"><a href="#WireShark" class="headerlink" title="WireShark"></a>WireShark</h2><p>安装<br><a target="_blank" rel="noopener" href="https://www.linuxidc.com/Linux/2016-08/134526.htm">https://www.linuxidc.com/Linux/2016-08/134526.htm</a></p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/wangqiguo/p/4529250.html">http://www.cnblogs.com/wangqiguo/p/4529250.html</a><br><a target="_blank" rel="noopener" href="http://www.cnblogs.com/TankXiao/archive/2012/10/10/2711777.html">http://www.cnblogs.com/TankXiao/archive/2012/10/10/2711777.html</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5cc313755188252d6f11b463">https://juejin.im/post/5cc313755188252d6f11b463</a></p>
<p>手机抓包</p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5ddddd2a6fb9a07161483fb2">https://juejin.im/post/5ddddd2a6fb9a07161483fb2</a></p>
<p>Charles抓包</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/e8dd1091d6d7">https://www.jianshu.com/p/e8dd1091d6d7</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ievjai/p/13512326.html">https://www.cnblogs.com/ievjai/p/13512326.html</a></p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/page/11/index.html">http://noteforme.github.io.com/page/11/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Generics" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/04/16/Generics/">Generics</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-04-16T06:36:29.000Z" itemprop="datePublished">2018年04月16日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/JAVA/">JAVA</a>
  </div>

      
      
<a href="/2018/04/16/Generics/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="泛型类"><a href="#泛型类" class="headerlink" title="泛型类"></a>泛型类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Order</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    String orderName;</span><br><span class="line">    <span class="keyword">int</span> orderId;</span><br><span class="line"></span><br><span class="line">    T orderT;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Order</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Order</span><span class="params">(String orderName, <span class="keyword">int</span> orderId, T orderT)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.orderName = orderName;</span><br><span class="line">        <span class="keyword">this</span>.orderId = orderId;</span><br><span class="line">        <span class="keyword">this</span>.orderT = orderT;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getOrderT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orderT;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrderT</span><span class="params">(T orderT)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.orderT = orderT;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="子类不是泛型类"><a href="#子类不是泛型类" class="headerlink" title="子类不是泛型类"></a>子类不是泛型类</h5><p> 父类指明类型,由于子类在继承带泛型的父类时，指明了泛型类型，则实例化子类对象时，不再需要指明泛型。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubOrder</span> <span class="keyword">extends</span> <span class="title">Order</span>&lt;<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//由于子类在继承带泛型的父类时，指明了泛型类型，则实例化子类对象时，不再需要指明泛型。</span></span><br><span class="line">        SubOrder subOrder = <span class="keyword">new</span> SubOrder();</span><br><span class="line">        subOrder.setOrderT(<span class="number">1122</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>



<h5 id="子父类关系"><a href="#子父类关系" class="headerlink" title="子父类关系"></a>子父类关系</h5><p>类A是类B的父类，G<A>和G<B>二者不具备父子类关系,也不具任何关系。</B></A></p>
<p>类A是类B的父类，A<G>是 B<G>的父类。</G></G></p>
<p>反证法:</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1fi4y1b7NM?p=11">https://www.bilibili.com/video/BV1fi4y1b7NM?p=11</a></p>
<h5 id="子类是泛型类"><a href="#子类是泛型类" class="headerlink" title="子类是泛型类"></a>子类是泛型类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubOrder1</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">Order</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SubOrder1&lt;String&gt; sub2 = <span class="keyword">new</span> SubOrder1&lt;&gt;();</span><br><span class="line">sub2.setOrderT(<span class="string">&quot;order...&quot;</span>);</span><br></pre></td></tr></table></figure>









<h4 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h4><p>无界通配符 意味着可以使用任何对象，因此使用它类似于使用原生类型</p>
<p>类A是类B的父类，G<A>和G<B>的公共的父类是: G&lt;?&gt;</B></A></p>
<h5 id="遍历List"><a href="#遍历List" class="headerlink" title="遍历List"></a>遍历List</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">      List&lt;Object&gt; list1 = <span class="keyword">null</span>;</span><br><span class="line">      List&lt;String&gt; list2 = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">      List&lt;?&gt; list = <span class="keyword">null</span>;</span><br><span class="line">      list = list1;</span><br><span class="line">      list = list2;</span><br><span class="line"></span><br><span class="line">      print(list1);</span><br><span class="line">      print(list2);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(List&lt;?&gt; list)</span></span>&#123;</span><br><span class="line">      Iterator&lt;?&gt; iterator = list.iterator();</span><br><span class="line">      <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line">          Object o = iterator.next();</span><br><span class="line">          System.out.println(o);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      list.forEach(o -&gt; &#123;</span><br><span class="line">          System.out.println(o);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>对于List<?> 就不能向其添加数据。如果任何类型引用通过赋值给 List<?> 能添加数据，那定义泛型就没意义了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> 		List&lt;?&gt; list = <span class="keyword">null</span>;</span><br><span class="line"> 		ArrayList&lt;String&gt; list3 = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        list3.add(<span class="string">&quot;AA&quot;</span>);</span><br><span class="line">        list3.add(<span class="string">&quot;BB&quot;</span>);</span><br><span class="line">        list3.add(<span class="string">&quot;CC&quot;</span>);</span><br><span class="line">        list = list3;</span><br><span class="line">        <span class="comment">//添加(写入):对于List&lt;?&gt; 就不能向其添加数据，如果能添加数据，那定义泛型就没意义了。</span></span><br><span class="line">        <span class="comment">//除了添加null之外</span></span><br><span class="line"><span class="comment">//        list.add(&quot;MED&quot;);</span></span><br><span class="line"><span class="comment">//        list.add(&quot;?&quot;);</span></span><br><span class="line">        list.add(<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//可以获取数据，读取的数据类型为Object</span></span><br><span class="line">        Object o = list.get(<span class="number">0</span>);</span><br><span class="line">        System.out.println(o);</span><br></pre></td></tr></table></figure>





<h4 id="类型擦除"><a href="#类型擦除" class="headerlink" title="类型擦除"></a>类型擦除</h4><p>Java中的泛型基本上都是在编译器这个层次来实现的。在生成的Java字节码中是不包含泛型中的类型信息的。使用泛型的时候加上的类型参数，会在编译器在编译的时候去掉。这个过程就称为类型擦除。</p>
<p>泛型的作用是能在编译期间就提示错误，而不是运行时。</p>
<p><strong>如果静态方法要使用泛型的话，必须将静态方法也定义成泛型方法</strong> </p>
<figure class="highlight nim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class <span class="type">StaticGenerator</span>&lt;T&gt; &#123;</span><br><span class="line">    ....</span><br><span class="line">    ....</span><br><span class="line">    /**</span><br><span class="line">     * 如果在类中定义使用泛型的静态方法，需要添加额外的泛型声明（将这个方法定义成泛型方法）</span><br><span class="line">     * 即使静态方法要使用泛型类中已经声明过的泛型也不可以。</span><br><span class="line">     * 如：public <span class="keyword">static</span> <span class="built_in">void</span> show(T t)<span class="meta">&#123;..&#125;</span>,此时编译器会提示错误信息：</span><br><span class="line">          <span class="string">&quot;StaticGenerator cannot be refrenced from static context&quot;</span></span><br><span class="line">     */</span><br><span class="line">    public <span class="keyword">static</span> &lt;T&gt; <span class="built_in">void</span> show(T t)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ul>
<li>上界&lt;? extends T&gt;不能往里存，只能往外取，适合频繁往外面读取内容的场景。</li>
<li>下界&lt;? super T&gt;不影响往里存，但往外取只能放在Object对象里，适合经常往里面插入数据的场景。</li>
</ul>
<h5 id="上界通配符-lt-extends-T-gt"><a href="#上界通配符-lt-extends-T-gt" class="headerlink" title="上界通配符    &lt;? extends T&gt;"></a>上界通配符    &lt;? extends T&gt;</h5><p>泛型中的继承</p>
<p>泛型中的继承不是Java中的继承。也就是说java中的父子类关系， 在泛型中 并不是父子类关系。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fruit</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Apple</span> <span class="keyword">extends</span> <span class="title">Fruit</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Plate</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    T item;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="title">Plate</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="title">Plate</span>(<span class="params">T item</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.item = item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> T <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">void</span> <span class="function"><span class="title">set</span>(<span class="params">T item</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.item = item;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2018/04/16/Generics/2020-09-13_at_9.33.25.png" alt="Screen Shot 2020-09-13 at 9.33.25 PM" style="zoom:67%;">

<h6 id="extends-Fruit赋值"><a href="#extends-Fruit赋值" class="headerlink" title="? extends Fruit赋值"></a>? extends Fruit赋值</h6><p>? extends Fruit 可以理解为 &lt;= Fruit</p>
<p>List&lt;? extends Fruit&gt; 可以作为 List<Apple> ， List<Fruit>的父类。</Fruit></Apple></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">        List&lt;? extends Fruit&gt; list1 = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        List&lt;Apple&gt; list3 = <span class="keyword">new</span> ArrayList&lt;&gt;(); <span class="comment">//  ? extends Fruit 可以理解为 &lt;= Fruit</span></span><br><span class="line">        List&lt;Fruit&gt; list4 = <span class="keyword">new</span> ArrayList&lt;&gt;();  <span class="comment">//List&lt;? extends Fruit&gt; 可以作为 List&lt;Apple&gt; ， List&lt;Fruit&gt;的父类。</span></span><br><span class="line">        List&lt;Object&gt; list5 = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">			  list5 = list4; <span class="comment">// 编译不通过,否则泛型就没意义了</span></span><br><span class="line">			</span><br><span class="line">        list1 = list3;</span><br><span class="line">        list1 = list4;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        list1 = list5;    //编译报错，Object类不在 &lt;= Fruit范围内</span></span><br></pre></td></tr></table></figure>



<h6 id="读取数据"><a href="#读取数据" class="headerlink" title="读取数据"></a>读取数据</h6><p>? extends Fruit 所以泛型最大的父类就是Fruit,子类型可以直接复制给父类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> Fruit fruit = list1.get(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Apple apple =list1.get(0); //编译不通过， &lt;= Fruit范围，list1.get(0)可能实际类型是Fruit，是Apple的父类。</span></span><br></pre></td></tr></table></figure>





<blockquote>
<p> <strong>你会发现无法往里面设置任何数据</strong>，按道理说我们将泛型类型设置为? extend Fruit。按理说我们往里面添加Fruit的子类应该是可以的。但是Java编译器不允许这样操作。&lt;? extends Fruit&gt;会使往盘子里放东西的set()方法失效。但取东西get()方法还有效</p>
</blockquote>
<blockquote>
<p> 原因是：Java编译期只知道容器里面存放的是Fruit和它的子类，具体是什么类型不知道，可能是Fruit？可能是Apple？也可能是Banana，RedApple，GreenApple？编译器在后面看到Plate&lt; Apple &gt;赋值以后，盘子里面没有标记为“苹果”。只是标记了一个占位符“CAP#1”，来表示捕获一个Fruit或者Fruit的派生类，具体是什么类型不知道。所有调用代码无论往容器里面插入Apple或者Meat或者Fruit编译器都不知道能不能和这个“CAP#1”匹配，所以这些操作都不允许。</p>
<p>一个Plate&lt;? extends Fruit&gt;的引用，可能是一个Plate <Apple>类型的盘子，要往这个盘子里放<Banana>当然是不被允许的.</Banana></Apple></p>
</blockquote>
<p>但是上界通配符是允许读取操作的。例如代码</p>
<p>这个我们很好理解，由于上界通配符设定容器中只能存放Fruit及其子类，那么获取出来的我们都可以隐式的转为Fruit基类。所以上界描述符Extends适合频繁读取的场景。</p>
<p>Java类型擦除只会擦除到Fruit类型,如果没有指明边界，那么类型参数将被擦除到Object.</p>
<h6 id="写入数据"><a href="#写入数据" class="headerlink" title="写入数据"></a>写入数据</h6><p>可以发现任何数据都不能存入。[-∞,Fruit]范围，-∞不知道具体的类型小到多少</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list1.add(<span class="keyword">new</span> Apple()); <span class="comment">//编译报错，&lt;= Fruit范围， List&lt;? extends Fruit&gt;实际类型可能比是GreenApple,比Apple范围还小，随意存不了数据</span></span><br></pre></td></tr></table></figure>





<h5 id="下界通配符-lt-super-T-gt"><a href="#下界通配符-lt-super-T-gt" class="headerlink" title="下界通配符 &lt;? super T&gt;"></a>下界通配符 &lt;? super T&gt;</h5><p><img src="/2018/04/16/Generics/2020-09-13_at_9.46.10.png" alt="Screen Shot 2020-09-13 at 9.46.10 PM"></p>
<h6 id="super-Fruit赋值"><a href="#super-Fruit赋值" class="headerlink" title="? super Fruit赋值"></a>? super Fruit赋值</h6><p> ? super Fruit 可以理解为 &gt;= Fruit</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> 				List&lt;? extends Fruit&gt; list1 = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        List&lt;Apple&gt; list3 = <span class="keyword">new</span> ArrayList&lt;&gt;(); <span class="comment">//  ? extends Fruit 可以理解为 &lt;= Fruit</span></span><br><span class="line">        List&lt;Fruit&gt; list4 = <span class="keyword">new</span> ArrayList&lt;&gt;();  <span class="comment">//List&lt;? extends Fruit&gt; 可以作为 List&lt;Apple&gt; ， List&lt;Fruit&gt;的父类。</span></span><br><span class="line">        List&lt;Object&gt; list5 = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        List&lt;? <span class="keyword">super</span> Fruit&gt; list2 = <span class="keyword">null</span>;  <span class="comment">//   ? super Fruit 可以理解为 &gt;= Fruit</span></span><br><span class="line"><span class="comment">//       list2 = list3;                    //  编译报错,Apple类不在 &gt;= Fruit范围内</span></span><br><span class="line">        list2 = list4;</span><br><span class="line">        list2 = list5;</span><br></pre></td></tr></table></figure>





<h6 id="读取数据-1"><a href="#读取数据-1" class="headerlink" title="读取数据"></a>读取数据</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Object object = list2.get(<span class="number">0</span>);</span><br><span class="line">        </span><br><span class="line"><span class="comment">//        Food food = list2.get(0); //编译不通过，&gt;=Fruit范围，list2.get(0)实际类型可能是Object,不能赋值给小于它子类，所以只能是Object</span></span><br></pre></td></tr></table></figure>



<h6 id="写入数据-1"><a href="#写入数据-1" class="headerlink" title="写入数据"></a>写入数据</h6><p> ? super Fruit范围是是 [Fruit,+∞), 所以Fruit范围内的都可以添加</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">        list2.add(<span class="keyword">new</span> Fruit());</span><br><span class="line">        list2.add(<span class="keyword">new</span> Apple()); <span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//        list2.add(new Food()); //   ? super Fruit范围是是 [Fruit,+∞), 所以Fruit范围内的都可以添加</span></span><br></pre></td></tr></table></figure>



<p>下界通配符&lt;? super Fruit&gt;不影响往里面存储，但是读取出来的数据只能是Object类型。</p>
<blockquote>
<p>下界通配符规定了元素最小的粒度，必须是Fruit或其基类，那么我往里面存储Fruit及其子类都是可以的，因为它都可以隐式的转化为Fruit类型。但是往外读就不好控制了，里面存储的都是Fruit及其基类，无法转型为任何一种类型，只有Object基类才能装下。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5b614848e51d45355d51f792">https://juejin.im/post/5b614848e51d45355d51f792</a></p>
<p><a target="_blank" rel="noopener" href="http://www.jianshu.com/p/dd34211f2565">www.jianshu.com/p/dd34211f2565</a></p>
<p><a target="_blank" rel="noopener" href="https://itimetraveler.github.io/2016/12/27/%E3%80%90Java%E3%80%91%E6%B3%9B%E5%9E%8B%E4%B8%AD%20extends%20%E5%92%8C%20super%20%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F/">https://itimetraveler.github.io/2016/12/27/%E3%80%90Java%E3%80%91%E6%B3%9B%E5%9E%8B%E4%B8%AD%20extends%20%E5%92%8C%20super%20%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1xJ411n77R?p=7">https://www.bilibili.com/video/BV1xJ411n77R?p=7</a></p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/page/11/index.html">http://noteforme.github.io.com/page/11/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-token" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/03/29/token/">token</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-03-29T09:41:28.000Z" itemprop="datePublished">2018年03月29日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/ANDROID/">ANDROID</a>
  </div>

      
      
<a href="/2018/03/29/token/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="rxjava-方式"><a href="#rxjava-方式" class="headerlink" title="rxjava 方式"></a>rxjava 方式</h4><p><a target="_blank" rel="noopener" href="http://alighters.com/blog/2016/05/02/rxjava-plus-retrofitshi-xian-wang-luo-dai-li/">http://alighters.com/blog/2016/05/02/rxjava-plus-retrofitshi-xian-wang-luo-dai-li/</a><br><a target="_blank" rel="noopener" href="http://alighters.com/blog/2016/08/22/rxjava-plus-retrofitshi-xian-zhi-demo/">http://alighters.com/blog/2016/08/22/rxjava-plus-retrofitshi-xian-zhi-demo/</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_20521573/article/details/76100558">最流行的网络请求框架Rxjava2+Retrofit之Token处理</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/jdsjlzx/article/details/52442113">https://blog.csdn.net/jdsjlzx/article/details/52442113</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_20521573/article/details/76100558">https://blog.csdn.net/qq_20521573/article/details/76100558</a></p>
<h4 id="拦截器做控制"><a href="#拦截器做控制" class="headerlink" title="拦截器做控制"></a>拦截器做控制</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u012771445/article/details/79750648">https://blog.csdn.net/u012771445/article/details/79750648</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/bestlbw/article/details/53984647">https://blog.csdn.net/bestlbw/article/details/53984647</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c325f5c32709">https://www.jianshu.com/p/c325f5c32709</a></p>
<h4 id="RxjavaPlugin处理token"><a href="#RxjavaPlugin处理token" class="headerlink" title="RxjavaPlugin处理token"></a>RxjavaPlugin处理token</h4><p><a target="_blank" rel="noopener" href="https://github.com/ssseasonnn/RxErrorHandler">https://github.com/ssseasonnn/RxErrorHandler</a></p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/page/11/index.html">http://noteforme.github.io.com/page/11/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-RxJava01" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/03/28/RxJava01/">RxJava01</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-03-28T09:58:39.000Z" itemprop="datePublished">2018年03月28日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/ANDROID/">ANDROID</a>
  </div>

      
      
<a href="/2018/03/28/RxJava01/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h5 id="RxJava"><a href="#RxJava" class="headerlink" title="RxJava"></a>RxJava</h5><h6 id="Describe"><a href="#Describe" class="headerlink" title="Describe"></a>Describe</h6><ul>
<li>subscribeOn() 指定上游发送事件的线程, observeOn　指定的是下游接收事件的线程</li>
<li>多次指定上游的线程只有第一次指定的有效,就是subscribeOn()只有第一次有效,其余忽略</li>
<li>可以多次指定下游线程,每调用一次observeOn(),下游的线程就会切换一次</li>
</ul>
<p>Demo在　AndroidDemo -&gt; RXLeran-&gt;RX基础-&gt;Rx线程切换</p>
<h6 id="链式调用"><a href="#链式调用" class="headerlink" title="链式调用"></a>链式调用</h6><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="module-access"><span class="module"><span class="identifier">RetrofitFactory</span>.</span></span>create(<span class="module-access"><span class="module"><span class="identifier">ICommonApis</span>.</span></span><span class="keyword">class</span>)</span><br><span class="line">              .img<span class="constructor">UpServer(<span class="params">part</span>)</span></span><br><span class="line">              .subscribe<span class="constructor">On(Schedulers.<span class="params">io</span>()</span>)</span><br><span class="line">              .observe<span class="constructor">On(AndroidSchedulers.<span class="params">mainThread</span>()</span>)</span><br><span class="line">              .<span class="keyword">do</span><span class="constructor">OnNext(<span class="params">new</span> Consumer&lt;PictureUp&gt;()</span> &#123;</span><br><span class="line">                  @Override</span><br><span class="line">                  public void accept(PictureUp pictureUp) throws Exception &#123;</span><br><span class="line">                      List&lt;PictureUp.ModelListBean&gt; picList = pictureUp.get<span class="constructor">Model_list()</span>;</span><br><span class="line">                      <span class="keyword">if</span> (picList != null<span class="operator"> &amp;&amp; </span>!picList.is<span class="constructor">Empty()</span>) &#123;</span><br><span class="line">                          String feet_id = picList.get(<span class="number">0</span>).get<span class="constructor">File_group_id()</span>;</span><br><span class="line">                          <span class="comment">//上传成功</span></span><br><span class="line">                          <span class="keyword">if</span> (!is<span class="constructor">Empty(<span class="params">feet_id</span>)</span><span class="operator"> &amp;&amp; </span>mvpView != null) &#123;</span><br><span class="line">                              mvpView.up<span class="constructor">FeetId(<span class="params">feet_id</span>)</span>;</span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;)</span><br><span class="line">              .observe<span class="constructor">On(Schedulers.<span class="params">io</span>()</span>)</span><br><span class="line">              .flat<span class="constructor">Map(<span class="params">new</span> Function&lt;PictureUp, ObservableSource&lt;BaseCount&gt;&gt;()</span> &#123;</span><br><span class="line">                  @Override</span><br><span class="line">                  public ObservableSource&lt;BaseCount&gt; apply(PictureUp pictureUp) throws Exception &#123;</span><br><span class="line">                      List&lt;PictureUp.ModelListBean&gt; picList = pictureUp.get<span class="constructor">Model_list()</span>;</span><br><span class="line">                      <span class="keyword">if</span> (picList != null<span class="operator"> &amp;&amp; </span>!picList.is<span class="constructor">Empty()</span>) &#123;</span><br><span class="line">                          String feet_id = picList.get(<span class="number">0</span>).get<span class="constructor">File_group_id()</span>;</span><br><span class="line">                          <span class="comment">//上传成功</span></span><br><span class="line">                          <span class="keyword">if</span> (!is<span class="constructor">Empty(<span class="params">feet_id</span>)</span><span class="operator"> &amp;&amp; </span>mvpView != null) &#123;</span><br><span class="line">                              mvpView.up<span class="constructor">FeetId(<span class="params">feet_id</span>)</span>;</span><br><span class="line">                          &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                              return  <span class="module-access"><span class="module"><span class="identifier">Observable</span>.</span></span>error(<span class="keyword">new</span> <span class="constructor">Exception()</span>);</span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                      return <span class="module-access"><span class="module"><span class="identifier">RetrofitFactory</span>.</span></span>create(<span class="module-access"><span class="module"><span class="identifier">ICommonApis</span>.</span></span><span class="keyword">class</span>).offline<span class="constructor">BoxInfo(<span class="params">requestBody</span>)</span>;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;)</span><br><span class="line">              .subscribe(<span class="keyword">new</span> Consumer&lt;BaseCount&gt;<span class="literal">()</span> &#123;</span><br><span class="line">                  @Override</span><br><span class="line">                  public void accept(BaseCount baseCount) throws Exception &#123;</span><br><span class="line">                      <span class="keyword">if</span> (mvpView<span class="operator"> == </span>null) &#123;</span><br><span class="line">                          return;</span><br><span class="line">                      &#125;</span><br><span class="line">                      <span class="keyword">if</span> (baseCount.get<span class="constructor">Meta()</span>.get<span class="constructor">StatusCode()</span><span class="operator"> == </span>AUTH_FAILED) &#123;</span><br><span class="line">                          mvpView.un<span class="constructor">OfficeEquip(<span class="params">baseCount</span>)</span>;</span><br><span class="line">                      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (baseCount.get<span class="constructor">Meta()</span>.get<span class="constructor">StatusCode()</span><span class="operator"> == </span><span class="number">0</span>) &#123;</span><br><span class="line">                          mvpView.up<span class="constructor">Success()</span>;</span><br><span class="line">                      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                          <span class="keyword">if</span> (baseCount.get<span class="constructor">Meta()</span> != null<span class="operator"> &amp;&amp; </span>!is<span class="constructor">Empty(<span class="params">baseCount</span>.<span class="params">getMeta</span>()</span>.get<span class="constructor">Describe()</span>)) &#123;</span><br><span class="line">                              <span class="module-access"><span class="module"><span class="identifier">ToastUtil</span>.</span></span>show<span class="constructor">BiggerText(<span class="params">baseCount</span>.<span class="params">getMeta</span>()</span>.get<span class="constructor">Describe()</span>);</span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;, <span class="keyword">new</span> Consumer&lt;Throwable&gt;<span class="literal">()</span> &#123;</span><br><span class="line">                  @Override</span><br><span class="line">                  public void accept(Throwable throwable) throws Exception &#123;</span><br><span class="line">                      <span class="keyword">if</span> (mvpView != null) &#123;</span><br><span class="line">                          mvpView.up<span class="constructor">UserInfoFailed()</span>;</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;);</span><br></pre></td></tr></table></figure>



<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fun</span> get<span class="constructor">ImgScan()</span> &#123;</span><br><span class="line">    <span class="keyword">val</span> request = <span class="module-access"><span class="module"><span class="identifier">RetrofitWeChatFactory</span>.</span></span>create(IApiStore::<span class="keyword">class</span>.java)</span><br><span class="line">    request.get<span class="constructor">_access_token()</span></span><br><span class="line">        .flatMap &#123; request.get<span class="constructor">Ticket(<span class="params">it</span>.<span class="params">access_token</span>, 2)</span> &#125;</span><br><span class="line">        .subscribe<span class="constructor">On(Schedulers.<span class="params">io</span>()</span>)</span><br><span class="line">        .observe<span class="constructor">On(AndroidSchedulers.<span class="params">mainThread</span>()</span>)</span><br><span class="line">        .subscribe(<span class="keyword">object</span> : Observer&lt;WeChatSecond&gt; &#123;</span><br><span class="line">            override <span class="keyword">fun</span> on<span class="constructor">Complete()</span> &#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            override <span class="keyword">fun</span> on<span class="constructor">Subscribe(<span class="params">d</span>: Disposable)</span> &#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            override <span class="keyword">fun</span> on<span class="constructor">Next(<span class="params">t</span>: WeChatSecond)</span> &#123;</span><br><span class="line">                <span class="keyword">val</span> noncestr = <span class="module-access"><span class="module"><span class="identifier">LoginNewActivity</span>.</span></span>get<span class="constructor">RandomString(8)</span></span><br><span class="line">                <span class="keyword">val</span> timeStamp =</span><br><span class="line">                    (<span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>current<span class="constructor">TimeMillis()</span><span class="operator"> / </span><span class="number">1000</span>).<span class="keyword">to</span><span class="constructor">String()</span></span><br><span class="line">                t.ticket?.<span class="keyword">let</span> &#123;</span><br><span class="line">                    <span class="keyword">val</span> string1 = <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>format(</span><br><span class="line">                        <span class="string">&quot;appid=%s&amp;noncestr=%s&amp;sdk_ticket=%s&amp;timestamp=%s&quot;</span>,</span><br><span class="line">                        WeChatAppID,</span><br><span class="line">                        noncestr,</span><br><span class="line">                        it,</span><br><span class="line">                        timeStamp</span><br><span class="line">                    )</span><br><span class="line">                    <span class="keyword">val</span> sha = <span class="module-access"><span class="module"><span class="identifier">EncryptUtils</span>.</span></span>get<span class="constructor">SHA(<span class="params">string1</span>)</span></span><br><span class="line"></span><br><span class="line">                    mvpView.sign(noncestr, timeStamp, sha)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            override <span class="keyword">fun</span> on<span class="constructor">Error(<span class="params">e</span>: Throwable)</span> &#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://yamlee.me/2020/03/11/2020-03-11-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3RxJava%E4%B8%8ERxKotlin/">http://yamlee.me/2020/03/11/2020-03-11-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3RxJava%E4%B8%8ERxKotlin/</a></p>
<p><a target="_blank" rel="noopener" href="http://reactivex.io/documentation/operators.html">http://reactivex.io/documentation/operators.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/fa1828d70192">https://www.jianshu.com/p/fa1828d70192</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/fuyaozhishang/p/8697404.html">https://www.cnblogs.com/fuyaozhishang/p/8697404.html</a></p>
<h6 id="Sample"><a href="#Sample" class="headerlink" title="Sample"></a>Sample</h6><p><a target="_blank" rel="noopener" href="http://www.10tiao.com/html/169/201709/2650823932/1.html">水管系列</a> </p>
<p><a target="_blank" rel="noopener" href="https://github.com/ReactiveX/RxAndroid">https://github.com/ReactiveX/RxAndroid</a><br><a target="_blank" rel="noopener" href="https://github.com/amitshekhariitbhu/RxJava2-Android-Samples">https://github.com/amitshekhariitbhu/RxJava2-Android-Samples</a><br><a target="_blank" rel="noopener" href="https://github.com/rengwuxian/RxJavaSample">https://github.com/rengwuxian/RxJavaSample</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ssseasonnn/RxJava2Demo">https://github.com/ssseasonnn/RxJava2Demo</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5b8f536c5188255c352d3528">https://juejin.im/post/5b8f536c5188255c352d3528</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzIwMTAzMTMxMg==&mid=2649492706&idx=1&sn=d7d213a1db9c8ae3a5b0525d45863518&chksm=8eec871db99b0e0bc4d4d1aa2b7ed5d7c32e5299aee0f0818a798c2deb2996f40f8971c7a6a2&scene=38#wechat_redirect">RxJava 只看这一篇文章就够了(上)</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzIwMTAzMTMxMg==&mid=2649492715&idx=1&sn=9d2160fae874472f1ecf40f91c52d837&chksm=8eec8714b99b0e02f08afc916f94fb2bd075c9ce31c214c5c45674739ca110bed423e8f44d5c&scene=38#wechat_redirect">RxJava 只看这一篇文章就够了 (中)</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzIwMTAzMTMxMg==&mid=2649492715&idx=2&sn=18ec403398fc5044732779ca8cbddd1b&chksm=8eec8714b99b0e02692798393314d6ac437db33e067ab2880972c1124937a66b32d07b49f978&scene=38#wechat_redirect">RxJava 只看这一篇文章就够了 (下)</a></p>
<p>使用MVP Dagger2 <a target="_blank" rel="noopener" href="https://juejin.im/post/5d5ce44d5188252231108e68">https://juejin.im/post/5d5ce44d5188252231108e68</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/user/590210f4ac502e0063d338f5/posts">https://juejin.im/user/590210f4ac502e0063d338f5/posts</a></p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/page/11/index.html">http://noteforme.github.io.com/page/11/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RxJava/" rel="tag">RxJava</a></li></ul>

          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-INTERVIEW-ANSWER" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/03/12/INTERVIEW-ANSWER/">INTERVIEW-ANSWER</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-03-12T04:44:01.000Z" itemprop="datePublished">2018年03月12日</time>
</span>
      
      
      
<a href="/2018/03/12/INTERVIEW-ANSWER/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="阿里面试题"><a href="#阿里面试题" class="headerlink" title="阿里面试题"></a><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/cf5092fa2694">阿里面试题</a></h2><h2 id="1-android事件分发机制，请详细说下整个流程"><a href="#1-android事件分发机制，请详细说下整个流程" class="headerlink" title="1.android事件分发机制，请详细说下整个流程"></a>1.android事件分发机制，请详细说下整个流程</h2><p><img src="https://upload-images.jianshu.io/upload_images/2911038-5349d6ebb32372da?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>事件分发（面试）.png</p>
<h2 id="2-android-view绘制机制和加载过程，请详细说下整个流程"><a href="#2-android-view绘制机制和加载过程，请详细说下整个流程" class="headerlink" title="2.android view绘制机制和加载过程，请详细说下整个流程"></a>2.android view绘制机制和加载过程，请详细说下整个流程</h2><ul>
<li><p>1.ViewRootImpl会调用performTraversals(),其内部会调用performMeasure()、performLayout、performDraw()。</p>
</li>
<li><p>2.performMeasure()会调用最外层的ViewGroup的measure()–&gt;onMeasure(),ViewGroup的onMeasure()是抽象方法，但其提供了measureChildren()，这之中会遍历子View然后循环调用measureChild()这之中会用getChildMeasureSpec()+父View的MeasureSpec+子View的LayoutParam一起获取本View的MeasureSpec，然后调用子View的measure()到View的onMeasure()–&gt;setMeasureDimension(getDefaultSize(),getDefaultSize()),getDefaultSize()默认返回measureSpec的测量数值，所以继承View进行自定义的wrap_content需要重写。</p>
</li>
<li><p>3.performLayout()会调用最外层的ViewGroup的layout(l,t,r,b),本View在其中使用setFrame()设置本View的四个顶点位置。在onLayout(抽象方法)中确定子View的位置，如LinearLayout会遍历子View，循环调用setChildFrame()–&gt;子View.layout()。</p>
</li>
<li><p>4.performDraw()会调用最外层ViewGroup的draw():其中会先后调用background.draw()(绘制背景)、onDraw()(绘制自己)、dispatchDraw()(绘制子View)、onDrawScrollBars()(绘制装饰)。</p>
</li>
<li><p>5.MeasureSpec由2位SpecMode(UNSPECIFIED、EXACTLY(对应精确值和match_parent)、AT_MOST(对应warp_content))和30位SpecSize组成一个int,DecorView的MeasureSpec由窗口大小和其LayoutParams决定，其他View由父View的MeasureSpec和本View的LayoutParams决定。ViewGroup中有getChildMeasureSpec()来获取子View的MeasureSpec。</p>
</li>
<li><p>6.三种方式获取measure()后的宽高：</p>
<ul>
<li>1.Activity#onWindowFocusChange()中调用获取</li>
<li>2.view.post(Runnable)将获取的代码投递到消息队列的尾部。</li>
<li>3.ViewTreeObservable.</li>
</ul>
<p>自定义 View 的绘制顺序</p>
</li>
</ul>
<h2 id="3-android四大组件的加载过程，请详细介绍下"><a href="#3-android四大组件的加载过程，请详细介绍下" class="headerlink" title="3.android四大组件的加载过程，请详细介绍下"></a>3.android四大组件的加载过程，请详细介绍下</h2><ul>
<li>1.<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/f499afd8d0ab">android四大组件的加载过程</a>:这是我总结的一篇博客</li>
</ul>
<h2 id="4-Activity的启动模式"><a href="#4-Activity的启动模式" class="headerlink" title="4.Activity的启动模式"></a>4.Activity的启动模式</h2><ul>
<li>1.standard:默认标准模式，每启动一个都会创建一个实例，</li>
<li>2.singleTop：栈顶复用，如果在栈顶就调用onNewIntent复用，从onResume()开始</li>
<li>3.singleTask：栈内复用，本栈内只要用该类型Activity就会将其顶部的activity出栈</li>
<li>4.singleInstance：单例模式，除了3中特性，系统会单独给该Activity创建一个栈，</li>
</ul>
<h2 id="5-A、B、C、D分别是四种Activity的启动模式，那么A-gt-B-gt-C-gt-D-gt-A-gt-B-gt-C-gt-D分别启动，最后的activity栈是怎么样的"><a href="#5-A、B、C、D分别是四种Activity的启动模式，那么A-gt-B-gt-C-gt-D-gt-A-gt-B-gt-C-gt-D分别启动，最后的activity栈是怎么样的" class="headerlink" title="5.A、B、C、D分别是四种Activity的启动模式，那么A-&gt;B-&gt;C-&gt;D-&gt;A-&gt;B-&gt;C-&gt;D分别启动，最后的activity栈是怎么样的"></a>5.A、B、C、D分别是四种Activity的启动模式，那么A-&gt;B-&gt;C-&gt;D-&gt;A-&gt;B-&gt;C-&gt;D分别启动，最后的activity栈是怎么样的</h2><ul>
<li>1.这个题目需要深入了解activity的启动模式</li>
<li>2.最后的答案是：两个栈，前台栈是只有D，后台栈从底至上是A、B、C</li>
</ul>
<h2 id="6-Activity缓存方法"><a href="#6-Activity缓存方法" class="headerlink" title="6.Activity缓存方法"></a>6.Activity缓存方法</h2><ul>
<li>1.配置改变导致Activity被杀死，横屏变竖屏：在onStop之前会调用onSaveInstanceState()保存数据在重建Activity之后，会在onStart()之后调用onRestoreInstanceState(),并把保存下来的Bundle传给onCreate()和它会默认重建Activity当前的视图，我们可以在onCreate()中，回复自己的数据。</li>
<li>2.内存不足杀掉Activity，优先级分别是：前台可见，可见非前台，后台。</li>
</ul>
<h2 id="7-Service的生命周期，两种启动方法，有什么区别"><a href="#7-Service的生命周期，两种启动方法，有什么区别" class="headerlink" title="7.Service的生命周期，两种启动方法，有什么区别"></a>7.Service的生命周期，两种启动方法，有什么区别</h2><ul>
<li>1.context.startService() -&gt;onCreate()- &gt;onStart()-&gt;Service running–&gt;(如果调用context.stopService() )-&gt;onDestroy() -&gt;Service shut down<ul>
<li>1.如果Service还没有运行，则调用onCreate()然后调用onStart()；</li>
<li>2.如果Service已经运行，则只调用onStart()，所以一个Service的onStart方法可能会重复调用多次。</li>
<li>3.调用stopService的时候直接onDestroy，</li>
<li>4.如果是调用者自己直接退出而没有调用stopService的话，Service会一直在后台运行。该Service的调用者再启动起来后可以通过stopService关闭Service。</li>
</ul>
</li>
<li>2.context.bindService()-&gt;onCreate()-&gt;onBind()-&gt;Service running–&gt;onUnbind() -&gt; onDestroy() -&gt;Service stop<ul>
<li>1.onBind将返回给客户端一个IBind接口实例，IBind允许客户端回调服务的方法，比如得到Service运行的状态或其他操作。</li>
<li>2.这个时候会把调用者和Service绑定在一起，Context退出了,Service就会调用onUnbind-&gt;onDestroy相应退出。</li>
<li>3.所以调用bindService的生命周期为：onCreate –&gt; onBind(只一次，不可多次绑定) –&gt; onUnbind –&gt; onDestory。</li>
</ul>
</li>
</ul>
<h2 id="8-怎么保证service不被杀死"><a href="#8-怎么保证service不被杀死" class="headerlink" title="8.怎么保证service不被杀死"></a>8.怎么保证service不被杀死</h2><ul>
<li>1.提升service优先级</li>
<li>2.提升service进程优先级</li>
<li>3.onDestroy方法里重启service</li>
</ul>
<h2 id="9-静态的Broadcast-和动态的有什么区别"><a href="#9-静态的Broadcast-和动态的有什么区别" class="headerlink" title="9.静态的Broadcast 和动态的有什么区别"></a>9.静态的Broadcast 和动态的有什么区别</h2><ul>
<li>1.动态的比静态的安全</li>
<li>2.静态在app启动的时候就初始化了 动态使用代码初始化</li>
<li>3.静态需要配置 动态不需要</li>
<li>4.生存期，静态广播的生存期可以比动态广播的长很多</li>
<li>5.优先级动态广播的优先级比静态广播高</li>
</ul>
<h2 id="10-Intent可以传递哪些数据类型"><a href="#10-Intent可以传递哪些数据类型" class="headerlink" title="10.Intent可以传递哪些数据类型"></a>10.Intent可以传递哪些数据类型</h2><ul>
<li>1.Serializable</li>
<li>2.charsequence: 主要用来传递String，char等</li>
<li>3.parcelable</li>
<li>4.Bundle</li>
</ul>
<h2 id="11-Json有什么优劣势、解析的原理"><a href="#11-Json有什么优劣势、解析的原理" class="headerlink" title="11.Json有什么优劣势、解析的原理"></a>11.Json有什么优劣势、解析的原理</h2><ul>
<li>1.JSON的速度要远远快于XML</li>
<li>2.JSON相对于XML来讲，数据的体积小</li>
<li>3.JSON对数据的描述性比XML较差</li>
<li>4.解析的基本原理是：词法分析</li>
</ul>
<h2 id="12-一个语言的编译过程"><a href="#12-一个语言的编译过程" class="headerlink" title="12.一个语言的编译过程"></a>12.一个语言的编译过程</h2><ul>
<li>1.词法分析：将一串文本按规则分割成最小的结构，关键字、标识符、运算符、界符和常量等。一般实现方法是自动机和正则表达式</li>
<li>2.语法分析：将一系列单词组合成语法树。一般实现方法有自顶向下和自底向上</li>
<li>3.语义分析：对结构上正确的源程序进行上下文有关性质的审查</li>
<li>4.目标代码生成</li>
<li>5.代码优化：优化生成的目标代码，</li>
</ul>
<h2 id="13-动画有哪几类，各有什么特点"><a href="#13-动画有哪几类，各有什么特点" class="headerlink" title="13.动画有哪几类，各有什么特点"></a>13.动画有哪几类，各有什么特点</h2><ul>
<li>1.动画的基本原理：其实就是利用插值器和估值器，来计算出各个时刻View的属性，然后通过改变View的属性来，实现View的动画效果。</li>
<li>2.View动画:只是影像变化，view的实际位置还在原来的地方。</li>
<li>3.帧动画是在xml中定义好一系列图片之后，使用AnimationDrawable来播放的动画。</li>
<li>4.View的属性动画：<ul>
<li>1.插值器：作用是根据时间的流逝的百分比来计算属性改变的百分比</li>
<li>2.估值器：在1的基础上由这个东西来计算出属性到底变化了多少数值的类</li>
</ul>
</li>
</ul>
<h2 id="14-Handler、Looper消息队列模型，各部分的作用"><a href="#14-Handler、Looper消息队列模型，各部分的作用" class="headerlink" title="14.Handler、Looper消息队列模型，各部分的作用"></a>14.Handler、Looper消息队列模型，各部分的作用</h2><ul>
<li>1.MessageQueue：读取会自动删除消息，单链表维护，在插入和删除上有优势。在其next()中会无限循环，不断判断是否有消息，有就返回这条消息并移除。</li>
<li>2.Looper：Looper创建的时候会创建一个MessageQueue，调用loop()方法的时候消息循环开始，loop()也是一个死循环，会不断调用messageQueue的next()，当有消息就处理，否则阻塞在messageQueue的next()中。当Looper的quit()被调用的时候会调用messageQueue的quit(),此时next()会返回null，然后loop()方法也跟着退出。</li>
<li>3.Handler：在主线程构造一个Handler，然后在其他线程调用sendMessage(),此时主线程的MessageQueue中会插入一条message，然后被Looper使用。</li>
<li>4.系统的主线程在ActivityThread的main()为入口开启主线程，其中定义了内部类Activity.H定义了一系列消息类型，包含四大组件的启动停止。</li>
<li>5.MessageQueue和Looper是一对一关系，Handler和Looper是多对一</li>
</ul>
<h2 id="15-怎样退出终止App"><a href="#15-怎样退出终止App" class="headerlink" title="15.怎样退出终止App"></a>15.怎样退出终止App</h2><ul>
<li>1.自己设置一个Activity的栈，然后一个个finish()</li>
</ul>
<h2 id="16-Android-IPC-Binder原理"><a href="#16-Android-IPC-Binder原理" class="headerlink" title="16.Android IPC:Binder原理"></a>16.Android IPC:Binder原理</h2><ul>
<li>1.在Activity和Service进行通讯的时候，用到了Binder。<ul>
<li>1.当属于同个进程我们可以继承Binder然后在Activity中对Service进行操作</li>
<li>2.当不属于同个进程，那么要用到AIDL让系统给我们创建一个Binder，然后在Activity中对远端的Service进行操作。</li>
</ul>
</li>
<li>2.系统给我们生成的Binder：<ul>
<li>1.Stub类中有:接口方法的id，有该Binder的标识，有asInterface(IBinder)(让我们在Activity中获取实现了Binder的接口，接口的实现在Service里，同进程时候返回Stub否则返回Proxy)，有onTransact()这个方法是在不同进程的时候让Proxy在Activity进行远端调用实现Activity操作Service</li>
<li>2.Proxy类是代理，在Activity端，其中有:IBinder mRemote(这就是远端的Binder)，两个接口的实现方法不过是代理最终还是要在远端的onTransact()中进行实际操作。</li>
</ul>
</li>
<li>3.哪一端的Binder是副本，该端就可以被另一端进行操作，因为Binder本体在定义的时候可以操作本端的东西。所以可以在Activity端传入本端的Binder，让Service端对其进行操作称为Listener，可以用RemoteCallbackList这个容器来装Listener，防止Listener因为经历过序列化而产生的问题。</li>
<li>4.当Activity端向远端进行调用的时候，当前线程会挂起，当方法处理完毕才会唤醒。</li>
<li>5.如果一个AIDL就用一个Service太奢侈，所以可以使用Binder池的方式，建立一个AIDL其中的方法是返回IBinder，然后根据方法中传入的参数返回具体的AIDL。</li>
<li>6.IPC的方式有：Bundle（在Intent启动的时候传入，不过是一次性的），文件共享(对于SharedPreference是特例，因为其在内存中会有缓存)，使用Messenger(其底层用的也是AIDL，同理要操作哪端，就在哪端定义Messenger)，AIDL，ContentProvider(在本进程中继承实现一个ContentProvider，在增删改查方法中调用本进程的SQLite，在其他进程中查询)，Socket</li>
</ul>
<h2 id="17-描述一次跨进程通讯"><a href="#17-描述一次跨进程通讯" class="headerlink" title="17.描述一次跨进程通讯"></a>17.描述一次跨进程通讯</h2><ul>
<li>1.client、proxy、serviceManager、BinderDriver、impl、service</li>
<li>2.client发起一个请求service信息的Binder请求到BinderDriver中，serviceManager发现BinderDiriver中有自己的请求 然后将clinet请求的service的数据返回给client这样完成了一次Binder通讯</li>
<li>3.clinet获取的service信息就是该service的proxy，此时调用proxy的方法，proxy将请求发送到BinderDriver中，此时service的 Binder线程池循环发现有自己的请求，然后用impl就处理这个请求最后返回，这样完成了第二次Binder通讯<br>4.中间client可挂起，也可以不挂起，有一个关键字oneway可以解决这个</li>
</ul>
<h2 id="18-android重要术语解释"><a href="#18-android重要术语解释" class="headerlink" title="18.android重要术语解释"></a>18.android重要术语解释</h2><ul>
<li>1.ActivityManagerServices，简称AMS，服务端对象，负责系统中所有Activity的生命周期</li>
<li>2.ActivityThread，App的真正入口。当开启App之后，会调用main()开始运行，开启消息循环队列，这就是传说中的UI线程或者叫主线程。与ActivityManagerServices配合，一起完成Activity的管理工作</li>
<li>3.ApplicationThread，用来实现ActivityManagerService与ActivityThread之间的交互。在ActivityManagerService需要管理相关Application中的Activity的生命周期时，通过ApplicationThread的代理对象与ActivityThread通讯。</li>
<li>4.ApplicationThreadProxy，是ApplicationThread在服务器端的代理，负责和客户端的ApplicationThread通讯。AMS就是通过该代理与ActivityThread进行通信的。</li>
<li>5.Instrumentation，每一个应用程序只有一个Instrumentation对象，每个Activity内都有一个对该对象的引用。Instrumentation可以理解为应用进程的管家，ActivityThread要创建或暂停某个Activity时，都需要通过Instrumentation来进行具体的操作。</li>
<li>6.ActivityStack，Activity在AMS的栈管理，用来记录已经启动的Activity的先后关系，状态信息等。通过ActivityStack决定是否需要启动新的进程。</li>
<li>7.ActivityRecord，ActivityStack的管理对象，每个Activity在AMS对应一个ActivityRecord，来记录Activity的状态以及其他的管理信息。其实就是服务器端的Activity对象的映像。</li>
<li>8.TaskRecord，AMS抽象出来的一个“任务”的概念，是记录ActivityRecord的栈，一个“Task”包含若干个ActivityRecord。AMS用TaskRecord确保Activity启动和退出的顺序。如果你清楚Activity的4种launchMode，那么对这个概念应该不陌生。</li>
</ul>
<h2 id="19-理解Window和WindowManager"><a href="#19-理解Window和WindowManager" class="headerlink" title="19.理解Window和WindowManager"></a>19.理解Window和WindowManager</h2><ul>
<li>1.Window用于显示View和接收各种事件，Window有三种类型：应用Window(每个Activity对应一个Window)、子Window(不能单独存在，附属于特定Window)、系统window(Toast和状态栏)</li>
<li>2.Window分层级，应用Window在1-99、子Window在1000-1999、系统Window在2000-2999.WindowManager提供了增删改View三个功能。</li>
<li>3.Window是个抽象概念：每一个Window对应着一个View和ViewRootImpl，Window通过ViewRootImpl来和View建立联系，View是Window存在的实体，只能通过WindowManager来访问Window。</li>
<li>4.WindowManager的实现是WindowManagerImpl其再委托给WindowManagerGlobal来对Window进行操作，其中有四个List分别储存对应的View、ViewRootImpl、WindowManger.LayoutParams和正在被删除的View</li>
<li>5.Window的实体是存在于远端的WindowMangerService中，所以增删改Window在本端是修改上面的几个List然后通过ViewRootImpl重绘View，通过WindowSession(每个应用一个)在远端修改Window。</li>
<li>6.Activity创建Window：Activity会在attach()中创建Window并设置其回调(onAttachedToWindow()、dispatchTouchEvent()),Activity的Window是由Policy类创建PhoneWindow实现的。然后通过Activity#setContentView()调用PhoneWindow的setContentView。</li>
</ul>
<h2 id="20-Bitmap的处理"><a href="#20-Bitmap的处理" class="headerlink" title="20.Bitmap的处理"></a>20.Bitmap的处理</h2><ul>
<li>1.当使用ImageView的时候，可能图片的像素大于ImageView，此时就可以通过BitmapFactory.Option来对图片进行压缩，inSampleSize表示缩小2^(inSampleSize-1)倍。</li>
<li>2.BitMap的缓存：<ul>
<li>1.使用LruCache进行内存缓存。</li>
<li>2.使用DiskLruCache进行硬盘缓存。</li>
<li>3.实现一个ImageLoader的流程：同步异步加载、图片压缩、内存硬盘缓存、网络拉取<ul>
<li>1.同步加载只创建一个线程然后按照顺序进行图片加载</li>
<li>2.异步加载使用线程池，让存在的加载任务都处于不同线程</li>
<li>3.为了不开启过多的异步任务，只在列表静止的时候开启图片加载</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="21-如何实现一个网络框架-参考Volley"><a href="#21-如何实现一个网络框架-参考Volley" class="headerlink" title="21.如何实现一个网络框架(参考Volley)"></a>21.如何实现一个网络框架(参考Volley)</h2><ul>
<li>1.缓存队列,以url为key缓存内容可以参考Bitmap的处理方式，这里单独开启一个线程。</li>
<li>2.网络请求队列，使用线程池进行请求。</li>
<li>3.提供各种不同类型的返回值的解析如String，Json，图片等等。</li>
</ul>
<h2 id="22-ClassLoader的基础知识"><a href="#22-ClassLoader的基础知识" class="headerlink" title="22.ClassLoader的基础知识"></a>22.ClassLoader的基础知识</h2><ul>
<li>1.双亲委托：一个ClassLoader类负责加载这个类所涉及的所有类，在加载的时候会判断该类是否已经被加载过，然后会递归去他父ClassLoader中找。</li>
<li>2.可以动态加载Jar通过URLClassLoader</li>
<li>3.ClassLoader 隔离问题 JVM识别一个类是由：ClassLoader id+PackageName+ClassName。</li>
<li>4.加载不同Jar包中的公共类：<ul>
<li>1.让父ClassLoader加载公共的Jar，子ClassLoader加载包含公共Jar的Jar，此时子ClassLoader在加载公共Jar的时候会先去父ClassLoader中找。(只适用Java)</li>
<li>2.重写加载包含公共Jar的Jar的ClassLoader，在loadClass中找到已经加载过公共Jar的ClassLoader，也就是把父ClassLoader替换掉。(只适用Java)</li>
<li>3.在生成包含公共Jar的Jar时候把公共Jar去掉。</li>
</ul>
</li>
</ul>
<h2 id="23-插件化框架描述：dynamicLoadApk为例子"><a href="#23-插件化框架描述：dynamicLoadApk为例子" class="headerlink" title="23.插件化框架描述：dynamicLoadApk为例子"></a>23.插件化框架描述：dynamicLoadApk为例子</h2><ul>
<li>1.可以通过DexClassLoader来对apk中的dex包进行加载访问</li>
<li>2.如何加载资源是个很大的问题，因为宿主程序中并没有apk中的资源，所以调用R资源会报错，所以这里使用了Activity中的实现ContextImpl的getAssets()和getResources()再加上反射来实现。</li>
<li>3.由于系统启动Activity有很多初始化动作要做，而我们手动反射很难完成，所以可以采用接口机制，将Activity的大部分生命周期提取成接口，然后通过代理Activity去调用插件Activity的生命周期。同时如果像增加一个新生命周期方法的时候，只需要在接口中和代理中声明一下就行。</li>
<li>4.缺点：<ul>
<li>1.慎用this，因为在apk中使用this并不代表宿主中的activity，当然如果this只是表示自己的接口还是可以的。除此之外可以使用that代替this。</li>
<li>2.不支持Service和静态注册的Broadcast</li>
<li>3.不支持LaunchMode和Apk中Activity的隐式调用。</li>
</ul>
</li>
</ul>
<h2 id="24-热修复：Andfix为例子"><a href="#24-热修复：Andfix为例子" class="headerlink" title="24.热修复：Andfix为例子"></a>24.热修复：Andfix为例子</h2><ul>
<li>1.大致原理：apkpatch将两个apk做一次对比，然后找出不同的部分。可以看到生成的apatch了文件，后缀改成zip再解压开，里面有一个dex文件。通过jadx查看一下源码，里面就是被修复的代码所在的类文件,这些更改过的类都加上了一个_CF的后缀，并且变动的方法都被加上了一个叫@MethodReplace的annotation，通过clazz和method指定了需要替换的方法。然后客户端sdk得到补丁文件后就会根据annotation来寻找需要替换的方法。最后由JNI层完成方法的替换。</li>
<li>2.无法添加新类和新的字段、补丁文件很容易被反编译、加固平台可能会使热补丁功能失效</li>
</ul>
<h2 id="25-线程同步的问题，常用的线程同步"><a href="#25-线程同步的问题，常用的线程同步" class="headerlink" title="25.线程同步的问题，常用的线程同步"></a>25.线程同步的问题，常用的线程同步</h2><ul>
<li>1.sycn：保证了原子性、可见性、有序性</li>
<li>2.锁：保证了原子性、可见性、有序性<ul>
<li>1.自旋锁:可以使线程在没有取得锁的时候，不被挂起，而转去执行一个空循环。<ul>
<li>1.优点:线程被挂起的几率减少，线程执行的连贯性加强。用于对于锁竞争不是很激烈，锁占用时间很短的并发线程。</li>
<li>2.缺点:过多浪费CPU时间，有一个线程连续两次试图获得自旋锁引起死锁</li>
</ul>
</li>
<li>2.阻塞锁:没得到锁的线程等待或者挂起，Sycn、Lock</li>
<li>3.可重入锁:一个线程可多次获取该锁，Sycn、Lock</li>
<li>4.悲观锁:每次去拿数据的时候都认为别人会修改，所以会阻塞全部其他线程 Sycn、Lock</li>
<li>5.乐观锁:每次去拿数据的时候都认为别人不会修改，所以不会上锁，但是在更新的时候会判断一下在此期间别人有没有去更新这个数据，可以使用版本号等机制。cas</li>
<li>6.显示锁和内置锁:显示锁用Lock来定义、内置锁用synchronized。</li>
<li>7.读-写锁:为了提高性能，Java提供了读</li>
</ul>
</li>
<li>3.volatile<ul>
<li>1.只能保证可见性，不能保证原子性</li>
<li>2.自增操作有三步，此时多线程写会出现问题</li>
</ul>
</li>
<li>4.cas<ul>
<li>1.操作:内存值V、旧的预期值A、要修改的值B，当且仅当预期值A和内存值V相同时，将内存值修改为B并返回true，否则什么都不做并返回false。</li>
<li>2.解释:本地副本为A，共享内存为V，线程A要把V修改成B。某个时刻线程A要把V修改成B，如果A和V不同那么就表示有其他线程在修改V，此时就表示修改失败，否则表示没有其他线程修改，那么把V改成B。</li>
<li>3.局限:如果V被修改成V1然后又被改成V，此时cas识别不出变化，还是认为没有其他线程在修改V，此时就会有问题</li>
<li>4.局限解决:将V带上版本。</li>
</ul>
</li>
<li>5.线程不安全到底是怎么回事：<ul>
<li>1.一个线程写，多个线程读的时候，会造成写了一半就去读</li>
<li>2.多线程写，会造成脏数据</li>
</ul>
</li>
</ul>
<h2 id="26-Asynctask和线程池，GC相关（怎么判断哪些内存该GC，GC算法）"><a href="#26-Asynctask和线程池，GC相关（怎么判断哪些内存该GC，GC算法）" class="headerlink" title="26.Asynctask和线程池，GC相关（怎么判断哪些内存该GC，GC算法）"></a>26.Asynctask和线程池，GC相关（怎么判断哪些内存该GC，GC算法）</h2><ul>
<li>1.Asynctask：异步任务类，单线程线程池+Handler</li>
<li>2.线程池：<ul>
<li>1.ThreadPoolExecutor：通过Executors可以构造单线程池、固定数目线程池、不固定数目线程池。</li>
<li>2.ScheduledThreadPoolExecutor：可以延时调用线程或者延时重复调度线程。</li>
</ul>
</li>
<li>3.GC相关：重要<ul>
<li>1.搜索算法：<ul>
<li>1.引用计数</li>
<li>2.图搜索，可达性分析</li>
</ul>
</li>
<li>2.回收算法：<ul>
<li>1.标记清除复制：用于青年代</li>
<li>2.标记整理：用于老年代</li>
</ul>
</li>
<li>3.堆分区：<ul>
<li>1.青年区eden 80%、survivor1 10%、survivor2 10%</li>
<li>2.老年区</li>
</ul>
</li>
<li>4.虚拟机栈分区：<ul>
<li>1.局部变量表</li>
<li>2.操作数栈</li>
<li>3.动态链接</li>
<li>4.方法返回地址</li>
</ul>
</li>
<li>5.GC Roots:<ul>
<li>1.虚拟机栈(栈桢中的本地变量表)中的引用的对象</li>
<li>2.方法区中的类静态属性引用的对象</li>
<li>3.方法区中的常量引用的对象</li>
<li>4.本地方法栈中JNI的引用的对象</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="27-网络"><a href="#27-网络" class="headerlink" title="27.网络"></a>27.网络</h2><ul>
<li>1.ARP协议:在IP以太网中，当一个上层协议要发包时，有了该节点的IP地址，ARP就能提供该节点的MAC地址。</li>
<li>2.HTTP HTTPS的区别:<ul>
<li>1.HTTPS使用TLS(SSL)进行加密</li>
<li>2.HTTPS缺省工作在TCP协议443端口</li>
<li>3.它的工作流程一般如以下方式:<ul>
<li>1.完成TCP三次同步握手</li>
<li>2.客户端验证服务器数字证书，通过，进入步骤3</li>
<li>3.DH算法协商对称加密算法的密钥、hash算法的密钥</li>
<li>4.SSL安全加密隧道协商完成</li>
<li>5.网页以加密的方式传输，用协商的对称加密算法和密钥加密，保证数据机密性；用协商的hash算法进行数据完整性保护，保证数据不被篡改</li>
</ul>
</li>
<li>3.http请求包结构，http返回码的分类，400和500的区别<ul>
<li>1.包结构：<ul>
<li>1.请求：请求行、头部、数据</li>
<li>2.返回：状态行、头部、数据</li>
</ul>
</li>
<li>2.http返回码分类：1到5分别是，消息、成功、重定向、客户端错误、服务端错误</li>
</ul>
</li>
<li>4.Tcp<ul>
<li>1.可靠连接，三次握手，四次挥手<ul>
<li>1.三次握手：防止了服务器端的一直等待而浪费资源，例如只是两次握手，如果s确认之后c就掉线了，那么s就会浪费资源<ul>
<li>1.syn-c = x，表示这消息是x序号</li>
<li>2.ack-s = x + 1，表示syn-c这个消息接收成功。syn-s = y，表示这消息是y序号。</li>
<li>3.ack-c = y + 1，表示syn-s这条消息接收成功</li>
</ul>
</li>
</ul>
</li>
<li>2.四次挥手：TCP是全双工模式<ul>
<li>1.fin-c = x , 表示现在需要关闭c到s了。ack-c = y,表示上一条s的消息已经接收完毕</li>
<li>2.ack-s = x + 1，表示需要关闭的fin-c消息已经接收到了，同意关闭</li>
<li>3.fin-s = y + 1，表示s已经准备好关闭了，就等c的最后一条命令</li>
<li>4.ack-c = y + 1，表示c已经关闭，让s也关闭</li>
</ul>
</li>
<li>3.滑动窗口，停止等待、后退N、选择重传</li>
<li>4.拥塞控制，慢启动、拥塞避免、加速递减、快重传快恢复</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="28-数据库性能优化：索引和事务，需要找本专门的书大概了解一下"><a href="#28-数据库性能优化：索引和事务，需要找本专门的书大概了解一下" class="headerlink" title="28.数据库性能优化：索引和事务，需要找本专门的书大概了解一下"></a>28.数据库性能优化：索引和事务，需要找本专门的书大概了解一下</h2><h2 id="29-13-APK打包流程和其内容"><a href="#29-13-APK打包流程和其内容" class="headerlink" title="29.13.APK打包流程和其内容"></a>29.13.APK打包流程和其内容</h2><ul>
<li>1.流程<ul>
<li>1.aapt生成R文件<ul>
<li>2.aidl生成java文件</li>
<li>3.将全部java文件编译成class文件</li>
<li>4.将全部class文件和第三方包合并成dex文件</li>
<li>5.将资源、so文件、dex文件整合成apk</li>
<li>6.apk签名</li>
<li>7.apk字节对齐</li>
</ul>
</li>
</ul>
</li>
<li>2.内容：so、dex、asset、资源文件</li>
</ul>
<h2 id="30-网络劫持的类型原理：可以百度一下了解一下具体概念"><a href="#30-网络劫持的类型原理：可以百度一下了解一下具体概念" class="headerlink" title="30.网络劫持的类型原理：可以百度一下了解一下具体概念"></a>30.网络劫持的类型原理：可以百度一下了解一下具体概念</h2><ul>
<li>1.DNS劫持、欺骗、污染</li>
<li>2.http劫持：重定向、注入js，http注入、报文扩展</li>
</ul>
<h2 id="31-java类加载过程："><a href="#31-java类加载过程：" class="headerlink" title="31.java类加载过程："></a>31.java类加载过程：</h2><ul>
<li>1.加载时机：创建实例、访问静态变量或方法、反射、加载子类之前</li>
<li>2.验证：验证文件格式、元数据、字节码、符号引用的正确性</li>
<li>3.加载：根据全类名获取文件字节流、将字节流转化为静态储存结构放入方法区、生成class对象</li>
<li>4.准备：在堆上为静态变量划分内存</li>
<li>5.解析：将常量池中的符号引用转换为直接引用</li>
<li>6.初始化：初始化静态变量</li>
<li>7.书籍推荐：<strong>深入理解java虚拟机</strong>，博客推荐：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/bc6d1770d92c">Java/Android阿里面试JVM部分理解</a></li>
</ul>
<h2 id="32-retrofit的了解"><a href="#32-retrofit的了解" class="headerlink" title="32.retrofit的了解"></a>32.retrofit的了解</h2><ul>
<li>1.动态代理创建一个接口的代理类</li>
<li>2.通过反射解析每个接口的注解、入参构造http请求</li>
<li>3.获取到返回的http请求，使用Adapter解析成需要的返回值。</li>
</ul>
<h2 id="33-bundle的数据结构，如何存储"><a href="#33-bundle的数据结构，如何存储" class="headerlink" title="33.bundle的数据结构，如何存储"></a>33.bundle的数据结构，如何存储</h2><ul>
<li>1.键值对储存</li>
<li>2.传递的数据可以是boolean、byte、int、long、float、double、string等基本类型或它们对应的数组，也可以是对象或对象数组。</li>
<li>3.当Bundle传递的是对象或对象数组时，必须实现Serializable 或Parcelable接口</li>
</ul>
<h2 id="34-listview内点击buttom并移动的事件流完整拦截过程："><a href="#34-listview内点击buttom并移动的事件流完整拦截过程：" class="headerlink" title="34.listview内点击buttom并移动的事件流完整拦截过程："></a>34.listview内点击buttom并移动的事件流完整拦截过程：</h2><ul>
<li>1.点下按钮的时候：<ul>
<li>1.产生了一个down事件，activity–&gt;phoneWindow–&gt;ViewGroup–&gt;ListView–&gt;botton,中间如果有重写了拦截方法，则事件被该view拦截可能消耗。</li>
<li>2.没拦截，事件到达了button，这个过程中建立了一条事件传递的view链表</li>
<li>3.到button的dispatch方法–&gt;onTouch–&gt;view是否可用–&gt;Touch代理</li>
</ul>
</li>
<li>2.移动点击按钮的时候:<ul>
<li>1.产生move事件，listView中会对move事件做拦截</li>
<li>2.此时listView会将该滑动事件消费掉</li>
<li>3.后续的滑动事件都会被listView消费掉</li>
</ul>
</li>
<li>3.手指抬起来时候：前面建立了一个view链表，listView的父view在获取事件的时候，会直接取链表中的listView让其进行事件消耗。</li>
</ul>
<h2 id="35-service的意义：不需要界面，在后台执行的程序"><a href="#35-service的意义：不需要界面，在后台执行的程序" class="headerlink" title="35.service的意义：不需要界面，在后台执行的程序"></a>35.service的意义：不需要界面，在后台执行的程序</h2><h2 id="36-android的IPC通信方式，线程（进程间）通信机制有哪些"><a href="#36-android的IPC通信方式，线程（进程间）通信机制有哪些" class="headerlink" title="36.android的IPC通信方式，线程（进程间）通信机制有哪些"></a>36.android的IPC通信方式，线程（进程间）通信机制有哪些</h2><ul>
<li>1.ipc通信方式：binder、contentprovider、socket</li>
<li>2.操作系统进程通讯方式：共享内存、socket、管道</li>
</ul>
<h2 id="37-操作系统进程和线程的区别"><a href="#37-操作系统进程和线程的区别" class="headerlink" title="37.操作系统进程和线程的区别"></a>37.操作系统进程和线程的区别</h2><ul>
<li>1.简而言之,一个程序至少有一个进程,一个进程至少有一个线程.</li>
<li>2.线程的划分尺度小于进程，使得多线程程序的并发性高。</li>
<li>3.另外，进程在执行过程中拥有独立的内存单元，而多个线程共享内存，从而极大地提高了程序的运行效率。</li>
<li>4.多线程的意义在于一个应用程序中，有多个执行部分可以同时执行。有将多个线程看做多个独立的应用，来实现进程的调度和管理以及资源分配</li>
</ul>
<h2 id="38-HashMap的实现过程：Capacity就是buckets的数目，Load-factor就是buckets填满程度的最大比例。如果对迭代性能要求很高的话不要把capacity设置过大，也不要把load-factor设置过小。"><a href="#38-HashMap的实现过程：Capacity就是buckets的数目，Load-factor就是buckets填满程度的最大比例。如果对迭代性能要求很高的话不要把capacity设置过大，也不要把load-factor设置过小。" class="headerlink" title="38.HashMap的实现过程：Capacity就是buckets的数目，Load factor就是buckets填满程度的最大比例。如果对迭代性能要求很高的话不要把capacity设置过大，也不要把load factor设置过小。"></a>38.HashMap的实现过程：Capacity就是buckets的数目，Load factor就是buckets填满程度的最大比例。如果对迭代性能要求很高的话不要把capacity设置过大，也不要把load factor设置过小。</h2><ul>
<li>1.简单来说HashMap就是一个会自动扩容的<strong>数组链表</strong></li>
<li>2.put过程<ul>
<li>1.对key的hashCode()做hash，然后再计算index;</li>
<li>2.如果没碰撞直接放到bucket里；</li>
<li>3.如果碰撞了，以链表的形式存在buckets后；</li>
<li>4.如果碰撞导致链表过长(大于等于TREEIFY_THRESHOLD)，就把链表转换成红黑树；</li>
<li>5.如果节点已经存在就替换old value(保证key的唯一性)</li>
<li>6.如果bucket满了(超过load factor*current capacity)，就要resize。</li>
</ul>
</li>
<li>3.resize：当put时，如果发现目前的bucket占用程度已经超过了Load Factor所希望的比例，那么就会发生resize。在resize的过程，简单的说就是把bucket扩充为2倍，之后重新计算index，把节点再放到新的bucket中</li>
<li>4.get过程<ul>
<li>1.根据key的hash算出数组下表</li>
<li>2.使用equals遍历链表进行比较</li>
</ul>
</li>
</ul>
<h2 id="39-mvc、mvp、mvvm："><a href="#39-mvc、mvp、mvvm：" class="headerlink" title="39.mvc、mvp、mvvm："></a>39.mvc、mvp、mvvm：</h2><ul>
<li>1.mvc:数据、View、Activity，View将操作反馈给Activity，Activitiy去获取数据，数据通过观察者模式刷新给View。循环依赖<ul>
<li>1.Activity重，很难单元测试</li>
<li>2.View和Model耦合严重</li>
</ul>
</li>
<li>2.mvp:数据、View、Presenter，View将操作给Presenter，Presenter去获取数据，数据获取好了返回给Presenter，Presenter去刷新View。PV，PM双向依赖<ul>
<li>1.接口爆炸</li>
<li>2.Presenter很重</li>
</ul>
</li>
<li>3.mvvm:数据、View、ViewModel，View将操作给ViewModel，ViewModel去获取数据，数据和界面绑定了，数据更新界面更新。<ul>
<li>1.viewModel的业务逻辑可以单独拿来测试</li>
<li>2.一个view 对应一个 viewModel 业务逻辑可以分离，不会出现全能类</li>
<li>3.数据和界面绑定了，不用写垃圾代码，但是复用起来不舒服</li>
</ul>
</li>
</ul>
<h2 id="40-java的线程如何实现"><a href="#40-java的线程如何实现" class="headerlink" title="40.java的线程如何实现"></a>40.java的线程如何实现</h2><ul>
<li>1.Thread继承</li>
<li>2.Runnale</li>
<li>3.Future</li>
<li>4.线程池</li>
</ul>
<h2 id="41-ArrayList-如何删除重复的元素或者指定的元素；"><a href="#41-ArrayList-如何删除重复的元素或者指定的元素；" class="headerlink" title="41.ArrayList 如何删除重复的元素或者指定的元素；"></a>41.ArrayList 如何删除重复的元素或者指定的元素；</h2><ul>
<li>1.删除重复：Set</li>
<li>2.删除指定：迭代器</li>
</ul>
<h2 id="42-如何设计在-UDP-上层保证-UDP-的可靠性传输；"><a href="#42-如何设计在-UDP-上层保证-UDP-的可靠性传输；" class="headerlink" title="42.如何设计在 UDP 上层保证 UDP 的可靠性传输；"></a>42.如何设计在 UDP 上层保证 UDP 的可靠性传输；</h2><ul>
<li>1.简单来讲，要使用UDP来构建可靠的面向连接的数据传输，就要实现类似于TCP协议的超时重传，有序接受，应答确认，滑动窗口流量控制等机制,等于说要在传输层的上一层（或者直接在应用层）实现TCP协议的可靠数据传输机制。</li>
<li>2.比如使用UDP数据包+序列号，UDP数据包+时间戳等方法，在服务器端进行应答确认机制，这样就会保证不可靠的UDP协议进行可靠的数据传输。</li>
<li>3.基于udp的可靠传输协议有：RUDP、RTP、UDT</li>
</ul>
<h2 id="43-Java-中内部类为什么可以访问外部类"><a href="#43-Java-中内部类为什么可以访问外部类" class="headerlink" title="43.Java 中内部类为什么可以访问外部类"></a>43.Java 中内部类为什么可以访问外部类</h2><ul>
<li>1.因为内部类创建的时候，需要外部类的对象，在内部类对象创建的时候会把外部类的引用传递进去</li>
</ul>
<h2 id="44-设计移动端的联系人存储与查询的功能，要求快速搜索联系人，可以用到哪些数据结构？数据库索引，平衡二叉树-B树、红黑树"><a href="#44-设计移动端的联系人存储与查询的功能，要求快速搜索联系人，可以用到哪些数据结构？数据库索引，平衡二叉树-B树、红黑树" class="headerlink" title="44.设计移动端的联系人存储与查询的功能，要求快速搜索联系人，可以用到哪些数据结构？数据库索引，平衡二叉树(B树、红黑树)"></a>44.设计移动端的联系人存储与查询的功能，要求快速搜索联系人，可以用到哪些数据结构？数据库索引，平衡二叉树(B树、红黑树)</h2><h2 id="45-红黑树特点"><a href="#45-红黑树特点" class="headerlink" title="45.红黑树特点"></a>45.红黑树特点</h2><ul>
<li>1.root节点和叶子节点是黑色</li>
<li>2.红色节点后必须为黑色节点</li>
<li>3.从root到叶子每条路径的黑节点数量相同</li>
</ul>
<h2 id="46-linux异步和同步i-o"><a href="#46-linux异步和同步i-o" class="headerlink" title="46.linux异步和同步i/o:"></a>46.linux异步和同步i/o:</h2><ul>
<li>1.同步：对于client，client一直等待，但是client不挂起：主线程调用</li>
<li>2.异步：对于client，client发起请求，service好了再回调client：其他线程调用，调用完成之后进行回调</li>
<li>3.阻塞：对于service，在准备io的时候会将service端挂起，直至准备完成然后唤醒service：bio</li>
<li>3.非阻塞：对于service，在准备io的时候不会将service端挂起，而是service一直去轮询判断io是否准备完成，准备完成了就进行操作：nio、linux的select、poll、epoll</li>
<li>4.多路复用io：非阻塞io的一种优化，java nio，用一个线程去轮询多个 io端口是否可用，如果一个可用就通知对应的io请求，这使用一个线程轮询可以大大增强性能。<ul>
<li>1.我可以采用 多线程+ 阻塞IO 达到类似的效果，但是由于在多线程 + 阻塞IO 中，每个socket对应一个线程，这样会造成很大的资源占用。</li>
<li>2.而在多路复用IO中，轮询每个socket状态是内核在进行的，这个效率要比用户线程要高的多。</li>
</ul>
</li>
<li>5.异步io：aio，用户线程完全不感知io的进行，所有操作都交给内核，io完成之后内核通知用户线程。<ul>
<li>1.这种io才是异步的，2、3、4都是同步io，因为内核进行数据拷贝的过程都会让用户线程阻塞。</li>
<li>2.异步IO是需要操作系统的底层支持，也就是内核支持，Java 7中，提供了Asynchronous IO</li>
</ul>
</li>
</ul>
<h2 id="47-ConcurrentHashMap内部实现，HashTable的实现被废弃的原因"><a href="#47-ConcurrentHashMap内部实现，HashTable的实现被废弃的原因" class="headerlink" title="47.ConcurrentHashMap内部实现，HashTable的实现被废弃的原因:"></a>47.ConcurrentHashMap内部实现，HashTable的实现被废弃的原因:</h2><ul>
<li>1.HashTable容器在竞争激烈的并发环境下表现出效率低下的原因，是因为所有访问HashTable的线程都必须竞争同一把锁，那假如容器里有多把锁，每一把锁用于锁容器其中一部分数据，那么当多线程访问容器里不同数据段的数据时，线程间就不会存在锁竞争，从而可以有效的提高并发访问效率，这就是ConcurrentHashMap所使用的锁分段技术，首先将数据分成一段一段的存储，然后给每一段数据配一把锁，当一个线程占用锁访问其中一个段数据的时候，其他段的数据也能被其他线程访问。</li>
<li>2.ConcurrentHashMap是由Segment数组结构和HashEntry数组结构组成。Segment是一种可重入锁ReentrantLock，在ConcurrentHashMap里扮演锁的角色，HashEntry则用于存储键值对数据。一个ConcurrentHashMap里包含一个Segment数组，Segment的结构和HashMap类似，是一种数组和链表结构， 一个Segment里包含一个HashEntry数组，每个HashEntry是一个链表结构的元素，每个Segment守护者一个HashEntry数组里的元素,当对HashEntry数组的数据进行修改时，必须首先获得它对应的Segment锁。</li>
</ul>
<h2 id="48-HandlerThread是什么"><a href="#48-HandlerThread是什么" class="headerlink" title="48.HandlerThread是什么"></a>48.HandlerThread是什么</h2><ul>
<li>1.MessageQueue + Looper + Handler</li>
</ul>
<h2 id="49-IntentService是什么"><a href="#49-IntentService是什么" class="headerlink" title="49.IntentService是什么"></a>49.IntentService是什么</h2><ul>
<li>1.含有HandlerThread的Service，可以多次startService()来多次在子线程中进行 onHandlerIntent()的调用。</li>
</ul>
<h2 id="50-class和dex"><a href="#50-class和dex" class="headerlink" title="50.class和dex"></a>50.class和dex</h2><ul>
<li>1.dvm执行的是dex格式文件，jvm执行的是class文件，android程序编译完之后生产class文件。然后dex工具会把class文件处理成dex文件，然后把资源文件和.dex文件等打包成apk文件。</li>
<li>2.dvm是基于寄存器的虚拟机，而jvm执行是基于虚拟栈的虚拟机。寄存器存取速度比栈快的多，dvm可以根据硬件实现最大的优化，比较适合移动设备。</li>
<li>3.class文件存在很多的冗余信息，dex工具会去除冗余信息，并把所有的class文件整合到dex文件中。减少了I/O操作，提高了类的查找速度</li>
</ul>
<h2 id="51-内存泄漏"><a href="#51-内存泄漏" class="headerlink" title="51.内存泄漏"></a>51.内存泄漏</h2><ul>
<li>1.其他线程持有一个Listener，Listener操作activity。那么在线程么有完毕的时候，activity关闭了，原本是要被回收的但是，不能被回收。</li>
<li>2.例如Handler导致的内存泄漏，Handler就相当于Listener。</li>
<li>3.在activity关闭的时候注意停止线程，或者将Listener的注册取消</li>
<li>3.使用弱引用，这样即使Listener持有了activity，在GC的时候还是会被回收</li>
<li>4.工具:LeakCanary</li>
</ul>
<h2 id="52-过度绘制、卡顿优化"><a href="#52-过度绘制、卡顿优化" class="headerlink" title="52.过度绘制、卡顿优化:"></a>52.过度绘制、卡顿优化:</h2><ul>
<li>1.过度绘制：<ul>
<li>1.移除Window默认的Background：getWidow.setBackgroundDrawable(null);</li>
<li>2.移除XML布局文件中非必需的Background</li>
<li>3.减少布局嵌套(扁平化的一个体现，减少View数的深度，也就减少了View树的遍历时间，渲染的时候，前后期的工作，总是按View树结点来)</li>
<li>4.在引入布局文件里面，最外层可以用merge替代LinearLayout,RelativeLayout，这样把子UI元素直接衔接在include位置</li>
<li>5.工具：HierarchyViewer 查看视图层级</li>
</ul>
</li>
<li>2.卡顿优化：16ms数据更新</li>
</ul>
<h2 id="53-apk瘦身"><a href="#53-apk瘦身" class="headerlink" title="53.apk瘦身:"></a>53.apk瘦身:</h2><ul>
<li>1.classes.dex：通过代码混淆，删掉不必要的jar包和代码实现该文件的优化</li>
<li>2.资源文件：通过Lint工具扫描代码中没有使用到的静态资源</li>
<li>3.图片资源：使用tinypng和webP，下面详细介绍图片资源优化的方案,矢量图</li>
<li>4.SO文件将不用的去掉，目前主流app一般只放一个arm的so包</li>
</ul>
<h2 id="54-ANR的形成，各个组件上出现ARN的时间限制是多少"><a href="#54-ANR的形成，各个组件上出现ARN的时间限制是多少" class="headerlink" title="54.ANR的形成，各个组件上出现ARN的时间限制是多少"></a>54.ANR的形成，各个组件上出现ARN的时间限制是多少</h2><ul>
<li>1.只要是主线程耗时的操作就会ARN  如io</li>
<li>2.broadcast超时时间为10秒  按键无响应的超时时间为5秒 前台service无响应的超时时间为20秒，后台service为200秒</li>
</ul>
<h2 id="55-Serializable和Parcelable-的区别"><a href="#55-Serializable和Parcelable-的区别" class="headerlink" title="55.Serializable和Parcelable 的区别"></a>55.Serializable和Parcelable 的区别</h2><ul>
<li>1.P 消耗内存小</li>
<li>2.网络传输用S  程序内使用P</li>
<li>3.S将数据持久化方便</li>
<li>4.S使用了反射 容易触发垃圾回收 比较慢</li>
</ul>
<h2 id="56-Sharedpreferences源码简述"><a href="#56-Sharedpreferences源码简述" class="headerlink" title="56.Sharedpreferences源码简述"></a>56.Sharedpreferences源码简述</h2><ul>
<li>1.储存于硬盘上的xml键值对，数据多了会有性能问题</li>
<li>2.ContextImpl记录着SharedPreferences的重要数据，文件路径和实例的键值对</li>
<li>3.在xml文件全部内加载到内存中之前，读取操作是阻塞的，在xml文件全部内加载到内存中之后，是直接读取内存中的数据</li>
<li>4.apply因为是异步的没有返回值, commit是同步的有返回值能知道修改是否提交成功</li>
<li>5.多并发的提交commit时，需等待正在处理的commit数据更新到磁盘文件后才会继续往下执行，从而降低效率; 而apply只是原子更新到内存，后调用apply函数会直接覆盖前面内存数据，从一定程度上提高很多效率。 3.edit()每次都是创建新的EditorImpl对象.</li>
<li>6.博客推荐：**<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/102f25cf64e3">全面剖析SharedPreferences</a>**</li>
</ul>
<h2 id="57-操作系统如何管理内存的："><a href="#57-操作系统如何管理内存的：" class="headerlink" title="57.操作系统如何管理内存的："></a>57.操作系统如何管理内存的：</h2><ul>
<li>1.使用寄存器进行将进程地址和物理内存进行映射</li>
<li>2.虚拟内存进行内存映射到硬盘上增大内存</li>
<li>3.虚拟内存是进行内存分页管理</li>
<li>4.页表实现分页，就是 页+地址偏移。</li>
<li>5.如果程序的内存在硬盘上，那么就需要用页置换算法来将其调入内存中：先进先出、最近未使用最少等等</li>
<li>6.博客推荐：**<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/aecff59430fa">现代操作系统部分章节笔记</a>**</li>
</ul>
<h2 id="58-浏览器输入地址到返回结果发生了什么"><a href="#58-浏览器输入地址到返回结果发生了什么" class="headerlink" title="58.浏览器输入地址到返回结果发生了什么"></a>58.浏览器输入地址到返回结果发生了什么</h2><ul>
<li>1.DNS解析</li>
<li>2.TCP连接</li>
<li>3.发送HTTP请求</li>
<li>4.服务器处理请求并返回HTTP报文</li>
<li>5.浏览器解析渲染页面</li>
<li>6.连接结束</li>
</ul>
<h2 id="59-java泛型类型擦除发生在什么时候，通配符有什么需要注意的。"><a href="#59-java泛型类型擦除发生在什么时候，通配符有什么需要注意的。" class="headerlink" title="59.java泛型类型擦除发生在什么时候，通配符有什么需要注意的。"></a>59.java泛型类型擦除发生在什么时候，通配符有什么需要注意的。</h2><ul>
<li>1.发生在编译的时候</li>
<li>2.PECS，extends善于提供精确的对象 A是B的子集，Super善于插入精确的对象 A是B的超集</li>
<li>3.博客推荐：**<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/4e4751b5bbbb">Effective Java笔记（不含反序列化、并发、注解和枚举）</a><strong>、</strong><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/6006a3284f55">android阿里面试java基础锦集</a>**</li>
</ul>
<h2 id="60-activity的生命周期"><a href="#60-activity的生命周期" class="headerlink" title="60.activity的生命周期"></a>60.activity的生命周期</h2><ul>
<li>1.a启动b，后退键再到a的生命周期流程：a.create–&gt;a.start–&gt;a.resume–&gt;a.pause–&gt;b.create–&gt;b.start–&gt;b.resume–&gt;b界面绘制–&gt;a.stop–&gt;b.pause–&gt;b.stop–&gt;b.destroy–&gt;a.restart–&gt;a.start–&gt;a.resume</li>
<li>2.意外销毁会调用saveInstance，重新恢复的时候回调用restoreInstance。储存数据的时候使用了委托机制，从activity–&gt;window–&gt;viewGroup–&gt;view 会递归调用save来保持本view的数据，restore则是递归恢复本view数据。我们可以在里面做一些自己需要的数据操作。</li>
</ul>
<h2 id="61-面试常考的算法"><a href="#61-面试常考的算法" class="headerlink" title="61.面试常考的算法"></a>61.面试常考的算法</h2><ul>
<li>1.快排、堆排序为首的各种排序算法</li>
<li>2.链表的各种操作：判断成环、判断相交、合并链表、倒数K个节点、寻找成环节点</li>
<li>3.二叉树、红黑树、B树定义以及时间复杂度计算方式</li>
<li>4.动态规划、贪心算法、简单的图论</li>
<li>5.推荐书籍：<strong>算法导论</strong>，将图论之前的例子写一遍</li>
</ul>
<h2 id="62-Launcher进程启动另外一个进程的过程：启动一个app"><a href="#62-Launcher进程启动另外一个进程的过程：启动一个app" class="headerlink" title="62.Launcher进程启动另外一个进程的过程：启动一个app"></a>62.Launcher进程启动另外一个进程的过程：<a target="_blank" rel="noopener" href="http://www.cnblogs.com/tiantianbyconan/p/5017056.html">启动一个app</a></h2><h2 id="63-开源框架源码"><a href="#63-开源框架源码" class="headerlink" title="63.开源框架源码"></a>63.开源框架源码</h2><ul>
<li>1.Fresco<ul>
<li>1.mvc框架：<ul>
<li>1.Controller控制数据显示在Hierarchy中的Drawable的显隐</li>
<li>2.ImagePipeline在Controller中负责进行数据获取，返回的数据是CloseableImage</li>
<li>3.Drawee把除了初始化之外的操作全部交给Holder去做，Holder持有Controller和Hierarchy</li>
</ul>
</li>
<li>2.Drawable层次以及绘制：<ul>
<li>1.如果要绘制一次Drawable就调用invalidateSelf()来触发onDraw()</li>
<li>2.Drawable分为：容器类(保存一些Drawable)、自我绘制类(进度条)、图形变换类(scale、rotate、矩阵变换)、动画类(内部不断刷新，进行webp和gif的帧绘制)</li>
<li>3.ImagePipeline返回的CloseableImage是由一个个DrawableFactory解析成Drawable的</li>
<li>4.webp和gif动画是由jni代码解析的，然后其他静态图片是根据不同的android平台使用BitmapFactory来解析的</li>
</ul>
</li>
<li>3.职责链模式：producer不做操作标n，表示只是提供一个consumer。获取图片–》解码图片缓存Producer–》后台线程Producer–》client图片处理producer(n)–》解码producer(n)–》旋转或剪裁producer(n)–》编码图片内存缓存producer–》读硬盘缓存producer–》写硬盘缓存producer(n)–》网络producer提供CloseableImage《–解码图片缓存consumer《–client图片处理consumer《–解码consumer《–旋转或剪裁consumer《–编码图片内存缓存consumer《–写硬盘缓存consumer《–图片数据</li>
<li>4.内存缓存：<ul>
<li>1.一个CountingLruMap保存已经没有被引用的缓存条目，一个CountingLruMap保存所有的条目包括没有引用的条目。每当缓存策略改变和一定时间缓存配置的更新的时候，就会将 待销毁条目Map中的条目一个个移除，直到缓存大小符合配置。</li>
<li>2.这里的引用计数是用Fresco组件实现的引用计数器。</li>
<li>3.缓存有一个代理类，用来追踪缓存的存取。</li>
<li>4.CountingLruMap是使用LinkedHashMap来储存数据的。</li>
</ul>
</li>
<li>5.硬盘缓存：<ul>
<li>1.DefaultDiskStorage使用Lru策略。</li>
<li>2.为了不让所有的文件集中在一个文件中，创建很多命名不同的文件夹，然后使用hash算法把缓存文件分散</li>
<li>3.DiskStorageCache封装了DefaultDiskStorage，不仅进行缓存存取追踪，并且其在内存里面维持着一个 &lt;key,value&gt; 的键值对，因为文件修改频繁，所有只是定时刷新，因此如果在内存中找不到，还要去硬盘中找一次。</li>
<li>4.删除硬盘的缓存只出现在硬盘数据大小超限的时候，此时同时也会删除缓存中的key，所以不会出现内存中有key，但是硬盘上没有的情况。</li>
<li>5.在插入硬盘数据的时候，采用的是插入器的形式。返回一个Inserter，在Inserter.writeData()中传入一个CallBack(里面封装了客户端插入数据的逻辑和文件引用)，让内部实现调用CallBack的逻辑来插入文件数据，前面写的文件后缀是.temp,只有调用commit()之后才会修改后缀，让文件对客户端可见。</li>
<li>6.使用了java提供的FileTreeVisitor来遍历文件</li>
</ul>
</li>
<li>6.对象池：<ul>
<li>1.使用数组来存储一个桶，桶内部是一个Queue。数组下标是数据申请内存的byte大小，桶内部的Queue存的是内存块的。所以数组使用的是稀疏数组</li>
<li>2.申请内存的方式有两种 1.java堆上开辟的内存 2.ashme 的本地内存中开辟的内存</li>
</ul>
</li>
<li>7.设计模式：Builder、职责链、观察者、代理、组合、享元、适配器、装饰者、策略、生产者消费者、提供者</li>
<li>8.自定义计数引用：类似c++智能指针<ul>
<li>1.使用一个静态IdentityHashMap &lt;储存需要被计数引用的对象,其被引用的次数&gt;</li>
<li>2.用SharedReference分装需要被计数引用的对象，提供一个销毁资源的销毁器，提供一个静态工厂方法来复制自己，复制一个引用计数加一。提供一个方法销毁自己，表示自己需要变成无人引用的对象了，此时引用计数减一。</li>
<li>3.引用计数归零，销毁器将销毁资源，如bitmap的recycle或者是jni内存调用jni方法归还内存。</li>
</ul>
</li>
<li>9.博客推荐：**<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/dbe01f9994d0">Android Fresco源码文档翻译</a><strong>、</strong><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ab2124764438">从零开始撸一个Fresco之硬盘缓存</a><strong>、</strong><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/36663090b140">从零开始撸一个Fresco之gif和Webp动画</a><strong>、</strong><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ba0de15ce667">从零开始撸一个Fresco之内存缓存</a><strong>、</strong><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/2dff47ae7666">从零开始撸一个Fresco之总结</a>**</li>
</ul>
</li>
<li>2.oKhttp：<ul>
<li>1.同步和异步：<ul>
<li>1.异步使用了Dispatcher来将存储在 Deque 中的请求分派给线程池中各个线程执行。</li>
<li>2.当任务执行完成后，无论是否有异常，finally代码段总会被执行，也就是会调用Dispatcher的finished函数，它将正在运行的任务Call从队列runningAsyncCalls中移除后，主动的把缓存队列向前走了一步。</li>
</ul>
</li>
<li>2.连接池：<ul>
<li>1.一个Connection封装了一个socket，ConnectionPool中储存s着所有的Connection，StreamAllocation是引用计数的一个单位</li>
<li>2.当一个请求获取一个Connection的时候要传入一个StreamAllocation，Connection中存着一个弱引用的StreamAllocation列表，每当上层应用引用一次Connection，StreamAllocation就会加一个。反之如果上层应用不使用了，就会删除一个。</li>
<li>3.ConnectionPool中会有一个后台任务定时清理StreamAllocation列表为空的Connection。5分钟时间，维持5个socket</li>
</ul>
</li>
<li>3.选择路线与建立连接<ul>
<li>1.选择路线有两种方式：<ul>
<li>1.无代理，那么在本地使用DNS查找到ip，注意结果是数组，即一个域名有多个IP，这就是自动重连的来源</li>
<li>2.有代理HTTP：设置socket的ip为代理地址的ip，设置socket的端口为代理地址的端口</li>
<li>3.代理好处：HTTP代理会帮你在远程服务器进行DNS查询，可以减少DNS劫持。</li>
</ul>
</li>
<li>2.建立连接<ul>
<li>1.连接池中已经存在连接，就从中取出(get)RealConnection，如果没有命中就进入下一步</li>
<li>2.根据选择的路线(Route)，调用Platform.get().connectSocket选择当前平台Runtime下最好的socket库进行握手</li>
<li>3.将建立成功的RealConnection放入(put)连接池缓存</li>
<li>4.如果存在TLS，就根据SSL版本与证书进行安全握手</li>
<li>5.构造HttpStream并维护刚刚的socket连接，管道建立完成</li>
</ul>
</li>
</ul>
</li>
<li>4.职责链模式：缓存、重试、建立连接等功能存在于拦截器中网络请求相关，主要是网络请求优化。网络请求的时候遇到的问题</li>
<li>5.博客推荐：**<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/60e5ebf0096a">Android数据层架构的实现 上篇</a><strong>、</strong><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/5def7b42d223">Android数据层架构的实现 下篇</a>**</li>
</ul>
</li>
<li>3.okio<ul>
<li>1.简介；<ul>
<li>1.sink：自己–》别人</li>
<li>2.source：别人–》自己</li>
<li>3.BufferSink：有缓存区域的sink</li>
<li>4.BufferSource：有缓存区域的source</li>
<li>5.Buffer：实现了3、4的缓存区域，内部有Segment的双向链表，在在转移数据的时候，只需要将指针转移指向就行</li>
</ul>
</li>
<li>2.比java io的好处：<ul>
<li>1.减少内存申请和数据拷贝</li>
<li>2.类少，功能齐全，开发效率高</li>
</ul>
</li>
<li>3.内部实现：<ul>
<li>1.Buffer的Segment双向链表，减少数据拷贝</li>
<li>2.Segment的内部byte数组的共享，减少数据拷贝</li>
<li>3.SegmentPool的共享和回收Segment</li>
<li>4.sink和source中被实际操作的其实是Buffer，Buffer可以充当sink和source</li>
<li>5.最终okio只是对java io的封装，所有操作都是基于java io 的</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>写在最后:能看到这里的人,我挺佩服你的.这篇文章是我在<strong>头条</strong>面试之前整理的,最后**80%**的题目都命中了,所以祝你好运.</p>
</blockquote>
<p>不贩卖焦虑，也不标题党。分享一些这个世界上有意思的事情。题材包括且不限于：科幻、科学、科技、互联网、程序员、计算机编程。下面是我的微信公众号：<strong>世界上有意思的事</strong>，干货多多等你来看。</p>
<p>作者：何时夕<br>链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/cf5092fa2694">https://www.jianshu.com/p/cf5092fa2694</a><br>来源：简书<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
<h1 id="百度面试题"><a href="#百度面试题" class="headerlink" title="百度面试题"></a><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/f0d2ed1254a9">百度面试题</a></h1><p>电话面试</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> 安卓View绘制流程</span><br><span class="line"><span class="bullet">2.</span> 事件分发机制</span><br><span class="line"><span class="bullet">3.</span> JAVA基础思想</span><br><span class="line"><span class="bullet">4.</span> 多线程和安全问题</span><br><span class="line"><span class="bullet">5.</span> 安卓性能优化和兼容问题</span><br><span class="line"><span class="bullet">6.</span> 再问一下常规的组件相关问题</span><br></pre></td></tr></table></figure>





<p>现场笔试</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>  请描述安卓四大组建之间的关系，并说下安卓MVC的设计模式。</span><br><span class="line"></span><br><span class="line"><span class="number">2</span> 线程中sleep()和wait()有和却别，各有什么含义                   </span><br><span class="line"></span><br><span class="line"><span class="number">3</span>  <span class="keyword">abstract</span>和<span class="class"><span class="keyword">interface</span>的区别?</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span> array,arrayList, List ,三者有何区别？</span><br><span class="line"></span><br><span class="line"><span class="number">5</span> hashtable和hashmap的区别,并简述Hashmap的实现原理</span><br><span class="line"></span><br><span class="line"><span class="number">6</span> StringBuilder和],String ,subString方法的细微差别</span><br><span class="line">          </span><br><span class="line"><span class="number">7</span> 请写出四种以上你知道的设计模式，并介绍下实现原理</span><br><span class="line">          </span><br><span class="line"><span class="number">8</span> 安卓子线程是否能更新UI，如果能请说明具体细节。</span><br><span class="line"></span><br><span class="line"><span class="number">9</span> ANR产生的原因和解决步骤</span><br><span class="line"></span><br><span class="line"><span class="number">10</span> JavaGC机制的原理和内存泄露</span><br><span class="line"></span><br><span class="line"><span class="number">11</span>  安卓布局优化方案，          </span><br><span class="line"></span><br><span class="line"><span class="number">12</span>  请在<span class="number">100</span>个电话号码找出<span class="number">135</span>的电话号码   注意 不能用正则，（类似怎么最好的遍历LogGat日志）</span><br><span class="line"><span class="number">13</span>  Handler机制，请写出一种更新UI的方法和代码</span><br><span class="line"></span><br><span class="line"><span class="number">14</span>  请解释安卓为啥要加签名机制。</span><br><span class="line"></span><br><span class="line"><span class="number">15</span>   你觉得安卓开发最关键的技术在哪里？</span><br><span class="line"><span class="number">13</span>  Handler机制，请写出一种更新UI的方法和代码</span><br><span class="line"></span><br><span class="line"><span class="number">14</span>  请解释安卓为啥要加签名机制。</span><br><span class="line"></span><br><span class="line"><span class="number">15</span>   你觉得安卓开发最关键的技术在哪里？</span><br></pre></td></tr></table></figure>

<p>一轮面试：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">1  ANR 具体产生的类型有哪些，具体说下其产生的最大超时时间。</span><br><span class="line"></span><br><span class="line">2  多线程多点下载的过程</span><br><span class="line"></span><br><span class="line">3 http协议的理解和用法</span><br><span class="line"></span><br><span class="line">4 安卓解决线程并发问题</span><br><span class="line"></span><br><span class="line">5 你知道的数据结构有哪些，说下具体实现机制</span><br><span class="line"></span><br><span class="line">6 十六进制数据怎么和十进制和二进制之间转换</span><br><span class="line"></span><br><span class="line">7 谈下对Java OOP中多态的理解</span><br><span class="line"></span><br><span class="line">8  activty和Fragmengt之间怎么通信，Fragmengt和Fragmengt怎么通信</span><br><span class="line"></span><br><span class="line">9 怎么让自己的进程不被第三方应用杀掉，系统杀掉之后怎么能启动起来。</span><br><span class="line">10 说下平时开发中比较注意的一些问题，</span><br><span class="line">         </span><br><span class="line">答 ：可以熟说下svn和git的细节，和代码规范问题，和一些安全信息的问题等</span><br><span class="line"></span><br><span class="line">11 自定义view效率高于xml定义吗？说明理由。</span><br><span class="line"></span><br><span class="line">13 广播注册一般有几种，各有什么优缺点</span><br><span class="line"></span><br><span class="line">14 服务启动一般有几种，服务和activty之间怎么通信，服务和服务之间怎么通信</span><br><span class="line">15 布局优化主要哪些？具体优化？</span><br><span class="line"></span><br><span class="line">16 数据库的知识，包括本地数据库优化点。</span><br></pre></td></tr></table></figure>

<p>二轮面试</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> 安卓事件分发机制，请详细说下整个流程</span><br><span class="line"></span><br><span class="line"><span class="number">2</span> 安卓view绘制机制和加载过程，请详细说下整个流程</span><br><span class="line"></span><br><span class="line"><span class="number">3</span> activty的加载过程 请详细介绍下（不是生命周期切记）</span><br><span class="line"></span><br><span class="line"><span class="number">4</span> 安卓采用自动垃圾回收机制，请说下安卓内存管理的原理</span><br><span class="line">     </span><br><span class="line"><span class="number">5</span>  说下安卓虚拟机和java虚拟机的原理和不同点 </span><br><span class="line"></span><br><span class="line"><span class="number">6</span> 多线程中的安全队列一般通过什么实现？线程池原理？（java）</span><br><span class="line"></span><br><span class="line"><span class="number">7</span> 安卓权限管理，为何在清单中注册权限，安卓APP就可以使用，反之不可以（操作系统）</span><br><span class="line"></span><br><span class="line"><span class="number">8</span>  socket短线重连怎么实现，心跳机制又是怎样实现，四次握手步骤有哪些（网络通讯原理）</span><br><span class="line"></span><br><span class="line"><span class="number">9</span> http中TCP和UDP有啥区别，说下HTTP请求的IP报文结构（计算机网络）</span><br><span class="line"><span class="number">10</span> 你知道的安全加密有哪些？   （如果你说了一个加密，面试官就会接着跟进提问，所以之前你必须要会，不会的话背也要背下来）（安全加密）</span><br><span class="line"><span class="number">11</span>  你知道的数据存储结构？堆栈和链表内部机制。（数据结构）</span><br><span class="line"></span><br><span class="line"><span class="number">12</span> 说下Linux进程和线程的区别。进程调度优先级，和cpu调度进程关系。（操作系统）</span><br><span class="line"> </span><br><span class="line"><span class="number">13</span> 请你详细说下你知道的一种设计模式，并解释下java的高内聚和低耦合。</span><br><span class="line"></span><br><span class="line"><span class="number">14</span>  spring 的反射和代理，在安卓中应用场景（插件和ROM数据框架）</span><br><span class="line"></span><br><span class="line"><span class="number">15</span> JNI 调用过程中 混淆问题</span><br><span class="line"></span><br><span class="line"><span class="number">16</span> 看过安卓源码吗，请说出一个你看过的API或者组建内部原理。</span><br><span class="line"></span><br><span class="line"><span class="number">17</span> android <span class="number">5.0</span> <span class="number">6.0</span> 以及<span class="number">7.0</span>预测新特性</span><br><span class="line"></span><br><span class="line"><span class="number">18</span> hybrid混合开发，响应式编程等</span><br><span class="line"></span><br><span class="line"><span class="number">17</span>为啥离职呢  对待加班看法</span><br><span class="line"></span><br><span class="line"><span class="number">18</span> 你擅长什么，做了那些东西。</span><br></pre></td></tr></table></figure>



<h1 id="名企面试题"><a href="#名企面试题" class="headerlink" title="名企面试题"></a><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/735be5ece9e8">名企面试题</a></h1><h2 id="Android"><a href="#Android" class="headerlink" title="Android"></a><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/tree/master/android">Android</a></h2><h5 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h5><ul>
<li>[Android 源码中的设计模式(你需要知道的设计模式全在这里)](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android</a> 源码中的设计模式(你需要知道的设计模式全在这里).md)</li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/%E5%85%A8%E9%9D%A2%E4%BA%86%E8%A7%A3Activity.md">全面了解Activity</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Service%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93.md">Service全面总结</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/IntentService%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3%E5%92%8C%E5%AE%9E%E4%BE%8B%E4%BB%8B%E7%BB%8D.md">IntentService使用详解和实例介绍</a></li>
<li>[Fragment 全解析](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Fragment">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Fragment</a> 全解析.md)</li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/ContentProvider%E5%AE%9E%E4%BE%8B%E8%AF%A6%E8%A7%A3.md">ContentProvider实例详解</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/BroadcastReceiver%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93.md">BroadcastReceiver使用总结</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1%E6%9C%BA%E5%88%B6%E4%B9%8BAsycTask.md">Android异步任务机制之AsycTask</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B%E5%9B%BE%E8%A7%A3.md">Android启动过程图解</a></li>
<li>[Android 自定义View入门](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android</a> 自定义View入门.md)</li>
<li>[Android 自定义ViewGroup入门实践](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android</a> 自定义ViewGroup入门实践.md)</li>
<li>[Android 缓存机制](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android</a> 缓存机制.md)</li>
<li>[Android 数据存储五种方式使用与总结](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android</a> 数据存储五种方式使用与总结.md)</li>
<li>[Android 异步消息处理机制源码解析](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android</a> 异步消息处理机制（Handler 、 Looper 、MessageQueue）源码解析.md)</li>
<li>[Android View事件分发机制源码分析](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android</a> View事件分发机制源码分析.md)</li>
<li>[Android SQLite的使用入门](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android</a> SQLite的使用入门.md)</li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/AIDL%E7%9A%84%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5%E5%92%8C%E5%AE%9E%E4%BE%8B%E4%BB%8B%E7%BB%8D.md">AIDL的使用情况和实例介绍</a></li>
<li>[Android 名企面试题及答案整理（一）](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android</a> 名企面试题及答案整理（一）.md)</li>
</ul>
<h5 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h5><ul>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android5.0%E3%80%816.0%E3%80%817.0%E6%96%B0%E7%89%B9%E6%80%A7.md">Android5.0、6.0、7.0新特性</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android%E4%B8%AD%E5%BC%B1%E5%BC%95%E7%94%A8%E4%B8%8E%E8%BD%AF%E5%BC%95%E7%94%A8%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF.md">Android中弱引用与软引用的应用场景</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Android%E9%95%BF%E8%BF%9E%E6%8E%A5%EF%BC%8C%E6%80%8E%E4%B9%88%E5%A4%84%E7%90%86%E5%BF%83%E8%B7%B3%E6%9C%BA%E5%88%B6.md">Android长连接，怎么处理心跳机制</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Asset%E7%9B%AE%E5%BD%95%E4%B8%8Eres%E7%9B%AE%E5%BD%95%E7%9A%84%E5%8C%BA%E5%88%AB.md">Asset目录与res目录的区别</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Binder%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86%E5%92%8C%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0.md">Binder机制原理和底层实现</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/Json%E4%BC%98%E5%8A%A3%E5%8A%BF.md">Json优劣势</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/ListView%E4%BC%98%E5%8C%96.md">ListView优化</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/android%E4%B8%AD%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98.md">android中图片缓存</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/%E4%B8%A4%E7%B1%BB%E5%8A%A8%E7%94%BB.md">两类动画</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/%E4%BA%94%E5%A4%A7%E5%B8%83%E5%B1%80%E6%98%93%E6%B7%B7%E6%B7%86%E7%9F%A5%E8%AF%86.md">五大布局易混淆知识</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/%E4%BF%9D%E8%AF%81service%E4%B8%8D%E8%A2%AB%E6%9D%80%E6%AD%BB.md">保证service不被杀死</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/%E5%8A%A0%E9%80%9F%E5%90%AF%E5%8A%A8activity.md">加速启动activity</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/%E6%80%8E%E6%A0%B7%E9%80%80%E5%87%BA%E7%BB%88%E6%AD%A2App.md">怎样退出终止App</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/android/activity%E5%88%87%E6%8D%A2%E5%8A%A8%E7%94%BB.md">activity切换动画</a></li>
</ul>
<h5 id="外链"><a href="#外链" class="headerlink" title="外链"></a>外链</h5><ul>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://www.trinea.cn/android/layout-performance/">布局性能优化(include, viewstub, merge)</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://www.cnblogs.com/xiaoluo501395377/p/3444744.html">DOM、SAX、Pull解析XML</a></li>
</ul>
<h2 id="Java"><a href="#Java" class="headerlink" title="Java"></a><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/tree/master/java">Java</a></h2><h5 id="基础-1"><a href="#基础-1" class="headerlink" title="基础"></a>基础</h5><ul>
<li>[ArrayList、LinkedList、Vector的区别](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> ArrayList、LinkedList、Vector的区别.md)</li>
<li>[Collection包结构，与Collections的区别](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> Collection包结构，与Collections的区别.md)</li>
<li>[Excption与Error包结构,OOM和SOF](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> Excption与Error包结构%2COOM和SOF.md)</li>
<li>[HashMap和HashTable的区别](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> HashMap和HashTable的区别.md)</li>
<li>[HashMap源码分析](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> HashMap源码分析.md)</li>
<li>[Hashcode的作用](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> Hashcode的作用.md)</li>
<li>[Map、Set、List、Queue、Stack的特点与用法](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> Map、Set、List、Queue、Stack的特点与用法.md)</li>
<li>[Object有哪些公用方法？](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> Object有哪些公用方法？.md)</li>
<li>[Override和Overload的使用规则和区别](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> Override和Overload的使用规则和区别.md)</li>
<li>[Switch能否用string做参数？](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> Switch能否用string做参数？.md)</li>
<li>[ThreadLocal的使用规则和源码分析](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> ThreadLocal的使用规则和源码分析.md)</li>
<li>[ThreadPool用法与示例](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> ThreadPool用法与示例.md)</li>
<li>[equals与==的区别](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> equals与%3D%3D的区别.md)</li>
<li>[try catch finally，try里有return，finally还执行么？](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> try catch finally，try里有return，finally还执行么？.md)</li>
<li>[九种基本数据类型的大小，以及他们的封装类](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> 九种基本数据类型的大小，以及他们的封装类.md)</li>
<li>[从源码分析String、StringBuffer与StringBuilder区别和联系](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> 从源码分析String、StringBuffer与StringBuilder区别和联系.md)</li>
<li>[多线程下生产者消费者问题的五种同步方法实现](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> 多线程下生产者消费者问题的五种同步方法实现.md)</li>
<li>[实现多线程的两种方法](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> 实现多线程的两种方法.md)</li>
<li>[接口（Interface）与 抽象类 （Abstract）使用规则和区别](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> 接口（Interface）与 抽象类 （Abstract）使用规则和区别.md)</li>
<li>[方法锁、对象锁和类锁的意义和区别](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> 方法锁、对象锁和类锁的意义和区别.md)</li>
<li>[四种引用，强弱软虚，用到的场景](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> 的四种引用，强弱软虚，用到的场景.md)</li>
<li>[线程同步的方法：sychronized、lock、reentrantLock分析](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> 线程同步的方法：sychronized、lock、reentrantLock分析.md)</li>
<li>[集合框架的层次结构和使用规则梳理](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> 集合框架的层次结构和使用规则梳理.md)</li>
<li>[面向对象的三个特征与含义](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5BJava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[Java]</a> 面向对象的三个特征与含义.md)</li>
<li>[static的作用和意义](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5Bjava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[java]</a> static的作用和意义.md)</li>
<li>[多态实现的JVM调用过程](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/%5Bjava%5D">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/java/[java]</a> 多态实现的JVM调用过程.md)</li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/wait()%E5%92%8Csleep()%E7%9A%84%E5%8C%BA%E5%88%AB.md">wait()和sleep()的区别</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/git%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8.md">git命令使用</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/java/Java%E4%B8%8EC++%E5%AF%B9%E6%AF%94.md">Java与C++对比</a></li>
</ul>
<h5 id="外链-1"><a href="#外链-1" class="headerlink" title="外链"></a>外链</h5><ul>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://762626559-qq-com.iteye.com/blog/395402">java反射</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://blog.csdn.net/xiaanming/article/details/8703708/">java回调</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://www.weixueyuan.net/view/6321.html">Java泛型</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://www.cnblogs.com/langtianya/p/3757993.html">java 新特性</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://www.iteye.com/topic/834447">Java IO与NIO</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://www.xuebuyuan.com/780786.html">foreach与正常for循环效率对比</a></li>
</ul>
<h2 id="数据结构-https-link-jianshu-com-t-https-github-com-helen-x-AndroidInterview-tree-master-data-structure"><a href="#数据结构-https-link-jianshu-com-t-https-github-com-helen-x-AndroidInterview-tree-master-data-structure" class="headerlink" title="[数据结构](https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/tree/master/data structure)"></a>[数据结构](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/tree/master/data">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/tree/master/data</a> structure)</h2><h5 id="基础-2"><a href="#基础-2" class="headerlink" title="基础"></a>基础</h5><ul>
<li>[九大基础排序总结与对比(排序算法一网打尽)](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/data">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/data</a> structure/[数据结构] 九大基础排序总结与对比.md)</li>
<li>[AVL树和AVL旋转、哈夫曼树和哈夫曼编码](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/data">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/data</a> structure/[数据结构] AVL树和AVL旋转、哈夫曼树和哈夫曼编码.md)</li>
<li>[B(B-)树、B+树、B树](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/data">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/data</a> structure/[数据结构] B(B-)树、B%2B树、B树.md)</li>
<li>[Hash表、Hash函数及冲突解决](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/data">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/data</a> structure/[数据结构] Hash表、Hash函数及冲突解决.md)</li>
<li>[KMP的一个简单解释](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/data">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/data</a> structure/[数据结构] KMP的一个简单解释.md)</li>
<li>[二分查找与变种二分查找](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/data">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/data</a> structure/[数据结构] 二分查找与变种二分查找.md)</li>
<li>[二叉树前中后、层次遍历算法](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/data">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/data</a> structure/[数据结构] 二叉树前中后、层次遍历算法.md)</li>
<li>[图的BFS、DFS、prim、Dijkstra算法](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/data">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/data</a> structure/[数据结构] 图的BFS、DFS、prim、Dijkstra算法.md)</li>
<li>[字符串操作](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/data">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/data</a> structure/[数据结构] 字符串操作.md)</li>
<li>[数组与链表的优缺点和区别](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/data">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/data</a> structure/[数据结构] 数组与链表的优缺点和区别.md)</li>
<li>[红黑树](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/data">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/data</a> structure/[数据结构] 红黑树.md)</li>
<li>[队列和栈](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/data">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/data</a> structure/[数据结构] 队列和栈.md)</li>
</ul>
<h5 id="外链-2"><a href="#外链-2" class="headerlink" title="外链"></a>外链</h5><ul>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://blog.csdn.net/zyq522376829/article/details/47686867">海量数据处理 </a></li>
</ul>
<h2 id="算法"><a href="#算法" class="headerlink" title="算法"></a><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/tree/master/algorithm">算法</a></h2><h5 id="基础-3"><a href="#基础-3" class="headerlink" title="基础"></a>基础</h5><ul>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E4%B8%8E%E5%8F%8C%E5%90%91%E9%93%BE%E8%A1%A8.md">二叉搜索树与双向链表</a></li>
<li>[二叉树中 和为某值 的所有路径](<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E4%BA%8C%E5%8F%89%E6%A0%91%E4%B8%AD">https://link.jianshu.com?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/二叉树中</a> 和为某值 的所有路径.md)</li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E9%95%9C%E5%83%8F.md">二叉树的镜像</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E6%9F%A5%E6%89%BE.md">二维数组中的查找</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%B8%AD1%E7%9A%84%E4%B8%AA%E6%95%B0.md">二进制中1的个数</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E4%BB%8E%E4%B8%8A%E5%BE%80%E4%B8%8B%E6%89%93%E5%8D%B0%E4%BA%8C%E5%8F%89%E6%A0%91.md">从上往下打印二叉树</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E4%BB%8E%E5%B0%BE%E5%88%B0%E5%A4%B4%E6%89%93%E5%8D%B0%E9%93%BE%E8%A1%A8.md">从尾到头打印链表</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E5%88%A4%E6%96%AD%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E7%9A%84%E5%90%8E%E5%BA%8F%E9%81%8D%E5%8E%86%E5%BA%8F%E5%88%97.md">判断二叉搜索树的后序遍历序列</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E5%88%A4%E6%96%AD%E6%A0%88%E7%9A%84%E5%BC%B9%E5%87%BA%E5%BA%8F%E5%88%97.md">判断栈的弹出序列</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E5%88%A4%E6%96%AD%E6%A0%91B%E6%98%AF%E4%B8%8D%E6%98%AF%E6%A0%91A%E7%9A%84%E5%AD%90%E7%BB%93%E6%9E%84.md">判断树B是不是树A的子结构</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E5%8C%85%E5%90%ABmin%E5%87%BD%E6%95%B0%E7%9A%84%E6%A0%88.md">包含min函数的栈</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E5%8F%8D%E8%BD%AC%E9%93%BE%E8%A1%A8.md">反转链表</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E5%8F%98%E6%80%81%E8%B7%B3%E5%8F%B0%E9%98%B6.md">变态跳台阶</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E6%8E%92%E5%BA%8F%E9%93%BE%E8%A1%A8.md">合并两个排序链表</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E5%A4%8D%E6%9D%82%E9%93%BE%E8%A1%A8%E7%9A%84%E5%A4%8D%E5%88%B6.md">复杂链表的复制</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E7%A9%BA%E6%A0%BC%E6%9B%BF%E6%8D%A2.md">字符串中空格替换</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E9%A1%BA%E5%BA%8F%E5%85%A8%E6%8E%92%E5%88%97.md">字符串的顺序全排列</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E6%95%B0%E7%BB%84%E4%B8%AD%E5%87%BA%E7%8E%B0%E6%AC%A1%E6%95%B0%E8%B6%85%E8%BF%87%E4%B8%80%E5%8D%8A%E7%9A%84%E6%95%B0%E5%AD%97.md">数组中出现次数超过一半的数字</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97.md">斐波那契数列</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E6%97%8B%E8%BD%AC%E6%95%B0%E7%BB%84%E7%9A%84%E6%9C%80%E5%B0%8F%E6%95%B0%E5%AD%97.md">旋转数组的最小数字</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E6%B5%AE%E7%82%B9%E6%95%B0%E7%9A%84%E6%95%B4%E6%95%B0%E6%AC%A1%E6%96%B9.md">浮点数的整数次方</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E7%94%A8%E4%B8%A4%E4%B8%AA%E6%A0%88%E5%AE%9E%E7%8E%B0%E9%98%9F%E5%88%97.md">用两个栈实现队列</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E7%9F%A9%E5%BD%A2%E8%A6%86%E7%9B%96.md">矩形覆盖</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E8%B0%83%E6%95%B4%E6%95%B0%E7%BB%84%E9%A1%BA%E5%BA%8F%E4%BD%BF%E5%A5%87%E6%95%B0%E4%BD%8D%E4%BA%8E%E5%81%B6%E6%95%B0%E5%89%8D%E9%9D%A2.md">调整数组顺序使奇数位于偶数前面</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E8%B7%B3%E5%8F%B0%E9%98%B6.md">跳台阶</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E9%87%8D%E5%BB%BA%E4%BA%8C%E5%8F%89%E6%A0%91.md">重建二叉树</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E9%93%BE%E8%A1%A8%E4%B8%AD%E5%80%92%E6%95%B0%E7%AC%ACk%E4%B8%AA%E7%BB%93%E7%82%B9.md">链表中倒数第k个结点</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/helen-x/AndroidInterview/blob/master/algorithm/swordForOffer/%E9%A1%BA%E6%97%B6%E9%92%88%E6%89%93%E5%8D%B0%E7%9F%A9%E9%98%B5.md">顺时针打印矩阵</a></li>
</ul>
<h5 id="外链-3"><a href="#外链-3" class="headerlink" title="外链"></a>外链</h5><ul>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://www.cnblogs.com/steven_oyj/archive/2010/05/22/1741370.html">分治算法</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://www.cnblogs.com/steven_oyj/archive/2010/05/22/1741374.html">动态规划</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://www.cnblogs.com/steven_oyj/archive/2010/05/22/1741375.html">贪心算法</a></li>
<li><a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://www.cnblogs.com/steven_oyj/archive/2010/05/22/1741378.html">分支限界法</a></li>
</ul>
<p>作者：菜刀文<br>链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/735be5ece9e8">https://www.jianshu.com/p/735be5ece9e8</a><br>来源：简书<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
<h1 id="面试和必备的技能"><a href="#面试和必备的技能" class="headerlink" title="面试和必备的技能"></a>面试和必备的技能</h1><p>这里只简单列举一些东西，可能不是特别全，但是却特别适用，也不一定按照下面的流程，有可能是穿插的，也有可能都有，根据公司的规模以及面试官的心情而定（哈哈哈 ，你们就自求多福吧）。建议大家还是要将下面的东西全部掌握，没事写写代码，练练手，在项目中能用到的地方一定要用，有可能会遇到很多坑，一定要自己想办法填坑，之后回忆起这段经历，肯定可以敢理直气壮的跟别人讨论。如果你说的头头是道，那么对方会先输一层，然后在心里对你佩服。</p>
<ol>
<li><p>一般情况下第一轮都是基础面试，需要扎实的基础</p>
<ul>
<li>最常用的Android 基础知识</li>
<li>Java 基础知识</li>
<li>了解一些 常用东西的原理，例如：handler， thread 等</li>
<li>项目中的技术点</li>
</ul>
</li>
<li><p>第二轮的时候需要了解更深层次的东西</p>
<ul>
<li>Android 事件分发机制原理</li>
<li>Android 绘图机制原理</li>
<li>WindowManager 的相关知识</li>
<li>进程间传输方式</li>
<li>Java 内存管理机制</li>
<li>一些常用的 list,map 原理，以及子类之间的差别</li>
</ul>
</li>
<li><p>能进入第三轮基本没什么问题，但是要注意以下问题</p>
<ul>
<li><p>该轮一般是 老大或者部门负责人，问的问题一般都看 深度与广度</p>
</li>
<li><p>当问及薪水的时候，要说一个合适的，小公司随意，大公司一定要慎重，当心里没底的时候，可以告诉对方，让对方给一个合理的薪资。一般都是在原工资基础之上增长，听猎头说一般涨幅都在15%-30%，超 NB 的可以要30%及以上，如果感觉自己还不错的，挺厉害的，建议最高20%，一般人就定在15% 左右最靠谱。公司内部一般有一套机制，根据公司情况而定。</p>
</li>
<li><p>我们的面试原则就是拿到合理薪资，得到 offer</p>
</li>
<li><p>个人发展情况，这个问题很难回答，如果和公司方向不符合，极有可能和公司无缘。建议多试探性的问问公司缺少什么，你能否给予公司对应的东西。当然对于有自我追求的人，那可以放心大胆的提。我的方向就是架构师，哈哈哈，挺极端的，别学我哦。我感觉选择都是双向的，因此我知道自己需要的是什么。</p>
</li>
<li><p>你最擅长什么UI 还是其他什么？这个问题更不好回答。你要说你擅长 UI，是不是意味着你其他能力就不行？虽然我不知道面试官的用意，但是我能感觉到，这个问题不是那么好回答，我会回答说自己都行，来什么业务接什么需求。可能回答不太好，总之和公司的职位吻合就行，这样总不至于出错吧。</p>
</li>
</ul>
</li>
</ol>
<h2 id="Android-高级面试题及答案"><a href="#Android-高级面试题及答案" class="headerlink" title="Android 高级面试题及答案"></a><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html">Android 高级面试题及答案</a></h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label0">1.如何对 Android 应用进行性能分析</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label1">2.什么情况下会导致内存泄露</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label2">3.如何避免 OOM 异常</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label3">4.Android 中如何捕获未捕获的异常</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label4">5.ANR 是什么？怎样避免和解决 ANR（重要）</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label5">6.Android 线程间通信有哪几种方式</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label6">7.Devik 进程，linux 进程，线程的区别</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label7">8.描述一下 android 的系统架构</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label8">9.android 应用对内存是如何限制的?我们应该如何合理使用内存？</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label9">10. 简述 android 应用程序结构是哪些</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label10">11.请解释下 Android 程序运行时权限与文件系统权限的区别</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label11">12.Framework 工作方式及原理，Activity 是如何生成一个 view 的，机制是什么</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label12">13.多线程间通信和多进程之间通信有什么不同，分别怎么实现</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label13">14.Android 屏幕适配</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label14">15.什么是 AIDL 以及如何使用</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label15">16.Handler 机制</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label16">17.事件分发机制</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label17">18.子线程发消息到主线程进行更新 UI，除了 handler 和 AsyncTask，还有什么</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label18">19.子线程中能不能 new handler？为什么</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label19">20.Android 中的动画有哪几类，它们的特点和区别是什么</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label20">21.如何修改 Activity 进入和退出动画</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label21">22.SurfaceView &amp; View 的区别</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label22">23.开发中都使用过哪些框架、平台</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label23">24.使用过那些自定义View</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label24">25.自定义控件：绘制圆环的实现过程</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label25">26.自定义控件：摩天轮的实现过程</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label27">28.流式布局的实现过程</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/deman/p/5860976.html#_label28">29.第三方登陆</a></li>
<li>[30.第三方支付](</li>
</ul>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/page/11/index.html">http://noteforme.github.io.com/page/11/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/inter/" rel="tag">inter</a></li></ul>

          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-TextView" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/03/04/TextView/">TextView</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-03-04T13:16:56.000Z" itemprop="datePublished">2018年03月04日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/ANDROID/">ANDROID</a>
  </div>

      
      
<a href="/2018/03/04/TextView/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h5 id="TextView颜色变化"><a href="#TextView颜色变化" class="headerlink" title="TextView颜色变化"></a>TextView颜色变化</h5><ul>
<li>SpannableString</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://juejin.im/entry/5729d28f1ea49300606854c9">https://juejin.im/entry/5729d28f1ea49300606854c9</a><br>SpannableString有一个不方便的地方是截取字符串</p>
<pre><code>    TextView tvRegister = findViewById(R.id.tv_register);
      //将TextView的显示文字设置为SpannableString
​        tvRegister.setText(getClickableSpan());
​        //设置该句使文本的超连接起作用
​        tvRegister.setMovementMethod(LinkMovementMethod.getInstance());
​        
​       private SpannableString getClickableSpan() &#123;
​        SpannableString spanTxt = new SpannableString(&quot;阅读并同意&lt;&lt;用户注册协议&gt;&gt;&quot;);
​        //设置文字的前景色
​        spanTxt.setSpan(new ForegroundColorSpan(Color.GREEN),5, 15,Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
​        spanTxt.setSpan(new ClickableSpan() &#123;    
​            @Override
​            public void onClick(View widget) &#123;
​                Intent intent = new Intent(TextViewActivity.this, FirstActivity.class);
​                startActivity(intent);
​            &#125;
​        &#125;, 5, 15, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
​      
</code></pre>
<p>​    </p>
<p>​     </p>
<ul>
<li>Html标签方式</li>
</ul>
<pre><code>    TextView textView = (TextView) findViewById(R.id.text_for_test);
    String textSource = &quot;修改TextView中部分文字的&lt;font color=&#39;#ff0000&#39;&gt;&lt;big&gt;大&lt;/big&gt;&lt;small&gt;小&lt;/small&gt;&lt;/font&gt;和&lt;font color=&#39;#00ff00&#39;&gt;颜色&lt;/font&gt;，展示多彩效果！&quot;;
    textView.setText(Html.fromHtml(textSource));
</code></pre>
<p><a target="_blank" rel="noopener" href="http://www.jianshu.com/p/f6cef78e8652">http://www.jianshu.com/p/f6cef78e8652</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/liqy/TextViewDemo">https://github.com/liqy/TextViewDemo</a></p>
<h5 id="EditText"><a href="#EditText" class="headerlink" title="EditText"></a>EditText</h5><ul>
<li>style里面的配置</li>
</ul>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">&quot;android:focusable&quot;</span>&gt;<span class="literal">true</span>&lt;/<span class="built_in">item</span>&gt;</span><br><span class="line"> &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">&quot;android:focusableInTouchMode&quot;</span>&gt;<span class="literal">true</span>&lt;/<span class="built_in">item</span>&gt;</span><br></pre></td></tr></table></figure>

<p> <a target="_blank" rel="noopener" href="https://blog.csdn.net/u011630575/article/details/50775639">https://blog.csdn.net/u011630575/article/details/50775639</a></p>
<ul>
<li><p>下划线颜色</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/lindroid20/article/details/72551102">https://blog.csdn.net/lindroid20/article/details/72551102</a></p>
</li>
<li><p>自定义解析器</p>
<p><a target="_blank" rel="noopener" href="https://my.oschina.net/ososchina/blog/3018393">https://my.oschina.net/ososchina/blog/3018393</a></p>
</li>
<li><p>密码输入框</p>
<p><a target="_blank" rel="noopener" href="https://github.com/li504799868/ZEditText">https://github.com/li504799868/ZEditText</a></p>
</li>
</ul>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/page/11/index.html">http://noteforme.github.io.com/page/11/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-LeakMemory" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/02/09/LeakMemory/">LeakMemory</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-02-09T08:15:17.000Z" itemprop="datePublished">2018年02月09日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/ANDROID/">ANDROID</a>
  </div>

      
      
<a href="/2018/02/09/LeakMemory/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="内存泄漏"><a href="#内存泄漏" class="headerlink" title="内存泄漏"></a>内存泄漏</h4><img src="/2018/02/09/LeakMemory/2021-07-31_leankreson.png" style="zoom:50%;">



<img src="/2018/02/09/LeakMemory/Users/john/Documents/noteforme.github.io/source/_posts/LeakMemory/2021-07-31_4.28_oom.png" style="zoom:33%;">





<img src="/2018/02/09/LeakMemory/Users/john/Documents/noteforme.github.io/source/_posts/LeakMemory/2021-07-31_4_webview.png" style="zoom:50%;">



<p><img src="/2018/02/09/LeakMemory/Users/john/Documents/noteforme.github.io/source/_posts/LeakMemory/2021-07-31_4_thread.png"></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/tO1yxFs2qNQlQ2bJ8vGzQA">https://mp.weixin.qq.com/s/tO1yxFs2qNQlQ2bJ8vGzQA</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ac00e370f83d">https://www.jianshu.com/p/ac00e370f83d</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/francistao/LearningNotes/blob/master/Part1/Android/Android%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E6%80%BB%E7%BB%93.md">内存泄漏总结</a></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">SampleActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Instances of static inner classes do not hold an implicit</span></span><br><span class="line"><span class="comment">   * reference to their outer class.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> static <span class="class"><span class="keyword">class</span> <span class="title">MyHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">WeakReference</span>&lt;<span class="type">SampleActivity</span>&gt; mActivity;</span><br><span class="line"></span><br><span class="line">    public <span class="type">MyHandler</span>(<span class="type">SampleActivity</span> activity) &#123;</span><br><span class="line">      mActivity = <span class="keyword">new</span> <span class="type">WeakReference</span>&lt;<span class="type">SampleActivity</span>&gt;(activity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    public void handleMessage(<span class="type">Message</span> msg) &#123;</span><br><span class="line">      <span class="type">SampleActivity</span> activity = mActivity.get();</span><br><span class="line">      <span class="keyword">if</span> (activity != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">MyHandler</span> mHandler = <span class="keyword">new</span> <span class="type">MyHandler</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Instances of anonymous classes do not hold an implicit</span></span><br><span class="line"><span class="comment">   * reference to their outer class when they are &quot;static&quot;.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> static <span class="keyword">final</span> <span class="type">Runnable</span> sRunnable = <span class="keyword">new</span> <span class="type">Runnable</span>() &#123;</span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      public void run() &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Post a message and delay its execution for 10 minutes.</span></span><br><span class="line">    mHandler.postDelayed(sRunnable, <span class="number">1000</span> * <span class="number">60</span> * <span class="number">10</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Go back to the previous Activity.</span></span><br><span class="line">    finish();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>kotin Fragment方式</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHandler</span> : <span class="type">Handler &#123;</span></span></span><br><span class="line">      <span class="keyword">private</span> <span class="keyword">var</span> mFragment: WeakReference&lt;Any&gt;</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">constructor</span>(fragment: Fragment) &#123;</span><br><span class="line">          mFragment = WeakReference(fragment)</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">handleMessage</span><span class="params">(msg: <span class="type">android</span>.<span class="type">os</span>.<span class="type">Message</span>?)</span></span> &#123;</span><br><span class="line">          <span class="keyword">super</span>.handleMessage(msg)</span><br><span class="line">          <span class="keyword">val</span> fragment = mFragment.<span class="keyword">get</span>() <span class="keyword">as</span> PayProFragment</span><br><span class="line">          fragment.reloadPay()</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li>
<li><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/63aead89f3b9">内存泄漏处理-Handler</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://juejin.im/entry/589542ed2f301e0069054007">查找方式</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/bdfd2a6b2681">https://www.jianshu.com/p/bdfd2a6b2681</a></p>
</li>
</ul>
<p>​    <a target="_blank" rel="noopener" href="https://developer.android.com/studio/profile/memory-profiler">https://developer.android.com/studio/profile/memory-profiler</a></p>
<h4 id="leakcanary"><a href="#leakcanary" class="headerlink" title="leakcanary"></a>leakcanary</h4><p><a target="_blank" rel="noopener" href="https://square.github.io/leakcanary/recipes/">https://square.github.io/leakcanary/recipes/</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5d617d6851882575e8054fab">https://juejin.im/post/5d617d6851882575e8054fab</a></p>
<p><img src="/2018/02/09/LeakMemory/2021-07-31_10.4_leankcanary.png"></p>
<img src="/2018/02/09/LeakMemory/2021-07-31_10.41_leankcanry_1.png" style="zoom:50%;">

<p><img src="/2018/02/09/LeakMemory/2021-07-31_10.4_leakcanary_2.png"></p>
<p><img src="/2018/02/09/LeakMemory/Users/john/Documents/noteforme.github.io/source/_posts/LeakMemory/2021-07-31_10.48_leakcanry3.png"></p>
<h4 id="内存抖动"><a href="#内存抖动" class="headerlink" title="内存抖动"></a>内存抖动</h4><p>Profiler</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1oz4y1m7Gw?p=14">https://www.bilibili.com/video/BV1oz4y1m7Gw?p=14</a></p>
<h4 id="App瘦身"><a href="#App瘦身" class="headerlink" title="App瘦身"></a>App瘦身</h4><ol>
<li><p>大图转成 webapp</p>
</li>
<li><p>svg批量转换</p>
<p>设置<code> vectorDrawables.useSupportLibrary = true</code>  然后 <code>app:srcCompat = </code> 否则会在每个drawable生成一个png图片，达不到效果了。</p>
<p>tink修改图片颜色</p>
<img src="/2018/02/09/LeakMemory/2021-08-01_4.4_image_tint.png" style="zoom:50%;"></li>
<li><p>国际化</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">android&#123;</span><br><span class="line">	defaultConfig&#123;</span><br><span class="line">		 resConfigs <span class="string">&#x27;en&#x27;</span>  <span class="comment">//只适配英语</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 这样只会保存 语言的映射</p>
</li>
<li><p>so库</p>
<p> 一般像微信用Armeabi-v7a</p>
<p>虚拟机运行 还需要 x86</p>
</li>
<li><p>删除无用资源</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">debug&#123;</span><br><span class="line">  minifyEnabled <span class="literal">true</span> <span class="comment">// 删除无用代码</span></span><br><span class="line">  shrinkResource <span class="literal">true</span> <span class="comment">//删除资源文件 minifyEnabled 为true,删除了无用代码，这个才知道删除哪些资源。</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/page/11/index.html">http://noteforme.github.io.com/page/11/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Hilt" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/01/23/Hilt/">Hilt</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2018-01-23T07:11:40.000Z" itemprop="datePublished">2018年01月23日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/ANDROID/">ANDROID</a>
  </div>

      
      
<a href="/2018/01/23/Hilt/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/OEX1d2cU1zGG5BBM-nANBg">https://mp.weixin.qq.com/s/OEX1d2cU1zGG5BBM-nANBg</a></p>
<p><img src="/2018/01/23/Hilt/Users/m/Documents/noteforme.github.io/source/_posts/Hilt/2021-08-29_11.12.20_overview.png" alt="2021-08-29_11.12.20_overview"></p>
<p><img src="/2018/01/23/Hilt/Users/m/Documents/noteforme.github.io/source/_posts/Hilt/2021-08-29_11.36.15_function.png" alt="2021-08-29_11.36.15_function"></p>
<h4 id="Hilt使用"><a href="#Hilt使用" class="headerlink" title="Hilt使用"></a>Hilt使用</h4><h5 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h5><p>1.生成组件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@HiltAndroidApp</span></span><br><span class="line">class MyApp : Application() &#123;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>建立绑定</p>
<p>通过@Inject告诉Dagger可以通过，构造方法创建实例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>注入对象 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AndroidEntryPoint</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HiltActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    User user; <span class="comment">//inject注解作用在User变量上,注入对象实例</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_hilt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>​        必须是ComponentActivity的子类</p>
<blockquote>
<p>29021-29021/com.john.kot I/HiltActivity: user: com.john.kot.hilt.User@2c507f</p>
</blockquote>
<h5 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h5><p>Module</p>
<p>不通过下面这种方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="comment">//    @Inject 不在这里，而是在Module提交对象创建</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Module装载到ApplicationComponent中</span></span><br><span class="line"><span class="variable">@InstallIn</span>(ApplicationComponent.class) <span class="comment">//通过这种方式和组件关联</span></span><br><span class="line"><span class="variable">@Module</span></span><br><span class="line">public class AppModule &#123;</span><br><span class="line">    <span class="variable">@Provides</span> </span><br><span class="line">    User provideUser()&#123;</span><br><span class="line">        <span class="selector-tag">return</span> <span class="selector-tag">new</span> <span class="selector-tag">User</span>(); <span class="comment">//Module提交对象创建</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p> 29143-29143/com.john.kot I/HiltActivity: user: com.john.kot.hilt.User@43b8a20</p>
</blockquote>
<h4 id="默认标准组件"><a href="#默认标准组件" class="headerlink" title="默认标准组件"></a>默认标准组件</h4><p><img src="/2018/01/23/Hilt/Users/m/Documents/noteforme.github.io/source/_posts/Hilt/2021-08-30_12.01.40_component_default.png" alt="2021-08-30_12.01.40_component_default"></p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/page/11/index.html">http://noteforme.github.io.com/page/11/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>



    <nav id="page-nav">

<a class="extend prev" rel="prev" href="/page/10/">Previous</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/12/">Next</a>
</nav>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-posts"></i> Recent</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/08/30/Leetcode-Linklist/">Leetcode_Linklist</a>
          </li>
        
          <li>
            <a href="/2021/08/29/Dagger/">Dagger</a>
          </li>
        
          <li>
            <a href="/2021/08/22/kotlin-senior/">kotlin-senior</a>
          </li>
        
          <li>
            <a href="/2021/08/21/kotlin-object/">kotlin-object</a>
          </li>
        
          <li>
            <a href="/2021/08/21/kotlin-medium/">kotlin-medium</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-tag"></i> Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AOSP/" style="font-size: 20px;">AOSP</a> <a href="/tags/Activity/" style="font-size: 10px;">Activity</a> <a href="/tags/AndroidNewFeatures/" style="font-size: 10px;">AndroidNewFeatures</a> <a href="/tags/Assembly/" style="font-size: 10px;">Assembly</a> <a href="/tags/BLOG/" style="font-size: 10px;">BLOG</a> <a href="/tags/ConstraintLayout/" style="font-size: 10px;">ConstraintLayout</a> <a href="/tags/DB/" style="font-size: 11.67px;">DB</a> <a href="/tags/DataStructure/" style="font-size: 10px;">DataStructure</a> <a href="/tags/Drawer/" style="font-size: 10px;">Drawer</a> <a href="/tags/Git/" style="font-size: 11.67px;">Git</a> <a href="/tags/JVM/" style="font-size: 18.33px;">JVM</a> <a href="/tags/RxJava/" style="font-size: 15px;">RxJava</a> <a href="/tags/THINK/" style="font-size: 10px;">THINK</a> <a href="/tags/TabLayout/" style="font-size: 10px;">TabLayout</a> <a href="/tags/Test/" style="font-size: 15px;">Test</a> <a href="/tags/TouchEvent/" style="font-size: 13.33px;">TouchEvent</a> <a href="/tags/VIEW/" style="font-size: 13.33px;">VIEW</a> <a href="/tags/concurrency/" style="font-size: 15px;">concurrency</a> <a href="/tags/inter/" style="font-size: 16.67px;">inter</a> <a href="/tags/keyboard/" style="font-size: 10px;">keyboard</a> <a href="/tags/operators/" style="font-size: 10px;">operators</a> <a href="/tags/proguard/" style="font-size: 10px;">proguard</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-classify"></i> Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ANDROID/">ANDROID</a><span class="category-list-count">54</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/BLE/">BLE</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DataStructure/">DataStructure</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DesignPatterns/">DesignPatterns</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ENGLISH/">ENGLISH</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Jetpack/">Jetpack</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kotlin/">Kotlin</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/LINUX/">LINUX</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mathematics/">Mathematics</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS/">OS</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Organization/">Organization</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TEST/">TEST</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TOOL/">TOOL</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/VIEW/">VIEW</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/anim/">anim</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/flutter/">flutter</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/kotlin/">kotlin</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-archive"></i> Archive</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021年08月</a><span class="archive-list-count">17</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020年12月</a><span class="archive-list-count">45</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019年12月</a><span class="archive-list-count">20</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018年11月</a><span class="archive-list-count">32</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017年12月</a><span class="archive-list-count">57</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-tag"></i> Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AOSP/" rel="tag">AOSP</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Activity/" rel="tag">Activity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AndroidNewFeatures/" rel="tag">AndroidNewFeatures</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Assembly/" rel="tag">Assembly</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BLOG/" rel="tag">BLOG</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ConstraintLayout/" rel="tag">ConstraintLayout</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DB/" rel="tag">DB</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DataStructure/" rel="tag">DataStructure</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Drawer/" rel="tag">Drawer</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/" rel="tag">JVM</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RxJava/" rel="tag">RxJava</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/THINK/" rel="tag">THINK</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TabLayout/" rel="tag">TabLayout</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Test/" rel="tag">Test</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TouchEvent/" rel="tag">TouchEvent</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VIEW/" rel="tag">VIEW</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/concurrency/" rel="tag">concurrency</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/inter/" rel="tag">inter</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/keyboard/" rel="tag">keyboard</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/operators/" rel="tag">operators</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/proguard/" rel="tag">proguard</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-link"></i> Blogroll</h3>
    <div class="widget">
      <ul>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example1.com/">site-name1</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example2.com/">site-name2</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example3.com/">site-name3</a>
        </li>
      
      </ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <a id="totop" href="#top"></a>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      <p>
        <a href="/sitemap.xml">Site Map</a>
        <span> | </span><a href="/atom.xml">Subscribe to this site</a>
        <span> | </span><a href="/about/">Contact the blogger</a>
      </p>
      
        <p>
          <i class="fa fa-visitors"></i>
          <i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>
          ，
          <i class="fa fa-views"></i>
          <i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>
        </p>
      
      <p>
        <span>Copyright &copy; 2021 Jon.</span>
        <span>Theme by <a href="https://github.com/chaooo/hexo-theme-BlueLake/" target="_blank">BlueLake.</a></span>
        
            <span>Count by <a href="http://busuanzi.ibruce.info/" target="_blank">busuanzi.</a></span>
        
        <span>Powered by <a href="https://hexo.io/" target="_blank">Hexo.</a></span>
      </p>
    </div>
  </div>
</footer>

    </div>
    
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/search.json.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>






  
<script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



  
<script src="/localshare/js/social-share.js"></script>

  
<script src="/localshare/js/qrcode.js"></script>




















  </div>
</body>
</html>