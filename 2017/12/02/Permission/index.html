<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Permission | Jon's Blog</title><meta name="author" content="Jon"><meta name="copyright" content="Jon"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="https:&#x2F;&#x2F;developer.android.com&#x2F;training&#x2F;permissions&#x2F;requesting https:&#x2F;&#x2F;developer.android.com&#x2F;guide&#x2F;topics&#x2F;permissions&#x2F;overview#normal-dangerous 权限管理Normal permissionsDangerous permissions  Android11权限申">
<meta property="og:type" content="article">
<meta property="og:title" content="Permission">
<meta property="og:url" content="https://noteforme.github.io/2017/12/02/Permission/index.html">
<meta property="og:site_name" content="Jon&#39;s Blog">
<meta property="og:description" content="https:&#x2F;&#x2F;developer.android.com&#x2F;training&#x2F;permissions&#x2F;requesting https:&#x2F;&#x2F;developer.android.com&#x2F;guide&#x2F;topics&#x2F;permissions&#x2F;overview#normal-dangerous 权限管理Normal permissionsDangerous permissions  Android11权限申">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:published_time" content="2017-12-02T12:11:32.000Z">
<meta property="article:modified_time" content="2023-08-26T07:51:44.920Z">
<meta property="article:author" content="Jon">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://noteforme.github.io/2017/12/02/Permission/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Permission',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-08-26 15:51:44'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">243</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">30</div></a></div><hr class="custom-hr"/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Jon's Blog"><span class="site-name">Jon's Blog</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Permission</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2017-12-02T12:11:32.000Z" title="Created 2017-12-02 20:11:32">2017-12-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-08-26T07:51:44.920Z" title="Updated 2023-08-26 15:51:44">2023-08-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ANDROID/">ANDROID</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Permission"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><a target="_blank" rel="noopener" href="https://developer.android.com/training/permissions/requesting">https://developer.android.com/training/permissions/requesting</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.android.com/guide/topics/permissions/overview#normal-dangerous">https://developer.android.com/guide/topics/permissions/overview#normal-dangerous</a></p>
<h4 id="权限管理"><a href="#权限管理" class="headerlink" title="权限管理"></a>权限管理</h4><h5 id="Normal-permissions"><a href="#Normal-permissions" class="headerlink" title="Normal permissions"></a>Normal permissions</h5><h5 id="Dangerous-permissions"><a href="#Dangerous-permissions" class="headerlink" title="Dangerous permissions"></a>Dangerous permissions</h5><img src="/2017/12/02/Permission/Screen Shot 2020-09-17 at 2.06.37 PM.png" alt="Screen Shot 2020-09-17 at 2.06.37 PM" style="zoom: 80%;">

<h4 id="Android11权限申请"><a href="#Android11权限申请" class="headerlink" title="Android11权限申请"></a>Android11权限申请</h4><p>申请位置权限，先申请前台，后申请后台权限。</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/275758740">https://zhuanlan.zhihu.com/p/275758740</a></p>
<h4 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PERMISSION_REQUEST_CODE = <span class="number">1000</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">requestPermission</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Here, thisActivity is the current activity</span></span><br><span class="line">        <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) &#123;</span><br><span class="line">            <span class="comment">//则每次执行需要这一权限的操作时您都必须检查自己是否具有该权限</span></span><br><span class="line">            <span class="keyword">if</span> (ActivityCompat.checkSelfPermission(<span class="keyword">this</span>, Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">                <span class="comment">// Should we show an explanation?</span></span><br><span class="line">                <span class="keyword">if</span> (ActivityCompat.shouldShowRequestPermissionRationale(<span class="keyword">this</span>, Manifest.permission.WRITE_EXTERNAL_STORAGE)) &#123;</span><br><span class="line"><span class="comment">//                            当某条权限之前已经请求过，并且用户已经拒绝了该权限时</span></span><br><span class="line">                    <span class="comment">//异步向用户显示解释，这里先弹出解释框，再请求权限.</span></span><br><span class="line">                    Log.d(TAG, <span class="string">&quot;用户看到解释后，再次常识请求权限&quot;</span>);</span><br><span class="line">                    ActivityCompat.requestPermissions(<span class="keyword">this</span>, <span class="keyword">new</span> String[]&#123;Manifest.permission.WRITE_EXTERNAL_STORAGE&#125;, PERMISSION_REQUEST_CODE);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">//无需解释，首次请求许可</span></span><br><span class="line">                    ActivityCompat.requestPermissions(<span class="keyword">this</span>, <span class="keyword">new</span> String[]&#123;Manifest.permission.WRITE_EXTERNAL_STORAGE&#125;, PERMISSION_REQUEST_CODE);</span><br><span class="line">                    Log.d(TAG, <span class="string">&quot;requestPermissions&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//权限已经授予</span></span><br><span class="line">                Log.d(TAG, <span class="string">&quot;requestPermissions is ok&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRequestPermissionsResult</span><span class="params">(<span class="keyword">int</span> requestCode, String[] permissions, <span class="keyword">int</span>[] grantResults)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onRequestPermissionsResult(requestCode, permissions, grantResults);</span><br><span class="line">        <span class="keyword">switch</span> (requestCode) &#123;</span><br><span class="line">            <span class="keyword">case</span> PERMISSION_REQUEST_CODE: &#123;</span><br><span class="line">                <span class="comment">// If request is cancelled, the result arrays are empty. 如果取消请求，则grantResult 为空</span></span><br><span class="line">                <span class="keyword">if</span> (grantResults.length &gt; <span class="number">0</span> &amp;&amp; grantResults[<span class="number">0</span>] == PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">                    Log.d(TAG, <span class="string">&quot;onRequestPermissionResult:ok&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Log.d(TAG, <span class="string">&quot;onRequestPermissionResult:no&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>





<blockquote>
<p>注意:需要在androidmanifest.xml声明 否则一直返回false</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.ACCESS_COARSE_LOCATION&quot; &#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.ACCESS_FINE_LOCATION&quot; &#x2F;&gt;</span><br></pre></td></tr></table></figure>

<p>1、检查权限是否授予。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Activity.java</span><br><span class="line">public int checkSelfPermission(permission)</span><br></pre></td></tr></table></figure>

<p>2、申请权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Activity.java    </span><br><span class="line">public final void requestPermissions( new String[permission1,permission2,...], requestCode)</span><br></pre></td></tr></table></figure>

<p>这个时候，会弹出系统授权弹窗（<strong>授权弹窗是不支持自定义的，原因理所当然</strong>）。</p>
<p>3、权限回调。</p>
<p>用户在系统弹窗里面选择后，结果会通过<code>Activity</code>的 <code>onRequestPermissionsResult</code>方法回调APP。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public void onRequestPermissionsResult(int requestCode, String[] permissions, int[] grantResults) &#123;</span><br><span class="line">    &#x2F;&#x2F;继续执行逻辑或者提示权限获取失败</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4、权限说明。</p>
<p>用户如果选择了拒绝，下一次在需要声明该权限的时候，Google建议APP开发者给予用户更多的说明，因此提供了下面这个API,<strong>这个方法返回值在使用过程中会发现有点纠结（具体解析见下面代码块说明）</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public boolean shouldShowRequestPermissionRationale(permission)</span><br><span class="line">&#123;</span><br><span class="line">    1、APP没有申请这个权限的话，返回false</span><br><span class="line">    2、用户拒绝时，勾选了不再提示的话，返回false</span><br><span class="line">    3、用户拒绝，但是没有勾选不再提示的话，返回true</span><br><span class="line">    因此如果想在第一次就给用户提示，需要记录权限是否申请过，没有申请过的话，强制弹窗提示，而不能根据这个方法的返回值来。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个 看情况选用</p>
<p>参考 <a target="_blank" rel="noopener" href="https://juejin.im/entry/58b2e490ac502e0069d9ae62">https://juejin.im/entry/58b2e490ac502e0069d9ae62</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.android.com/guide/topics/security/permissions?hl=zh-cn#normal-dangerous">https://developer.android.com/guide/topics/security/permissions?hl=zh-cn#normal-dangerous</a></p>
<p><a target="_blank" rel="noopener" href="http://www.10tiao.com/html/227/201610/2650237473/1.html">http://www.10tiao.com/html/227/201610/2650237473/1.html</a></p>
<h4 id="PERMISSION"><a href="#PERMISSION" class="headerlink" title="PERMISSION"></a>PERMISSION</h4><p>​      </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 这个权限用于进行网络定位--&gt;</span><br><span class="line">  &lt;permission android:name&#x3D;&quot;android.permission.ACCESS_COARSE_LOCATION&quot;&gt;&lt;&#x2F;permission&gt;</span><br><span class="line">  &lt;!-- 这个权限用于访问GPS定位--&gt;</span><br><span class="line">  &lt;permission android:name&#x3D;&quot;android.permission.ACCESS_FINE_LOCATION&quot;&gt;&lt;&#x2F;permission&gt;</span><br><span class="line">  &lt;!-- 用于访问wifi网络信息，wifi信息会用于进行网络定位--&gt;</span><br><span class="line">  &lt;permission android:name&#x3D;&quot;android.permission.ACCESS_WIFI_STATE&quot;&gt;&lt;&#x2F;permission&gt;</span><br><span class="line">  &lt;!-- 获取运营商信息，用于支持提供运营商信息相关的接口--&gt;</span><br><span class="line">  &lt;permission android:name&#x3D;&quot;android.permission.ACCESS_NETWORK_STATE&quot;&gt;&lt;&#x2F;permission&gt;</span><br><span class="line">  &lt;!-- 这个权限用于获取wifi的获取权限，wifi信息会用来进行网络定位--&gt;</span><br><span class="line">  &lt;permission android:name&#x3D;&quot;android.permission.CHANGE_WIFI_STATE&quot;&gt;&lt;&#x2F;permission&gt;</span><br><span class="line">  &lt;!-- 用于读取手机当前的状态--&gt;</span><br><span class="line">  &lt;permission android:name&#x3D;&quot;android.permission.READ_PHONE_STATE&quot;&gt;&lt;&#x2F;permission&gt;</span><br><span class="line">  &lt;!-- 写入扩展存储，向扩展卡写入数据，用于写入离线定位数据--&gt;</span><br><span class="line">  &lt;permission android:name&#x3D;&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;&gt;&lt;&#x2F;permission&gt;</span><br><span class="line">  &lt;!-- 访问网络，网络定位需要上网--&gt;</span><br><span class="line">  &lt;permission android:name&#x3D;&quot;android.permission.INTERNET&quot; &#x2F;&gt;</span><br><span class="line">  &lt;!-- SD卡读取权限，用户写入离线定位数据--&gt;</span><br><span class="line">  &lt;permission android:name&#x3D;&quot;android.permission.MOUNT_UNMOUNT_FILESYSTEMS&quot;&gt;&lt;&#x2F;permission&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h5 id="One-time-permissions"><a href="#One-time-permissions" class="headerlink" title="One-time permissions"></a>One-time permissions</h5><p>Starting in Android 11 (API level 30), whenever your app requests a permission related to location, microphone, or camera, the user-facing permissions dialog contains an option called <strong>Only this time</strong>. If the user selects this option in the dialog, your app is granted a temporary <em>one-time permission</em>.</p>
<h5 id="Permission-groups"><a href="#Permission-groups" class="headerlink" title="Permission groups"></a>Permission groups</h5><ul>
<li><p>If the app has already been granted another dangerous permission in the same permission group, the system immediately grants the permission without any interaction with the user. For example, if an app had previously requested and been granted the <code>READ_CONTACTS</code> permission, and it then requests <code>WRITE_CONTACTS</code>, the system immediately grants that permission without showing the permissions dialog to the user.</p>
</li>
<li><p><strong>Caution:</strong> Future versions of the Android SDK might move a particular permission from one group to another. Therefore, don’t base your app’s logic on the structure of these permission groups.</p>
<p>For example, <code>READ_CONTACTS</code> is in the same permission group as <code>WRITE_CONTACTS</code> as of Android 8.1 (API level 27). If your app requests the <code>READ_CONTACTS</code> permission, and then requests the <code>WRITE_CONTACTS</code> permission, don’t assume that the system can automatically grant the <code>WRITE_CONTACTS</code> permission.</p>
</li>
</ul>
<h4 id="多权限申请"><a href="#多权限申请" class="headerlink" title="多权限申请"></a>多权限申请</h4><p><a target="_blank" rel="noopener" href="https://github.com/permissions-dispatcher/PermissionsDispatcher">https://github.com/permissions-dispatcher/PermissionsDispatcher</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/googlesamples/android-RuntimePermissions">https://github.com/googlesamples/android-RuntimePermissions</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/a51593817825">https://www.jianshu.com/p/a51593817825</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.android.com/training/permissions/requesting">https://developer.android.com/training/permissions/requesting</a></p>
<p>livedata</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/Hw_FI0GRpUDWJ1NwjK652w">https://mp.weixin.qq.com/s/Hw_FI0GRpUDWJ1NwjK652w</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/7RpGzTjXo9rnHRCVEnrYWQ">https://mp.weixin.qq.com/s/7RpGzTjXo9rnHRCVEnrYWQ</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/i8K-6CSxYuLanR4x1WNSGA">https://mp.weixin.qq.com/s/i8K-6CSxYuLanR4x1WNSGA</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/gaSmpT5UQLqNa4Ck0r0eOg">https://mp.weixin.qq.com/s/gaSmpT5UQLqNa4Ck0r0eOg</a></p>
<p><a target="_blank" rel="noopener" href="http://blog.csdn.net/huaiyiheyuan/article/details/52473984">http://blog.csdn.net/huaiyiheyuan/article/details/52473984</a><br><a target="_blank" rel="noopener" href="https://developer.android.com/training/permissions/requesting.html">https://developer.android.com/training/permissions/requesting.html</a></p>
<h4 id="Android-10权限"><a href="#Android-10权限" class="headerlink" title="Android 10权限"></a>Android 10权限</h4><p>在后台运行时访问设备位置信息需要权限</p>
<p><code> &lt;uses-permission android:name=&quot;android.permission.ACCESS_BACKGROUND_LOCATION&quot;/&gt;</code>        </p>
<p>该权限允许应用程序在后台访问位置。如果请求此权限，则还必须请求<code>ACCESS_FINE_LOCATION</code> 或 <code>ACCESS_COARSE_LOCATION</code>权限。只请求此权限无效果</p>
<p>在Android 10的设备上，如果你的应用的 <code>targetSdkVersion</code> &lt; 29，则在请求<code>ACCESS_FINE_LOCATION</code> 或<code>ACCESS_COARSE_LOCATION</code>权限时，系统会自动同时请求<code>ACCESS_BACKGROUND_LOCATION</code>。在请求弹框中，选择“始终允许”表示同意后台获取位置信息，选择“仅在应用使用过程中允许”或”拒绝”选项表示拒绝授权。</p>
<p>如果你的应用的 <code>targetSdkVersion</code> &gt;= 29，则请求<code>ACCESS_FINE_LOCATION</code> 或 <code>ACCESS_COARSE_LOCATION</code>权限表示在前台时拥有访问设备位置信息的权限。在请求弹框中，选择“始终允许”表示前后台都可以获取位置信息，选择“仅在应用使用过程中允许”只表示拥有前台的权限。</p>
<p><a target="_blank" rel="noopener" href="https://developer.android.com/about/versions/10/privacy/changes">https://developer.android.com/about/versions/10/privacy/changes</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/6844904073024503822#heading-5">https://juejin.im/post/6844904073024503822#heading-5</a></p>
<p>request permission demo<br><a target="_blank" rel="noopener" href="https://github.com/android/platform-samples/tree/main/samples/privacy/permissions">https://github.com/android/platform-samples/tree/main/samples/privacy/permissions</a></p>
<h3 id="Custom-Permission"><a href="#Custom-Permission" class="headerlink" title="Custom Permission"></a>Custom Permission</h3><p>can run Demo</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Ibtisam/Dangerous-Activity">https://github.com/Ibtisam/Dangerous-Activity</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/Ibtisam/Using-Dangerous-Activity">https://github.com/Ibtisam/Using-Dangerous-Activity</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/commonsguy/cwac-netsecurity">https://github.com/commonsguy/cwac-netsecurity</a></p>
<p><a target="_blank" rel="noopener" href="https://medium.com/code-procedure-and-rants/android-permissions-create-custom-permissions-5784188311f3">https://medium.com/code-procedure-and-rants/android-permissions-create-custom-permissions-5784188311f3</a></p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=YeLmufMZfcI">https://www.youtube.com/watch?v=YeLmufMZfcI</a></p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/28975706/start-activity-with-permissions">https://stackoverflow.com/questions/28975706/start-activity-with-permissions</a></p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/26700767/custom-permission-for-activity">https://stackoverflow.com/questions/26700767/custom-permission-for-activity</a></p>
<h4 id="Sensors"><a href="#Sensors" class="headerlink" title="Sensors"></a>Sensors</h4><p>An acceleration sensor measures the acceleration applied to the device, including the force of gravity. The following code shows you how to get an instance of the default acceleration sensor:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val sensorManager &#x3D; getSystemService(Context.SENSOR_SERVICE) as SensorManager</span><br><span class="line">val sensor: Sensor? &#x3D; sensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://developer.android.com/guide/topics/sensors/sensors_motion.html#sensors-motion-accel">https://developer.android.com/guide/topics/sensors/sensors_motion.html#sensors-motion-accel</a></p>
<p>If you are publishing your application on Google Play you can use the <uses-feature> element in your manifest file to filter your application from devices that do not have the appropriate sensor configuration for your application. The <uses-feature> element has several hardware descriptors that let you filter applications based on the presence of specific sensors. The sensors you can list include: accelerometer, barometer, compass (geomagnetic field), gyroscope, light, and proximity. The following is an example manifest entry that filters apps that do not have an accelerometer:</uses-feature></uses-feature></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-feature android:name&#x3D;&quot;android.hardware.sensor.accelerometer&quot;</span><br><span class="line">              android:required&#x3D;&quot;true&quot; &#x2F;&gt;</span><br></pre></td></tr></table></figure>






</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://noteforme.github.io">Jon</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://noteforme.github.io/2017/12/02/Permission/">https://noteforme.github.io/2017/12/02/Permission/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2017/12/09/LOG/" title="LOG"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">LOG</div></div></a></div><div class="next-post pull-right"><a href="/2017/11/23/English/" title="English"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">English</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jon</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">243</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">30</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">权限管理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Normal-permissions"><span class="toc-number">1.1.</span> <span class="toc-text">Normal permissions</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Dangerous-permissions"><span class="toc-number">1.2.</span> <span class="toc-text">Dangerous permissions</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android11%E6%9D%83%E9%99%90%E7%94%B3%E8%AF%B7"><span class="toc-number">2.</span> <span class="toc-text">Android11权限申请</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">基本使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PERMISSION"><span class="toc-number">4.</span> <span class="toc-text">PERMISSION</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#One-time-permissions"><span class="toc-number">4.1.</span> <span class="toc-text">One-time permissions</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Permission-groups"><span class="toc-number">4.2.</span> <span class="toc-text">Permission groups</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E6%9D%83%E9%99%90%E7%94%B3%E8%AF%B7"><span class="toc-number">5.</span> <span class="toc-text">多权限申请</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-10%E6%9D%83%E9%99%90"><span class="toc-number">6.</span> <span class="toc-text">Android 10权限</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Custom-Permission"><span class="toc-number"></span> <span class="toc-text">Custom Permission</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Sensors"><span class="toc-number">1.</span> <span class="toc-text">Sensors</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><div class="content"><a class="title" href="/2024/07/04/DesignPatterns-State/" title="DesignPatterns_State">DesignPatterns_State</a><time datetime="2024-07-04T07:57:26.000Z" title="Created 2024-07-04 15:57:26">2024-07-04</time></div></div><div class="aside-list-item"><div class="content"><a class="title" href="/2024/07/03/glide/" title="glide">glide</a><time datetime="2024-07-03T05:51:25.000Z" title="Created 2024-07-03 13:51:25">2024-07-03</time></div></div><div class="aside-list-item"><div class="content"><a class="title" href="/2024/06/28/bitmap/" title="Bitmap">Bitmap</a><time datetime="2024-06-28T09:37:49.000Z" title="Created 2024-06-28 17:37:49">2024-06-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/28/bits-and-bytes/" title="Bits and Bytes">Bits and Bytes</a><time datetime="2024-06-28T08:04:14.000Z" title="Created 2024-06-28 16:04:14">2024-06-28</time></div></div><div class="aside-list-item"><div class="content"><a class="title" href="/2024/06/26/lifecycle/" title="LifeCycle">LifeCycle</a><time datetime="2024-06-26T06:45:50.000Z" title="Created 2024-06-26 14:45:50">2024-06-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Jon</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>