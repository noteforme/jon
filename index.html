<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Jon&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  
  
    <link rel="alternate" href="/atom.xml" title="Jon's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="/localshare/css/share.css">

  
  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Jon&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Cease to struggle and you cease to live. - Thomas Carlyle</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/."><i class="fa fa-home"></i> Home</a>
        
          <a class="main-nav-link" href="/archives/"><i class="fa fa-archive"></i> Archive</a>
        
          <a class="main-nav-link" href="/about/"><i class="fa fa-user"></i> About</a>
        
          <a class="main-nav-link" href="/atom.xml"><i class="fa fa-rss"></i> RSS</a>
        
      </nav>
    </div>
    <div id="search-form">
      <div id="result-mask" class="hide"></div>
      <label><input id="search-key" type="text" autocomplete="off" placeholder="search"></label>
      <div id="result-wrap" class="hide">
        <div id="search-result"></div>
      </div>
      <div class="hide">
        <template id="search-tpl">
          <div class="item">
            <a href="/{path}" title="{title}">
              <div class="title">{title}</div>
              <div class="time">{date}</div>
              <div class="tags">{tags}</div>
            </a>
          </div>
        </template>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  <article id="post-Leetcode-Linklist" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/30/Leetcode-Linklist/">Leetcode_Linklist</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2021-08-30T13:03:37.000Z" itemprop="datePublished">2021年08月30日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/DataStructure/">DataStructure</a>
  </div>

      
      
<a href="/2021/08/30/Leetcode-Linklist/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="160-相交链表"><a href="#160-相交链表" class="headerlink" title="160. 相交链表"></a><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/intersection-of-two-linked-lists/">160. 相交链表</a></h4><p>给你两个单链表的头节点 headA 和 headB ，请你找出并返回两个单链表相交的起始节点。如果两个链表没有交点，返回 null 。</p>
<p>图示两个链表在节点 c1 开始相交：</p>
<p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/14/160_statement.png"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution_160</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">getIntersectionNode</span><span class="params">(ListNode headA, ListNode headB)</span> </span>&#123;</span><br><span class="line">        ListNode la = headA;</span><br><span class="line">        ListNode lb = headB;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(la!=lb)&#123;</span><br><span class="line">            la = (la==<span class="keyword">null</span>) ? headB : la.next;</span><br><span class="line">            lb = (lb==<span class="keyword">null</span>) ? headA : lb.next ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> la;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><strong>先走自己的路，再走对方的路，最终路程一样</strong></p>
<p>可以这么理解，a，b两个链表，变更为 a+b 和 b+a，长度就相等了，然后等步遍历判断是否相等就行了</p>
<p>原始的数据</p>
<p><img src="https://pic.leetcode-cn.com/1628662967-RLmciV-2.png"></p>
<p>修改后的数据示意图</p>
<p><img src="https://pic.leetcode-cn.com/1628662688-ZdSYRM-1.png" alt="1.png"></p>
<p>!(<img src="https://pic.leetcode-cn.com/e86e947c8b87ac723b9c858cd3834f9a93bcc6c5e884e41117ab803d205ef662-%E7%9B%B8%E4%BA%A4%E9%93%BE%E8%A1%A8.png" alt="相交链表.png">)</p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/index.html">http://noteforme.github.io.com/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Dagger" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/29/Dagger/">Dagger</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2021-08-29T12:45:53.000Z" itemprop="datePublished">2021年08月29日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/ANDROID/">ANDROID</a>
  </div>

      
      
<a href="/2021/08/29/Dagger/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>依赖注入</p>
<ol>
<li>构造方法注入</li>
<li>Setter注入(字段注入)</li>
</ol>
<p>IOC框架</p>
<ol>
<li>基于反射的方式实现： Spring IOC(动态的进行依赖关系的建立)</li>
<li>静态方式 ： 程序在编译时就已经提供好了建立依赖关系的类</li>
</ol>
<p>两种注入方式</p>
<p><img src="/2021/08/29/Dagger/2021-08-29_8.43.22_type_dagger.png" alt="2021-08-29_8.43.22_type_dagger"></p>
<h4 id="Dagger注入"><a href="#Dagger注入" class="headerlink" title="Dagger注入"></a>Dagger注入</h4><h5 id="构造方法注入"><a href="#构造方法注入" class="headerlink" title="构造方法注入"></a>构造方法注入</h5><p>构造方法构造实例注入0</p>
<ol>
<li><p>使用 @Inject注解在构造方法上；就是告知Dagger可以通过构造方法来创建并获取到User的实例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1.使用 @Inject注解在构造方法上；就是告知Dagger可以通过构造方法来创建并获取到User的实例</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123; <span class="comment">//构造方法构造实例</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>当作IOC容器,把对象注入到目标类中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2. 当作IOC容器,把对象注入到目标类中</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ApplicationComponent</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inject</span><span class="params">(DaggerActivity daggerActivity)</span></span>;<span class="comment">//指定目标类</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>设置Inject注解</p>
<p>DaggerActivity.java</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//<span class="number">3</span>.设置Inject注解</span><br><span class="line">@Inject</span><br><span class="line"><span class="keyword">User</span> <span class="title">user</span>;</span><br></pre></td></tr></table></figure></li>
<li><p>执行注入动作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">      setContentView(R.layout.activity_dagger2);</span><br><span class="line"><span class="comment">//4.执行注入动作</span></span><br><span class="line">    DaggerApplicationComponent.create().inject(<span class="keyword">this</span>);<span class="comment">//DaggerApplicationComponent相当于DaggerApplication的实现类 </span></span><br><span class="line">      Log.i(TAG, <span class="string">&quot;user: &quot;</span> + user);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="针对第三方库"><a href="#针对第三方库" class="headerlink" title="针对第三方库"></a>针对第三方库</h5><ol>
<li><p>第二种方式告知Dagger,可以通过调用该方法来获取到注入对象的实例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NetModule</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//第二种方式告知Dagger,可以通过调用该方法来获取到注入对象的实例</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Retrofit <span class="title">provideRetrofit</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Retrofit.Builder()</span><br><span class="line">            .baseUrl(<span class="string">&quot;http://www.google.com&quot;</span>)</span><br><span class="line">            .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<ol start="2">
<li><p>compoent</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2. 当作IOC容器,把对象注入到目标类中</span></span><br><span class="line"><span class="meta">@Component(modules = &#123;NetModule.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ApplicationComponent</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>DaggerActivity.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DaggerActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    String TAG = <span class="string">&quot;DaggerActivity&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.设置Inject注解</span></span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Retrofit retrofit;</span><br><span class="line">  </span><br><span class="line">    Log.i(TAG, <span class="string">&quot;retrofit: &quot;</span> + retrofit);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="复杂使用场景"><a href="#复杂使用场景" class="headerlink" title="复杂使用场景"></a>复杂使用场景</h5><p>​    </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ApiService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GET(&quot;/user/info&quot;)</span></span><br><span class="line">    <span class="function">Call&lt;String&gt; <span class="title">requestInfo</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Module已经知道怎么获取retrofit实例</span></span><br><span class="line"><span class="comment">//接着同一个Module中的方法，就可以作为参数直接传入 使用</span></span><br><span class="line"><span class="comment">// 比如provideApiService需要Retrofit实例，会从当前容器查找是否已经有Retrofit实例</span></span><br><span class="line"><span class="comment">// 然后从当前容器直接获取</span></span><br><span class="line"><span class="meta">@Provides</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ApiService <span class="title">provideApiService</span><span class="params">(Retrofit retrofit)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> retrofit.create(ApiService.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Inject</span></span><br><span class="line">ApiService apiService;</span><br><span class="line"></span><br><span class="line">Log.i(TAG, <span class="string">&quot;apiService: &quot;</span> +apiService);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Module已经知道怎么获取retrofit实例<br>接着同一个Module中的方法，就可以作为参数直接传入 使用<br>// 比如provideApiService需要Retrofit实例，会从当前容器查找是否已经有Retrofit实例<br>// 然后从当前容器直接获取</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NetModule</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//第二种方式告知Dagger,可以通过调用该方法来获取到注入对象的实例</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Retrofit <span class="title">provideRetrofit</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Retrofit.Builder()</span><br><span class="line">            .baseUrl(<span class="string">&quot;http://www.google.com&quot;</span>)</span><br><span class="line">            .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Module已经知道怎么获取retrofit实例</span></span><br><span class="line">    <span class="comment">//接着同一个Module中的方法，就可以作为参数直接传入 使用</span></span><br><span class="line">    <span class="comment">// 比如provideApiService需要Retrofit实例，会从当前容器查找是否已经有Retrofit实例</span></span><br><span class="line">    <span class="comment">// 然后从当前容器直接获取</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ApiService <span class="title">provideApiService</span><span class="params">(Retrofit retrofit)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> retrofit.create(ApiService.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> OkHttpClient <span class="title">provideOkHttpClient</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> OkHttpClient.Builder().build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="局部单例实现"><a href="#局部单例实现" class="headerlink" title="局部单例实现"></a>局部单例实现</h4><p><img src="/2021/08/29/Dagger/2021-08-29_8.43.44_local.png" alt="2021-08-29_8.43.44_local"></p>
<p><img src="/2021/08/29/Dagger/2021-08-29_8.48.38_lifecycle.png" alt="2021-08-29_8.48.38_lifecycle"></p>
<p>3个对象实例指定了作用域是 @Singleton,这个作用域和使用了@Singleton组件的生命周期一致。</p>
<h5 id="局部实例1"><a href="#局部实例1" class="headerlink" title="局部实例1"></a>局部实例1</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NetModule</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//第二种方式告知Dagger,可以通过调用该方法来获取到注入对象的实例</span></span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Retrofit <span class="title">provideRetrofit</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Retrofit.Builder()</span><br><span class="line">            .baseUrl(<span class="string">&quot;http://www.google.com&quot;</span>)</span><br><span class="line">            .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Module已经知道怎么获取retrofit实例</span></span><br><span class="line">    <span class="comment">//接着同一个Module中的方法，就可以作为参数直接传入 使用</span></span><br><span class="line">    <span class="comment">// 比如provideApiService需要Retrofit实例，会从当前容器查找是否已经有Retrofit实例</span></span><br><span class="line">    <span class="comment">// 然后从当前容器直接获取</span></span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ApiService <span class="title">provideApiService</span><span class="params">(Retrofit retrofit)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> retrofit.create(ApiService.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//@Singleton是Dagger提供的一种作用域</span></span><br><span class="line">    <span class="comment">// 作用域就是用来管理Component来获取对象实例的生命周期</span></span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> OkHttpClient <span class="title">provideOkHttpClient</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> OkHttpClient.Builder().build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DaggerActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    String TAG = <span class="string">&quot;DaggerActivity&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.设置Inject注解</span></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    User user;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    User user2;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Retrofit retrofit;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    ApiService apiService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    ApiService apiService2;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_dagger2);</span><br><span class="line">        <span class="comment">//4.执行注入动作</span></span><br><span class="line">        DaggerApplicationComponent.create().inject(<span class="keyword">this</span>);<span class="comment">//DaggerApplicationComponent相当于DaggerApplication的实现类</span></span><br><span class="line"></span><br><span class="line">        Log.i(TAG, <span class="string">&quot;user: &quot;</span> + user);</span><br><span class="line">        Log.i(TAG, <span class="string">&quot;user2: &quot;</span> + user2);</span><br><span class="line"></span><br><span class="line">        Log.i(TAG, <span class="string">&quot;retrofit: &quot;</span> + retrofit);</span><br><span class="line"></span><br><span class="line">        Log.i(TAG, <span class="string">&quot;apiService: &quot;</span> +apiService);</span><br><span class="line">        Log.i(TAG, <span class="string">&quot;apiService2: &quot;</span> +apiService2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结构</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">2092</span>-<span class="number">2092</span>/com.comm.util I/DaggerActivity: user: com.comm.util.dagger.dn.di.User@<span class="number">2129</span>cef</span><br><span class="line"><span class="attribute">2092</span>-<span class="number">2092</span>/com.comm.util I/DaggerActivity: user<span class="number">2</span>: com.comm.util.dagger.dn.di.User@d<span class="number">97</span>d<span class="number">3</span>fc</span><br><span class="line"><span class="attribute">2092</span>-<span class="number">2092</span>/com.comm.util I/DaggerActivity: retrofit: retrofit<span class="number">2</span>.Retrofit@d<span class="number">243</span>a<span class="number">85</span></span><br><span class="line"><span class="attribute">2092</span>-<span class="number">2092</span>/com.comm.util I/DaggerActivity: apiService: retrofit<span class="number">2</span>.Retrofit$<span class="number">1</span>@a<span class="number">1</span>fa<span class="number">0</span>da</span><br><span class="line"><span class="attribute">2092</span>-<span class="number">2092</span>/com.comm.util I/DaggerActivity: apiService<span class="number">2</span>: retrofit<span class="number">2</span>.Retrofit$<span class="number">1</span>@a<span class="number">1</span>fa<span class="number">0</span>da</span><br></pre></td></tr></table></figure>

<p>可以看到 user 是2个实例</p>
<p>retorift用了同一个对象实例,所以可以看到和DaggerApplicationComponent组件生命周期一致。</p>
<h5 id="局部实例2"><a href="#局部实例2" class="headerlink" title="局部实例2"></a>局部实例2</h5><p>添加一个Activity</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecondActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    String TAG = <span class="string">&quot;SecondActivity&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    ApiService apiService3;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_second2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//DaggerApplicationComponent相当于DaggerApplication的实现类</span></span><br><span class="line">        DaggerApplicationComponent.create().inject(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        Log.i(TAG, <span class="string">&quot;apiService3: &quot;</span> + apiService3);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inject</span><span class="params">(SecondActivity secondActivity)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">startActivity(<span class="keyword">new</span> Intent(<span class="keyword">this</span>,SecondActivity.class));</span><br></pre></td></tr></table></figure>



<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">7410</span>-<span class="number">7410</span>/com.comm.util I/DaggerActivity: apiService: retrofit<span class="number">2</span>.Retrofit$<span class="number">1</span>@a<span class="number">1</span>fa<span class="number">0</span>da</span><br><span class="line"><span class="attribute">7410</span>-<span class="number">7410</span>/com.comm.util I/DaggerActivity: apiService<span class="number">2</span>: retrofit<span class="number">2</span>.Retrofit$<span class="number">1</span>@a<span class="number">1</span>fa<span class="number">0</span>da</span><br><span class="line"><span class="attribute">2021</span>-<span class="number">08</span>-<span class="number">29</span> <span class="number">22</span>:<span class="number">28</span>:<span class="number">35</span>.<span class="number">812</span> <span class="number">7410</span>-<span class="number">7410</span>/com.comm.util I/SecondActivity: apiService<span class="number">3</span>: retrofit<span class="number">2</span>.Retrofit$<span class="number">1</span>@<span class="number">84</span>eb<span class="number">79</span>a</span><br></pre></td></tr></table></figure>

<p>不同的DaggerApplicationComponent组件，不同的实例</p>
<h5 id="全局实例"><a href="#全局实例" class="headerlink" title="全局实例"></a>全局实例</h5><p>保证组件全局实例</p>
<p>MyApplication.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> ApplicationComponent  applicationComponent = DaggerApplicationComponent.create();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ApplicationComponent <span class="title">getApplicationComponent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> applicationComponent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MyApplication.getApplicationComponent().inject(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure>



<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">8044</span>-<span class="number">8044</span>/com.comm.util I/DaggerActivity: apiService: retrofit<span class="number">2</span>.Retrofit$<span class="number">1</span>@<span class="number">516190</span>b</span><br><span class="line"><span class="attribute">8044</span>-<span class="number">8044</span>/com.comm.util I/DaggerActivity: apiService<span class="number">2</span>: retrofit<span class="number">2</span>.Retrofit$<span class="number">1</span>@<span class="number">516190</span>b</span><br><span class="line"><span class="attribute">8044</span>-<span class="number">8044</span>/com.comm.util I/SecondActivity: apiService<span class="number">3</span>: retrofit<span class="number">2</span>.Retrofit$<span class="number">1</span>@<span class="number">516190</span>b</span><br></pre></td></tr></table></figure>



<h5 id="作用域规则"><a href="#作用域规则" class="headerlink" title="作用域规则"></a>作用域规则</h5><p><img src="/2021/08/29/Dagger/2021-08-29_10.50.21_myscope.png" alt="2021-08-29_10.50.21_myscope"></p>
<p>组件ApplicationComponent指定了作用域,组件中的模块modules = {NetModule.class}，也要指定相同的作用域。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span> <span class="comment">// 设置作用域和ApplicationComponent组件的生命周期一致</span></span><br><span class="line"><span class="meta">@Component(modules = &#123;NetModule.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ApplicationComponent</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inject</span><span class="params">(DaggerActivity daggerActivity)</span></span>;<span class="comment">//指定目标类</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inject</span><span class="params">(SecondActivity secondActivity)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>第07课</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Ki4y1A7hA?p=07">https://www.bilibili.com/video/BV1Ki4y1A7hA?p=07</a></p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/index.html">http://noteforme.github.io.com/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-kotlin-senior" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/22/kotlin-senior/">kotlin-senior</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2021-08-22T05:27:15.000Z" itemprop="datePublished">2021年08月22日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/kotlin/">kotlin</a>
  </div>

      
      
<a href="/2021/08/22/kotlin-senior/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="拓展函数"><a href="#拓展函数" class="headerlink" title="拓展函数"></a>拓展函数</h3><p><img src="/2021/08/22/kotlin-senior/2021-08-22_1.26.04_expand.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//给字符串追加若干个 !</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">addExt</span><span class="params">(amount:<span class="type">Int</span>=<span class="number">1</span>)</span></span>= <span class="keyword">this</span> + <span class="string">&quot; !&quot;</span>.repeat(amount)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> Any.<span class="title">easyPrint</span><span class="params">()</span></span> = println(<span class="keyword">this</span>) <span class="comment">//默认是public</span></span><br><span class="line"><span class="comment">//fun Any.easyPrint() = println(this) //不能定义两次</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    println(<span class="string">&quot;abc&quot;</span>.addExt(<span class="number">2</span>))</span><br><span class="line">    <span class="string">&quot;abc&quot;</span>.easyPrint()</span><br><span class="line">    <span class="number">15.</span>easyPrint()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="泛型拓展函数"><a href="#泛型拓展函数" class="headerlink" title="泛型拓展函数"></a>泛型拓展函数</h5><p>![](kotlin-senior/ 2021-08-22 _1.42.27_generic_extends.png)</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//给字符串追加若干个 !</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">addExt</span><span class="params">(amount:<span class="type">Int</span>=<span class="number">1</span>)</span></span>= <span class="keyword">this</span> + <span class="string">&quot; !&quot;</span>.repeat(amount)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> T.<span class="title">easyPrint</span><span class="params">()</span></span>:T&#123;</span><br><span class="line">    println(<span class="keyword">this</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="string">&quot;abc&quot;</span>.addExt(<span class="number">2</span>).easyPrint()</span><br><span class="line">    <span class="number">15.</span>easyPrint()</span><br><span class="line">    <span class="number">15.</span>also &#123;  &#125;</span><br><span class="line">    <span class="keyword">val</span> let = <span class="string">&quot;abc&quot;</span>.let &#123; <span class="number">50</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Let源码"><a href="#Let源码" class="headerlink" title="Let源码"></a>Let源码</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &quot;abc&quot;调用let，传进来参数就是&quot;abc&quot;类型T为String</span></span><br><span class="line"><span class="comment">// let返回lambda表达式执行的结果 50 类型R为Int</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T, R&gt;</span> T.<span class="title">let</span><span class="params">(block: (<span class="type">T</span>) -&gt; <span class="type">R</span>)</span></span>: R &#123;</span><br><span class="line">    contract &#123;</span><br><span class="line">        callsInPlace(block, InvocationKind.EXACTLY_ONCE)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> block(<span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="拓展属性"><a href="#拓展属性" class="headerlink" title="拓展属性"></a>拓展属性</h5><p>给String类添加一个拓展</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//给字符串追加若干个 !</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">addExt</span><span class="params">(amount: <span class="type">Int</span> = <span class="number">1</span>)</span></span> = <span class="keyword">this</span> + <span class="string">&quot; !&quot;</span>.repeat(amount)</span><br><span class="line"><span class="keyword">val</span> String.numVowels</span><br><span class="line">    <span class="keyword">get</span>() = count &#123; <span class="string">&quot;aeiou&quot;</span>.contains(it) &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> T.<span class="title">easyPrint</span><span class="params">()</span></span>: T &#123;</span><br><span class="line">    println(<span class="keyword">this</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="string">&quot;abc&quot;</span>.addExt(<span class="number">2</span>).easyPrint()</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;The people&#x27;s Republic of China&quot;</span>.numVowels.easyPrint()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="可空类拓展"><a href="#可空类拓展" class="headerlink" title="可空类拓展"></a>可空类拓展</h5><p>可以定义拓展函数用于可空类型，在可空类型上定义拓展函数，你可以直接在拓展函数体内借鉴可能出现的空值问题。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> String?.<span class="title">printWithDefault</span><span class="params">(default:<span class="type">String</span>)</span></span> =print(<span class="keyword">this</span> ?: default) <span class="comment">//null打印默认值,不为null 打印自身</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">//    val nullableString:String? = null</span></span><br><span class="line">    <span class="keyword">val</span> nullableString:String? = <span class="string">&quot;hehe&quot;</span></span><br><span class="line">    nullableString.printWithDefault(<span class="string">&quot;abc&quot;</span>) <span class="comment">// nullableString?就不会设置默认值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="Infix"><a href="#Infix" class="headerlink" title="Infix"></a>Infix</h5><p><img src="/2021/08/22/kotlin-senior/2021-08-22_2.48.05_infix.png" alt="2021-08-22_2.48.05_infix"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">infix</span> <span class="function"><span class="keyword">fun</span> String?.<span class="title">printWithDefault</span><span class="params">(default:<span class="type">String</span>)</span></span> =print(<span class="keyword">this</span> ?: default) <span class="comment">//null打印默认值,不为null 打印自身</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">//    val nullableString:String? = null</span></span><br><span class="line">    <span class="keyword">val</span> nullableString:String? = <span class="string">&quot;hehe&quot;</span></span><br><span class="line">    nullableString.printWithDefault(<span class="string">&quot;abc&quot;</span>) <span class="comment">// nullableString?就不会设置默认值</span></span><br><span class="line">    nullableString printWithDefault <span class="string">&quot;abc&quot;</span></span><br><span class="line">    <span class="string">&quot;girl&quot;</span>.to(<span class="number">18</span>)</span><br><span class="line">    mapOf(<span class="string">&quot;girl&quot;</span> to <span class="number">18</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//to是拓展函数，返回 Pair&lt;A,B&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">infix</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;A, B&gt;</span> A.<span class="title">to</span><span class="params">(that: <span class="type">B</span>)</span></span>: Pair&lt;A, B&gt; = Pair(<span class="keyword">this</span>, that)</span><br></pre></td></tr></table></figure>



<h5 id="定义拓展文件"><a href="#定义拓展文件" class="headerlink" title="定义拓展文件"></a>定义拓展文件</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.util.kotin.extension</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> Iterable<span class="type">&lt;T&gt;</span>.<span class="title">randomTake</span><span class="params">()</span></span>: T = <span class="keyword">this</span>.shuffled().first()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> list = listOf(<span class="string">&quot;Jack&quot;</span>, <span class="string">&quot;Json&quot;</span>, <span class="string">&quot;John&quot;</span>)</span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">set</span> = listOf(<span class="string">&quot;Jack&quot;</span>, <span class="string">&quot;Json&quot;</span>, <span class="string">&quot;John&quot;</span>)</span><br><span class="line">    list.shuffled().first()</span><br><span class="line"></span><br><span class="line">    list.randomTake()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="重命名拓展"><a href="#重命名拓展" class="headerlink" title="重命名拓展"></a>重命名拓展</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.util.kotin.extension.randomTake <span class="keyword">as</span> Randomizer</span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> list = listOf(<span class="string">&quot;Jack&quot;</span>, <span class="string">&quot;Json&quot;</span>, <span class="string">&quot;John&quot;</span>)</span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">set</span> = listOf(<span class="string">&quot;Jack&quot;</span>, <span class="string">&quot;Json&quot;</span>, <span class="string">&quot;John&quot;</span>)</span><br><span class="line">    list.shuffled().first()</span><br><span class="line"></span><br><span class="line"><span class="comment">//    list.randomTake()</span></span><br><span class="line">    list.Randomizer()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/08/22/kotlin-senior/2021-08-22_3.00.52_extent.png" alt="2021-08-22_3.00.52_extent"></p>
<h5 id="Apply源码"><a href="#Apply源码" class="headerlink" title="Apply源码"></a>Apply源码</h5><p>带接收者的函数字面量</p>
<p>apply函数是如何做到支持接收者对象的隐式调用</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> T.<span class="title">apply</span><span class="params">(block: <span class="type">T</span>.() -&gt; <span class="type">Unit</span>)</span></span>: T &#123;</span><br><span class="line">    block()</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File</span><br><span class="line"></span><br><span class="line"><span class="comment">//fun String.addExt(amount: Int = 1) = this + &quot; !&quot;.repeat(amount)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">addExt</span><span class="params">()</span></span> = <span class="string">&quot; !&quot;</span>.repeat(<span class="keyword">this</span>.count())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 泛型的拓展函数</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> T.<span class="title">easyPrint</span><span class="params">()</span></span>: <span class="built_in">Unit</span> = println(<span class="keyword">this</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// T.apply 返回的还是T</span></span><br><span class="line"><span class="comment">// T.() -&gt; Unit 传入拓展函数(泛型), 而不是普通的匿名函数 ???</span></span><br><span class="line"><span class="comment">// 拓展函数里自带了接收者对象的this隐式调用</span></span><br><span class="line"><span class="comment">// 匿名函数，也可以是 拓展函数</span></span><br><span class="line"><span class="comment">//普通的匿名函数 ()-&gt;Unit</span></span><br><span class="line"><span class="comment">//匿名函数内部this指向一个File对象,隐式调用，File.() -&gt; Unit</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> T.<span class="title">apply</span><span class="params">(block: <span class="type">T</span>.() -&gt; <span class="type">Unit</span>)</span></span>: T &#123;</span><br><span class="line">    block()</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*public inline fun &lt;File&gt; File.apply(block: File.() -&gt; Unit): File &#123;</span></span><br><span class="line"><span class="comment">    block()</span></span><br><span class="line"><span class="comment">    return this</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> file = File(<span class="string">&quot;xx&quot;</span>).apply &#123;</span><br><span class="line">        <span class="keyword">this</span>.setReadable(<span class="literal">true</span>) <span class="comment">//默认又一个对象指向File</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//这里分解一下</span></span><br><span class="line">    <span class="comment">//1. 定义拓展函数</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> File.<span class="title">ext</span><span class="params">()</span></span>: <span class="built_in">Unit</span> &#123;</span><br><span class="line">        setReadable(<span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.给block变量赋值</span></span><br><span class="line">    <span class="keyword">val</span> block = File::ext</span><br><span class="line">    <span class="comment">//3.传入apply函数</span></span><br><span class="line">    File(<span class="string">&quot;xxx&quot;</span>).apply &#123; block &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    doSomething &#123;</span><br><span class="line">        goFix()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="string">&quot;abcefg&quot;</span>.addExt().easyPrint() <span class="comment">// &quot;abcefg&quot;调用addExt() ,addExt()有一个对象指向&quot;abcefg&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;abc&quot;</span>.apply &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">doSomething</span><span class="params">(fix: () -&gt; <span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">    fix</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">goFix</span><span class="params">()</span></span>: <span class="built_in">Unit</span> &#123;</span><br><span class="line">    <span class="string">&quot;goFxi&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/08/22/kotlin-senior/2021-08-22_3.34.23_DSL.png"></p>
<h3 id="函数式编程"><a href="#函数式编程" class="headerlink" title="函数式编程"></a>函数式编程</h3><p><img src="/2021/08/22/kotlin-senior/2021-08-22_3.39.01_math_func.png" alt="2021-08-22_3.39.01_math_func"></p>
<p>函数类别</p>
<p><img src="/2021/08/22/kotlin-senior/2021-08-22_3.43.38_qualify.png" alt="2021-08-22_3.43.38_qualify"></p>
<h5 id="Map变换"><a href="#Map变换" class="headerlink" title="Map变换"></a>Map变换</h5><p><img src="/2021/08/22/kotlin-senior/Users/m/Documents/noteforme.github.io/source/_posts/kotlin-senior/2021-08-22_3.49.42_convert.png" alt="2021-08-22_3.49.42_convert"></p>
<p><img src="/2021/08/22/kotlin-senior/2021-08-22_3.50.14_map.png" alt="2021-08-22_3.50.14_map"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> animals = listOf(<span class="string">&quot;zebra&quot;</span>, <span class="string">&quot;giraffe&quot;</span>, <span class="string">&quot;elephant&quot;</span>, <span class="string">&quot;rat&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> banies = animals.map &#123; animal -&gt;</span><br><span class="line">    <span class="string">&quot;A baby <span class="variable">$animal</span>&quot;</span></span><br><span class="line">&#125;.map &#123;</span><br><span class="line">    baby -&gt; <span class="string">&quot;<span class="variable">$baby</span> , with the cutest little tail ever!&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">println(animals)</span><br><span class="line">println(banies)</span><br></pre></td></tr></table></figure>

<p><img src="/2021/08/22/kotlin-senior/Users/m/Documents/noteforme.github.io/source/_posts/kotlin-senior/2021-08-22_3.59.20_map1.png" alt="2021-08-22_3.59.20_map1"></p>
<p><img src="/2021/08/22/kotlin-senior/Users/m/Documents/noteforme.github.io/source/_posts/kotlin-senior/2021-08-22_3.59.53_map2.png" alt="2021-08-22_3.59.53_map2"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> animalsLength = animals.map &#123; it.length &#125;</span><br><span class="line">println(animalsLength)</span><br></pre></td></tr></table></figure>



<h5 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap"></a>flatMap</h5><p>faltMap函数操作一个集合的集合，将其中多个<strong>集合中的元素的合并</strong>后返回一个包含所有元素的单一集合。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> result = listOf(listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), listOf(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)).flatMap &#123; it &#125;</span><br><span class="line">println(result)</span><br></pre></td></tr></table></figure>

<h5 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h5><p><img src="/2021/08/22/kotlin-senior/2021-08-22_4.07.58_filter.png" alt="2021-08-22_4.07.58_filter"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> result = listOf(<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Jimmy&quot;</span>,<span class="string">&quot;Rose&quot;</span>,<span class="string">&quot;Tom&quot;</span>).filter &#123;</span><br><span class="line">    it.contains(<span class="string">&quot;J&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">println(result)</span><br></pre></td></tr></table></figure>

<p><img src="/2021/08/22/kotlin-senior/2021-08-22_4.10.58_filter.png" alt="2021-08-22_4.10.58_filter"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> items = listOf(</span><br><span class="line">        listOf(<span class="string">&quot;rea apple&quot;</span>, <span class="string">&quot;green apple&quot;</span>, <span class="string">&quot;blue apple&quot;</span>),</span><br><span class="line">        listOf(<span class="string">&quot;red fish&quot;</span>, <span class="string">&quot;blue fish&quot;</span>),</span><br><span class="line">        listOf(<span class="string">&quot;yellow banana&quot;</span>, <span class="string">&quot;teal banana&quot;</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">val</span> redItems = items.flatMap &#123; it.filter &#123; it.contains(<span class="string">&quot;red&quot;</span>) &#125; &#125;</span><br><span class="line">println(redItems)</span><br></pre></td></tr></table></figure>



<p><img src="/2021/08/22/kotlin-senior/2021-08-22_4.56.png" alt="2021-08-22_4.56"></p>
<p>133</p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/index.html">http://noteforme.github.io.com/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-kotlin-object" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/21/kotlin-object/">kotlin-object</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2021-08-21T13:02:57.000Z" itemprop="datePublished">2021年08月21日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/kotlin/">kotlin</a>
  </div>

      
      
<a href="/2021/08/21/kotlin-object/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>object目录下</p>
<h3 id="对象相关"><a href="#对象相关" class="headerlink" title="对象相关"></a>对象相关</h3><h5 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h5><p>类默认是封闭的，要让某个类开放继承，必须使用opem关键字修饰它</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span></span>(<span class="keyword">val</span> name:String) &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">description</span><span class="params">()</span></span> = <span class="string">&quot;Product: <span class="variable">$name</span>&quot;</span></span><br><span class="line">   <span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> <span class="title">load</span><span class="params">()</span></span> = <span class="string">&quot;Nothing..&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LuxuryProduct</span> : <span class="type">Product</span></span>(<span class="string">&quot;Luxury&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">load</span><span class="params">()</span></span> =<span class="string">&quot; LuxuryProduct loading&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> p : Product = LuxuryProduct()</span><br><span class="line">    println(p.load())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="类型检测-智能类型转换"><a href="#类型检测-智能类型转换" class="headerlink" title="类型检测 智能类型转换"></a>类型检测 智能类型转换</h5><p><img src="/2021/08/21/kotlin-object/2021-08-21_9.11.39_convert.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">println(p <span class="keyword">is</span> Product)</span><br><span class="line">println(p <span class="keyword">is</span> LuxuryProduct)</span><br><span class="line">println(p <span class="keyword">is</span> File)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (p <span class="keyword">is</span> LuxuryProduct)&#123;</span><br><span class="line">    println((p <span class="keyword">as</span> LuxuryProduct).special())</span><br><span class="line">    println(p.special()) <span class="comment">//只要转换一次，后面就直接可以使用，不用转换</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="Kotlin层次"><a href="#Kotlin层次" class="headerlink" title="Kotlin层次"></a>Kotlin层次</h5><p>无须在代码里显示指定，每一个类都会继承一个共同的叫做Any的超类。</p>
<h5 id="Object关键字"><a href="#Object关键字" class="headerlink" title="Object关键字"></a>Object关键字</h5><p>定义一个能产生一个实例的类- 单例</p>
<p>Object关键字有三种方式</p>
<ol>
<li><p>对象声明</p>
<p>有利于组织代码和管理状态，尤其是管理整个应用运行生命周期内的某些一致性状态</p>
</li>
<li><p>对象表达式</p>
<p><img src="/2021/08/21/kotlin-object/2021-08-21_9.30.54_expression.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Player</span> </span>&#123;</span><br><span class="line">    <span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> <span class="title">load</span><span class="params">()</span></span> = <span class="string">&quot;loading nothing..&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//匿名内部类，实例p对象</span></span><br><span class="line">    <span class="keyword">val</span> p = <span class="keyword">object</span> : Player()&#123;</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">load</span><span class="params">()</span></span>= <span class="string">&quot;anonymous nothing..&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    println(p.load())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>伴生对象</p>
<p><img src="/2021/08/21/kotlin-object/2021-08-21_9.40.03_companion.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 只要调用load() 或者实例化ConfigMap, 这个companion object才会被实例化</span></span><br><span class="line"><span class="comment"> * 而且也是单例的</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConfigMap</span> </span>&#123;</span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">val</span> PATH = <span class="string">&quot;xxxx&quot;</span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">load</span><span class="params">()</span></span> = File(PATH).readBytes()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//  类似于Java static</span></span><br><span class="line">    ConfigMap.load()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="类相关"><a href="#类相关" class="headerlink" title="类相关"></a>类相关</h3><h5 id="嵌套类"><a href="#嵌套类" class="headerlink" title="嵌套类"></a>嵌套类</h5><p><img src="/2021/08/21/kotlin-object/2021-08-21_9.47.48_innerclass.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InnerClassTest</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Equipment</span></span>(<span class="keyword">var</span> name:String)&#123;</span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">show</span><span class="params">()</span></span> = println(<span class="string">&quot;equipment:<span class="variable">$name</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">battle</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    InnerClassTest.Equipment(<span class="string">&quot;shap knife&quot;</span>).show()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="数据类"><a href="#数据类" class="headerlink" title="数据类"></a>数据类</h5><p><img src="/2021/08/21/kotlin-object/2021-08-21_9.52.32_data.png"></p>
<h5 id="数据类使用条件"><a href="#数据类使用条件" class="headerlink" title="数据类使用条件"></a>数据类使用条件</h5><p><img src="/2021/08/21/kotlin-object/2021-08-21_11.01.56_data_condition.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Coordinate</span></span>(<span class="keyword">var</span> x:<span class="built_in">Int</span>,<span class="keyword">var</span> y:<span class="built_in">Int</span>) &#123;</span><br><span class="line">    <span class="keyword">val</span> isInBounds = x &gt; <span class="number">0</span> &amp;&amp; y &gt; <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    println(Coordinate(<span class="number">10</span>,<span class="number">20</span>))</span><br><span class="line">    println(Coordinate(<span class="number">10</span>,<span class="number">20</span>)==Coordinate(<span class="number">10</span>,<span class="number">20</span>)) <span class="comment">//data默认重写equals方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果</p>
<blockquote>
<p>Coordinate(x=10, y=20) // 说明默认提供了toString方法</p>
</blockquote>
<p>重写了equals方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(<span class="meta">@Nullable</span> Object var1)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span> != var1) &#123;</span><br><span class="line">         <span class="keyword">if</span> (var1 <span class="keyword">instanceof</span> Coordinate) &#123;</span><br><span class="line">            Coordinate var2 = (Coordinate)var1;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.x == var2.x &amp;&amp; <span class="keyword">this</span>.y == var2.y) &#123;</span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="Copy"><a href="#Copy" class="headerlink" title="Copy"></a>Copy</h5><p><img src="/2021/08/21/kotlin-object/2021-08-21_10.00_copy.png"></p>
<p>注意:次构造函数数据不会copy过来</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span>  <span class="class"><span class="keyword">class</span> <span class="title">Student</span></span>(</span><br><span class="line">        <span class="keyword">var</span> name: String,</span><br><span class="line">        <span class="keyword">val</span> age: <span class="built_in">Int</span>	 <span class="comment">//age 主构造函数里声明的属性</span></span><br><span class="line">)&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> hobby = <span class="string">&quot;music&quot;</span></span><br><span class="line">    <span class="keyword">val</span> subject:String</span><br><span class="line">    <span class="keyword">var</span> score = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span> &#123;</span><br><span class="line">        println(<span class="string">&quot;initializing student&quot;</span>)</span><br><span class="line">        subject = <span class="string">&quot;english&quot;</span>			<span class="comment">//Init初始化块里的属性赋值和函数调用</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">constructor</span>(_name: String):<span class="keyword">this</span>(_name,<span class="number">10</span>)&#123;</span><br><span class="line">        score = <span class="number">10</span>; <span class="comment">//次构造函数数据不会copy过来</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">toString</span><span class="params">()</span></span>: String &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Student(name=&#x27;<span class="variable">$name</span>&#x27;, age=<span class="variable">$age</span>, hobby=&#x27;<span class="variable">$hobby</span>&#x27;, subject=&#x27;<span class="variable">$subject</span>&#x27;, score=<span class="variable">$score</span>)&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> s = Student(<span class="string">&quot;Jon&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> copy = s.copy(<span class="string">&quot;girl&quot;</span>)</span><br><span class="line">    <span class="keyword">var</span> s2 = s.copy(name = <span class="string">&quot;girl2&quot;</span>, age = <span class="number">18</span>)</span><br><span class="line">    println(s)</span><br><span class="line">    println(s2)</span><br><span class="line">    println(copy)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="解构声明"><a href="#解构声明" class="headerlink" title="解构声明"></a>解构声明</h5><p><img src="/2021/08/21/kotlin-object/2021-08-21_10.13.25_component.png"></p>
<ol>
<li><p>普通类</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlayerScore</span></span>(<span class="keyword">val</span> experience:<span class="built_in">Int</span>,<span class="keyword">val</span> level:<span class="built_in">Int</span>) &#123;</span><br><span class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">component1</span><span class="params">()</span></span> = experience</span><br><span class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">component2</span><span class="params">()</span></span> = level</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> (x,y) = PlayerScore(<span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line">    println(<span class="string">&quot;<span class="variable">$x</span>, <span class="variable">$y</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Data数据类</p>
<p>数据类自动生成解构语法</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Coordinate</span></span>(<span class="keyword">var</span> x:<span class="built_in">Int</span>,<span class="keyword">var</span> y:<span class="built_in">Int</span>) &#123;</span><br><span class="line">    <span class="keyword">val</span> isInBounds = x &gt; <span class="number">0</span> &amp;&amp; y &gt; <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    println(Coordinate(<span class="number">10</span>,<span class="number">20</span>))</span><br><span class="line">    println(Coordinate(<span class="number">10</span>,<span class="number">20</span>)==Coordinate(<span class="number">10</span>,<span class="number">20</span>)) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span>(x,y) = Coordinate(<span class="number">10</span>,<span class="number">20</span>) <span class="comment">//数据类自动生成解构语法</span></span><br><span class="line">    println(<span class="string">&quot;<span class="variable">$x</span> , <span class="variable">$y</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="运算符重载"><a href="#运算符重载" class="headerlink" title="运算符重载"></a>运算符重载</h5><p>如果要将内置运算符应用在自定义类身上，你必须重写运算符函数，告诉编译器该如何操作自定义类</p>
<p><img src="/2021/08/21/kotlin-object/2021-08-21_10.24.07_overload.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Coordinate2</span></span>(<span class="keyword">var</span> x:<span class="built_in">Int</span>,<span class="keyword">var</span> y:<span class="built_in">Int</span>) &#123;</span><br><span class="line">    <span class="keyword">val</span> isInBounds = x &gt; <span class="number">0</span> &amp;&amp; y &gt; <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">plus</span><span class="params">(other:<span class="type">Coordinate2</span>)</span></span> = Coordinate2(x + other.x,y+other.y)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">     <span class="keyword">val</span> c1=Coordinate2(<span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line">     <span class="keyword">val</span> c2=Coordinate2(<span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line">     println(c1 + c2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="枚举类"><a href="#枚举类" class="headerlink" title="枚举类"></a>枚举类</h3><p>用来定义常量集合特殊的类</p>
<p>枚举类是一个实例</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="class"><span class="keyword">class</span> <span class="title">Direction</span> </span>&#123;</span><br><span class="line">    EAST,</span><br><span class="line">    WEST,</span><br><span class="line">    SOUTH,</span><br><span class="line">    NORTH</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    println(Direction.EAST)</span><br><span class="line">    println(Direction.EAST <span class="keyword">is</span> Direction)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="枚举类定义函数"><a href="#枚举类定义函数" class="headerlink" title="枚举类定义函数"></a>枚举类定义函数</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="class"><span class="keyword">class</span> <span class="title">Direction2</span></span>(<span class="keyword">private</span> <span class="keyword">val</span> coordinate: Coordinate) &#123;</span><br><span class="line">    EAST(Coordinate(<span class="number">1</span>, <span class="number">0</span>)), <span class="comment">//EAST()是Direction2的实例</span></span><br><span class="line">    WEST(Coordinate(-<span class="number">1</span>, <span class="number">0</span>)),</span><br><span class="line">    SOUTH(Coordinate(-<span class="number">1</span>, <span class="number">0</span>)),</span><br><span class="line">    NORTH(Coordinate(<span class="number">1</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义函数</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">updateCoordinate</span><span class="params">(playerCoordinate: <span class="type">Coordinate</span>)</span></span> =</span><br><span class="line">            Coordinate(playerCoordinate.x + coordinate.x, playerCoordinate.y + coordinate.y)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    println(Direction2.EAST.updateCoordinate(Coordinate(<span class="number">10</span>, <span class="number">20</span>)))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="代数数据类型"><a href="#代数数据类型" class="headerlink" title="代数数据类型"></a>代数数据类型</h5><p>可以用来表示一组子类型的闭集，枚举类就是一种简单的ADT</p>
<p><img src="/2021/08/21/kotlin-object/2021-08-21_10.40.31_enum_data.png"></p>
<h5 id="密封类"><a href="#密封类" class="headerlink" title="密封类"></a>密封类</h5><p><img src="/2021/08/21/kotlin-object/2021-08-21_10.42.08_closure_sealed.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//密封类</span></span><br><span class="line"><span class="keyword">sealed</span> <span class="class"><span class="keyword">class</span> <span class="title">LicenseStatus2</span> </span>&#123;</span><br><span class="line">    <span class="keyword">object</span> UnQualified:LicenseStatus2()</span><br><span class="line">    <span class="keyword">object</span> Learning:LicenseStatus2()</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Qualified</span></span>(<span class="keyword">val</span> licenseId:String):LicenseStatus2() <span class="comment">//用来保存数据</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Driver2</span></span>(<span class="keyword">var</span> status: LicenseStatus2)&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">checkLicense</span><span class="params">()</span></span>:String&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">when</span>(status)&#123;</span><br><span class="line">            <span class="keyword">is</span> LicenseStatus2.UnQualified -&gt; <span class="string">&quot;没资格&quot;</span></span><br><span class="line">            <span class="keyword">is</span> LicenseStatus2.Learning -&gt; <span class="string">&quot;在学&quot;</span></span><br><span class="line">            <span class="keyword">is</span> LicenseStatus2.Qualified -&gt; <span class="string">&quot;有资格，驾驶证编号: <span class="subst">$&#123;((this.status as LicenseStatus2.Qualified).licenseId)&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> status1 = LicenseStatus2.Learning</span><br><span class="line">    <span class="keyword">val</span> status = LicenseStatus2.Qualified(<span class="string">&quot;2333003&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> driver = Driver2(status)</span><br><span class="line">    println(driver.checkLicense())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h5><p><img src="/2021/08/21/kotlin-object/Users/m/Documents/noteforme.github.io/source/_posts/kotlin-object/2021-08-22_9.59.22_interface.png"></p>
<p>InterfaceTest.kt</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Movable</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> maxSpeed:<span class="built_in">Int</span></span><br><span class="line">    <span class="keyword">var</span> wheels:<span class="built_in">Int</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">move</span><span class="params">(movable:<span class="type">Movable</span>)</span></span>:String</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span></span>(_name:String,<span class="keyword">override</span>  <span class="keyword">var</span> wheels:<span class="built_in">Int</span>=<span class="number">4</span>):Movable&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> maxSpeed: <span class="built_in">Int</span></span><br><span class="line">        <span class="keyword">get</span>() = TODO(<span class="string">&quot;Not yet implemented&quot;</span>)</span><br><span class="line">        <span class="keyword">set</span>(value) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">move</span><span class="params">(movable: <span class="type">Movable</span>)</span></span>: String &#123;</span><br><span class="line">        TODO(<span class="string">&quot;Not yet implemented&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="默认实现"><a href="#默认实现" class="headerlink" title="默认实现"></a>默认实现</h5><p>可以在接口里提供默认属性getter方法和函数实现</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Movable</span></span>&#123;</span><br><span class="line">    <span class="keyword">val</span> maxSpeed:<span class="built_in">Int</span></span><br><span class="line">        <span class="keyword">get</span>() = (<span class="number">1.</span><span class="number">.500</span>).shuffled().last()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> wheels:<span class="built_in">Int</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">move</span><span class="params">(movable:<span class="type">Movable</span>)</span></span>:String</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span></span>(_name:String,<span class="keyword">override</span>  <span class="keyword">var</span> wheels:<span class="built_in">Int</span>=<span class="number">4</span>):Movable&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> maxSpeed: <span class="built_in">Int</span></span><br><span class="line">        <span class="keyword">get</span>() = <span class="keyword">super</span>.maxSpeed</span><br><span class="line">        <span class="keyword">set</span>(value) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">move</span><span class="params">(movable: <span class="type">Movable</span>)</span></span>: String &#123;</span><br><span class="line">        TODO(<span class="string">&quot;Not yet implemented&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>抽象类</p>
<p><img src="/2021/08/21/kotlin-object/2021-08-22_10.13.48_abstract.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Gun</span></span>(<span class="keyword">val</span> range: <span class="built_in">Int</span>) &#123;</span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">pullTrigger</span><span class="params">()</span></span>: String</span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">fun</span> <span class="title">doSomething</span><span class="params">()</span></span> &#123;</span><br><span class="line">        println(<span class="string">&quot;doSomething&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AK47</span></span>(<span class="keyword">val</span> price: <span class="built_in">Int</span>) : Gun(range = <span class="number">500</span>)&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">pullTrigger</span><span class="params">()</span></span>: String &#123;</span><br><span class="line">        TODO()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h3><h5 id="定义泛型类"><a href="#定义泛型类" class="headerlink" title="定义泛型类"></a>定义泛型类</h5><p><img src="/2021/08/21/kotlin-object/2021-08-22_10.25.51_generics.png"></p>
<p>magicBox1.kt</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MagicBox</span>&lt;<span class="type">T</span>&gt;</span>(item:T)&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">var</span> subject:T = item</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Boy</span></span>(<span class="keyword">val</span> name:String,<span class="keyword">val</span> age:<span class="built_in">Int</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span></span>(<span class="keyword">val</span> weight:<span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> box1 = MagicBox(Boy(<span class="string">&quot;John&quot;</span>, <span class="number">20</span>))</span><br><span class="line">    <span class="keyword">val</span> box2 = MagicBox(Dog( <span class="number">20</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/08/21/kotlin-object/2021-08-22_20.30.09_notice.png"></p>
<h5 id="泛型函数"><a href="#泛型函数" class="headerlink" title="泛型函数"></a>泛型函数</h5><ol>
<li><p>泛型参数也可以用于函数。</p>
</li>
<li><p>定义一个函数用于获取元素，当且仅当MagicBox可用时，才能获取元素。</p>
<p>magicBox2.kt</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MagicBox</span>&lt;<span class="type">T</span>&gt;</span>(item: T) &#123;</span><br><span class="line">    <span class="keyword">var</span> available = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">var</span> subject: T = item</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">fetch</span><span class="params">()</span></span>: T? &#123;</span><br><span class="line">        <span class="keyword">return</span> subject.takeIf &#123; available &#125; <span class="comment">//当available =true，返回接收者对象</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Boy</span></span>(<span class="keyword">val</span> name: String, <span class="keyword">val</span> age: <span class="built_in">Int</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span></span>(<span class="keyword">val</span> weight: <span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> box1 = MagicBox(Boy(<span class="string">&quot;John&quot;</span>, <span class="number">20</span>))</span><br><span class="line">    <span class="keyword">val</span> box2 = MagicBox(Dog(<span class="number">20</span>))</span><br><span class="line">    box1.available = <span class="literal">true</span></span><br><span class="line">    box1.fetch()?.run &#123;</span><br><span class="line">        println(<span class="string">&quot;you find <span class="variable">$name</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="多泛型参数"><a href="#多泛型参数" class="headerlink" title="多泛型参数"></a>多泛型参数</h5><p>magicBox3.kt</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MagicBox</span>&lt;<span class="type">T</span>&gt;</span>(item: T) &#123;</span><br><span class="line">    <span class="keyword">var</span> available = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">var</span> subject: T = item</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">fetch</span><span class="params">()</span></span>: T? &#123;</span><br><span class="line">        <span class="keyword">return</span> subject.takeIf &#123; available &#125; <span class="comment">//当available =true，返回接收者对象</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return R缩写</span></span><br><span class="line">    <span class="comment">// 业务，把元素进行修改，魔盒里放的是男孩，取出来，变成男人</span></span><br><span class="line">    <span class="comment">//传入subjectModfunction是匿名函数类型 (T)-&gt;(R), 这个匿名函数传入的是 T 返回的是R,fetch执行返回的是R类型</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="type">&lt;R&gt;</span> <span class="title">fetch</span><span class="params">(subjectModFunction: (<span class="type">T</span>) -&gt; <span class="type">R</span>)</span></span>: R? &#123;</span><br><span class="line">        <span class="keyword">return</span> subjectModFunction(subject).takeIf &#123; available &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Boy</span></span>(<span class="keyword">val</span> name: String, <span class="keyword">val</span> age: <span class="built_in">Int</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Man</span></span>(<span class="keyword">val</span> name: String, <span class="keyword">val</span> age: <span class="built_in">Int</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span></span>(<span class="keyword">val</span> weight: <span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> box1 = MagicBox(Boy(<span class="string">&quot;John&quot;</span>, <span class="number">20</span>))</span><br><span class="line">    <span class="keyword">val</span> box2 = MagicBox(Dog(<span class="number">20</span>))</span><br><span class="line">    box1.available = <span class="literal">true</span></span><br><span class="line">    box1.fetch()?.run &#123;</span><br><span class="line">        println(<span class="string">&quot;you find <span class="variable">$name</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> fetch = box1.fetch &#123;</span><br><span class="line">        Man(it.name, it.age.plus(<span class="number">15</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="泛型类型约束"><a href="#泛型类型约束" class="headerlink" title="泛型类型约束"></a>泛型类型约束</h5><p>确保MagicBox只能装指定类型的物品， 如Human类型，咋弄?</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MagicBox</span>&lt;<span class="type">T:Human</span>&gt;</span>(item: T) &#123;</span><br><span class="line">    <span class="keyword">var</span> available = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">var</span> subject: T = item</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">fetch</span><span class="params">()</span></span>: T? &#123;</span><br><span class="line">        <span class="keyword">return</span> subject.takeIf &#123; available &#125; <span class="comment">//当available =true，返回接收者对象</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return R缩写</span></span><br><span class="line">    <span class="comment">// 业务，把元素进行修改，魔盒里放的是男孩，取出来，变成男人</span></span><br><span class="line">    <span class="comment">//传入subjectModfunction是匿名函数类型 (T)-&gt;(R), 这个匿名函数传入的是 T 返回的是R,fetch执行返回的是R类型</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="type">&lt;R&gt;</span> <span class="title">fetch</span><span class="params">(subjectModFunction: (<span class="type">T</span>) -&gt; <span class="type">R</span>)</span></span>: R? &#123;</span><br><span class="line">        <span class="keyword">return</span> subjectModFunction(subject).takeIf &#123; available &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Human</span></span>(<span class="keyword">val</span> age: <span class="built_in">Int</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Boy</span></span>(<span class="keyword">val</span> name: String, age: <span class="built_in">Int</span>) : Human(age)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Man</span></span>(<span class="keyword">val</span> name: String,  age: <span class="built_in">Int</span>):Human(age)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span></span>(<span class="keyword">val</span> weight: <span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> box1 = MagicBox(Boy(<span class="string">&quot;John&quot;</span>, <span class="number">20</span>))</span><br><span class="line"><span class="comment">//    val box2 = MagicBox(Dog(20))</span></span><br><span class="line">    box1.available = <span class="literal">true</span></span><br><span class="line">    box1.fetch()?.run &#123;</span><br><span class="line">        println(<span class="string">&quot;you find <span class="variable">$name</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> fetch = box1.fetch &#123;</span><br><span class="line">        Man(it.name, it.age.plus(<span class="number">15</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="vararg关键字与get函数"><a href="#vararg关键字与get函数" class="headerlink" title="vararg关键字与get函数"></a>vararg关键字与get函数</h5><p>MagicBox能存放任何类型的Human实例，但一次只能放一个，如果要存放多个实例呢？</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MagicBox</span>&lt;<span class="type">T : Human</span>&gt;</span>(<span class="keyword">vararg</span> item: T) &#123;</span><br><span class="line">    <span class="keyword">var</span> available = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">var</span> subject: Array&lt;<span class="keyword">out</span> T&gt; = item <span class="comment">//可变参数 必须写out</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">fetch</span><span class="params">(index: <span class="type">Int</span>)</span></span>: T? &#123;</span><br><span class="line">        <span class="keyword">return</span> subject[index].takeIf &#123; available &#125; <span class="comment">//当available =true，返回接收者对象</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return R缩写</span></span><br><span class="line">    <span class="comment">// 业务，把元素进行修改，魔盒里放的是男孩，取出来，变成男人</span></span><br><span class="line">    <span class="comment">//传入subjectModfunction是匿名函数类型 (T)-&gt;(R), 这个匿名函数传入的是 T 返回的是R,fetch执行返回的是R类型</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="type">&lt;R&gt;</span> <span class="title">fetch</span><span class="params">(index: <span class="type">Int</span>, subjectModFunction: (<span class="type">T</span>) -&gt; <span class="type">R</span>)</span></span>: R? &#123;</span><br><span class="line">        <span class="keyword">return</span> subjectModFunction(subject[index]).takeIf &#123; available &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Human</span></span>(<span class="keyword">val</span> age: <span class="built_in">Int</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Boy</span></span>(<span class="keyword">val</span> name: String, age: <span class="built_in">Int</span>) : Human(age)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Man</span></span>(<span class="keyword">val</span> name: String, age: <span class="built_in">Int</span>) : Human(age)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span></span>(<span class="keyword">val</span> weight: <span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> box1 = MagicBox(Boy(<span class="string">&quot;John&quot;</span>, <span class="number">20</span>), Boy(<span class="string">&quot;Jack&quot;</span>, <span class="number">20</span>), Boy(<span class="string">&quot;Jon&quot;</span>, <span class="number">20</span>))</span><br><span class="line">    box1.available = <span class="literal">true</span></span><br><span class="line">    box1.fetch(<span class="number">1</span>)?.run &#123;</span><br><span class="line">        println(<span class="string">&quot;you find <span class="variable">$name</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">val</span> fetch = box1.fetch(<span class="number">2</span>) &#123;</span><br><span class="line">        Man(it.name, it.age.plus(<span class="number">15</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="操作符"><a href="#操作符" class="headerlink" title="[]操作符"></a>[]操作符</h5><p>运算符重载</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MagicBox</span>&lt;<span class="type">T : Human</span>&gt;</span>(<span class="keyword">vararg</span> item: T) &#123;</span><br><span class="line">    <span class="keyword">var</span> available = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">var</span> subject: Array&lt;<span class="keyword">out</span> T&gt; = item <span class="comment">//可变参数 必须写out</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">fetch</span><span class="params">(index: <span class="type">Int</span>)</span></span>: T? &#123;</span><br><span class="line">        <span class="keyword">return</span> subject[index].takeIf &#123; available &#125; <span class="comment">//当available =true，返回接收者对象</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return R缩写</span></span><br><span class="line">    <span class="comment">// 业务，把元素进行修改，魔盒里放的是男孩，取出来，变成男人</span></span><br><span class="line">    <span class="comment">//传入subjectModfunction是匿名函数类型 (T)-&gt;(R), 这个匿名函数传入的是 T 返回的是R,fetch执行返回的是R类型</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="type">&lt;R&gt;</span> <span class="title">fetch</span><span class="params">(index: <span class="type">Int</span>, subjectModFunction: (<span class="type">T</span>) -&gt; <span class="type">R</span>)</span></span>: R? &#123;</span><br><span class="line">        <span class="keyword">return</span> subjectModFunction(subject[index]).takeIf &#123; available &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(index: <span class="type">Int</span>)</span></span>: T? = subject[index]?.takeIf &#123; available &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Human</span></span>(<span class="keyword">val</span> age: <span class="built_in">Int</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Boy</span></span>(<span class="keyword">val</span> name: String, age: <span class="built_in">Int</span>) : Human(age)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Man</span></span>(<span class="keyword">val</span> name: String, age: <span class="built_in">Int</span>) : Human(age)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span></span>(<span class="keyword">val</span> weight: <span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> box1 = MagicBox(Boy(<span class="string">&quot;John&quot;</span>, <span class="number">20</span>), Boy(<span class="string">&quot;Jack&quot;</span>, <span class="number">20</span>), Boy(<span class="string">&quot;Jon&quot;</span>, <span class="number">20</span>))</span><br><span class="line">    box1.available = <span class="literal">true</span></span><br><span class="line">    box1.fetch(<span class="number">1</span>)?.run &#123;</span><br><span class="line">        println(<span class="string">&quot;you find <span class="variable">$name</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">val</span> fetch = box1.fetch(<span class="number">2</span>) &#123;</span><br><span class="line">        Man(it.name, it.age.plus(<span class="number">15</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    box1[<span class="number">0</span>] <span class="comment">//重写get</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h5 id="Out-In"><a href="#Out-In" class="headerlink" title="Out In"></a>Out In<img src="/2021/08/21/kotlin-object/2021-08-22_11.08.36_out.png"></h5><p><img src="/2021/08/21/kotlin-object/2021-08-22_11.11.09_IN.png"></p>
<p>invariant（不变）</p>
<p>如果泛型类即将泛型类型作为函数参数，又将泛型类型作为函数的输出，那么即不用out也不用in.</p>
<p>为什么需要in out</p>
<p>如果泛型有继承关系，可以直接用,Java只能用具体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericTypeTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">//        ArrayList&lt;CharSequence&gt; list = new ArrayList&lt;String&gt;();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/08/21/kotlin-object/2021-08-22_11.37.32_why_inout.png"></p>
<ol>
<li>父类泛型对象可以赋值给子类泛型对象 ， 用in</li>
<li>子类泛型对象可以赋值给父类泛型对象，用out</li>
</ol>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// out</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Production</span>&lt;<span class="type">out T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">product</span><span class="params">()</span></span>: T</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Consumer</span>&lt;<span class="type">in T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">//    fun consume(item:T):T //Type parameter T is declared as &#x27;in&#x27; but occurs in &#x27;out&#x27; position in type T</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">consume</span><span class="params">(item: <span class="type">T</span>)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//不变</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">ProductionConsumer</span>&lt;<span class="type">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">product</span><span class="params">()</span></span>: T</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">consume</span><span class="params">(item: <span class="type">T</span>)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Food</span></span></span><br><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">FastFood</span>:<span class="type">Food</span></span>()</span><br><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Burger</span> :<span class="type">FastFood</span></span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//生产者</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FoodStore</span> : <span class="type">Production</span>&lt;<span class="type">Food</span>&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">product</span><span class="params">()</span></span>: Food &#123;</span><br><span class="line">        println(<span class="string">&quot;Product food&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> Food()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FastFoodStore</span> : <span class="type">Production</span>&lt;<span class="type">FastFood</span>&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">product</span><span class="params">()</span></span>: FastFood &#123;</span><br><span class="line">        println(<span class="string">&quot;Product FastFood&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> FastFood()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BurgerFoodStore</span> : <span class="type">Production</span>&lt;<span class="type">Burger</span>&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">product</span><span class="params">()</span></span>: Burger &#123;</span><br><span class="line">        println(<span class="string">&quot;Product Burger&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> Burger()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//消费者</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EveryBody</span> : <span class="type">Consumer</span>&lt;<span class="type">Food</span>&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">consume</span><span class="params">(item: <span class="type">Food</span>)</span></span> &#123;</span><br><span class="line">        println(<span class="string">&quot;Eat food.&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ModernPeople</span> : <span class="type">Consumer</span>&lt;<span class="type">FastFood</span>&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">consume</span><span class="params">(item: <span class="type">FastFood</span>)</span></span> &#123;</span><br><span class="line">        println(<span class="string">&quot;Eat fastFood&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AmericanPeople</span> : <span class="type">Consumer</span>&lt;<span class="type">Burger</span>&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">consume</span><span class="params">(item: <span class="type">Burger</span>)</span></span> &#123;</span><br><span class="line">        println(<span class="string">&quot;Eat Burger&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> production1 : Production&lt;Food&gt; = FoodStore() <span class="comment">// 理解时，别看方法只看类就可以了，父子类关系</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//子类泛型对象可以复制给负累泛型对象，用out</span></span><br><span class="line">    <span class="keyword">val</span> production2 : Production&lt;Food&gt; = FastFoodStore() <span class="comment">// 就是因为有 out，out删除就报错</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//父类泛型对象可以赋值给子类泛型对象 ， 用in</span></span><br><span class="line">    <span class="keyword">val</span> consumer1:Consumer&lt;Burger&gt; = EveryBody()</span><br><span class="line"><span class="comment">//    val consumer2:Consumer&lt;Food&gt; = ModernPeople()//Required:Consumer&lt;Food&gt; Found : ModernPeople</span></span><br><span class="line">    <span class="keyword">val</span> consumer2:Consumer&lt;Burger&gt; = ModernPeople()</span><br><span class="line">    consumer2.consume(Burger())</span><br><span class="line"><span class="comment">//    consumer2.consume(Food())</span></span><br><span class="line">    <span class="keyword">val</span> consumer3:Consumer&lt;Burger&gt; = AmericanPeople()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="Reified"><a href="#Reified" class="headerlink" title="Reified"></a>Reified</h5><p><img src="/2021/08/21/kotlin-object/2021-08-22_1.01.03_reified.png" alt="2021-08-22_1.01.03_reified"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MagicBox</span>&lt;<span class="type">T : Human</span>&gt;</span>() &#123;</span><br><span class="line">    <span class="comment">//随机产生一个对象，如果不是指定类型的对象，就通过backup函数生成一个指定类型的对象</span></span><br><span class="line">    <span class="comment">/*  fun &lt;T&gt; randomOrBackup(backup: () -&gt; T): T &#123;    // backup: ()-&gt;T 函数 和randomOrBackup返回的都是T类型</span></span><br><span class="line"><span class="comment">          val items = listOf(Boy(&quot;jocnk&quot;, 20), Man(&quot;john&quot;, 20))</span></span><br><span class="line"><span class="comment">          val random = items.shuffled().first()</span></span><br><span class="line"><span class="comment">          return if (random is T) &#123;</span></span><br><span class="line"><span class="comment">              random</span></span><br><span class="line"><span class="comment">          &#125; else &#123;</span></span><br><span class="line"><span class="comment">              backup()</span></span><br><span class="line"><span class="comment">          &#125;</span></span><br><span class="line"><span class="comment">      &#125; */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// backup: ()-&gt;T 函数 和randomOrBackup返回的都是T类型</span></span><br><span class="line">    <span class="comment">//inline  reified一起使用</span></span><br><span class="line">    <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;<span class="keyword">reified</span> T&gt;</span> <span class="title">randomOrBackup</span><span class="params">(backup: () -&gt; <span class="type">T</span>)</span></span>: T &#123;</span><br><span class="line">        <span class="keyword">val</span> items = listOf(Boy(<span class="string">&quot;jocnk&quot;</span>, <span class="number">20</span>), Man(<span class="string">&quot;john&quot;</span>, <span class="number">20</span>))</span><br><span class="line">        <span class="keyword">val</span> random = items.shuffled().first()</span><br><span class="line">        println(random)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">if</span> (random <span class="keyword">is</span> T) &#123;</span><br><span class="line">            random</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            backup()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Human</span></span>(<span class="keyword">val</span> age: <span class="built_in">Int</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Boy</span></span>(<span class="keyword">val</span> name: String, age: <span class="built_in">Int</span>) : Human(age)&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">toString</span><span class="params">()</span></span>: String &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Boy(name=&#x27;<span class="variable">$name</span>&#x27;)&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Man</span></span>(<span class="keyword">val</span> name: String, age: <span class="built_in">Int</span>) : Human(age)&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">toString</span><span class="params">()</span></span>: String &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Man(name=&#x27;<span class="variable">$name</span>&#x27;)&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> box1: MagicBox&lt;Man&gt; = MagicBox()</span><br><span class="line">    <span class="comment">// 由backup函数推断出来T的类型</span></span><br><span class="line">    <span class="keyword">val</span> subject = box1.randomOrBackup &#123; Man(<span class="string">&quot;Jimmy&quot;</span>, <span class="number">28</span>) &#125; <span class="comment">//Man推断T类型</span></span><br><span class="line">    println(subject)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/index.html">http://noteforme.github.io.com/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-kotlin-medium" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/21/kotlin-medium/">kotlin-medium</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2021-08-21T08:48:52.000Z" itemprop="datePublished">2021年08月21日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/kotlin/">kotlin</a>
  </div>

      
      
<a href="/2021/08/21/kotlin-medium/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h3><h4 id="List"><a href="#List" class="headerlink" title="List"></a>List</h4><p>List.kt</p>
<h5 id="List创建与元素获取"><a href="#List创建与元素获取" class="headerlink" title="List创建与元素获取"></a>List创建与元素获取</h5><p><img src="/2021/08/21/kotlin-medium/2021-08-21_getelseif.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="string">&quot;girl1&quot;</span>, <span class="string">&quot;girl2&quot;</span>, <span class="string">&quot;girl3&quot;</span>)</span><br><span class="line">println(list.getOrElse(<span class="number">3</span>) &#123; <span class="string">&quot;Unknown&quot;</span> &#125;)</span><br><span class="line">println(list.getOrNull(<span class="number">3</span>))</span><br><span class="line">println(list.getOrNull(<span class="number">3</span>) ?: <span class="string">&quot;Unknown&quot;</span>)</span><br></pre></td></tr></table></figure>



<h5 id="可变列表"><a href="#可变列表" class="headerlink" title="可变列表"></a>可变列表</h5><p><img src="/2021/08/21/kotlin-medium/2021-08-21_16-57-45_mutable.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> mutableList = mutableListOf(<span class="string">&quot;Jason&quot;</span>, <span class="string">&quot;Jack&quot;</span>, <span class="string">&quot;girl1&quot;</span>)</span><br><span class="line">mutableList.add(<span class="string">&quot;Jimmy&quot;</span>)</span><br><span class="line">mutableList.remove(<span class="string">&quot;Jack&quot;</span>)</span><br><span class="line">println(mutableList)</span><br><span class="line"></span><br><span class="line">list.toMutableList() <span class="comment">// 不可变转可变</span></span><br><span class="line">mutableList.toList() <span class="comment">// 可变转不可变</span></span><br></pre></td></tr></table></figure>



<h5 id="mutator函数"><a href="#mutator函数" class="headerlink" title="mutator函数"></a>mutator函数</h5><p><img src="/2021/08/21/kotlin-medium/2021-08-21_17-01-19_mutaber.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mutableList += <span class="string">&quot;John&quot;</span></span><br><span class="line">mutableList -= <span class="string">&quot;girl1&quot;</span></span><br><span class="line">mutableList.removeIf&#123;it.contains(<span class="string">&quot;Jack&quot;</span>)&#125; <span class="comment">//包含Jack就把 Jack移除</span></span><br><span class="line">println(mutableList)</span><br></pre></td></tr></table></figure>



<h5 id="集合遍历"><a href="#集合遍历" class="headerlink" title="集合遍历"></a>集合遍历</h5><ol>
<li>for in</li>
<li>forEach</li>
<li>forEachIndexed遍历时要获取索引</li>
</ol>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (s <span class="keyword">in</span> list)&#123;</span><br><span class="line">    println(s)</span><br><span class="line">&#125;</span><br><span class="line">list.forEach&#123;</span><br><span class="line">    println(it)</span><br><span class="line">&#125;</span><br><span class="line">list.forEachIndexed&#123;index,item-&gt;</span><br><span class="line">    println(<span class="string">&quot;<span class="variable">$index</span>  <span class="variable">$item</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="解构"><a href="#解构" class="headerlink" title="解构"></a>解构</h5><p>通过_符号过滤不想要的元素</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//    val(girl1,girl2,girl3) = list</span></span><br><span class="line">    <span class="keyword">val</span>(girl1,_,girl3) = list   <span class="comment">//如果不需要girl2,用_，这个字节码也不会取出</span></span><br></pre></td></tr></table></figure>



<h4 id="Set集合"><a href="#Set集合" class="headerlink" title="Set集合"></a>Set集合</h4><h5 id="elementAt获取元素"><a href="#elementAt获取元素" class="headerlink" title="elementAt获取元素"></a>elementAt获取元素</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> <span class="keyword">set</span> = setOf(<span class="string">&quot;girl1&quot;</span>, <span class="string">&quot;girl2&quot;</span>, <span class="string">&quot;girl3&quot;</span>, <span class="string">&quot;girl1&quot;</span>)</span><br><span class="line">println(<span class="keyword">set</span>.elementAt(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> mutableSet = mutableSetOf(<span class="string">&quot;girl1&quot;</span>, <span class="string">&quot;girl2&quot;</span>, <span class="string">&quot;girl3&quot;</span>, <span class="string">&quot;girl1&quot;</span>)</span><br><span class="line">mutableSet += <span class="string">&quot;girl5&quot;</span></span><br></pre></td></tr></table></figure>



<h5 id="List去重"><a href="#List去重" class="headerlink" title="List去重"></a>List去重</h5><p>通过toSet去重</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = mutableSetOf(<span class="string">&quot;girl1&quot;</span>, <span class="string">&quot;girl2&quot;</span>, <span class="string">&quot;girl3&quot;</span>, <span class="string">&quot;girl1&quot;</span>).toSet().toList()</span><br><span class="line">println(list)</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> distinct = mutableSetOf(<span class="string">&quot;girl1&quot;</span>, <span class="string">&quot;girl2&quot;</span>, <span class="string">&quot;girl3&quot;</span>, <span class="string">&quot;girl1&quot;</span>).distinct()</span><br><span class="line">println(distinct)</span><br></pre></td></tr></table></figure>



<h5 id="数组类型"><a href="#数组类型" class="headerlink" title="数组类型"></a>数组类型</h5><p> kotlin提供了各种Array,虽然是引用类型，但最终编译成Java基本数据类型</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> intArray = intArrayOf(<span class="number">10</span>, <span class="number">30</span>, <span class="number">40</span>)</span><br><span class="line">listOf(<span class="number">10</span>, <span class="number">30</span>, <span class="number">40</span>).toIntArray()</span><br><span class="line"><span class="keyword">val</span> array = arrayOf(File(<span class="string">&quot;xxx&quot;</span>), File(<span class="string">&quot;yyyy&quot;</span>))</span><br></pre></td></tr></table></figure>



<p><img src="/2021/08/21/kotlin-medium/2021-08-21_17-32-32_array.png"></p>
<h4 id="Map集合"><a href="#Map集合" class="headerlink" title="Map集合"></a>Map集合</h4><p><img src="/2021/08/21/kotlin-medium/2021-08-21_17-51-48_map_read.png"></p>
<h5 id="map获取"><a href="#map获取" class="headerlink" title="map获取"></a>map获取</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">println(map[<span class="string">&quot;lucy1&quot;</span>])</span><br><span class="line">println(map.getValue(<span class="string">&quot;lucy2&quot;</span>))</span><br><span class="line">println(map.getOrElse(<span class="string">&quot;Jon&quot;</span>)&#123;<span class="string">&quot;Unknown&quot;</span>&#125;) <span class="comment">//没有Jon，返回Unknown</span></span><br><span class="line">println(map.getOrDefault(<span class="string">&quot;Jon&quot;</span>,<span class="number">0</span>)) <span class="comment">//没有Jon，返回默认值0</span></span><br></pre></td></tr></table></figure>



<h5 id="map遍历"><a href="#map遍历" class="headerlink" title="map遍历"></a>map遍历</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">map.forEach&#123;</span><br><span class="line">    println(<span class="string">&quot;<span class="subst">$&#123;it.key&#125;</span>, <span class="subst">$&#123;it.value&#125;</span>&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">map.forEach&#123;(key:String,value:<span class="built_in">Int</span>)-&gt;</span><br><span class="line">    println(<span class="string">&quot;<span class="subst">$&#123;key&#125;</span>, <span class="subst">$&#123;value&#125;</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="mutableMap"><a href="#mutableMap" class="headerlink" title="mutableMap"></a>mutableMap</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> mutableMap = mutableMapOf(<span class="string">&quot;lucy1&quot;</span> to <span class="number">18</span>, <span class="string">&quot;lucy2&quot;</span> to <span class="number">19</span>, <span class="string">&quot;lucy3&quot;</span> to <span class="number">20</span>)</span><br><span class="line">mutableMap += <span class="string">&quot;jon&quot;</span> to <span class="number">22</span></span><br><span class="line">mutableMap.put(<span class="string">&quot;jon2&quot;</span>,<span class="number">35</span>)</span><br><span class="line">mutableMap.getOrPut(<span class="string">&quot;Rose&quot;</span>)&#123;<span class="number">30</span>&#125; <span class="comment">// 如果没有Rose,就添加进来</span></span><br><span class="line">println(mutableMap)</span><br></pre></td></tr></table></figure>



<h3 id="定义类"><a href="#定义类" class="headerlink" title="定义类"></a>定义类</h3><p><img src="/2021/08/21/kotlin-medium/2021-08-211_8-32-51_field_class.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Class Player&#123;</span><br><span class="line">	<span class="keyword">var</span> name:String? = <span class="string">&quot;jack&quot;</span> <span class="comment">// 编译后生成了get. set方法</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> p = Player()</span><br><span class="line">  p.name = <span class="string">&quot;rose&quot;</span> <span class="comment">//编译生成了 setName方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Player</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: String = <span class="string">&quot;jack&quot;</span></span><br><span class="line">        <span class="keyword">get</span>() = field.capitalize()</span><br><span class="line">        <span class="keyword">set</span>(value) &#123;</span><br><span class="line">            field = value.trim()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//计算属性是通过一个覆盖的get或set运算符来定义，这时field就不需要了。</span></span><br><span class="line">    <span class="keyword">val</span> rolledValue</span><br><span class="line">        <span class="keyword">get</span>() = (<span class="number">1.</span><span class="number">.6</span>).shuffled().first()</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="防范竞态条件"><a href="#防范竞态条件" class="headerlink" title="防范竞态条件"></a>防范竞态条件</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//    如果一个类属性即可空又可变，那么引用它之前必须保证它非空，一个办法是用also标准函数</span></span><br><span class="line">    <span class="keyword">var</span> words:String? = <span class="string">&quot;hello&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">saySomething</span><span class="params">()</span></span>&#123;</span><br><span class="line">        words?.also &#123; </span><br><span class="line">            println(<span class="string">&quot;Hello <span class="subst">$&#123;it.uppercase()&#125;</span>&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h5 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span>(</span><br><span class="line">        _name: String,</span><br><span class="line">        _age: <span class="built_in">Int</span>,</span><br><span class="line">        _isNormal: <span class="built_in">Boolean</span></span><br><span class="line">) &#123;</span><br><span class="line">    <span class="keyword">var</span> name = _name <span class="comment">//临时变量用 _表示 只用一次</span></span><br><span class="line">        <span class="keyword">get</span>() = field.capitalize()</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">set</span>(value) &#123;</span><br><span class="line">            value.trim()</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">var</span> age = _age <span class="comment">//临时变量用 _表示 只用一次</span></span><br><span class="line">        <span class="keyword">get</span>() = age.absoluteValue</span><br><span class="line">        <span class="keyword">set</span>(value) &#123;</span><br><span class="line">            field = value.absoluteValue</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">var</span> isNormal = _isNormal</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> p = Student(<span class="string">&quot;john&quot;</span>, <span class="number">19</span>, <span class="literal">true</span>)</span><br><span class="line"><span class="comment">//    p.name = &quot;rose&quot; //Cannot assign to &#x27;name&#x27;: the setter is private in &#x27;Student&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="主构造函数里定义属性"><a href="#主构造函数里定义属性" class="headerlink" title="主构造函数里定义属性"></a>主构造函数里定义属性</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student2</span></span>(</span><br><span class="line">        _name: String,</span><br><span class="line">        <span class="keyword">val</span> age: <span class="built_in">Int</span>,</span><br><span class="line">        <span class="keyword">val</span> isNormal: <span class="built_in">Boolean</span></span><br><span class="line">) &#123;</span><br><span class="line">    <span class="keyword">var</span> name = _name <span class="comment">//临时变量用 _表示 只用一次</span></span><br><span class="line">        <span class="keyword">get</span>() = field.capitalize()</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">set</span>(value) &#123;</span><br><span class="line">            value.trim()</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> p = Student2(<span class="string">&quot;john&quot;</span>, <span class="number">19</span>, <span class="literal">true</span>)</span><br><span class="line"><span class="comment">//    p.name = &quot;rose&quot; //Cannot assign to &#x27;name&#x27;: the setter is private in &#x27;Student&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="次构造函数"><a href="#次构造函数" class="headerlink" title="次构造函数"></a>次构造函数</h5><p>Student2.kt</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(_name:String):<span class="keyword">this</span>(_name,age=<span class="number">100</span>,isNormal = <span class="literal">false</span>)</span><br><span class="line"><span class="keyword">constructor</span>(_name:String,age: <span class="built_in">Int</span>):<span class="keyword">this</span>(_name,age=<span class="number">100</span>,isNormal = <span class="literal">false</span>)&#123; <span class="comment">//定义初始化代码逻辑</span></span><br><span class="line">    <span class="keyword">this</span>.name = name.uppercase()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">val</span> p2 = Student2(<span class="string">&quot;Rose&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> p3 = Student2(<span class="string">&quot;Rose&quot;</span>,<span class="number">20</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="构造函数给默认值"><a href="#构造函数给默认值" class="headerlink" title="构造函数给默认值"></a>构造函数给默认值</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student3</span></span>(</span><br><span class="line">        _name: String,</span><br><span class="line">        <span class="keyword">val</span> age: <span class="built_in">Int</span> = <span class="number">20</span>,</span><br><span class="line">        <span class="keyword">val</span> isNormal: <span class="built_in">Boolean</span></span><br><span class="line">) &#123;</span><br><span class="line">    <span class="keyword">var</span> name = _name <span class="comment">//临时变量用 _表示 只用一次</span></span><br><span class="line">        <span class="keyword">get</span>() = field.capitalize()</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">set</span>(value) &#123;</span><br><span class="line">            value.trim()</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    Student3(isNormal = <span class="literal">false</span>, _name = <span class="string">&quot;Jon&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="初始化块"><a href="#初始化块" class="headerlink" title="初始化块"></a>初始化块</h5><p>初始化块可以设置变量或值，以及执行有效性检查，如果检查传给某构造函数的值是否有效，<strong>初始化块代码会在构造类实例时执行</strong>。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student3</span></span>(</span><br><span class="line">        _name: String,</span><br><span class="line">        <span class="keyword">val</span> age: <span class="built_in">Int</span> = <span class="number">20</span>,</span><br><span class="line">        <span class="keyword">val</span> isNormal: <span class="built_in">Boolean</span></span><br><span class="line">) &#123;</span><br><span class="line">    <span class="keyword">var</span> name = _name <span class="comment">//临时变量用 _表示 只用一次</span></span><br><span class="line">        <span class="keyword">get</span>() = field.capitalize()</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">set</span>(value) &#123;</span><br><span class="line">            value.trim()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>&#123;</span><br><span class="line">        require(age&gt;<span class="number">0</span>)&#123;<span class="string">&quot;age must be positive&quot;</span>&#125;</span><br><span class="line">        require(name.isNotBlank())&#123;<span class="string">&quot;player must have a name.&quot;</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    Student3(isNormal = <span class="literal">false</span>, _name = <span class="string">&quot;Jon&quot;</span>)</span><br><span class="line">    Student3(isNormal = <span class="literal">false</span>, _name = <span class="string">&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="初始化顺序"><a href="#初始化顺序" class="headerlink" title="初始化顺序"></a>初始化顺序</h5><ol>
<li>主构造函数里声明的属性</li>
<li>类级别的属性赋值</li>
<li>Init初始化块里的属性赋值和函数调用</li>
<li>次构造函数里的属性赋值和函数调用</li>
</ol>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student4</span></span>(</span><br><span class="line">        _name: String,</span><br><span class="line">        <span class="keyword">val</span> age: <span class="built_in">Int</span>	 <span class="comment">//age 主构造函数里声明的属性</span></span><br><span class="line">)&#123;</span><br><span class="line">    <span class="keyword">var</span> name = _name	<span class="comment">//类级别的属性赋值 	name , score, hobby</span></span><br><span class="line">    <span class="keyword">var</span> score = <span class="number">10</span>;	</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> hobby = <span class="string">&quot;music&quot;</span> </span><br><span class="line">    <span class="keyword">val</span> subject:String</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span> &#123;</span><br><span class="line">        println(<span class="string">&quot;initializing student&quot;</span>)	</span><br><span class="line">        subject = <span class="string">&quot;english&quot;</span>			<span class="comment">//Init初始化块里的属性赋值和函数调用</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">constructor</span>(_name: String):<span class="keyword">this</span>(_name,<span class="number">10</span>)&#123;</span><br><span class="line">        score = <span class="number">20</span>		<span class="comment">//次构造函数里的属性赋值和函数调用</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Student4(<span class="string">&quot;jon&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>反编译字节码后</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Student4</span><span class="params">(<span class="meta">@NotNull</span> String _name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">   Intrinsics.checkNotNullParameter(_name, <span class="string">&quot;_name&quot;</span>);</span><br><span class="line">   <span class="keyword">super</span>();</span><br><span class="line">   <span class="keyword">this</span>.age = age;			<span class="comment">//主构造函数里声明的属性</span></span><br><span class="line">   <span class="keyword">this</span>.name = _name;		<span class="comment">//类级别的属性赋值	name , score, hobby</span></span><br><span class="line">   <span class="keyword">this</span>.score = <span class="number">10</span>;			</span><br><span class="line">   <span class="keyword">this</span>.hobby = <span class="string">&quot;music&quot;</span>;</span><br><span class="line">   String var3 = <span class="string">&quot;initializing student&quot;</span>; 		<span class="comment">//Init初始化块里的属性赋值和函数调用</span></span><br><span class="line">   <span class="keyword">boolean</span> var4 = <span class="keyword">false</span>;</span><br><span class="line">   System.out.println(var3);</span><br><span class="line">   <span class="keyword">this</span>.subject = <span class="string">&quot;english&quot;</span>;		</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Student4</span><span class="params">(<span class="meta">@NotNull</span> String _name)</span> </span>&#123;  <span class="comment">//调用这个构造方法</span></span><br><span class="line">   Intrinsics.checkNotNullParameter(_name, <span class="string">&quot;_name&quot;</span>);</span><br><span class="line">   <span class="keyword">this</span>(_name, <span class="number">10</span>); </span><br><span class="line">   <span class="keyword">this</span>.score = <span class="number">20</span>;			<span class="comment">//次构造函数里的属性赋值和函数调用</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/08/21/kotlin-medium/2021-08-21_20-07-53_class_init_order.png"></p>
<h5 id="延迟初始化"><a href="#延迟初始化" class="headerlink" title="延迟初始化"></a>延迟初始化</h5><p><img src="/2021/08/21/kotlin-medium/2021-08-21_8.18.35_lateinit.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Player4</span> </span>&#123;</span><br><span class="line">    <span class="keyword">lateinit</span> <span class="keyword">var</span> equipment:String</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">ready</span><span class="params">()</span></span>&#123;</span><br><span class="line">        equipment = <span class="string">&quot;sharp knife&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">battle</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (::equipment.isInitialized) println(equipment)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> p = Player4()</span><br><span class="line">    p.ready()</span><br><span class="line">    p.battle()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="惰性初始化"><a href="#惰性初始化" class="headerlink" title="惰性初始化"></a>惰性初始化</h5><p>延迟初始化并不是推后初始化的唯一方式，也可以暂时不初始化某个变量，<strong>直到首次使用它才初始化</strong>，这个叫做惰性初始化。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Player5</span></span>(_name: String) &#123;</span><br><span class="line">    <span class="keyword">var</span> name = _name</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> config <span class="keyword">by</span> lazy &#123; loadConfig() &#125; <span class="comment">// 懒汉式</span></span><br><span class="line"><span class="comment">//    val config = loadConfig()   //饿汉式</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">loadConfig</span><span class="params">()</span></span>: String &#123;</span><br><span class="line">        println(<span class="string">&quot;loading...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;beauty girl&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> p = Player5(<span class="string">&quot;girl&quot;</span>)</span><br><span class="line">    Thread.sleep(<span class="number">5000</span>)</span><br><span class="line">    println(p.config)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>Java不会有这种陷阱</p>
<h5 id="初始化陷阱1"><a href="#初始化陷阱1" class="headerlink" title="初始化陷阱1"></a>初始化陷阱1</h5><p>顺序非常重要，必须保证块中的所有属性已完成初始化</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">init</span> &#123;</span><br><span class="line">    <span class="keyword">val</span> bloodBonus = blood.times(<span class="number">4</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">val</span> blood  = <span class="number">100</span> <span class="comment">//必须保证块中的所有属性已完成初始化</span></span><br></pre></td></tr></table></figure>



<h5 id="初始化陷阱2"><a href="#初始化陷阱2" class="headerlink" title="初始化陷阱2"></a>初始化陷阱2</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Player7</span> </span>&#123;</span><br><span class="line">   <span class="keyword">val</span> name:String <span class="comment">//类级别属性</span></span><br><span class="line">   <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span>  <span class="title">firstLetter</span><span class="params">()</span></span> = name[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">init</span> &#123;</span><br><span class="line">        println(firstLetter())</span><br><span class="line">        name= <span class="string">&quot;john&quot;</span>    <span class="comment">//初始化块代码排第三</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    Player7()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="初始化陷阱3"><a href="#初始化陷阱3" class="headerlink" title="初始化陷阱3"></a>初始化陷阱3</h5><p>initPlayerName() 初始化 playerName时，name属性还未完初始化。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InitTrapTest3</span></span>(_name:String) &#123;</span><br><span class="line">    <span class="keyword">val</span> playerName:String = initPlayerName()</span><br><span class="line">    <span class="keyword">val</span> name:String = _name     <span class="comment">//这个要放第一句</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">initPlayerName</span><span class="params">()</span></span> = name</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   println(InitTrapTest3(<span class="string">&quot;John&quot;</span>).playerName)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/index.html">http://noteforme.github.io.com/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-kotlin-elementary" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/19/kotlin-elementary/">kotlin_elementary</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2021-08-19T14:29:06.000Z" itemprop="datePublished">2021年08月19日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/kotlin/">kotlin</a>
  </div>

      
      
<a href="/2021/08/19/kotlin-elementary/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h3><h5 id="Kotlin内置数据类型"><a href="#Kotlin内置数据类型" class="headerlink" title="Kotlin内置数据类型"></a>Kotlin内置数据类型</h5><p><img src="/2021/08/19/kotlin-elementary/2021-08-19_datatype.png"></p>
<h5 id="类型推断"><a href="#类型推断" class="headerlink" title="类型推断"></a>类型推断</h5><p>对于已经声明并赋值的变量，它允许你省略类型定义.</p>
<h5 id="编译时常量"><a href="#编译时常量" class="headerlink" title="编译时常量"></a>编译时常量</h5><p>编译时常量只能再函数外定义，因为编译时常量必须在编译时赋值，而函数时在运行时才调用，函数内的变量也是在运行时赋值，编译时常量要在这些变量赋值前就已存在。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">val</span> MAX =<span class="number">200</span>;</span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123; </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">val</span> MAX =<span class="number">200</span>;<span class="comment">//报错 Modifier &#x27;const&#x27; is not applicable to &#x27;local variable&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="基本表达式"><a href="#基本表达式" class="headerlink" title="基本表达式"></a>基本表达式</h3><h5 id="age表达式"><a href="#age表达式" class="headerlink" title="age表达式"></a>age表达式</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> score = <span class="number">6</span>;</span><br><span class="line"><span class="keyword">if</span> (score <span class="keyword">in</span> <span class="number">9.</span><span class="number">.10</span>)&#123;</span><br><span class="line">    println(<span class="string">&quot;Big美女&quot;</span>)</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> (score <span class="keyword">in</span> <span class="number">6.</span><span class="number">.8</span>)&#123;</span><br><span class="line">    println(<span class="string">&quot;美女&quot;</span>)</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    println(<span class="string">&quot;who knows&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(score !<span class="keyword">in</span> <span class="number">1.</span><span class="number">.5</span>)&#123;</span><br><span class="line">    println(<span class="string">&quot;good&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>美女<br>good</p>
</blockquote>
<h5 id="when"><a href="#when" class="headerlink" title="when"></a>when</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> school = <span class="string">&quot;0小学&quot;</span>;</span><br><span class="line"><span class="keyword">val</span> level = <span class="keyword">when</span> (school) &#123;</span><br><span class="line">    <span class="string">&quot;幼儿园&quot;</span> -&gt; <span class="string">&quot;幼儿&quot;</span></span><br><span class="line">    <span class="string">&quot;小学&quot;</span> -&gt; <span class="string">&quot;少儿&quot;</span></span><br><span class="line">    <span class="string">&quot;中学&quot;</span> -&gt; <span class="string">&quot;青少年&quot;</span></span><br><span class="line">    <span class="keyword">else</span> -&gt; &#123;</span><br><span class="line">        <span class="string">&quot;未知&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="String模版"><a href="#String模版" class="headerlink" title="String模版"></a>String模版</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> flag = <span class="literal">false</span></span><br><span class="line">println(<span class="string">&quot;Answer is : <span class="subst">$&#123;if (flag) <span class="string">&quot;我可以&quot;</span> else <span class="string">&quot;I can play&quot;</span>&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>



<h5 id="函数-函数参数"><a href="#函数-函数参数" class="headerlink" title="函数,函数参数"></a>函数,函数参数</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">printUser(<span class="string">&quot;Jon&quot;</span>)</span><br><span class="line">printUser(name = <span class="string">&quot;john&quot;</span>)</span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">printUser</span><span class="params">(name:<span class="type">String</span>,age:<span class="type">Int</span>=<span class="number">2</span>)</span></span>&#123;</span><br><span class="line">    println(name+age)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="Nothing类型"><a href="#Nothing类型" class="headerlink" title="Nothing类型"></a>Nothing类型</h5><p>终止代码运行</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TODO(<span class="string">&quot;nothing&quot;</span>)</span><br></pre></td></tr></table></figure>



<h5 id="反引号"><a href="#反引号" class="headerlink" title="反引号 ``"></a>反引号 ``</h5><p>可以用来测试 某一段代码</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> `**~ special function with  test util ~**`<span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>Kotlin和Java保留不同的关键字，使用反引号括住函数名能避免任何冲突</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">KeyWordJava</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">is</span><span class="params">()</span></span>&#123; <span class="comment">//is时关键字</span></span><br><span class="line">        System.out.println(<span class="string">&quot;is invoked&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KeyWordJava.`<span class="keyword">is</span>`()</span><br></pre></td></tr></table></figure>





<h3 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h3><p>匿名函数可以当作变量赋值给函数类型变量。函数的类型，由传入的参数和返回值类型决定。</p>
<p>和具名函数不一样，除极少情况外，匿名函数不需要return关键字，来返回数据，匿名函数会隐式或自动返回函数体最后一行语句的结果。</p>
<p>通过匿名函数给标准函数 制定规则</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> total  = <span class="string">&quot;Mississippi&quot;</span>.count()</span><br><span class="line"><span class="comment">//通过匿名函数给标准函数 制定规则</span></span><br><span class="line"><span class="keyword">val</span> totalS = <span class="string">&quot;Mississippi&quot;</span>.count(&#123;letter-&gt; <span class="comment">//letter变量</span></span><br><span class="line">    letter ==<span class="string">&#x27;s&#x27;</span><span class="comment">//函数体</span></span><br><span class="line">&#125;)</span><br><span class="line">println(total)</span><br><span class="line">println(totalS)</span><br></pre></td></tr></table></figure>





<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//变量的类型是一个匿名函数,一个函数类型的变量</span></span><br><span class="line"><span class="keyword">val</span> helloFunction:()-&gt;String <span class="comment">//任意函数 无传入参数，返回类型String ,都可以 =helloFunction</span></span><br><span class="line">helloFunction = &#123;</span><br><span class="line">    <span class="keyword">val</span> greet = <span class="string">&quot; how  is going. &quot;</span></span><br><span class="line">    <span class="string">&quot;hello girl , <span class="variable">$greet</span> &quot;</span>  <span class="comment">//默认返回这行语句的结果</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> helloFunction1:()-&gt;String = &#123;<span class="comment">//任意函数 无传入参数，返回类型String ,都可以 =helloFunction</span></span><br><span class="line">    <span class="keyword">val</span> greet = <span class="string">&quot; how is going. &quot;</span></span><br><span class="line">    <span class="keyword">val</span> hah = <span class="string">&quot;haha&quot;</span></span><br><span class="line">    <span class="string">&quot;hello beauty girl, <span class="variable">$greet</span> &quot;</span> <span class="comment">//默认返回这行语句的结果</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">println(helloFunction())</span><br><span class="line">println(helloFunction1())</span><br></pre></td></tr></table></figure>

<blockquote>
<p>hello girl ,  how  is going.<br>hello beauty girl,  how is going.  </p>
</blockquote>
<h5 id="匿名函数参数"><a href="#匿名函数参数" class="headerlink" title="匿名函数参数"></a>匿名函数参数</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> helloFunction2:(String)-&gt;String = &#123;name-&gt;   <span class="comment">// name传入参数,String参数类型</span></span><br><span class="line">    <span class="keyword">val</span> hah = <span class="string">&quot;haha&quot;</span></span><br><span class="line">    <span class="string">&quot;hello beauty girl, I am <span class="subst">$&#123;name&#125;</span> &quot;</span> <span class="comment">//默认返回这行语句的结果</span></span><br><span class="line">&#125;</span><br><span class="line">println(helloFunction2(<span class="string">&quot;Jon&quot;</span>))</span><br></pre></td></tr></table></figure>



<h5 id="it关键字"><a href="#it关键字" class="headerlink" title="it关键字"></a>it关键字</h5><p>定义只有一个参数的匿名函数时，可以用it来表示参数名。当需要传入两个值参，就不能用了。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> helloFunction3:(String)-&gt;String = &#123;   <span class="comment">// name传入参数,String参数类型, 只有一个参数name可以省略，用it替代</span></span><br><span class="line">    <span class="keyword">val</span> hah = <span class="string">&quot;haha&quot;</span></span><br><span class="line">    <span class="string">&quot;hello beauty girl, I am <span class="subst">$&#123;it&#125;</span> &quot;</span> <span class="comment">//默认返回这行语句的结果</span></span><br><span class="line">&#125;</span><br><span class="line">println(helloFunction3(<span class="string">&quot;John&quot;</span>))</span><br></pre></td></tr></table></figure>

<h5 id="类型推断-1"><a href="#类型推断-1" class="headerlink" title="类型推断"></a>类型推断</h5><p>定义一个变量时，如果已把匿名函数作为变量赋值给它, 就不需要显示指明变量类型了。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> helloFunction4 = &#123;</span><br><span class="line">    <span class="keyword">val</span> holiday = <span class="string">&quot;New Year&quot;</span></span><br><span class="line">    <span class="string">&quot;Happy <span class="variable">$holiday</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">println(helloFunction4())</span><br></pre></td></tr></table></figure>

<p>类型推断也支持带参数的匿名函数，但为了帮助编译器更准确的推断变量类型，匿名函数的参数名和参数类型必须有。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> helloFunction5:(String,<span class="built_in">Int</span>) -&gt; String = &#123;name,year -&gt;</span><br><span class="line">    <span class="keyword">val</span> holiday = <span class="string">&quot;New Year&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="variable">$name</span>  Happy <span class="variable">$holiday</span> <span class="variable">$year</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">println(helloFunction5(<span class="string">&quot;jon&quot;</span>,<span class="number">2023</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用类型推断</span></span><br><span class="line"><span class="keyword">val</span> helloFunction6  = &#123;name:String,year:<span class="built_in">Int</span> -&gt;</span><br><span class="line">    <span class="keyword">val</span> holiday = <span class="string">&quot;New Year&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="variable">$name</span>  Happy <span class="variable">$holiday</span> <span class="variable">$year</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">println(helloFunction6(<span class="string">&quot;jon&quot;</span>,<span class="number">2023</span>))</span><br></pre></td></tr></table></figure>



<p>匿名函数成为lambda,将它的定义成为lambda表达式，它返回的数据成为lambda结果。</p>
<p>lambda由来：在定义匿名函数时，使用了lambda演算记法。</p>
<h5 id="一个函数作为另一个函数的参数"><a href="#一个函数作为另一个函数的参数" class="headerlink" title="一个函数作为另一个函数的参数"></a>一个函数作为另一个函数的参数</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//定义参数是函数 的函数</span></span><br><span class="line">    <span class="keyword">val</span> disCountWord = &#123; goodsName: String, hour: <span class="built_in">Int</span> -&gt;</span><br><span class="line">        <span class="keyword">val</span> currentYear = <span class="number">2023</span>;</span><br><span class="line">        <span class="string">&quot;<span class="subst">$&#123;currentYear&#125;</span>年, 双11 <span class="subst">$&#123;goodsName&#125;</span>促销倒计时: <span class="variable">$hour</span> 小时&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    showOnBoard(<span class="string">&quot;小玩具&quot;</span>, disCountWord)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//getDiscountWord是第二个参数,类型时是(String, Int) -&gt; String 函数类型</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">showOnBoard</span><span class="params">(goodsName: <span class="type">String</span>, getDiscountWords: (<span class="type">String</span>, <span class="type">Int</span>) -&gt; <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> hour = (<span class="number">1.</span><span class="number">.24</span>).shuffled().last();</span><br><span class="line">    print(getDiscountWords(goodsName, hour))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="java实现传递函数"><a href="#java实现传递函数" class="headerlink" title="java实现传递函数"></a>java实现传递函数</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    showOnBoard(<span class="string">&quot;牙膏&quot;</span>,((goodsName, hour) -&gt; &#123;</span><br><span class="line">        <span class="keyword">int</span> currentYear = <span class="number">2023</span>;</span><br><span class="line">        <span class="keyword">return</span> String.format(<span class="string">&quot;%s年，双11 %s 促销倒计时 %d小时 &quot;</span>,currentYear,goodsName,hour);</span><br><span class="line">    &#125;));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DiscountWords</span></span>&#123;</span><br><span class="line">    <span class="function">String <span class="title">getDiscountWords</span><span class="params">(String goodsName,<span class="keyword">int</span> hour)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">showOnBoard</span><span class="params">(String goodsName,DiscountWords discountWords)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> hour  = <span class="keyword">new</span> Random().nextInt(<span class="number">24</span>);</span><br><span class="line">    System.out.println(discountWords.getDiscountWords(goodsName,hour));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h5 id="简略写法"><a href="#简略写法" class="headerlink" title="简略写法"></a>简略写法</h5><p>如果一个函数的lambda函数排在最后，或者是唯一的参数，那么括住的lambda值参的一对圆括号就可以省略.</p>
<p>唯一的参数</p>
<p>AnonymousFunc2.kt</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> totalS = <span class="string">&quot;Mississippi&quot;</span>.count(&#123;letter-&gt; <span class="comment">//letter变量</span></span><br><span class="line">    letter ==<span class="string">&#x27;s&#x27;</span><span class="comment">//函数体</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> totalS1 = <span class="string">&quot;Mississippi&quot;</span>.count&#123;letter-&gt; <span class="comment">//letter变量</span></span><br><span class="line">    letter ==<span class="string">&#x27;s&#x27;</span><span class="comment">//函数体</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>AnonymousFunc2.kt</p>
<p>排在最后,一对圆括号就可以省略</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">showOnBoard(<span class="string">&quot;小玩具&quot;</span>, &#123; goodsName: String, hour: <span class="built_in">Int</span> -&gt;</span><br><span class="line">    <span class="keyword">val</span> currentYear = <span class="number">2023</span>;</span><br><span class="line">    <span class="string">&quot;<span class="subst">$&#123;currentYear&#125;</span>年, 双11 <span class="subst">$&#123;goodsName&#125;</span>促销倒计时: <span class="variable">$hour</span> 小时&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">showOnBoard(<span class="string">&quot;小玩具&quot;</span>) &#123; goodsName: String, hour: <span class="built_in">Int</span> -&gt;</span><br><span class="line">    <span class="keyword">val</span> currentYear = <span class="number">2023</span>;</span><br><span class="line">    <span class="string">&quot;<span class="subst">$&#123;currentYear&#125;</span>年, 双11 <span class="subst">$&#123;goodsName&#125;</span>促销倒计时: <span class="variable">$hour</span> 小时&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>内联函数</p>
<p><img src="/2021/08/19/kotlin-elementary/2021-08-20_lambda_inline.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//定义参数是函数 的函数</span></span><br><span class="line">    <span class="keyword">val</span> disCountWord = (&#123; goodsName: String, hour: <span class="built_in">Int</span> -&gt;</span><br><span class="line">        <span class="keyword">val</span> currentYear = <span class="number">2023</span>;</span><br><span class="line">        <span class="string">&quot;<span class="subst">$&#123;currentYear&#125;</span>年, 双11 <span class="subst">$&#123;goodsName&#125;</span>促销倒计时: <span class="variable">$hour</span> 小时&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    showOnBoard(<span class="string">&quot;小玩具&quot;</span>, disCountWord)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//getDiscountWord是第二个参数,类型时是(String, Int) -&gt; String 函数类型</span></span><br><span class="line"> <span class="function"><span class="keyword">fun</span> <span class="title">showOnBoard</span><span class="params">(goodsName: <span class="type">String</span>, getDiscountWords: (<span class="type">String</span>, <span class="type">Int</span>) -&gt; <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> hour = (<span class="number">1.</span><span class="number">.24</span>).shuffled().last();</span><br><span class="line">    println(getDiscountWords(goodsName, hour))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">AnonymousFunc2Kt</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      Function2 disCountWord = (Function2)<span class="keyword">null</span>.INSTANCE;</span><br><span class="line">      showOnBoard(<span class="string">&quot;小玩具&quot;</span>, disCountWord);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// $FF: synthetic method</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] var0)</span> </span>&#123;</span><br><span class="line">      main();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">showOnBoard</span><span class="params">(<span class="meta">@NotNull</span> String goodsName, <span class="meta">@NotNull</span> Function2 getDiscountWords)</span> </span>&#123;</span><br><span class="line">      Intrinsics.checkNotNullParameter(goodsName, <span class="string">&quot;goodsName&quot;</span>);</span><br><span class="line">      Intrinsics.checkNotNullParameter(getDiscountWords, <span class="string">&quot;getDiscountWords&quot;</span>);</span><br><span class="line">      <span class="keyword">byte</span> var3 = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">int</span> hour = ((Number)CollectionsKt.last(CollectionsKt.shuffled((Iterable)(<span class="keyword">new</span> IntRange(var3, <span class="number">24</span>))))).intValue();</span><br><span class="line">      Object var5 = getDiscountWords.invoke(goodsName, hour);</span><br><span class="line">      <span class="keyword">boolean</span> var4 = <span class="keyword">false</span>;</span><br><span class="line">      System.out.println(var5);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>内联后，代码直接替换 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">AnonymousFunc2Kt</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      Function2 disCountWord = (Function2)<span class="keyword">null</span>.INSTANCE;</span><br><span class="line">      String goodsName$iv = <span class="string">&quot;小玩具&quot;</span>;</span><br><span class="line">      <span class="keyword">int</span> $i$f$showOnBoard = <span class="keyword">false</span>;  </span><br><span class="line">      <span class="keyword">byte</span> var3 = <span class="number">1</span>;	<span class="comment">//这里开始 后面代码直接复制过来了</span></span><br><span class="line">      <span class="keyword">int</span> hour$iv = ((Number)CollectionsKt.last(CollectionsKt.shuffled((Iterable)(<span class="keyword">new</span> IntRange(var3, <span class="number">24</span>))))).intValue();</span><br><span class="line">      Object var6 = disCountWord.invoke(goodsName$iv, hour$iv);</span><br><span class="line">      <span class="keyword">boolean</span> var5 = <span class="keyword">false</span>;</span><br><span class="line">      System.out.println(var6);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// $FF: synthetic method</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] var0)</span> </span>&#123;</span><br><span class="line">      main();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">showOnBoard</span><span class="params">(<span class="meta">@NotNull</span> String goodsName, <span class="meta">@NotNull</span> Function2 getDiscountWords)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">int</span> $i$f$showOnBoard = <span class="number">0</span>;</span><br><span class="line">      Intrinsics.checkNotNullParameter(goodsName, <span class="string">&quot;goodsName&quot;</span>);</span><br><span class="line">      Intrinsics.checkNotNullParameter(getDiscountWords, <span class="string">&quot;getDiscountWords&quot;</span>);</span><br><span class="line">      <span class="keyword">byte</span> var4 = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">int</span> hour = ((Number)CollectionsKt.last(CollectionsKt.shuffled((Iterable)(<span class="keyword">new</span> IntRange(var4, <span class="number">24</span>))))).intValue();</span><br><span class="line">      Object var6 = getDiscountWords.invoke(goodsName, hour);</span><br><span class="line">      <span class="keyword">boolean</span> var5 = <span class="keyword">false</span>;</span><br><span class="line">      System.out.println(var6);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="函数引用"><a href="#函数引用" class="headerlink" title="函数引用"></a>函数引用</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数引用</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    showOnBoard(<span class="string">&quot;小玩具&quot;</span>,::getDiscountWords)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//普通 具名函数</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getDiscountWords</span><span class="params">(goodsName: <span class="type">String</span>, hour: <span class="type">Int</span>)</span></span>: String &#123;</span><br><span class="line">    <span class="keyword">val</span> currentYear = <span class="number">2023</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;<span class="subst">$&#123;currentYear&#125;</span>年, 双11 <span class="subst">$&#123;goodsName&#125;</span>促销倒计时: <span class="variable">$hour</span> 小时&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//getDiscountWord是第二个参数,类型时是(String, Int) -&gt; String 函数类型</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">showOnBoard</span><span class="params">(goodsName: <span class="type">String</span>, getDiscountWords: (<span class="type">String</span>, <span class="type">Int</span>) -&gt; <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> hour = (<span class="number">1.</span><span class="number">.24</span>).shuffled().last();</span><br><span class="line">    println(getDiscountWords(goodsName, hour))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>函数类型作为返回类型</p>
<p>函数类型也是有效的返回类型，也就是说可以定义一个能返回函数的函数。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> getDiscountWords = configDiscountWords()</span><br><span class="line">    println(getDiscountWords(<span class="string">&quot;小玩具&quot;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">configDiscountWords</span><span class="params">()</span></span>: (String) -&gt; String &#123;<span class="comment">//返回一个传入字符串 返回类型也是函数的字符串,的返回类型</span></span><br><span class="line">    <span class="keyword">val</span> currentYear = <span class="number">2023</span>;</span><br><span class="line">    <span class="keyword">val</span> hour = (<span class="number">1.</span><span class="number">.24</span>).shuffled().last();</span><br><span class="line">    <span class="keyword">return</span> &#123; goodsName: String -&gt;</span><br><span class="line">        <span class="string">&quot;<span class="subst">$&#123;currentYear&#125;</span>年, 双11 <span class="subst">$&#123;goodsName&#125;</span>促销倒计时: <span class="variable">$hour</span> 小时&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h5><p>作用: 控制作用域</p>
<p>匿名函数引用着定义自身函数里的变量</p>
<p>kotlin中的lambda就是闭包,上面</p>
<ol>
<li>currentYear,hour    在configDiscountWords()中定义</li>
<li>{ goodsName: String -&gt;  “${currentYear}年, 双11 ${goodsName}促销倒计时: $hour 小时}  也在configDiscountWords()定义</li>
<li> 2 引用了currentYear,hour变量. 所以形成闭包</li>
</ol>
<img src="/2021/08/19/kotlin-elementary/Users/m/Documents/noteforme.github.io/source/_posts/kotlin-elementary/2021-08-20_Closure.png" style="zoom:66%;">

<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1wf4y1s7TG?p=34&amp;spm_id_from=pageDriver">https://www.bilibili.com/video/BV1wf4y1s7TG?p=34&amp;spm_id_from=pageDriver</a></p>
<h3 id="Null"><a href="#Null" class="headerlink" title="Null"></a>Null</h3><p>编译时出错的方式，提前在编译期强迫开发者重视起来，而不是等到运行时报错。</p>
<h5 id=""><a href="#" class="headerlink" title="?"></a>?</h5><p>变量为null，不会执行后面的方法</p>
<p>let匿名函数，返回lambda最后一行</p>
<p>可以支持函数链式调用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">var</span> str:String? = <span class="string">&quot;butterfly&quot;</span></span><br><span class="line"><span class="comment">//    var str=&quot;&quot;</span></span><br><span class="line">    str = str?.let &#123;</span><br><span class="line">        <span class="keyword">if</span> (it.isNotBlank())&#123;</span><br><span class="line">            it.capitalize()</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="string">&quot;butterfly&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    println(str)</span><br></pre></td></tr></table></figure>



<h5 id="-1"><a href="#-1" class="headerlink" title="!!"></a>!!</h5><p>当变量为null,会抛出KotlinNullPointerException</p>
<h5 id="空合并操作符"><a href="#空合并操作符" class="headerlink" title="空合并操作符  ?:"></a>空合并操作符  ?:</h5><p>类似三目运算符</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">str=<span class="literal">null</span></span><br><span class="line">str=<span class="string">&quot;guy&quot;</span></span><br><span class="line">str = str?.let &#123; it.capitalize()&#125; ?:<span class="string">&quot;butterfly&quot;</span>	<span class="comment">//和let一起使用</span></span><br><span class="line">println(str ?: <span class="string">&quot;girl&quot;</span>) <span class="comment">// str=null,就是girl,不为null就是自己</span></span><br></pre></td></tr></table></figure>





<h5 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h5><p>执行之前，先进行检查，可以自定义异常</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> number: <span class="built_in">Int</span>? = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        checkOperation(number)</span><br><span class="line">        number!!.plus(<span class="number">1</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">        println(e)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">checkOperation</span><span class="params">(number: <span class="type">Int</span>?)</span></span> &#123;</span><br><span class="line">    number ?: <span class="keyword">throw</span>  UnskilledException()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//自定义异常</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UnskilledException</span> : <span class="type">IllegalArgumentException</span></span>(<span class="string">&quot;操作不当&quot;</span>)</span><br></pre></td></tr></table></figure>



<h5 id="先决条件函数"><a href="#先决条件函数" class="headerlink" title="先决条件函数"></a>先决条件函数</h5><p>kotlin标准库 提供了一些便利函数，使用这些内置函数，可以跑出带自定义信息的异常，这些便利函数叫做先决条件函数。也可以用它定义先决条件，条件必须满足，目标代码才能执行。</p>
<img src="/2021/08/19/kotlin-elementary/2021-08-21_kotlin_suggest.png" style="zoom:50%;">

<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">checkOperation</span><span class="params">(number: <span class="type">Int</span>?)</span></span> &#123;</span><br><span class="line"><span class="comment">//    number ?: throw  UnskilledException()</span></span><br><span class="line">    checkNotNull(number,&#123;<span class="string">&quot;Something is no good.&quot;</span>&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><p>String.kt</p>
<h5 id="substring"><a href="#substring" class="headerlink" title="substring"></a>substring</h5><p>substring支持IntRange类型的参数，until创建的范围不包括上限值。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">val</span> NAME =<span class="string">&quot;Jimmy&#x27;s friend&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> index = NAME.indexOf(<span class="string">&#x27;\&#x27;&#x27;</span>) <span class="comment">// \转义 &#x27;</span></span><br><span class="line">    NAME.substring(<span class="number">0</span>,index) <span class="comment">// java写法</span></span><br><span class="line">    <span class="keyword">val</span> str = NAME.substring(<span class="number">0</span> until index)</span><br><span class="line">    println(str)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="spilt"><a href="#spilt" class="headerlink" title="spilt"></a>spilt</h5><p>siilt返回的是List集合数据，List集合又支持解构语法特性，它允许你在一个表达式里给多个变量赋值，解构常用来简化变量的赋值。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> <span class="keyword">data</span> = NAMES.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> (girl1,girl2,girl3,girl4) = NAMES.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">println(<span class="string">&quot;<span class="variable">$girl1</span>  <span class="variable">$girl2</span>  <span class="variable">$girl3</span>  <span class="variable">$girl4</span> &quot;</span>)</span><br></pre></td></tr></table></figure>



<h5 id="replcae"><a href="#replcae" class="headerlink" title="replcae"></a>replcae</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 加密替换一个字符串</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">val</span> str1  = <span class="string">&quot;The people&#x27;s Republic of China.&quot;</span></span><br><span class="line">    <span class="comment">//第一个参数是正则表达式，用来决定要替换哪些字符</span></span><br><span class="line">    <span class="comment">//第二个参数是匿名函数，用来确定如何替换正则表达式搜索到的字符</span></span><br><span class="line"><span class="keyword">val</span> str2 = str1.replace(Regex(<span class="string">&quot;[aeiou]&quot;</span>)) &#123;</span><br><span class="line">    <span class="keyword">when</span> (it.value) &#123;</span><br><span class="line">        <span class="string">&quot;a&quot;</span> -&gt; <span class="string">&quot;8&quot;</span></span><br><span class="line">        <span class="string">&quot;e&quot;</span> -&gt; <span class="string">&quot;6&quot;</span></span><br><span class="line">        <span class="string">&quot;i&quot;</span> -&gt; <span class="string">&quot;9&quot;</span></span><br><span class="line">        <span class="string">&quot;o&quot;</span> -&gt; <span class="string">&quot;1&quot;</span></span><br><span class="line">        <span class="string">&quot;u&quot;</span> -&gt; <span class="string">&quot;3&quot;</span></span><br><span class="line">        <span class="keyword">else</span> -&gt; it.value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">println(str1)</span><br><span class="line">println(str2)</span><br></pre></td></tr></table></figure>

<p>结果</p>
<blockquote>
<p>The people’s Republic of China.<br>Th6 p61pl6’s R6p3bl9c 1f Ch9n8.</p>
</blockquote>
<h5 id="字符串的比较"><a href="#字符串的比较" class="headerlink" title="字符串的比较"></a>字符串的比较</h5><p>用 == 检查两个字符串中的字符是否匹配， 用 === 检查两个变量是否指向内存堆上的同一对象， 而在Java中 ==做引用比较，做结构比较时用equals方法.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> str3 = <span class="string">&quot;Jason&quot;</span></span><br><span class="line"><span class="keyword">val</span> str4 = <span class="string">&quot;Jason&quot;</span></span><br><span class="line">println(str3==str4)</span><br><span class="line">println(str3===str4) <span class="comment">//相同字符串的字符串，使用字符串常量池中相同的对象</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> str5 = <span class="string">&quot;jason&quot;</span>.capitalize() <span class="comment">//这种情况会创建新的对象，why?</span></span><br><span class="line">println(str3===str5)</span><br></pre></td></tr></table></figure>

<p>结果</p>
<blockquote>
<p>true<br>true<br>false</p>
</blockquote>
<h5 id="字符串遍历"><a href="#字符串遍历" class="headerlink" title="字符串遍历"></a>字符串遍历</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">str1.forEach &#123;</span><br><span class="line">    print(<span class="string">&quot;<span class="variable">$it</span> &quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="数字类型"><a href="#数字类型" class="headerlink" title="数字类型"></a>数字类型</h3><p>kotlin所有的数字类型都是有符号的，也就是既可以表示正数，也可以表示负数。</p>
<p><img src="/2021/08/19/kotlin-elementary/2021-08-21_data_type.png"></p>
<h5 id="安全转换函数"><a href="#安全转换函数" class="headerlink" title="安全转换函数"></a>安全转换函数</h5><p>NumberConvert</p>
<p>toDoubleOrNull和toIntOrNull这样的安全转换函数，如果数值不能正确转换，与其触发异常不如干脆返回null值。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//    val number1 = &quot;6.66&quot;.toInt()</span></span><br><span class="line">    <span class="keyword">val</span> number1:<span class="built_in">Int</span>? = <span class="string">&quot;6.66&quot;</span>.toIntOrNull()</span><br><span class="line">    println(number1)</span><br><span class="line"></span><br><span class="line">    println(<span class="number">8.956765</span>.toInt())</span><br><span class="line">    println(<span class="number">8.956765</span>.roundToInt()) <span class="comment">//四舍五入</span></span><br><span class="line">    <span class="keyword">val</span> s = <span class="string">&quot;%.2f&quot;</span>.format(<span class="number">8.956765</span>)</span><br><span class="line">    println(s)</span><br></pre></td></tr></table></figure>

<p>结果</p>
<blockquote>
<p>null<br>8<br>9<br>8.96</p>
</blockquote>
<h3 id="标准库函数"><a href="#标准库函数" class="headerlink" title="标准库函数"></a>标准库函数</h3><p>StandLibFunc.kt</p>
<h5 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h5><p>apply函数可看作一个配置函数，传入一个接收者，然后调用一系列的函数来配置它以便使用，如果提供lambda给apply函数执行，它会返回配置好的接收者。</p>
<p>配置file对象，传入file对象配置它，配置完file对象返回.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置一个File实例</span></span><br><span class="line"><span class="keyword">val</span> file = File(<span class="string">&quot;E// I have a dream.txt&quot;</span>)</span><br><span class="line">file.setReadable(<span class="literal">true</span>)</span><br><span class="line">file.setWritable(<span class="literal">true</span>)</span><br><span class="line">file.setExecutable(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用apply</span></span><br><span class="line"><span class="keyword">val</span> file1 = File(<span class="string">&quot;E// I have a dream.txt&quot;</span>).apply &#123;</span><br><span class="line">    setReadable(<span class="literal">true</span>)</span><br><span class="line">    setWritable(<span class="literal">true</span>)</span><br><span class="line">    setExecutable(<span class="literal">false</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Lambda表达式里，apply能让每个配置函数都作用于接收者，这种行为又叫相关作用于，因为lambda表达式里的所有函数调用都是针对接收者的，或者说他们是针对接收者的隐式调用。</p>
<h5 id="let"><a href="#let" class="headerlink" title="let"></a>let</h5><p>let函数能是某个便利作用于lambda表达式里，让it关键字能引用它。let与apply比较，let会把接收者传给lambda，而apply什么都不传，匿名函数执行完，apply会发挥当前接收者，而let会返回lambda的最后一行。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">var</span> result = listOf(<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>).first().let &#123; it * it &#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//    val firstElement = listOf(3, 2, 1).first() //java 方式 </span></span><br><span class="line"><span class="comment">//    val result = firstElement * firstElement</span></span><br><span class="line"></span><br><span class="line">    println(formatGreeting(<span class="literal">null</span>))</span><br><span class="line">    println(formatGreeting(<span class="string">&quot;Jack&quot;</span>))</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">formatGreeting</span><span class="params">(guestNmae: <span class="type">String</span>?)</span></span>: String &#123;</span><br><span class="line">    <span class="keyword">return</span> guestNmae?.let &#123;</span><br><span class="line">        <span class="string">&quot;Welcom, <span class="variable">$it</span>&quot;</span></span><br><span class="line">    &#125; ?: <span class="string">&quot;What&#x27;s your name&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Java方式</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">formatGreeting2</span><span class="params">(guestNmae: <span class="type">String</span>?)</span></span>: String &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">if</span> (guestNmae != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="string">&quot;Welcom, <span class="variable">$guestNmae</span>&quot;</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="string">&quot;What&#x27;s your name&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="run"><a href="#run" class="headerlink" title="run"></a>run</h5><ol>
<li>光看作用域行为， run和apply差不多，但与apply不同，run函数不返回接收者，run返回的是lambda结果.</li>
<li>run也能用来执行函数引用å</li>
</ol>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> file = File(<span class="string">&quot;THINKKOTLIN/I have a dream.txt&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> result = file.run &#123;</span><br><span class="line">    readText().contains(<span class="string">&quot;great&quot;</span>) <span class="comment">//最后一行执行结果返回</span></span><br><span class="line">    <span class="string">&quot;xxx&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">println(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> result2 = <span class="string">&quot;The people&#x27;s Republic of china.&quot;</span>.run(::isLong)</span><br><span class="line">println(result2)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;The people&#x27;s Republic of china.&quot;</span></span><br><span class="line">        .run(::isLong)</span><br><span class="line">        .run(::showMessage)</span><br><span class="line">        .run(::println)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">isLong</span><span class="params">(name: <span class="type">String</span>)</span></span> = name.length&gt;<span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">showMessage</span><span class="params">(isLong: <span class="type">Boolean</span>)</span></span>: String &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">if</span>(isLong)&#123;</span><br><span class="line">        <span class="string">&quot;Name is too long.&quot;</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="string">&quot;Please rename.&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="with"><a href="#with" class="headerlink" title="with"></a>with</h5><p>with函数是run的变体，他们的功能行为是一样的，但with的调用方式不同，调用with时需要值参作为其第一个参数传入。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> result3 = <span class="string">&quot;The people&#x27;s Republic of china.&quot;</span>.run &#123; length &gt; <span class="number">10</span> &#125;</span><br><span class="line"><span class="keyword">val</span> result4 = with(<span class="string">&quot;The people&#x27;s Republic of china.&quot;</span>) &#123; length &gt;= <span class="number">10</span> &#125;</span><br></pre></td></tr></table></figure>



<h5 id="also"><a href="#also" class="headerlink" title="also"></a>also</h5><p>​    also和let类似，和let一样，also也是把接收者作为值参传给lambda,但是有点不同: also返回接收者对象，而let返回lambda结果。因此also适合针对<strong>同一原始对象</strong>，利用副作用做事，肌肉also返回的是接收者对象，就可以<strong>基于原始接收者对象执行额外的链式调用</strong>。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fileContents: List&lt;String&gt;</span><br><span class="line">File(FILE_DREAM)</span><br><span class="line">        .also &#123;</span><br><span class="line">            println(it.name)</span><br><span class="line">        &#125;.also &#123;</span><br><span class="line">            fileContents = it.readLines()</span><br><span class="line">        &#125;</span><br><span class="line">println(fileContents)</span><br></pre></td></tr></table></figure>



<h5 id="takeif"><a href="#takeif" class="headerlink" title="takeif"></a>takeif</h5><p><img src="/2021/08/19/kotlin-elementary/2021-08-21_takeif.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//如果 it.exists() &amp;&amp; it.canRead() 返回true,返回file对象，接着执行后面语句。</span></span><br><span class="line"><span class="comment">// 如果为false，就返回null,就不会执行后面的语句。</span></span><br><span class="line"><span class="keyword">val</span> readText = File(FILE_DREAM)</span><br><span class="line">        .takeIf &#123; it.exists() &amp;&amp; it.canRead() &#125; </span><br><span class="line">        ?.readText()</span><br><span class="line">println(readText)</span><br></pre></td></tr></table></figure>



<h5 id="takeUnless"><a href="#takeUnless" class="headerlink" title="takeUnless"></a>takeUnless</h5><p>和takeif是反的</p>
<p>takeUnless, 只有判断你给定的条件结果是 false 时，takeUnless才会返回原始接收者对象。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> result5 = File(FILE_DREAM)</span><br><span class="line">        .takeUnless &#123; it.isHidden &#125; <span class="comment">//不是 不可见的，所以是false</span></span><br><span class="line">        ?.readText()</span><br><span class="line">println(result5)</span><br></pre></td></tr></table></figure>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/index.html">http://noteforme.github.io.com/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-kmp" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/06/17/kmp/">kmp</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2021-06-17T14:44:42.000Z" itemprop="datePublished">2021年06月17日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/DataStructure/">DataStructure</a>
  </div>

      
      
<a href="/2021/06/17/kmp/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="蛮力算法"><a href="#蛮力算法" class="headerlink" title="蛮力算法"></a>蛮力算法</h4><ol>
<li><p>i++  j++</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/******************************************************************************************</span></span><br><span class="line"><span class="comment"> * Text     :  0   1   2   .   .   .   i-j .   .   .   .   i   .   .   n-1</span></span><br><span class="line"><span class="comment"> *             ------------------------|-------------------|------------</span></span><br><span class="line"><span class="comment"> * Pattern  :                          0   .   .   .   .   j   .   .</span></span><br><span class="line"><span class="comment"> *                                     |-------------------|</span></span><br><span class="line"><span class="comment"> ******************************************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">match</span> <span class="params">( <span class="keyword">char</span>* P, <span class="keyword">char</span>* T )</span> </span>&#123; <span class="comment">//串匹配算法（Brute-force-1）</span></span><br><span class="line">   <span class="keyword">size_t</span> n = <span class="built_in">strlen</span> ( T ), i = <span class="number">0</span>; <span class="comment">//文本串长度、当前接受比对字符的位置</span></span><br><span class="line">   <span class="keyword">size_t</span> m = <span class="built_in">strlen</span> ( P ), j = <span class="number">0</span>; <span class="comment">//模式串长度、当前接受比对字符的位置</span></span><br><span class="line">   <span class="keyword">while</span> ( j &lt; m &amp;&amp; i &lt; n ) <span class="comment">//自左向右逐个比对字符</span></span><br><span class="line">      <span class="comment">/*DSA*/</span>&#123;</span><br><span class="line"><span class="comment">//      /*DSA*/showProgress ( T, P, i - j, j );   getchar();</span></span><br><span class="line">      <span class="keyword">if</span> ( T[i] == P[j] ) <span class="comment">//若匹配</span></span><br><span class="line">         &#123; i ++;  j++; &#125; <span class="comment">//则转到下一对字符</span></span><br><span class="line">      <span class="keyword">else</span> <span class="comment">//否则</span></span><br><span class="line">         &#123; i -= (j - <span class="number">1</span>); j = <span class="number">0</span>; &#125; <span class="comment">//文本串回退、模式串复位   // i j 都在往右走， i -= (j - 1) 相当于i在初始位置 又往右走了一步</span></span><br><span class="line">      <span class="comment">/*DSA*/</span>&#125;</span><br><span class="line">   <span class="keyword">return</span> i - j; <span class="comment">//如何通过返回值，判断匹配结果？</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>i , j++</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/******************************************************************************************</span></span><br><span class="line"><span class="comment"> * Text     :  0   1   2   .   .   .   i   i+1 .   .   .   i+j .   .   n-1</span></span><br><span class="line"><span class="comment"> *             ------------------------|-------------------|------------</span></span><br><span class="line"><span class="comment"> * Pattern  :                          0   1   .   .   .   j   .   .</span></span><br><span class="line"><span class="comment"> *                                     |-------------------|</span></span><br><span class="line"><span class="comment"> ******************************************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">match</span> <span class="params">( <span class="keyword">char</span>* P, <span class="keyword">char</span>* T )</span> </span>&#123; <span class="comment">//串匹配算法（Brute-force-2）</span></span><br><span class="line">   <span class="keyword">size_t</span> n = <span class="built_in">strlen</span> ( T ), i = <span class="number">0</span>; <span class="comment">//文本串长度、与模式串首字符的对齐位置</span></span><br><span class="line">   <span class="keyword">size_t</span> m = <span class="built_in">strlen</span> ( P ), j; <span class="comment">//模式串长度、当前接受比对字符的位置</span></span><br><span class="line">   <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; n - m + <span class="number">1</span>; i++ ) &#123; <span class="comment">//文本串从第i个字符起，与</span></span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; m; j++ ) <span class="comment">//模式串中对应的字符逐个比对</span></span><br><span class="line">         <span class="comment">/*DSA*/</span>&#123;<span class="built_in">showProgress</span> ( T, P, i, j ); <span class="built_in">getchar</span>();</span><br><span class="line">         <span class="keyword">if</span> ( T[i + j] != P[j] ) <span class="keyword">break</span>; <span class="comment">//若失配，模式串整体右移一个字符，再做一轮比对</span></span><br><span class="line">         <span class="comment">/*DSA*/</span>&#125;</span><br><span class="line">      <span class="keyword">if</span> ( j &gt;= m ) <span class="keyword">break</span>; <span class="comment">//找到匹配子串</span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> i; <span class="comment">//如何通过返回值，判断匹配结果？</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="KMP算法"><a href="#KMP算法" class="headerlink" title="KMP算法"></a>KMP算法</h4><p><img src="/2021/06/17/kmp/1kmp/2021-06-17_21-27-43_kmp.png"></p>
<p>算法主体</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">match</span> <span class="params">( <span class="keyword">char</span>* P, <span class="keyword">char</span>* T )</span> </span>&#123;  <span class="comment">//KMP算法</span></span><br><span class="line">   <span class="keyword">int</span>* next = <span class="built_in">buildNext</span> ( P ); <span class="comment">//构造next表</span></span><br><span class="line">   <span class="keyword">int</span> n = ( <span class="keyword">int</span> ) <span class="built_in">strlen</span> ( T ), i = <span class="number">0</span>; <span class="comment">//文本串指针</span></span><br><span class="line">   <span class="keyword">int</span> m = ( <span class="keyword">int</span> ) <span class="built_in">strlen</span> ( P ), j = <span class="number">0</span>; <span class="comment">//模式串指针</span></span><br><span class="line">   <span class="keyword">while</span> ( j &lt; m  &amp;&amp; i &lt; n ) <span class="comment">//自左向右逐个比对字符</span></span><br><span class="line">      <span class="comment">/*DSA*/</span>&#123;</span><br><span class="line">      <span class="comment">/*DSA*/</span><span class="built_in">showProgress</span> ( T, P, i - j, j );</span><br><span class="line">      <span class="comment">/*DSA*/</span><span class="built_in">printNext</span> ( next, i - j, <span class="built_in">strlen</span> ( P ) );</span><br><span class="line">      <span class="comment">/*DSA*/</span><span class="built_in">getchar</span>(); <span class="built_in">printf</span> ( <span class="string">&quot;\n&quot;</span> );</span><br><span class="line">      <span class="keyword">if</span> ( <span class="number">0</span> &gt; j || T[i] == P[j] ) <span class="comment">//若匹配，或P已移出最左侧（两个判断的次序不可交换）</span></span><br><span class="line">         &#123; i ++;  j ++; &#125; <span class="comment">//则转到下一字符</span></span><br><span class="line">      <span class="keyword">else</span> <span class="comment">//否则</span></span><br><span class="line">         j = next[j]; <span class="comment">//模式串右移（注意：文本串不用回退）</span></span><br><span class="line">      <span class="comment">/*DSA*/</span>&#125;</span><br><span class="line">   <span class="keyword">delete</span> [] next; <span class="comment">//释放next表</span></span><br><span class="line">   <span class="keyword">return</span> i - j;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>构建next表</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span>* <span class="title">buildNext</span> <span class="params">( <span class="keyword">char</span>* P )</span> </span>&#123; <span class="comment">//构造模式串P的next表</span></span><br><span class="line">   <span class="keyword">size_t</span> m = <span class="built_in">strlen</span> ( P ), j = <span class="number">0</span>; <span class="comment">//“主”串指针</span></span><br><span class="line">   <span class="keyword">int</span>* N = <span class="keyword">new</span> <span class="keyword">int</span>[m]; <span class="comment">//next表</span></span><br><span class="line">   <span class="keyword">int</span> t = N[<span class="number">0</span>] = <span class="number">-1</span>; <span class="comment">//模式串指针</span></span><br><span class="line">   <span class="keyword">while</span> ( j &lt; m - <span class="number">1</span> )</span><br><span class="line">      <span class="keyword">if</span> ( <span class="number">0</span> &gt; t || P[j] == P[t] ) &#123; <span class="comment">//匹配</span></span><br><span class="line">         j ++; t ++;</span><br><span class="line">         N[j] = t; <span class="comment">//此句可改进...</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="comment">//失配</span></span><br><span class="line">         t = N[t];</span><br><span class="line">   <span class="comment">/*DSA*/</span><span class="built_in">printString</span> ( P ); <span class="built_in">printf</span> ( <span class="string">&quot;\n&quot;</span> );</span><br><span class="line">   <span class="comment">/*DSA*/</span><span class="built_in">printNext</span> ( N, <span class="number">0</span>, m );</span><br><span class="line">   <span class="keyword">return</span> N;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/av3246487/">https://www.bilibili.com/video/av3246487/</a></p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/index.html">http://noteforme.github.io.com/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Assembly" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/05/21/Assembly/">Assembly</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2021-05-21T03:13:41.000Z" itemprop="datePublished">2021年05月21日</time>
</span>
      
      
      
<a href="/2021/05/21/Assembly/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="8086-14个寄存器"><a href="#8086-14个寄存器" class="headerlink" title="8086 14个寄存器"></a>8086 14个寄存器</h4><p>AX , BX , CX , DX , SI , DI , SP , BP, IP , CS , SS, DS ,ES ,PSW</p>
<p>实验环境搭建</p>
<p><a target="_blank" rel="noopener" href="https://github.com/froginwell/assembly">https://github.com/froginwell/assembly</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/s/video/BV1254y1B75r">https://www.bilibili.com/s/video/BV1254y1B75r</a></p>
<p><img src="/2021/05/21/Assembly/2021-05-20_19-06-09.png"></p>
<p>CS:IP  他们指示了CPU当前要读取指令的地址。</p>
<p>CS为代码段地址</p>
<p>IP 指令指针寄存器</p>
<p>jmp ax ,含义上类似 ： mov IP , ax</p>
<p><img src="/2021/05/21/Assembly/2021-05-21_17-22-59.png"></p>
<h4 id="第三章"><a href="#第三章" class="headerlink" title="第三章"></a>第三章</h4><h5 id="DS和address"><a href="#DS和address" class="headerlink" title="DS和address"></a>DS和address</h5><p>debug中，内存单元从左到右是地址从低到高顺序排列的。</p>
<p>8086CPU自动取ds中的数据为内存单元的段地址</p>
<h5 id="move-add-sub"><a href="#move-add-sub" class="headerlink" title="move , add , sub"></a>move , add , sub</h5><p><img src="/2021/05/21/Assembly/2021-05-21_19-21-51.png"></p>
<p>[0] ， 0表示内存单元的偏移地址</p>
<p>SS:SP 指向栈顶元素，栈顶的段地址存放在栈顶，偏移地址存放在SP中。</p>
<p><img src="/2021/05/21/Assembly/2021-05-22_16-18-16.png" alt="t"></p>
<h5 id="Loop"><a href="#Loop" class="headerlink" title="Loop"></a>Loop</h5><p>5.3 在Debug中跟踪用loop指令实现的循环程序 </p>
<p><img src="/2021/05/21/Assembly/2021-05-23_17-48-42.png"></p>
<p>​             </p>
<h4 id="实验四"><a href="#实验四" class="headerlink" title="实验四"></a>实验四</h4><p>  向内存0:200H<del>0:23fH依次传送数据0</del>63（3FH）</p>
<p>  内存0:200H~0:23fH空间与0020:0-0020:3f内存空间是一样的   (0:200  0020:0物理地址相同)                                                                                                                             </p>
<p><img src="/2021/05/21/Assembly/2021-05-24_14-59-10.png"></p>
<p>答案 </p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Base-Of-Practice/category/1005745.html">https://www.cnblogs.com/Base-Of-Practice/category/1005745.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blackdragonf.github.io/2017/03/09/%E7%8E%8B%E7%88%BD%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E7%AC%AC%E4%B8%89%E7%89%88%E5%AE%9E%E9%AA%8C/">https://blackdragonf.github.io/2017/03/09/%E7%8E%8B%E7%88%BD%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E7%AC%AC%E4%B8%89%E7%89%88%E5%AE%9E%E9%AA%8C/</a></p>
<p> 视频 小甲鱼</p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/index.html">http://noteforme.github.io.com/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Assembly/" rel="tag">Assembly</a></li></ul>

          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Data-LinkedList" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/04/19/Data-LinkedList/">Data_LinkedList</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2021-04-19T13:49:19.000Z" itemprop="datePublished">2021年04月19日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/DataStructure/">DataStructure</a>
  </div>

      
      
<a href="/2021/04/19/Data-LinkedList/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="链表"><a href="#链表" class="headerlink" title="链表"></a>链表</h4><ul>
<li><p>首节点 </p>
<p> 第一个有效节点</p>
</li>
<li><p>尾节点</p>
<p> 最后一个有效节点</p>
</li>
<li><p>头节点</p>
<p>头节点的数据类型和首节点类型一样</p>
<p>第一个有效节点之前的那个节点，只存放了 首节点 的地址</p>
<p>头节点并不存在有效数据</p>
<p>加头节点的目的主要是为了方便对链表的操作</p>
</li>
<li><p>头指针</p>
</li>
</ul>
<p>​        指向头节点的指针变量</p>
<p>​        只占用4个byte,比头节点占用空间小.</p>
<ul>
<li><p>尾指针</p>
<p>指向尾节点的指针变量</p>
</li>
</ul>
<h4 id="栈"><a href="#栈" class="headerlink" title="栈"></a>栈</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;printf.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">pNext</span>;</span></span><br><span class="line">&#125; NODE, *PNODE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Stack</span> &#123;</span></span><br><span class="line">    PNODE pTop;</span><br><span class="line">    PNODE pBottom;</span><br><span class="line">&#125; STACK, *PSTACK; <span class="comment">//PSTACK等价于 stuct STACK *</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(PSTACK)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(STACK *pStack, <span class="keyword">int</span> i)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">traverse</span><span class="params">(STACK *pStack)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">pop</span><span class="params">(PSTACK pS, <span class="keyword">int</span> *pVal)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span>  <span class="title">clear</span><span class="params">(PSTACK ps)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">empty</span><span class="params">(PSTACK pStack)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    STACK S; <span class="comment">//等价于 struct Stack</span></span><br><span class="line">    init(&amp;S);</span><br><span class="line">    push(&amp;S, <span class="number">1</span>);</span><br><span class="line">    push(&amp;S, <span class="number">22</span>);</span><br><span class="line">    push(&amp;S, <span class="number">88</span>);</span><br><span class="line"></span><br><span class="line">    traverse(&amp;S);</span><br><span class="line">    <span class="keyword">int</span> val;</span><br><span class="line"><span class="comment">//    if (pop(&amp;S, &amp;val)) &#123;</span></span><br><span class="line"><span class="comment">//        printf(&quot;出栈成功\n&quot;);</span></span><br><span class="line"><span class="comment">//        printf(&quot;出栈的数据 %d \n&quot;, val);</span></span><br><span class="line"><span class="comment">//    &#125; else &#123;</span></span><br><span class="line"><span class="comment">//        printf(&quot;出栈失败\n&quot;);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line">    clear(&amp;S);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;清空数据\n&quot;</span>);</span><br><span class="line">    traverse(&amp;S);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(STACK *pStack, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    PNODE pNew = (PNODE) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(NODE));</span><br><span class="line">    pNew-&gt;data = val;</span><br><span class="line">    pNew-&gt;pNext = pStack-&gt;pTop; <span class="comment">//如果是空可以用pBottom，但是后面不为空</span></span><br><span class="line">    pStack-&gt;pTop = pNew;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(PSTACK pS)</span> </span>&#123;</span><br><span class="line">    pS-&gt;pTop = (PNODE) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(NODE));</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == pS-&gt;pTop) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;动态内存分配失败!\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        pS-&gt;pBottom = pS-&gt;pTop;</span><br><span class="line">        pS-&gt;pTop-&gt;pNext = <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">traverse</span><span class="params">(PSTACK pS)</span> </span>&#123;</span><br><span class="line">    PNODE p = pS-&gt;pTop;</span><br><span class="line">    <span class="keyword">while</span> (p != pS-&gt;pBottom) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, p-&gt;data);</span><br><span class="line">        p = p-&gt;pNext;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//把pS所指向的栈出栈一次，并把出栈的元素存入pVal形参所指向的变量中，如果出栈失败，返回false,否则返回true,</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">pop</span><span class="params">(PSTACK pS, <span class="keyword">int</span> *pVal)</span> </span>&#123;</span><br><span class="line">    *pVal = pS-&gt;pTop-&gt;data;</span><br><span class="line">    PNODE p = pS-&gt;pTop;</span><br><span class="line">    <span class="keyword">if</span> (pS-&gt;pTop != pS-&gt;pBottom) &#123; <span class="comment">//或者写个方法 isEmpty()</span></span><br><span class="line">        pS-&gt;pTop = pS-&gt;pTop-&gt;pNext;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(p);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//清空</span></span><br><span class="line"><span class="function"><span class="keyword">void</span>  <span class="title">clear</span><span class="params">(PSTACK pS)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(empty(pS))&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">        PNODE  p = pS-&gt;pTop;</span><br><span class="line">        PNODE  q = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">while</span>(p!=pS-&gt;pBottom)&#123;</span><br><span class="line">             q = p-&gt;pNext;</span><br><span class="line">             <span class="built_in">free</span>(p);</span><br><span class="line">             p = q;</span><br><span class="line">        &#125;</span><br><span class="line">        pS-&gt;pTop = pS-&gt;pBottom;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">empty</span><span class="params">(PSTACK pS)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(pS-&gt;pTop==pS-&gt;pBottom)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>应用 </p>
<p>函数调用     中断    表达式求值    内存分配  缓冲处理    迷宫</p>
<p><img src="/2021/04/19/Data-LinkedList/2021-04-22_11-50-30stack.png"></p>
<h4 id="链表队列"><a href="#链表队列" class="headerlink" title="链表队列"></a>链表队列</h4><p>队列 ： 一种可以实现先进先出的存储结构</p>
<p><img src="/2021/04/19/Data-LinkedList/2021-04-22_12-50-46queue.png"></p>
<h4 id="队列"><a href="#队列" class="headerlink" title="队列"></a>队列</h4><p>链式队列 – 用链表实现。</p>
<p>静态队列 – 用数组实现。</p>
<h5 id="循环队列（数组）"><a href="#循环队列（数组）" class="headerlink" title="循环队列（数组）"></a>循环队列（数组）</h5><h5 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h5><ol>
<li><p>队列初始化</p>
<p>front和rear的值都是0。</p>
</li>
<li><p>队列非空</p>
<p>front代表队列的第一个元素。</p>
<p>rear代表队列的最后一个有效 元素的下一个元素。</p>
</li>
<li><p>队列空</p>
<p>front和rear的值相等，但他们的值不一定时0。</p>
</li>
</ol>
<p><img src="/2021/04/19/Data-LinkedList/2021-04-22_15-45-41.png"></p>
<h5 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h5><p>入队: 将值存入r所代表的位置，接着r后移一位。</p>
<p>出队:f后移一位。</p>
<h5 id="如何判断循环队列是否已满"><a href="#如何判断循环队列是否已满" class="headerlink" title="如何判断循环队列是否已满"></a>如何判断循环队列是否已满</h5><p>​    r==f时候，可能为空，页可能满的。</p>
<ol>
<li><p>多增加一个标识参数，存放元素个数</p>
</li>
<li><p>少用一个元素</p>
<p>(r+1)%数组的长度 = f</p>
</li>
</ol>
<h1 id=""><a href="#" class="headerlink" title=""></a><img src="/2021/04/19/Data-LinkedList/2021-04-22_17-48-04_circleLinkedList.png"></h1><p>![](Data-LinkedList/Screenshot from 2021-04-22 17-48-04_circleLinkedList.png)</p>
<p>CircleQueue</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Queue</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> *pBase;</span><br><span class="line">    <span class="keyword">int</span> front;</span><br><span class="line">    <span class="keyword">int</span> rear;</span><br><span class="line">&#125; QUEUE;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(QUEUE *)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">en_queue</span><span class="params">(QUEUE *, <span class="keyword">int</span> val)</span></span>; <span class="comment">//入队</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">traverse_queue</span><span class="params">(QUEUE *)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">full_queue</span><span class="params">(QUEUE *pQueue)</span></span>;<span class="comment">//队列是否已满</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">out_queue</span><span class="params">(QUEUE *pQueue, <span class="keyword">int</span> *pInt)</span></span>; <span class="comment">//出队</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">empty_queue</span><span class="params">(QUEUE *pQueue)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    QUEUE Q;</span><br><span class="line">    init(&amp;Q);</span><br><span class="line">    en_queue(&amp;Q, <span class="number">2</span>);</span><br><span class="line">    en_queue(&amp;Q, <span class="number">7</span>);</span><br><span class="line">    en_queue(&amp;Q, <span class="number">33</span>);</span><br><span class="line">    en_queue(&amp;Q, <span class="number">4</span>);</span><br><span class="line">    en_queue(&amp;Q, <span class="number">9</span>);</span><br><span class="line"></span><br><span class="line">    traverse_queue(&amp;Q); <span class="comment">//执行这句 pQ-&gt;front会变，所以出队列失败</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    int pVal;</span></span><br><span class="line"><span class="comment">//    if(out_queue(&amp;Q,&amp;pVal))&#123;</span></span><br><span class="line"><span class="comment">//        printf(&quot;出队成功，出队元素是 %d \n&quot;,pVal);</span></span><br><span class="line"><span class="comment">//    &#125; else&#123;</span></span><br><span class="line"><span class="comment">//        printf(&quot;出队失败\n&quot;);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    traverse_queue(&amp;Q);</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(QUEUE *pQ)</span> </span>&#123;</span><br><span class="line">    pQ-&gt;pBase = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>) * <span class="number">6</span>);</span><br><span class="line">    pQ-&gt;front = <span class="number">0</span>;</span><br><span class="line">    pQ-&gt;rear = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">full_queue</span><span class="params">(QUEUE *pQ)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ((pQ-&gt;rear + <span class="number">1</span>) % <span class="number">6</span> == pQ-&gt;front) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">en_queue</span><span class="params">(QUEUE *pQ, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (full_queue(pQ)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        pQ-&gt;pBase[pQ-&gt;rear] = val;</span><br><span class="line">        pQ-&gt;rear = (pQ-&gt;rear + <span class="number">1</span>) % <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//void traverse_queue(QUEUE *pQ) &#123;</span></span><br><span class="line"><span class="comment">//    int q = pQ-&gt;front;</span></span><br><span class="line"><span class="comment">//    while ((q) % 6 != pQ-&gt;rear) &#123;</span></span><br><span class="line"><span class="comment">//        printf(&quot; %d &quot;, pQ-&gt;pBase[(pQ-&gt;front++) % 6]);</span></span><br><span class="line"><span class="comment">//        q++;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    return;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//或者下面方式</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">traverse_queue</span><span class="params">(QUEUE *pQ)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = pQ-&gt;front;</span><br><span class="line">    <span class="keyword">while</span> (i!=pQ-&gt;rear)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,pQ-&gt;pBase[i]);</span><br><span class="line">        i = (i+<span class="number">1</span>)%<span class="number">6</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">out_queue</span><span class="params">(QUEUE *pQ, <span class="keyword">int</span> *pInt)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(empty_queue(pQ))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        *pInt = pQ-&gt;pBase[pQ-&gt;front];</span><br><span class="line">        pQ-&gt;front=(pQ-&gt;front+<span class="number">1</span>)%<span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">empty_queue</span><span class="params">(QUEUE *pQ)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(pQ-&gt;front==pQ-&gt;rear)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/index.html">http://noteforme.github.io.com/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Data-Tree" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/24/Data-Tree/">Data_Tree</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2021-03-24T13:46:39.000Z" itemprop="datePublished">2021年03月24日</time>
</span>
      
  <div class="article-category">
    <i class="fa fa-classify"></i>
    <a class="article-category-link" href="/categories/DataStructure/">DataStructure</a>
  </div>

      
      
<a href="/2021/03/24/Data-Tree/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="树"><a href="#树" class="headerlink" title="树"></a>树</h4><h5 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h5><ol>
<li>满二叉树 :</li>
</ol>
<p>​        在不增加树的层数的前提下，无法再多添加一个节点的二叉树就是满二叉树。</p>
<ol start="2">
<li>完全二叉树 :</li>
</ol>
<p>​        如果只是删除了满二叉树最底层最右边的连续若干个节点，这样形成的二叉树是完全二叉树。</p>
<h5 id="树的存储"><a href="#树的存储" class="headerlink" title="树的存储"></a>树的存储</h5><p>二叉树表示法</p>
<p>​    先把一般树转化为二叉树，再存储二叉树。</p>
<p>​    一般树转化为二叉树的方法是:设法保证任意一个节点的</p>
<ol>
<li><p>左指针域指向它的第一个孩子</p>
</li>
<li><p>右指针域指向它的下一个兄弟</p>
<p>只要能满足此条件，就可以把一个普通树转化为二叉树来存储。</p>
</li>
</ol>
<h4 id="BST树-Binary-search-tree"><a href="#BST树-Binary-search-tree" class="headerlink" title="BST树- Binary search tree"></a>BST树- Binary search tree</h4><h5 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h5><p><img src="/2021/03/24/Data-Tree/2021-06-08_17-53-25.png"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">static</span> BinNodePosi&lt;T&gt; <span class="title">removeAt</span><span class="params">(BinNodePosi&lt;T&gt; &amp;x, BinNodePosi&lt;T&gt; &amp;hot)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot; x %d  \n&quot;</span>,x-&gt;data);</span><br><span class="line"></span><br><span class="line">    BinNodePosi&lt;T&gt; w = x; <span class="comment">//实际被摘除的节点，初值同x</span></span><br><span class="line">    BinNodePosi&lt;T&gt; succ = <span class="literal">NULL</span>; <span class="comment">//实际被删除节点的接替者</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">HasLChild</span> (*x)) <span class="comment">//若*x的左子树为空，则可</span></span><br><span class="line">        succ = x = x-&gt;rc; <span class="comment">//直接将*x替换为其右子树</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="built_in">HasRChild</span> (*x)) <span class="comment">//若右子树为空，则可</span></span><br><span class="line">        succ = x = x-&gt;lc; <span class="comment">//对称地处理——注意：此时succ != NULL</span></span><br><span class="line">    <span class="keyword">else</span> &#123; <span class="comment">//若左右子树均存在，则选择x的直接后继作为实际被摘除节点，为此需要</span></span><br><span class="line">        w = w-&gt;<span class="built_in">succ</span>(); <span class="comment">//（在右子树中）找到*x的直接后继*w</span></span><br><span class="line">        <span class="built_in">swap</span>(x-&gt;data, w-&gt;data); <span class="comment">//交换*x和*w的数据元素</span></span><br><span class="line">        BinNodePosi&lt;T&gt; u = w-&gt;parent;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;u %d  x %d  \n&quot;</span>,u-&gt;data,x-&gt;data);</span><br><span class="line">        ((u == x) ? u-&gt;rc : u-&gt;lc) = succ = w-&gt;rc; <span class="comment">//隔离节点*w      // (u == x)感觉没作用呀 ???</span></span><br><span class="line">    &#125;</span><br><span class="line">    hot = w-&gt;parent; <span class="comment">//记录实际被删除节点的父亲</span></span><br><span class="line">    <span class="keyword">if</span> (succ) succ-&gt;parent = hot; <span class="comment">//并将被删除节点的接替者与hot相联</span></span><br><span class="line">    <span class="built_in">release</span>(w-&gt;data);</span><br><span class="line">    <span class="built_in">release</span>(w);</span><br><span class="line">    <span class="keyword">return</span> succ; <span class="comment">//释放被摘除节点，返回接替者</span></span><br><span class="line">&#125; <span class="comment">//rele</span></span><br></pre></td></tr></table></figure>



<p>​        </p>
<h5 id="树的遍历"><a href="#树的遍历" class="headerlink" title="树的遍历"></a>树的遍历</h5><p><img src="/2021/03/24/Data-Tree/2021-04-23_17-38pre_order_traversal.png" alt="tu"></p>
<p>​    M N 作为根节点</p>
<ol>
<li><p>先序遍历[先访问根节点]</p>
<p>先访问根节点</p>
<p>再先序访问左子树</p>
<p>再先序访问右子树</p>
<p>A B Q M N L C D H K E F</p>
</li>
<li><p>中序遍历[中间访问根节点]</p>
<p>中序遍历左子树</p>
<p>再访问根节点</p>
<p>再中遍历右子树</p>
<p>M Q N B L A H D K C  E F</p>
</li>
<li><p> 后序遍历[最后访问根节点]</p>
</li>
</ol>
<p>   先中序遍历左子树</p>
<p>   再中序遍历右子树</p>
<p>   再访问根节点</p>
<p>   M N Q L B  H K D F E C A</p>
<h6 id="推导"><a href="#推导" class="headerlink" title="推导"></a>推导</h6><p>通过先序和中序或者 中序和后序可以还原出 原始的二叉树.</p>
<ol>
<li><p>示例1</p>
<p>先序: ABCDEFGH</p>
<p>中序:BDCEAFHG</p>
<p>求后序: DECBHGFA</p>
</li>
<li><p>示例2</p>
<p>先序: ABDGHCEFI</p>
<p>中序:GDHBAECIF</p>
<p><img src="/2021/03/24/Data-Tree/2021-04-23_17-38-57_order_traversal.png"></p>
<p>求后序 :  G H D B E I F C A</p>
</li>
</ol>
<h5 id="二叉树遍历示例"><a href="#二叉树遍历示例" class="headerlink" title="二叉树遍历示例"></a>二叉树遍历示例</h5><p><img src="/2021/03/24/Data-Tree/tree_traversal.code.png"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;zconf.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;malloc.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BTNode</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">BTNode</span> *<span class="title">pLchild</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">BTNode</span> *<span class="title">pRchild</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">struct BTNode *<span class="title">createBTree</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">preTraverseBTree</span><span class="params">(struct BTNode *pNode)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">BTNode</span> *<span class="title">pT</span> =</span> createBTree();</span><br><span class="line"></span><br><span class="line"><span class="comment">//    preTraverseBTree(pT);</span></span><br><span class="line"><span class="comment">//    inTraverseBTree(pT);</span></span><br><span class="line">    postTraverseBTree(pT);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">preTraverseBTree</span><span class="params">(struct BTNode *pNode)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pNode-&gt;data != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c\n&quot;</span>, pNode-&gt;data);</span><br><span class="line">        <span class="keyword">if</span> (pNode-&gt;pLchild != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            preTraverseBTree(pNode-&gt;pLchild);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pNode-&gt;pRchild != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            preTraverseBTree(pNode-&gt;pRchild);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inTraverseBTree</span><span class="params">(struct BTNode *pNode)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pNode-&gt;data != <span class="literal">NULL</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pNode-&gt;pLchild != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            inTraverseBTree(pNode-&gt;pLchild);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c\n&quot;</span>, pNode-&gt;data);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pNode-&gt;pRchild != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            inTraverseBTree(pNode-&gt;pRchild);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">postTraverseBTree</span><span class="params">(struct BTNode *pNode)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pNode-&gt;data != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (pNode-&gt;pLchild != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            postTraverseBTree(pNode-&gt;pLchild);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (pNode-&gt;pRchild != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            postTraverseBTree(pNode-&gt;pRchild);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c\n&quot;</span>, pNode-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">struct BTNode *<span class="title">createBTree</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">BTNode</span> *<span class="title">pA</span> =</span> (struct BTNode *) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct BTNode));</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">BTNode</span> *<span class="title">pB</span> =</span> (struct BTNode *) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct BTNode));</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">BTNode</span> *<span class="title">pC</span> =</span> (struct BTNode *) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct BTNode));</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">BTNode</span> *<span class="title">pD</span> =</span> (struct BTNode *) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct BTNode));</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">BTNode</span> *<span class="title">pE</span> =</span> (struct BTNode *) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct BTNode));</span><br><span class="line"></span><br><span class="line">    pA-&gt;data = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">    pB-&gt;data = <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">    pC-&gt;data = <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">    pD-&gt;data = <span class="string">&#x27;D&#x27;</span>;</span><br><span class="line">    pE-&gt;data = <span class="string">&#x27;E&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    pA-&gt;pLchild = pB;</span><br><span class="line">    pA-&gt;pRchild = pC;</span><br><span class="line">    pB-&gt;pLchild = pB-&gt;pRchild = <span class="literal">NULL</span>;</span><br><span class="line">    pC-&gt;pLchild = pD;</span><br><span class="line">    pC-&gt;pRchild = <span class="literal">NULL</span>;</span><br><span class="line">    pD-&gt;pLchild = <span class="literal">NULL</span>;</span><br><span class="line">    pD-&gt;pRchild = pE;</span><br><span class="line">    pE-&gt;pLchild = pE-&gt;pRchild = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> pA;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="AVL树"><a href="#AVL树" class="headerlink" title="AVL树"></a>AVL树</h5><p>左右子树的高度差 不超过1</p>
<p><img src="/2021/03/24/Data-Tree/2021-06-09_16-38-48_avl.png"></p>
<p>通过左旋或者右旋(左旋右旋后一定不会破坏二叉搜索树的查找规则</p>
<p><img src="/2021/03/24/Data-Tree/AVL.png"></p>
<h5 id="zig-zag"><a href="#zig-zag" class="headerlink" title="zig zag"></a>zig zag</h5><p>zig    顺时针</p>
<p>zag  逆时针</p>
<p><img src="/2021/03/24/Data-Tree/2021-06-09_15-10-10.png"></p>
<p>g : grandparent节点</p>
<p>p : parent节点</p>
<h5 id="zigzig"><a href="#zigzig" class="headerlink" title="zigzig"></a>zigzig</h5><p><img src="/2021/03/24/Data-Tree/2021-06-09_15-24-12_zigzig.png"></p>
<h5 id="zigzag节点"><a href="#zigzag节点" class="headerlink" title="zigzag节点"></a>zigzag节点</h5><p><img src="/2021/03/24/Data-Tree/home/mc/Documents/noteforme.github.io/source/_posts/Data-Tree/2021-06-09_15-26-26_zigzag.png"></p>
<p>类似工人组装魔方，确定好 G P V 所对应的 a b c ,何 0 1 2 3 所对应的 T0 T1 T2  T3,直接组装程图1的树</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; BinNodePosi&lt;T&gt; BST&lt;T&gt;::<span class="built_in">rotateAt</span> ( BinNodePosi&lt;T&gt; v ) &#123; <span class="comment">//v为非空孙辈节点</span></span><br><span class="line">    <span class="comment">/*DSA*/</span><span class="keyword">if</span> ( !v ) &#123; <span class="built_in">printf</span> ( <span class="string">&quot;\a\nFail to rotate a null node\n&quot;</span> ); <span class="built_in">exit</span> ( <span class="number">-1</span> ); &#125;</span><br><span class="line">    BinNodePosi&lt;T&gt; p = v-&gt;parent; BinNodePosi&lt;T&gt; g = p-&gt;parent; <span class="comment">//视v、p和g相对位置分四种情况</span></span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">IsLChild</span> ( *p ) ) <span class="comment">/* zig */</span></span><br><span class="line">        <span class="keyword">if</span> ( <span class="built_in">IsLChild</span> ( *v ) ) &#123; <span class="comment">/* zig-zig */</span> <span class="comment">//*DSA*/printf(&quot;\tzIg-zIg: &quot;);</span></span><br><span class="line">            p-&gt;parent = g-&gt;parent; <span class="comment">//向上联接</span></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">connect34</span> ( v, p, g, v-&gt;lc, v-&gt;rc, p-&gt;rc, g-&gt;rc );</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">/* zig-zag */</span>  <span class="comment">//*DSA*/printf(&quot;\tzIg-zAg: &quot;);</span></span><br><span class="line">            v-&gt;parent = g-&gt;parent; <span class="comment">//向上联接</span></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">connect34</span> ( p, v, g, p-&gt;lc, v-&gt;lc, v-&gt;rc, g-&gt;rc );</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">else</span>  <span class="comment">/* zag */</span></span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">IsRChild</span> ( *v ) ) &#123; <span class="comment">/* zag-zag */</span> <span class="comment">//*DSA*/printf(&quot;\tzAg-zAg: &quot;);</span></span><br><span class="line">        p-&gt;parent = g-&gt;parent; <span class="comment">//向上联接</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">connect34</span> ( g, p, v, g-&gt;lc, p-&gt;lc, v-&gt;lc, v-&gt;rc );</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">/* zag-zig */</span>  <span class="comment">//*DSA*/printf(&quot;\tzAg-zIg: &quot;);</span></span><br><span class="line">        v-&gt;parent = g-&gt;parent; <span class="comment">//向上联接</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">connect34</span> ( g, v, p, g-&gt;lc, v-&gt;lc, v-&gt;rc, p-&gt;rc );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<h4 id="伸缩树"><a href="#伸缩树" class="headerlink" title="伸缩树"></a>伸缩树</h4><p><img src="/2021/03/24/Data-Tree/2021-06-09_22-05-22_shensuo.png"></p>
<h4 id="B-Tree"><a href="#B-Tree" class="headerlink" title="B-Tree"></a>B-Tree</h4><p>B树解决 一段一段从IO读取数据</p>
<p><img src="/2021/03/24/Data-Tree/2021-06-10_22-21-20_btree.png"></p>
<p><img src="/2021/03/24/Data-Tree/2021-06-10_22-59-50_BTREE2.png"></p>
<p><a target="_blank" rel="noopener" href="https://www.xuetangx.com/learn/THU08091002048/THU08091002048/5883385/video/9195150">地址</a></p>
<h5 id="B树插入"><a href="#B树插入" class="headerlink" title="B树插入"></a>B树插入</h5><p>因为新节点的插入，导致所属节点的分支数超过B树阶次m的情况称作overflow</p>
<p><img src="/2021/03/24/Data-Tree/2021-06-11_15-07-47_btree_define.png"></p>
<p>​             m=5时，每个节点的分支数不超过5，一般节点分支树不少于是3, (3,5)</p>
<p>​            m=6    对于6阶B树，分支树的上限是6，下限是3。 (3,6)</p>
<h5 id="B树"><a href="#B树" class="headerlink" title="B树"></a>B树</h5><h6 id="上溢分裂"><a href="#上溢分裂" class="headerlink" title="上溢分裂"></a>上溢分裂</h6><p><img src="/2021/03/24/Data-Tree/2021-06-11_14-55-51_btree.png"></p>
<p>A[n/2]节点中点分裂</p>
<p><img src="/2021/03/24/Data-Tree/2021-06-11_15-32-52_split1.png"></p>
<p><img src="/2021/03/24/Data-Tree/2021-06-11_15-32-59_split2.png"></p>
<p>​               插入37，然后上溢分裂  </p>
<h6 id="下溢"><a href="#下溢" class="headerlink" title="下溢"></a>下溢</h6><p> 先从兄弟树借节点，借不到的话就合并</p>
<h4 id="2-3-4树"><a href="#2-3-4树" class="headerlink" title="2-3-4树"></a>2-3-4树</h4><h5 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h5><ol>
<li><p>所有叶子节点都拥有相同的深度。</p>
</li>
<li><p>节点只能是 2-节点、3-节点、4-节点之一。</p>
<blockquote>
<p>2-节点:包含 1 个元素的节点，有 2 个子节点; </p>
<p>3-节点:包含 2 个元素的节点，有 3 个子节点; </p>
<p>4-节点:包含 3 个元素的节点，有 4 个子节点; 所有节点必须至少包含1个元素</p>
</blockquote>
</li>
<li><p>元素始终保持排序顺序，整体上保持二叉查找树的性质，即父结点大于左子结点，小于右子结点;<br>  而且结点有多个元素时，每个元素必须大于它左边的和它的左子树中元素。</p>
</li>
</ol>
<h5 id="2-3树的生长"><a href="#2-3树的生长" class="headerlink" title="2-3树的生长"></a>2-3树的生长</h5><p>和标准的二叉查找树由上向下生长不同，2-3树的生长是由下向上的。</p>
<p><img src="/2021/03/24/Data-Tree/2-3grow.png"></p>
<h4 id="红黑二叉查找树"><a href="#红黑二叉查找树" class="headerlink" title="红黑二叉查找树"></a>红黑二叉查找树</h4><h5 id="2-3-4树与红黑树的等价关系"><a href="#2-3-4树与红黑树的等价关系" class="headerlink" title="2-3-4树与红黑树的等价关系"></a>2-3-4树与红黑树的等价关系</h5><p><img src="/2021/03/24/Data-Tree/2-3-4%E6%A0%91%E5%92%8C%E7%BA%A2%E9%BB%91%E6%A0%91%E7%AD%89%E4%BB%B7%E5%85%B3%E7%B3%BB.png"></p>
<p>​    </p>
<p>​        裂变状态 9先从黑节点(从4节点)变成红节点，10、12先从红节点变成黑节点。</p>
<h5 id="2-3-4-树"><a href="#2-3-4-树" class="headerlink" title="2-3-4 树"></a>2-3-4 树</h5><p>新增操作，从叶子节点开始</p>
<p><img src="/2021/03/24/Data-Tree/2-3-4%E6%A0%91.png"></p>
<h5 id="红黑树"><a href="#红黑树" class="headerlink" title="红黑树"></a>红黑树</h5><p><img src="/2021/03/24/Data-Tree/2021-06-12_20-50-01_redbtree.png"></p>
<h5 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h5><p>红黑树是一种结点带有颜色属性的二叉查找树，但它在二叉查找树之外，还有以下5大性质:</p>
<ol>
<li>节点是红色或黑色。</li>
<li>根是黑色。</li>
<li>所有叶子都是黑色(叶子是NIL节点，这类节点不可以忽视，否则代码会看不懂)。</li>
<li>每个红色节点必须有两个黑色的子节点。(从每个叶子到根的所有路径上不能有两个连续的红色节点。)</li>
<li>从任一节点到其每个叶子的所有简单路径都包含相同数目的黑色节点(黑色平衡)。// 2-3-4树层级相等.</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://www.cs.usfca.edu/~galles/visualization/RedBlack.html">https://www.cs.usfca.edu/~galles/visualization/RedBlack.html</a></p>
<p>红黑树 新增都是红色节点</p>
<p>根据上面的等价关系，把2-3-4树转换成下面的红黑树。</p>
<p><img src="/2021/03/24/Data-Tree/%E8%BD%AC%E5%8C%96%E4%B8%BA%E7%BA%A2%E9%BB%91%E6%A0%91.png"></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV135411h7wJ?p=4">https://www.bilibili.com/video/BV135411h7wJ?p=4</a></p>
<h5 id="旋转"><a href="#旋转" class="headerlink" title="旋转"></a>旋转</h5><p><img src="/2021/03/24/Data-Tree/%E5%B7%A6%E6%97%8B.gif"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 围绕p左旋</span></span><br><span class="line"><span class="comment">   *       pf                    pf</span></span><br><span class="line"><span class="comment">   *      /                     /</span></span><br><span class="line"><span class="comment">   *     p                     pr(r)</span></span><br><span class="line"><span class="comment">   *    / \          ==&gt;      / \</span></span><br><span class="line"><span class="comment">   *  pl  pr(r)              p   rr</span></span><br><span class="line"><span class="comment">   *     / \                / \</span></span><br><span class="line"><span class="comment">   *    rl  rr             pl  rl</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> p</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">leftRotate</span><span class="params">(RBNode p)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (p != <span class="keyword">null</span>) &#123;</span><br><span class="line">          RBNode r = p.right;</span><br><span class="line">          p.right = r.left;</span><br><span class="line">          <span class="keyword">if</span> (r.left != <span class="keyword">null</span>) &#123;</span><br><span class="line">              r.left.parent = p;</span><br><span class="line">          &#125;</span><br><span class="line">          r.parent = p.parent;</span><br><span class="line">          <span class="keyword">if</span> (p.parent == <span class="keyword">null</span>) &#123;</span><br><span class="line">              root = r;</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (p.parent.left == p) &#123;</span><br><span class="line">              p.parent.left = r;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              p.parent.right = r;</span><br><span class="line">          &#125;</span><br><span class="line">          r.left = p;</span><br><span class="line">          p.parent = r;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>





<p><img src="/2021/03/24/Data-Tree/%E5%8F%B3%E6%97%8B.gif"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 右旋</span></span><br><span class="line"><span class="comment">   *    pf                pf</span></span><br><span class="line"><span class="comment">   *     \                 \</span></span><br><span class="line"><span class="comment">   *      p             (l)pl</span></span><br><span class="line"><span class="comment">   *     / \      =&gt;      /  \</span></span><br><span class="line"><span class="comment">   *(l)pl  pr            ll   p</span></span><br><span class="line"><span class="comment">   *   / \                   / \</span></span><br><span class="line"><span class="comment">   *  ll lr                 lr  pr</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> p</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">rightRotate</span><span class="params">(RBNode p)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (p != <span class="keyword">null</span>) &#123;</span><br><span class="line">          RBNode l = p.left;</span><br><span class="line">          p.left = l.right;</span><br><span class="line">          <span class="keyword">if</span> (l.right != <span class="keyword">null</span>) &#123;</span><br><span class="line">              l.right.parent = p;</span><br><span class="line">          &#125;</span><br><span class="line">          l.parent = p.parent;</span><br><span class="line">          <span class="keyword">if</span> (p.parent == <span class="keyword">null</span>) &#123;</span><br><span class="line">              root = l;</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (p.parent.right == p) &#123;</span><br><span class="line">              p.parent.right = l;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              p.parent.left = l;</span><br><span class="line">          &#125;</span><br><span class="line">          l.right = p;</span><br><span class="line">          p.parent = l;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>



<h5 id="新增"><a href="#新增" class="headerlink" title="新增"></a>新增</h5><p>红黑树新增，第一个节点 是红节点</p>
<p><img src="/2021/03/24/Data-Tree/tree_insert_01.png"></p>
<img src="/2021/03/24/Data-Tree/tree_insert_02.png" style="zoom:150%;">



<p>新增的节点都是红节点 </p>
<p>红黑树形成过程，忘了怎么形成，包括旋转 ， 节点颜色是怎么变化的。</p>
<h5 id="删除-1"><a href="#删除-1" class="headerlink" title="删除"></a>删除</h5><p><a target="_blank" rel="noopener" href="https://www.cs.usfca.edu/~galles/visualization/RedBlack.html">https://www.cs.usfca.edu/~galles/visualization/RedBlack.html</a></p>
<h4 id="图"><a href="#图" class="headerlink" title="图"></a>图</h4><p>找到最优路径</p>

        
        
          <blockquote id="copyright">
              <p>Original link: <a href="http://noteforme.github.io.com/index.html">http://noteforme.github.io.com/index.html</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
      
    </footer>
  </div>
</article>



    <nav id="page-nav">

<span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/2/">Next</a>
</nav>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-posts"></i> Recent</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/08/30/Leetcode-Linklist/">Leetcode_Linklist</a>
          </li>
        
          <li>
            <a href="/2021/08/29/Dagger/">Dagger</a>
          </li>
        
          <li>
            <a href="/2021/08/22/kotlin-senior/">kotlin-senior</a>
          </li>
        
          <li>
            <a href="/2021/08/21/kotlin-object/">kotlin-object</a>
          </li>
        
          <li>
            <a href="/2021/08/21/kotlin-medium/">kotlin-medium</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-tag"></i> Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AOSP/" style="font-size: 20px;">AOSP</a> <a href="/tags/Activity/" style="font-size: 10px;">Activity</a> <a href="/tags/AndroidNewFeatures/" style="font-size: 10px;">AndroidNewFeatures</a> <a href="/tags/Assembly/" style="font-size: 10px;">Assembly</a> <a href="/tags/BLOG/" style="font-size: 10px;">BLOG</a> <a href="/tags/ConstraintLayout/" style="font-size: 10px;">ConstraintLayout</a> <a href="/tags/DB/" style="font-size: 11.67px;">DB</a> <a href="/tags/DataStructure/" style="font-size: 10px;">DataStructure</a> <a href="/tags/Drawer/" style="font-size: 10px;">Drawer</a> <a href="/tags/Git/" style="font-size: 11.67px;">Git</a> <a href="/tags/JVM/" style="font-size: 18.33px;">JVM</a> <a href="/tags/RxJava/" style="font-size: 15px;">RxJava</a> <a href="/tags/THINK/" style="font-size: 10px;">THINK</a> <a href="/tags/TabLayout/" style="font-size: 10px;">TabLayout</a> <a href="/tags/Test/" style="font-size: 15px;">Test</a> <a href="/tags/TouchEvent/" style="font-size: 13.33px;">TouchEvent</a> <a href="/tags/VIEW/" style="font-size: 13.33px;">VIEW</a> <a href="/tags/concurrency/" style="font-size: 15px;">concurrency</a> <a href="/tags/inter/" style="font-size: 16.67px;">inter</a> <a href="/tags/keyboard/" style="font-size: 10px;">keyboard</a> <a href="/tags/operators/" style="font-size: 10px;">operators</a> <a href="/tags/proguard/" style="font-size: 10px;">proguard</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-classify"></i> Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ANDROID/">ANDROID</a><span class="category-list-count">54</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/BLE/">BLE</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DataStructure/">DataStructure</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DesignPatterns/">DesignPatterns</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ENGLISH/">ENGLISH</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Jetpack/">Jetpack</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kotlin/">Kotlin</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/LINUX/">LINUX</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mathematics/">Mathematics</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS/">OS</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Organization/">Organization</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TEST/">TEST</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TOOL/">TOOL</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/VIEW/">VIEW</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/anim/">anim</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/flutter/">flutter</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/kotlin/">kotlin</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-archive"></i> Archive</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021年08月</a><span class="archive-list-count">17</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020年12月</a><span class="archive-list-count">45</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019年12月</a><span class="archive-list-count">20</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018年11月</a><span class="archive-list-count">32</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017年12月</a><span class="archive-list-count">57</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-tag"></i> Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AOSP/" rel="tag">AOSP</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Activity/" rel="tag">Activity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AndroidNewFeatures/" rel="tag">AndroidNewFeatures</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Assembly/" rel="tag">Assembly</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BLOG/" rel="tag">BLOG</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ConstraintLayout/" rel="tag">ConstraintLayout</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DB/" rel="tag">DB</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DataStructure/" rel="tag">DataStructure</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Drawer/" rel="tag">Drawer</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/" rel="tag">JVM</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RxJava/" rel="tag">RxJava</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/THINK/" rel="tag">THINK</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TabLayout/" rel="tag">TabLayout</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Test/" rel="tag">Test</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TouchEvent/" rel="tag">TouchEvent</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VIEW/" rel="tag">VIEW</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/concurrency/" rel="tag">concurrency</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/inter/" rel="tag">inter</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/keyboard/" rel="tag">keyboard</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/operators/" rel="tag">operators</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/proguard/" rel="tag">proguard</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-link"></i> Blogroll</h3>
    <div class="widget">
      <ul>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example1.com/">site-name1</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example2.com/">site-name2</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example3.com/">site-name3</a>
        </li>
      
      </ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <a id="totop" href="#top"></a>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      <p>
        <a href="/sitemap.xml">Site Map</a>
        <span> | </span><a href="/atom.xml">Subscribe to this site</a>
        <span> | </span><a href="/about/">Contact the blogger</a>
      </p>
      
        <p>
          <i class="fa fa-visitors"></i>
          <i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>
          ，
          <i class="fa fa-views"></i>
          <i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>
        </p>
      
      <p>
        <span>Copyright &copy; 2021 Jon.</span>
        <span>Theme by <a href="https://github.com/chaooo/hexo-theme-BlueLake/" target="_blank">BlueLake.</a></span>
        
            <span>Count by <a href="http://busuanzi.ibruce.info/" target="_blank">busuanzi.</a></span>
        
        <span>Powered by <a href="https://hexo.io/" target="_blank">Hexo.</a></span>
      </p>
    </div>
  </div>
</footer>

    </div>
    
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/search.json.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>






  
<script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



  
<script src="/localshare/js/social-share.js"></script>

  
<script src="/localshare/js/qrcode.js"></script>




















  </div>
</body>
</html>